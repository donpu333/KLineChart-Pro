// node_modules/klinecharts/dist/index.esm.js
var extendStatics = function(d10, b) {
  extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d11, b10) {
    d11.__proto__ = b10;
  } || function(d11, b10) {
    for (var p in b10) if (Object.prototype.hasOwnProperty.call(b10, p)) d11[p] = b10[p];
  };
  return extendStatics(d10, b);
};
function __extends(d10, b) {
  if (typeof b !== "function" && b !== null)
    throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
  extendStatics(d10, b);
  function __() {
    this.constructor = d10;
  }
  d10.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}
var __assign = function() {
  __assign = Object.assign || function __assign2(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
    }
    return t;
  };
  return __assign.apply(this, arguments);
};
function __awaiter(thisArg, _arguments, P, generator) {
  function adopt(value) {
    return value instanceof P ? value : new P(function(resolve) {
      resolve(value);
    });
  }
  return new (P || (P = Promise))(function(resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }
    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }
    function step(result) {
      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);
    }
    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
}
function __generator(thisArg, body) {
  var _ = { label: 0, sent: function() {
    if (t[0] & 1) throw t[1];
    return t[1];
  }, trys: [], ops: [] }, f, y, t, g5 = Object.create((typeof Iterator === "function" ? Iterator : Object).prototype);
  return g5.next = verb(0), g5["throw"] = verb(1), g5["return"] = verb(2), typeof Symbol === "function" && (g5[Symbol.iterator] = function() {
    return this;
  }), g5;
  function verb(n) {
    return function(v) {
      return step([n, v]);
    };
  }
  function step(op) {
    if (f) throw new TypeError("Generator is already executing.");
    while (g5 && (g5 = 0, op[0] && (_ = 0)), _) try {
      if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
      if (y = 0, t) op = [op[0] & 2, t.value];
      switch (op[0]) {
        case 0:
        case 1:
          t = op;
          break;
        case 4:
          _.label++;
          return { value: op[1], done: false };
        case 5:
          _.label++;
          y = op[1];
          op = [0];
          continue;
        case 7:
          op = _.ops.pop();
          _.trys.pop();
          continue;
        default:
          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
            _ = 0;
            continue;
          }
          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
            _.label = op[1];
            break;
          }
          if (op[0] === 6 && _.label < t[1]) {
            _.label = t[1];
            t = op;
            break;
          }
          if (t && _.label < t[2]) {
            _.label = t[2];
            _.ops.push(op);
            break;
          }
          if (t[2]) _.ops.pop();
          _.trys.pop();
          continue;
      }
      op = body.call(thisArg, _);
    } catch (e) {
      op = [6, e];
      y = 0;
    } finally {
      f = t = 0;
    }
    if (op[0] & 5) throw op[1];
    return { value: op[0] ? op[1] : void 0, done: true };
  }
}
function __values(o) {
  var s = typeof Symbol === "function" && Symbol.iterator, m10 = s && o[s], i = 0;
  if (m10) return m10.call(o);
  if (o && typeof o.length === "number") return {
    next: function() {
      if (o && i >= o.length) o = void 0;
      return { value: o && o[i++], done: !o };
    }
  };
  throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function __read(o, n) {
  var m10 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m10) return o;
  var i = m10.call(o), r, ar2 = [], e;
  try {
    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar2.push(r.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r && !r.done && (m10 = i["return"])) m10.call(i);
    } finally {
      if (e) throw e.error;
    }
  }
  return ar2;
}
function __spreadArray(to2, from, pack) {
  if (pack || arguments.length === 2) for (var i = 0, l10 = from.length, ar2; i < l10; i++) {
    if (ar2 || !(i in from)) {
      if (!ar2) ar2 = Array.prototype.slice.call(from, 0, i);
      ar2[i] = from[i];
    }
  }
  return to2.concat(ar2 || Array.prototype.slice.call(from));
}
var LineType;
(function(LineType2) {
  LineType2["Dashed"] = "dashed";
  LineType2["Solid"] = "solid";
})(LineType || (LineType = {}));
var PolygonType;
(function(PolygonType2) {
  PolygonType2["Stroke"] = "stroke";
  PolygonType2["Fill"] = "fill";
  PolygonType2["StrokeFill"] = "stroke_fill";
})(PolygonType || (PolygonType = {}));
var TooltipShowRule;
(function(TooltipShowRule2) {
  TooltipShowRule2["Always"] = "always";
  TooltipShowRule2["FollowCross"] = "follow_cross";
  TooltipShowRule2["None"] = "none";
})(TooltipShowRule || (TooltipShowRule = {}));
var TooltipShowType;
(function(TooltipShowType2) {
  TooltipShowType2["Standard"] = "standard";
  TooltipShowType2["Rect"] = "rect";
})(TooltipShowType || (TooltipShowType = {}));
var TooltipIconPosition;
(function(TooltipIconPosition2) {
  TooltipIconPosition2["Left"] = "left";
  TooltipIconPosition2["Middle"] = "middle";
  TooltipIconPosition2["Right"] = "right";
})(TooltipIconPosition || (TooltipIconPosition = {}));
var CandleTooltipRectPosition;
(function(CandleTooltipRectPosition2) {
  CandleTooltipRectPosition2["Fixed"] = "fixed";
  CandleTooltipRectPosition2["Pointer"] = "pointer";
})(CandleTooltipRectPosition || (CandleTooltipRectPosition = {}));
var CandleType;
(function(CandleType2) {
  CandleType2["CandleSolid"] = "candle_solid";
  CandleType2["CandleStroke"] = "candle_stroke";
  CandleType2["CandleUpStroke"] = "candle_up_stroke";
  CandleType2["CandleDownStroke"] = "candle_down_stroke";
  CandleType2["Ohlc"] = "ohlc";
  CandleType2["Area"] = "area";
})(CandleType || (CandleType = {}));
var YAxisPosition;
(function(YAxisPosition2) {
  YAxisPosition2["Left"] = "left";
  YAxisPosition2["Right"] = "right";
})(YAxisPosition || (YAxisPosition = {}));
var YAxisType;
(function(YAxisType2) {
  YAxisType2["Normal"] = "normal";
  YAxisType2["Percentage"] = "percentage";
  YAxisType2["Log"] = "log";
})(YAxisType || (YAxisType = {}));
var red = "#F92855";
var alphaRed = "rgba(249, 40, 85, .7)";
var green = "#2DC08E";
var alphaGreen = "rgba(45, 192, 142, .7)";
var grey = "#888888";
var white = "#FFFFFF";
var blue = "#1677FF";
var textColor = "#76808F";
var axisLineColor = "#DDDDDD";
function getAlphaBlue(alpha) {
  return "rgba(22, 119, 255, ".concat(alpha, ")");
}
function getDefaultGridStyle() {
  function item() {
    return {
      show: true,
      size: 1,
      color: "#EDEDED",
      style: LineType.Dashed,
      dashedValue: [2, 2]
    };
  }
  return {
    show: true,
    horizontal: item(),
    vertical: item()
  };
}
function getDefaultCandleStyle() {
  var highLow = {
    show: true,
    color: textColor,
    textOffset: 5,
    textSize: 10,
    textFamily: "Helvetica Neue",
    textWeight: "normal"
  };
  return {
    type: CandleType.CandleSolid,
    bar: {
      upColor: green,
      downColor: red,
      noChangeColor: grey,
      upBorderColor: green,
      downBorderColor: red,
      noChangeBorderColor: grey,
      upWickColor: green,
      downWickColor: red,
      noChangeWickColor: grey
    },
    area: {
      lineSize: 2,
      lineColor: blue,
      smooth: false,
      value: "close",
      backgroundColor: [{
        offset: 0,
        color: getAlphaBlue(0.01)
      }, {
        offset: 1,
        color: getAlphaBlue(0.2)
      }],
      point: {
        show: true,
        color: blue,
        radius: 4,
        rippleColor: getAlphaBlue(0.3),
        rippleRadius: 8,
        animation: true,
        animationDuration: 1e3
      }
    },
    priceMark: {
      show: true,
      high: __assign({}, highLow),
      low: __assign({}, highLow),
      last: {
        show: true,
        upColor: green,
        downColor: red,
        noChangeColor: grey,
        line: {
          show: true,
          style: LineType.Dashed,
          dashedValue: [4, 4],
          size: 1
        },
        text: {
          show: true,
          style: PolygonType.Fill,
          size: 12,
          paddingLeft: 4,
          paddingTop: 4,
          paddingRight: 4,
          paddingBottom: 4,
          borderColor: "transparent",
          borderStyle: LineType.Solid,
          borderSize: 0,
          borderDashedValue: [2, 2],
          color: white,
          family: "Helvetica Neue",
          weight: "normal",
          borderRadius: 2
        }
      }
    },
    tooltip: {
      offsetLeft: 4,
      offsetTop: 6,
      offsetRight: 4,
      offsetBottom: 6,
      showRule: TooltipShowRule.Always,
      showType: TooltipShowType.Standard,
      custom: [
        { title: "time", value: "{time}" },
        { title: "open", value: "{open}" },
        { title: "high", value: "{high}" },
        { title: "low", value: "{low}" },
        { title: "close", value: "{close}" },
        { title: "volume", value: "{volume}" }
      ],
      defaultValue: "n/a",
      rect: {
        position: CandleTooltipRectPosition.Fixed,
        paddingLeft: 4,
        paddingRight: 4,
        paddingTop: 4,
        paddingBottom: 4,
        offsetLeft: 4,
        offsetTop: 4,
        offsetRight: 4,
        offsetBottom: 4,
        borderRadius: 4,
        borderSize: 1,
        borderColor: "#F2F3F5",
        color: "#FEFEFE"
      },
      text: {
        size: 12,
        family: "Helvetica Neue",
        weight: "normal",
        color: textColor,
        marginLeft: 8,
        marginTop: 4,
        marginRight: 8,
        marginBottom: 4
      },
      icons: []
    }
  };
}
function getDefaultIndicatorStyle() {
  var lines = ["#FF9600", "#935EBD", blue, "#E11D74", "#01C5C4"].map(function(color) {
    return {
      style: LineType.Solid,
      smooth: false,
      size: 1,
      dashedValue: [2, 2],
      color
    };
  });
  return {
    ohlc: {
      upColor: alphaGreen,
      downColor: alphaRed,
      noChangeColor: grey
    },
    bars: [{
      style: PolygonType.Fill,
      borderStyle: LineType.Solid,
      borderSize: 1,
      borderDashedValue: [2, 2],
      upColor: alphaGreen,
      downColor: alphaRed,
      noChangeColor: grey
    }],
    lines,
    circles: [{
      style: PolygonType.Fill,
      borderStyle: LineType.Solid,
      borderSize: 1,
      borderDashedValue: [2, 2],
      upColor: alphaGreen,
      downColor: alphaRed,
      noChangeColor: grey
    }],
    lastValueMark: {
      show: false,
      text: {
        show: false,
        style: PolygonType.Fill,
        color: white,
        size: 12,
        family: "Helvetica Neue",
        weight: "normal",
        borderStyle: LineType.Solid,
        borderColor: "transparent",
        borderSize: 0,
        borderDashedValue: [2, 2],
        paddingLeft: 4,
        paddingTop: 4,
        paddingRight: 4,
        paddingBottom: 4,
        borderRadius: 2
      }
    },
    tooltip: {
      offsetLeft: 4,
      offsetTop: 6,
      offsetRight: 4,
      offsetBottom: 6,
      showRule: TooltipShowRule.Always,
      showType: TooltipShowType.Standard,
      showName: true,
      showParams: true,
      defaultValue: "n/a",
      text: {
        size: 12,
        family: "Helvetica Neue",
        weight: "normal",
        color: textColor,
        marginLeft: 8,
        marginTop: 4,
        marginRight: 8,
        marginBottom: 4
      },
      icons: []
    }
  };
}
function getDefaultXAxisStyle() {
  return {
    show: true,
    size: "auto",
    axisLine: {
      show: true,
      color: axisLineColor,
      size: 1
    },
    tickText: {
      show: true,
      color: textColor,
      size: 12,
      family: "Helvetica Neue",
      weight: "normal",
      marginStart: 4,
      marginEnd: 4
    },
    tickLine: {
      show: true,
      size: 1,
      length: 3,
      color: axisLineColor
    }
  };
}
function getDefaultYAxisStyle() {
  var style = getDefaultXAxisStyle();
  style.type = YAxisType.Normal;
  style.position = YAxisPosition.Right;
  style.inside = false;
  style.reverse = false;
  return style;
}
function getDefaultCrosshairStyle() {
  function item() {
    return {
      show: true,
      line: {
        show: true,
        style: LineType.Dashed,
        dashedValue: [4, 2],
        size: 1,
        color: textColor
      },
      text: {
        show: true,
        style: PolygonType.Fill,
        color: white,
        size: 12,
        family: "Helvetica Neue",
        weight: "normal",
        borderStyle: LineType.Solid,
        borderDashedValue: [2, 2],
        borderSize: 1,
        borderColor: textColor,
        borderRadius: 2,
        paddingLeft: 4,
        paddingRight: 4,
        paddingTop: 4,
        paddingBottom: 4,
        backgroundColor: textColor
      }
    };
  }
  return {
    show: true,
    horizontal: item(),
    vertical: item()
  };
}
function getDefaultOverlayStyle() {
  var pointBorderColor = getAlphaBlue(0.35);
  var alphaBg = getAlphaBlue(0.25);
  function text2() {
    return {
      style: PolygonType.Fill,
      color: white,
      size: 12,
      family: "Helvetica Neue",
      weight: "normal",
      borderStyle: LineType.Solid,
      borderDashedValue: [2, 2],
      borderSize: 1,
      borderRadius: 2,
      borderColor: blue,
      paddingLeft: 4,
      paddingRight: 4,
      paddingTop: 4,
      paddingBottom: 4,
      backgroundColor: blue
    };
  }
  return {
    point: {
      color: blue,
      borderColor: pointBorderColor,
      borderSize: 1,
      radius: 5,
      activeColor: blue,
      activeBorderColor: pointBorderColor,
      activeBorderSize: 3,
      activeRadius: 5
    },
    line: {
      style: LineType.Solid,
      smooth: false,
      color: blue,
      size: 1,
      dashedValue: [2, 2]
    },
    rect: {
      style: PolygonType.Fill,
      color: alphaBg,
      borderColor: blue,
      borderSize: 1,
      borderRadius: 0,
      borderStyle: LineType.Solid,
      borderDashedValue: [2, 2]
    },
    polygon: {
      style: PolygonType.Fill,
      color: blue,
      borderColor: blue,
      borderSize: 1,
      borderStyle: LineType.Solid,
      borderDashedValue: [2, 2]
    },
    circle: {
      style: PolygonType.Fill,
      color: alphaBg,
      borderColor: blue,
      borderSize: 1,
      borderStyle: LineType.Solid,
      borderDashedValue: [2, 2]
    },
    arc: {
      style: LineType.Solid,
      color: blue,
      size: 1,
      dashedValue: [2, 2]
    },
    text: text2(),
    rectText: text2()
  };
}
function getDefaultSeparatorStyle() {
  return {
    size: 1,
    color: axisLineColor,
    fill: true,
    activeBackgroundColor: getAlphaBlue(0.08)
  };
}
function getDefaultStyles() {
  return {
    grid: getDefaultGridStyle(),
    candle: getDefaultCandleStyle(),
    indicator: getDefaultIndicatorStyle(),
    xAxis: getDefaultXAxisStyle(),
    yAxis: getDefaultYAxisStyle(),
    separator: getDefaultSeparatorStyle(),
    crosshair: getDefaultCrosshairStyle(),
    overlay: getDefaultOverlayStyle()
  };
}
var DEV = true;
function log(templateText, tagStyle, messageStyle, api, invalidParam, append) {
  if (DEV) {
    var apiStr = api !== "" ? "Call api `".concat(api, "`").concat(invalidParam !== "" || append !== "" ? ", " : ".") : "";
    var invalidParamStr = invalidParam !== "" ? "invalid parameter `".concat(invalidParam, "`").concat(append !== "" ? ", " : ".") : "";
    var appendStr = append !== "" ? append : "";
    console.log(templateText, tagStyle, messageStyle, apiStr, invalidParamStr, appendStr);
  }
}
function logWarn(api, invalidParam, append) {
  log("%c😑 klinecharts warning%c %s%s%s", "padding:3px 4px;border-radius:2px;color:#ffffff;background-color:#FF9600", "color:#FF9600", api, invalidParam, append !== null && append !== void 0 ? append : "");
}
function logError(api, invalidParam, append) {
  log("%c😟 klinecharts error%c %s%s%s", "padding:3px 4px;border-radius:2px;color:#ffffff;background-color:#F92855;", "color:#F92855;", api, invalidParam, append);
}
function logTag() {
  log("%c❤️ Welcome to klinecharts. Version is 9.8.12", "border-radius:4px;border:dashed 1px #1677FF;line-height:70px;padding:0 20px;margin:16px 0;font-size:14px;color:#1677FF;", "", "", "", "");
}
function merge(target, source) {
  if (!isObject(target) && !isObject(source)) {
    return;
  }
  for (var key in source) {
    if (Object.prototype.hasOwnProperty.call(source, key)) {
      var targetProp = target[key];
      var sourceProp = source[key];
      if (isObject(sourceProp) && isObject(targetProp)) {
        merge(targetProp, sourceProp);
      } else {
        if (isValid(source[key])) {
          target[key] = clone(source[key]);
        }
      }
    }
  }
}
function clone(target) {
  if (!isObject(target)) {
    return target;
  }
  var copy;
  if (isArray(target)) {
    copy = [];
  } else {
    copy = {};
  }
  for (var key in target) {
    if (Object.prototype.hasOwnProperty.call(target, key)) {
      var v = target[key];
      if (isObject(v)) {
        copy[key] = clone(v);
      } else {
        copy[key] = v;
      }
    }
  }
  return copy;
}
function isArray(value) {
  return Object.prototype.toString.call(value) === "[object Array]";
}
function isFunction(value) {
  return typeof value === "function";
}
function isObject(value) {
  return typeof value === "object" && isValid(value);
}
function isNumber(value) {
  return typeof value === "number" && !isNaN(value);
}
function isValid(value) {
  return value !== null && value !== void 0;
}
function isBoolean(value) {
  return typeof value === "boolean";
}
function isString(value) {
  return typeof value === "string";
}
var reEscapeChar = /\\(\\)?/g;
var rePropName = RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`, "g");
function formatValue(data, key, defaultValue) {
  if (isValid(data)) {
    var path_1 = [];
    key.replace(rePropName, function(subString) {
      var args = [];
      for (var _i2 = 1; _i2 < arguments.length; _i2++) {
        args[_i2 - 1] = arguments[_i2];
      }
      var k = subString;
      if (isValid(args[1])) {
        k = args[2].replace(reEscapeChar, "$1");
      } else if (isValid(args[0])) {
        k = args[0].trim();
      }
      path_1.push(k);
      return "";
    });
    var value = data;
    var index = 0;
    var length_1 = path_1.length;
    while (isValid(value) && index < length_1) {
      value = value === null || value === void 0 ? void 0 : value[path_1[index++]];
    }
    return isValid(value) ? value : defaultValue !== null && defaultValue !== void 0 ? defaultValue : "--";
  }
  return defaultValue !== null && defaultValue !== void 0 ? defaultValue : "--";
}
function formatDate(dateTimeFormat, timestamp, format) {
  var date = {};
  dateTimeFormat.formatToParts(new Date(timestamp)).forEach(function(_a2) {
    var type = _a2.type, value = _a2.value;
    switch (type) {
      case "year": {
        date.YYYY = value;
        break;
      }
      case "month": {
        date.MM = value;
        break;
      }
      case "day": {
        date.DD = value;
        break;
      }
      case "hour": {
        date.HH = value === "24" ? "00" : value;
        break;
      }
      case "minute": {
        date.mm = value;
        break;
      }
      case "second": {
        date.ss = value;
        break;
      }
    }
  });
  return format.replace(/YYYY|MM|DD|HH|mm|ss/g, function(key) {
    return date[key];
  });
}
function formatPrecision(value, precision) {
  var v = +value;
  if (isNumber(v)) {
    return v.toFixed(precision !== null && precision !== void 0 ? precision : 2);
  }
  return "".concat(value);
}
function formatBigNumber(value) {
  var v = +value;
  if (isNumber(v)) {
    if (v > 1e9) {
      return "".concat(+(v / 1e9).toFixed(3), "B");
    }
    if (v > 1e6) {
      return "".concat(+(v / 1e6).toFixed(3), "M");
    }
    if (v > 1e3) {
      return "".concat(+(v / 1e3).toFixed(3), "K");
    }
  }
  return "".concat(value);
}
function formatThousands(value, sign) {
  var vl2 = "".concat(value);
  if (sign.length === 0) {
    return vl2;
  }
  if (vl2.includes(".")) {
    var arr = vl2.split(".");
    return "".concat(arr[0].replace(/(\d)(?=(\d{3})+$)/g, function($12) {
      return "".concat($12).concat(sign);
    }), ".").concat(arr[1]);
  }
  return vl2.replace(/(\d)(?=(\d{3})+$)/g, function($12) {
    return "".concat($12).concat(sign);
  });
}
function formatFoldDecimal(value, threshold) {
  var vl2 = "".concat(value);
  var reg = new RegExp("\\.0{" + threshold + ",}[1-9][0-9]*$");
  if (reg.test(vl2)) {
    var result = vl2.split(".");
    var v = result[result.length - 1];
    var match = v.match(/0*/);
    if (isValid(match)) {
      var count = match[0].length;
      result[result.length - 1] = v.replace(/0*/, "0{".concat(count, "}"));
      return result.join(".");
    }
  }
  return vl2;
}
var measureCtx;
function getPixelRatio(canvas) {
  var _a2, _b, _c2;
  return (_c2 = (_b = (_a2 = canvas.ownerDocument) === null || _a2 === void 0 ? void 0 : _a2.defaultView) === null || _b === void 0 ? void 0 : _b.devicePixelRatio) !== null && _c2 !== void 0 ? _c2 : 1;
}
function createFont(size, weight, family) {
  return "".concat(weight !== null && weight !== void 0 ? weight : "normal", " ").concat(size !== null && size !== void 0 ? size : 12, "px ").concat(family !== null && family !== void 0 ? family : "Helvetica Neue");
}
function calcTextWidth(text2, size, weight, family) {
  if (!isValid(measureCtx)) {
    var canvas = document.createElement("canvas");
    var pixelRatio = getPixelRatio(canvas);
    measureCtx = canvas.getContext("2d");
    measureCtx.scale(pixelRatio, pixelRatio);
  }
  measureCtx.font = createFont(size, weight, family);
  return Math.round(measureCtx.measureText(text2).width);
}
var ActionType;
(function(ActionType2) {
  ActionType2["OnDataReady"] = "onDataReady";
  ActionType2["OnZoom"] = "onZoom";
  ActionType2["OnScroll"] = "onScroll";
  ActionType2["OnVisibleRangeChange"] = "onVisibleRangeChange";
  ActionType2["OnTooltipIconClick"] = "onTooltipIconClick";
  ActionType2["OnCrosshairChange"] = "onCrosshairChange";
  ActionType2["OnCandleBarClick"] = "onCandleBarClick";
  ActionType2["OnPaneDrag"] = "onPaneDrag";
})(ActionType || (ActionType = {}));
var Delegate = (
  /** @class */
  function() {
    function Delegate2() {
      this._callbacks = [];
    }
    Delegate2.prototype.subscribe = function(callback) {
      var _a2;
      var index = (_a2 = this._callbacks.indexOf(callback)) !== null && _a2 !== void 0 ? _a2 : -1;
      if (index < 0) {
        this._callbacks.push(callback);
      }
    };
    Delegate2.prototype.unsubscribe = function(callback) {
      var _a2;
      if (isFunction(callback)) {
        var index = (_a2 = this._callbacks.indexOf(callback)) !== null && _a2 !== void 0 ? _a2 : -1;
        if (index > -1) {
          this._callbacks.splice(index, 1);
        }
      } else {
        this._callbacks = [];
      }
    };
    Delegate2.prototype.execute = function(data) {
      this._callbacks.forEach(function(callback) {
        callback(data);
      });
    };
    Delegate2.prototype.isEmpty = function() {
      return this._callbacks.length === 0;
    };
    return Delegate2;
  }()
);
var LoadDataType;
(function(LoadDataType2) {
  LoadDataType2["Init"] = "init";
  LoadDataType2["Forward"] = "forward";
  LoadDataType2["Backward"] = "backward";
})(LoadDataType || (LoadDataType = {}));
var IndicatorSeries;
(function(IndicatorSeries2) {
  IndicatorSeries2["Normal"] = "normal";
  IndicatorSeries2["Price"] = "price";
  IndicatorSeries2["Volume"] = "volume";
})(IndicatorSeries || (IndicatorSeries = {}));
function eachFigures(kLineDataList, indicator, dataIndex, defaultStyles, eachFigureCallback) {
  var result = indicator.result;
  var figures2 = indicator.figures;
  var styles2 = indicator.styles;
  var circleStyles = formatValue(styles2, "circles", defaultStyles.circles);
  var circleStyleCount = circleStyles.length;
  var barStyles = formatValue(styles2, "bars", defaultStyles.bars);
  var barStyleCount = barStyles.length;
  var lineStyles = formatValue(styles2, "lines", defaultStyles.lines);
  var lineStyleCount = lineStyles.length;
  var circleCount = 0;
  var barCount = 0;
  var lineCount = 0;
  var defaultFigureStyles;
  var figureIndex = 0;
  figures2.forEach(function(figure) {
    var _a2;
    switch (figure.type) {
      case "circle": {
        figureIndex = circleCount;
        var styles_1 = circleStyles[circleCount % circleStyleCount];
        defaultFigureStyles = __assign(__assign({}, styles_1), { color: styles_1.noChangeColor });
        circleCount++;
        break;
      }
      case "bar": {
        figureIndex = barCount;
        var styles_2 = barStyles[barCount % barStyleCount];
        defaultFigureStyles = __assign(__assign({}, styles_2), { color: styles_2.noChangeColor });
        barCount++;
        break;
      }
      case "line": {
        figureIndex = lineCount;
        defaultFigureStyles = lineStyles[lineCount % lineStyleCount];
        lineCount++;
        break;
      }
    }
    if (isValid(defaultFigureStyles)) {
      var cbData = {
        prev: { kLineData: kLineDataList[dataIndex - 1], indicatorData: result[dataIndex - 1] },
        current: { kLineData: kLineDataList[dataIndex], indicatorData: result[dataIndex] },
        next: { kLineData: kLineDataList[dataIndex + 1], indicatorData: result[dataIndex + 1] }
      };
      var ss2 = (_a2 = figure.styles) === null || _a2 === void 0 ? void 0 : _a2.call(figure, cbData, indicator, defaultStyles);
      eachFigureCallback(figure, __assign(__assign({}, defaultFigureStyles), ss2), figureIndex);
    }
  });
}
var IndicatorImp = (
  /** @class */
  function() {
    function IndicatorImp2(indicator) {
      this.result = [];
      this._precisionFlag = false;
      var name = indicator.name, shortName = indicator.shortName, series = indicator.series, calcParams = indicator.calcParams, figures2 = indicator.figures, precision = indicator.precision, shouldOhlc = indicator.shouldOhlc, shouldFormatBigNumber = indicator.shouldFormatBigNumber, visible = indicator.visible, zLevel = indicator.zLevel, minValue = indicator.minValue, maxValue = indicator.maxValue, styles2 = indicator.styles, extendData = indicator.extendData, regenerateFigures = indicator.regenerateFigures, createTooltipDataSource = indicator.createTooltipDataSource, draw = indicator.draw;
      this.name = name;
      this.shortName = shortName !== null && shortName !== void 0 ? shortName : name;
      this.series = series !== null && series !== void 0 ? series : IndicatorSeries.Normal;
      this.precision = precision !== null && precision !== void 0 ? precision : 4;
      this.calcParams = calcParams !== null && calcParams !== void 0 ? calcParams : [];
      this.figures = figures2 !== null && figures2 !== void 0 ? figures2 : [];
      this.shouldOhlc = shouldOhlc !== null && shouldOhlc !== void 0 ? shouldOhlc : false;
      this.shouldFormatBigNumber = shouldFormatBigNumber !== null && shouldFormatBigNumber !== void 0 ? shouldFormatBigNumber : false;
      this.visible = visible !== null && visible !== void 0 ? visible : true;
      this.zLevel = zLevel !== null && zLevel !== void 0 ? zLevel : 0;
      this.minValue = minValue !== null && minValue !== void 0 ? minValue : null;
      this.maxValue = maxValue !== null && maxValue !== void 0 ? maxValue : null;
      this.styles = clone(styles2 !== null && styles2 !== void 0 ? styles2 : {});
      this.extendData = extendData;
      this.regenerateFigures = regenerateFigures !== null && regenerateFigures !== void 0 ? regenerateFigures : null;
      this.createTooltipDataSource = createTooltipDataSource !== null && createTooltipDataSource !== void 0 ? createTooltipDataSource : null;
      this.draw = draw !== null && draw !== void 0 ? draw : null;
    }
    IndicatorImp2.prototype.setShortName = function(shortName) {
      if (this.shortName !== shortName) {
        this.shortName = shortName;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setSeries = function(series) {
      if (this.series !== series) {
        this.series = series;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setPrecision = function(precision, flag) {
      var f = flag !== null && flag !== void 0 ? flag : false;
      var optimalPrecision = Math.floor(precision);
      if (optimalPrecision !== this.precision && precision >= 0 && (!f || f && !this._precisionFlag)) {
        this.precision = optimalPrecision;
        if (!f) {
          this._precisionFlag = true;
        }
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setCalcParams = function(params) {
      var _a2, _b;
      this.calcParams = params;
      this.figures = (_b = (_a2 = this.regenerateFigures) === null || _a2 === void 0 ? void 0 : _a2.call(this, params)) !== null && _b !== void 0 ? _b : this.figures;
      return true;
    };
    IndicatorImp2.prototype.setShouldOhlc = function(shouldOhlc) {
      if (this.shouldOhlc !== shouldOhlc) {
        this.shouldOhlc = shouldOhlc;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setShouldFormatBigNumber = function(shouldFormatBigNumber) {
      if (this.shouldFormatBigNumber !== shouldFormatBigNumber) {
        this.shouldFormatBigNumber = shouldFormatBigNumber;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setVisible = function(visible) {
      if (this.visible !== visible) {
        this.visible = visible;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setZLevel = function(zLevel) {
      if (this.zLevel !== zLevel) {
        this.zLevel = zLevel;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setStyles = function(styles2) {
      merge(this.styles, styles2);
      return true;
    };
    IndicatorImp2.prototype.setExtendData = function(extendData) {
      if (this.extendData !== extendData) {
        this.extendData = extendData;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setFigures = function(figures2) {
      if (this.figures !== figures2) {
        this.figures = figures2;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setMinValue = function(value) {
      if (this.minValue !== value) {
        this.minValue = value;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setMaxValue = function(value) {
      if (this.maxValue !== value) {
        this.maxValue = value;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setRegenerateFigures = function(callback) {
      if (this.regenerateFigures !== callback) {
        this.regenerateFigures = callback;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setCreateTooltipDataSource = function(callback) {
      if (this.createTooltipDataSource !== callback) {
        this.createTooltipDataSource = callback;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.setDraw = function(callback) {
      if (this.draw !== callback) {
        this.draw = callback;
        return true;
      }
      return false;
    };
    IndicatorImp2.prototype.calcIndicator = function(dataList) {
      return __awaiter(this, void 0, void 0, function() {
        var result;
        return __generator(this, function(_a2) {
          switch (_a2.label) {
            case 0:
              _a2.trys.push([0, 2, , 3]);
              return [4, this.calc(dataList, this)];
            case 1:
              result = _a2.sent();
              this.result = result;
              return [2, true];
            case 2:
              _a2.sent();
              return [2, false];
            case 3:
              return [
                2
                /*return*/
              ];
          }
        });
      });
    };
    IndicatorImp2.extend = function(template) {
      var Custom = (
        /** @class */
        function(_super) {
          __extends(Custom2, _super);
          function Custom2() {
            return _super.call(this, template) || this;
          }
          Custom2.prototype.calc = function(dataList, indicator) {
            return template.calc(dataList, indicator);
          };
          return Custom2;
        }(IndicatorImp2)
      );
      return Custom;
    };
    return IndicatorImp2;
  }()
);
var OverlayMode;
(function(OverlayMode2) {
  OverlayMode2["Normal"] = "normal";
  OverlayMode2["WeakMagnet"] = "weak_magnet";
  OverlayMode2["StrongMagnet"] = "strong_magnet";
})(OverlayMode || (OverlayMode = {}));
function getAllOverlayFigureIgnoreEventTypes() {
  return [
    "mouseClickEvent",
    "mouseDoubleClickEvent",
    "mouseRightClickEvent",
    "tapEvent",
    "doubleTapEvent",
    "mouseDownEvent",
    "touchStartEvent",
    "mouseMoveEvent",
    "touchMoveEvent"
  ];
}
var OVERLAY_DRAW_STEP_START = 1;
var OVERLAY_DRAW_STEP_FINISHED = -1;
var OVERLAY_ID_PREFIX = "overlay_";
var OVERLAY_FIGURE_KEY_PREFIX = "overlay_figure_";
var OverlayImp = (
  /** @class */
  function() {
    function OverlayImp2(overlay) {
      this.currentStep = OVERLAY_DRAW_STEP_START;
      this.points = [];
      this._prevPressedPoint = null;
      this._prevPressedPoints = [];
      var mode = overlay.mode, modeSensitivity = overlay.modeSensitivity, extendData = overlay.extendData, styles2 = overlay.styles, name = overlay.name, totalStep = overlay.totalStep, lock = overlay.lock, visible = overlay.visible, zLevel = overlay.zLevel, needDefaultPointFigure = overlay.needDefaultPointFigure, needDefaultXAxisFigure = overlay.needDefaultXAxisFigure, needDefaultYAxisFigure = overlay.needDefaultYAxisFigure, createPointFigures = overlay.createPointFigures, createXAxisFigures = overlay.createXAxisFigures, createYAxisFigures = overlay.createYAxisFigures, performEventPressedMove = overlay.performEventPressedMove, performEventMoveForDrawing = overlay.performEventMoveForDrawing, onDrawStart = overlay.onDrawStart, onDrawing = overlay.onDrawing, onDrawEnd = overlay.onDrawEnd, onClick = overlay.onClick, onDoubleClick = overlay.onDoubleClick, onRightClick = overlay.onRightClick, onPressedMoveStart = overlay.onPressedMoveStart, onPressedMoving = overlay.onPressedMoving, onPressedMoveEnd = overlay.onPressedMoveEnd, onMouseEnter = overlay.onMouseEnter, onMouseLeave = overlay.onMouseLeave, onRemoved = overlay.onRemoved, onSelected = overlay.onSelected, onDeselected = overlay.onDeselected;
      this.name = name;
      this.totalStep = !isNumber(totalStep) || totalStep < 2 ? 1 : totalStep;
      this.lock = lock !== null && lock !== void 0 ? lock : false;
      this.visible = visible !== null && visible !== void 0 ? visible : true;
      this.zLevel = zLevel !== null && zLevel !== void 0 ? zLevel : 0;
      this.needDefaultPointFigure = needDefaultPointFigure !== null && needDefaultPointFigure !== void 0 ? needDefaultPointFigure : false;
      this.needDefaultXAxisFigure = needDefaultXAxisFigure !== null && needDefaultXAxisFigure !== void 0 ? needDefaultXAxisFigure : false;
      this.needDefaultYAxisFigure = needDefaultYAxisFigure !== null && needDefaultYAxisFigure !== void 0 ? needDefaultYAxisFigure : false;
      this.mode = mode !== null && mode !== void 0 ? mode : OverlayMode.Normal;
      this.modeSensitivity = modeSensitivity !== null && modeSensitivity !== void 0 ? modeSensitivity : 8;
      this.extendData = extendData;
      this.styles = clone(styles2 !== null && styles2 !== void 0 ? styles2 : {});
      this.createPointFigures = createPointFigures !== null && createPointFigures !== void 0 ? createPointFigures : null;
      this.createXAxisFigures = createXAxisFigures !== null && createXAxisFigures !== void 0 ? createXAxisFigures : null;
      this.createYAxisFigures = createYAxisFigures !== null && createYAxisFigures !== void 0 ? createYAxisFigures : null;
      this.performEventPressedMove = performEventPressedMove !== null && performEventPressedMove !== void 0 ? performEventPressedMove : null;
      this.performEventMoveForDrawing = performEventMoveForDrawing !== null && performEventMoveForDrawing !== void 0 ? performEventMoveForDrawing : null;
      this.onDrawStart = onDrawStart !== null && onDrawStart !== void 0 ? onDrawStart : null;
      this.onDrawing = onDrawing !== null && onDrawing !== void 0 ? onDrawing : null;
      this.onDrawEnd = onDrawEnd !== null && onDrawEnd !== void 0 ? onDrawEnd : null;
      this.onClick = onClick !== null && onClick !== void 0 ? onClick : null;
      this.onDoubleClick = onDoubleClick !== null && onDoubleClick !== void 0 ? onDoubleClick : null;
      this.onRightClick = onRightClick !== null && onRightClick !== void 0 ? onRightClick : null;
      this.onPressedMoveStart = onPressedMoveStart !== null && onPressedMoveStart !== void 0 ? onPressedMoveStart : null;
      this.onPressedMoving = onPressedMoving !== null && onPressedMoving !== void 0 ? onPressedMoving : null;
      this.onPressedMoveEnd = onPressedMoveEnd !== null && onPressedMoveEnd !== void 0 ? onPressedMoveEnd : null;
      this.onMouseEnter = onMouseEnter !== null && onMouseEnter !== void 0 ? onMouseEnter : null;
      this.onMouseLeave = onMouseLeave !== null && onMouseLeave !== void 0 ? onMouseLeave : null;
      this.onRemoved = onRemoved !== null && onRemoved !== void 0 ? onRemoved : null;
      this.onSelected = onSelected !== null && onSelected !== void 0 ? onSelected : null;
      this.onDeselected = onDeselected !== null && onDeselected !== void 0 ? onDeselected : null;
    }
    OverlayImp2.prototype.setId = function(id) {
      if (!isString(this.id)) {
        this.id = id;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setGroupId = function(groupId) {
      if (!isString(this.groupId)) {
        this.groupId = groupId;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setPaneId = function(paneId) {
      this.paneId = paneId;
    };
    OverlayImp2.prototype.setExtendData = function(extendData) {
      if (extendData !== this.extendData) {
        this.extendData = extendData;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setStyles = function(styles2) {
      merge(this.styles, styles2);
      return true;
    };
    OverlayImp2.prototype.setPoints = function(points) {
      if (points.length > 0) {
        var repeatTotalStep = void 0;
        this.points = __spreadArray([], __read(points), false);
        if (points.length >= this.totalStep - 1) {
          this.currentStep = OVERLAY_DRAW_STEP_FINISHED;
          repeatTotalStep = this.totalStep - 1;
        } else {
          this.currentStep = points.length + 1;
          repeatTotalStep = points.length;
        }
        if (this.performEventMoveForDrawing !== null) {
          for (var i = 0; i < repeatTotalStep; i++) {
            this.performEventMoveForDrawing({
              currentStep: i + 2,
              mode: this.mode,
              points: this.points,
              performPointIndex: i,
              performPoint: this.points[i]
            });
          }
        }
        if (this.currentStep === OVERLAY_DRAW_STEP_FINISHED && this.performEventPressedMove !== null) {
          this.performEventPressedMove({
            currentStep: this.currentStep,
            mode: this.mode,
            points: this.points,
            performPointIndex: this.points.length - 1,
            performPoint: this.points[this.points.length - 1]
          });
        }
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setLock = function(lock) {
      if (this.lock !== lock) {
        this.lock = lock;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setVisible = function(visible) {
      if (this.visible !== visible) {
        this.visible = visible;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setZLevel = function(zLevel) {
      if (this.zLevel !== zLevel) {
        this.zLevel = zLevel;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setMode = function(mode) {
      if (this.mode !== mode) {
        this.mode = mode;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setModeSensitivity = function(modeSensitivity) {
      if (this.modeSensitivity !== modeSensitivity) {
        this.modeSensitivity = modeSensitivity;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnDrawStartCallback = function(callback) {
      if (this.onDrawStart !== callback) {
        this.onDrawStart = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnDrawingCallback = function(callback) {
      if (this.onDrawing !== callback) {
        this.onDrawing = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnDrawEndCallback = function(callback) {
      if (this.onDrawEnd !== callback) {
        this.onDrawEnd = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnClickCallback = function(callback) {
      if (this.onClick !== callback) {
        this.onClick = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnDoubleClickCallback = function(callback) {
      if (this.onDoubleClick !== callback) {
        this.onDoubleClick = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnRightClickCallback = function(callback) {
      if (this.onRightClick !== callback) {
        this.onRightClick = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnPressedMoveStartCallback = function(callback) {
      if (this.onPressedMoveStart !== callback) {
        this.onPressedMoveStart = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnPressedMovingCallback = function(callback) {
      if (this.onPressedMoving !== callback) {
        this.onPressedMoving = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnPressedMoveEndCallback = function(callback) {
      if (this.onPressedMoveEnd !== callback) {
        this.onPressedMoveEnd = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnMouseEnterCallback = function(callback) {
      if (this.onMouseEnter !== callback) {
        this.onMouseEnter = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnMouseLeaveCallback = function(callback) {
      if (this.onMouseLeave !== callback) {
        this.onMouseLeave = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnRemovedCallback = function(callback) {
      if (this.onRemoved !== callback) {
        this.onRemoved = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnSelectedCallback = function(callback) {
      if (this.onSelected !== callback) {
        this.onSelected = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.setOnDeselectedCallback = function(callback) {
      if (this.onDeselected !== callback) {
        this.onDeselected = callback;
        return true;
      }
      return false;
    };
    OverlayImp2.prototype.nextStep = function() {
      if (this.currentStep === this.totalStep - 1) {
        this.currentStep = OVERLAY_DRAW_STEP_FINISHED;
      } else {
        this.currentStep++;
      }
    };
    OverlayImp2.prototype.forceComplete = function() {
      this.currentStep = OVERLAY_DRAW_STEP_FINISHED;
    };
    OverlayImp2.prototype.isDrawing = function() {
      return this.currentStep !== OVERLAY_DRAW_STEP_FINISHED;
    };
    OverlayImp2.prototype.isStart = function() {
      return this.currentStep === OVERLAY_DRAW_STEP_START;
    };
    OverlayImp2.prototype.eventMoveForDrawing = function(point) {
      var _a2;
      var pointIndex = this.currentStep - 1;
      var newPoint = {};
      if (isNumber(point.timestamp)) {
        newPoint.timestamp = point.timestamp;
      }
      if (isNumber(point.dataIndex)) {
        newPoint.dataIndex = point.dataIndex;
      }
      if (isNumber(point.value)) {
        newPoint.value = point.value;
      }
      this.points[pointIndex] = newPoint;
      (_a2 = this.performEventMoveForDrawing) === null || _a2 === void 0 ? void 0 : _a2.call(this, {
        currentStep: this.currentStep,
        mode: this.mode,
        points: this.points,
        performPointIndex: pointIndex,
        performPoint: newPoint
      });
    };
    OverlayImp2.prototype.eventPressedPointMove = function(point, pointIndex) {
      var _a2;
      if (isNumber(point.dataIndex)) {
        this.points[pointIndex].dataIndex = point.dataIndex;
        this.points[pointIndex].timestamp = point.timestamp;
      }
      if (isNumber(point.value)) {
        this.points[pointIndex].value = point.value;
      }
      (_a2 = this.performEventPressedMove) === null || _a2 === void 0 ? void 0 : _a2.call(this, {
        currentStep: this.currentStep,
        points: this.points,
        mode: this.mode,
        performPointIndex: pointIndex,
        performPoint: this.points[pointIndex]
      });
    };
    OverlayImp2.prototype.startPressedMove = function(point) {
      this._prevPressedPoint = __assign({}, point);
      this._prevPressedPoints = clone(this.points);
    };
    OverlayImp2.prototype.eventPressedOtherMove = function(point, timeScaleStore) {
      if (this._prevPressedPoint !== null) {
        var difDataIndex_1;
        if (isNumber(point.dataIndex) && isNumber(this._prevPressedPoint.dataIndex)) {
          difDataIndex_1 = point.dataIndex - this._prevPressedPoint.dataIndex;
        }
        var difValue_1;
        if (isNumber(point.value) && isNumber(this._prevPressedPoint.value)) {
          difValue_1 = point.value - this._prevPressedPoint.value;
        }
        this.points = this._prevPressedPoints.map(function(p) {
          var _a2;
          if (isNumber(p.timestamp)) {
            p.dataIndex = timeScaleStore.timestampToDataIndex(p.timestamp);
          }
          var newPoint = __assign({}, p);
          if (isNumber(difDataIndex_1) && isNumber(p.dataIndex)) {
            newPoint.dataIndex = p.dataIndex + difDataIndex_1;
            newPoint.timestamp = (_a2 = timeScaleStore.dataIndexToTimestamp(newPoint.dataIndex)) !== null && _a2 !== void 0 ? _a2 : void 0;
          }
          if (isNumber(difValue_1) && isNumber(p.value)) {
            newPoint.value = p.value + difValue_1;
          }
          return newPoint;
        });
      }
    };
    OverlayImp2.extend = function(template) {
      var Custom = (
        /** @class */
        function(_super) {
          __extends(Custom2, _super);
          function Custom2() {
            return _super.call(this, template) || this;
          }
          return Custom2;
        }(OverlayImp2)
      );
      return Custom;
    };
    return OverlayImp2;
  }()
);
var FormatDateType;
(function(FormatDateType2) {
  FormatDateType2[FormatDateType2["Tooltip"] = 0] = "Tooltip";
  FormatDateType2[FormatDateType2["Crosshair"] = 1] = "Crosshair";
  FormatDateType2[FormatDateType2["XAxis"] = 2] = "XAxis";
})(FormatDateType || (FormatDateType = {}));
function getDefaultCustomApi() {
  return {
    formatDate,
    formatBigNumber
  };
}
var defaultLocale = "en-US";
var DEFAULT_REQUEST_ID = -1;
function requestAnimationFrame(fn2) {
  if (isFunction(window.requestAnimationFrame)) {
    return window.requestAnimationFrame(fn2);
  }
  return window.setTimeout(fn2, 20);
}
function cancelAnimationFrame(id) {
  if (isFunction(window.cancelAnimationFrame)) {
    window.cancelAnimationFrame(id);
  } else {
    window.clearTimeout(id);
  }
}
var Animation = (
  /** @class */
  function() {
    function Animation2(options) {
      this._options = { duration: 500, iterationCount: 1 };
      this._currentIterationCount = 0;
      this._running = false;
      this._time = 0;
      merge(this._options, options);
    }
    Animation2.prototype._loop = function() {
      var _this = this;
      this._running = true;
      var step = function() {
        var _a2;
        if (_this._running) {
          var diffTime = (/* @__PURE__ */ new Date()).getTime() - _this._time;
          if (diffTime < _this._options.duration) {
            (_a2 = _this._doFrameCallback) === null || _a2 === void 0 ? void 0 : _a2.call(_this, diffTime);
            requestAnimationFrame(step);
          } else {
            _this.stop();
            _this._currentIterationCount++;
            if (_this._currentIterationCount < _this._options.iterationCount) {
              _this.start();
            }
          }
        }
      };
      requestAnimationFrame(step);
    };
    Animation2.prototype.doFrame = function(callback) {
      this._doFrameCallback = callback;
      return this;
    };
    Animation2.prototype.setDuration = function(duration) {
      this._options.duration = duration;
      return this;
    };
    Animation2.prototype.setIterationCount = function(iterationCount) {
      this._options.iterationCount = iterationCount;
      return this;
    };
    Animation2.prototype.start = function() {
      if (!this._running) {
        this._time = (/* @__PURE__ */ new Date()).getTime();
        this._loop();
      }
    };
    Animation2.prototype.stop = function() {
      var _a2;
      if (this._running) {
        (_a2 = this._doFrameCallback) === null || _a2 === void 0 ? void 0 : _a2.call(this, this._options.duration);
      }
      this._running = false;
    };
    return Animation2;
  }()
);
var baseId = 1;
var prevIdTimestamp = (/* @__PURE__ */ new Date()).getTime();
function createId(prefix) {
  var timestamp = (/* @__PURE__ */ new Date()).getTime();
  if (timestamp === prevIdTimestamp) {
    ++baseId;
  } else {
    baseId = 1;
  }
  prevIdTimestamp = timestamp;
  return "".concat(prefix !== null && prefix !== void 0 ? prefix : "").concat(timestamp, "_").concat(baseId);
}
function createDom(tagName, styles2) {
  var _a2;
  var dom = document.createElement(tagName);
  var s = styles2 !== null && styles2 !== void 0 ? styles2 : {};
  for (var key in s) {
    dom.style[key] = (_a2 = s[key]) !== null && _a2 !== void 0 ? _a2 : "";
  }
  return dom;
}
function binarySearchNearest(dataList, valueKey, targetValue) {
  var left = 0;
  var right = 0;
  for (right = dataList.length - 1; left !== right; ) {
    var midIndex = Math.floor((right + left) / 2);
    var mid = right - left;
    var midValue = dataList[midIndex][valueKey];
    if (targetValue === dataList[left][valueKey]) {
      return left;
    }
    if (targetValue === dataList[right][valueKey]) {
      return right;
    }
    if (targetValue === midValue) {
      return midIndex;
    }
    if (targetValue > midValue) {
      left = midIndex;
    } else {
      right = midIndex;
    }
    if (mid <= 2) {
      break;
    }
  }
  return left;
}
function nice(value) {
  var exponent = Math.floor(log10(value));
  var exp10 = index10(exponent);
  var f = value / exp10;
  var nf = 0;
  if (f < 1.5) {
    nf = 1;
  } else if (f < 2.5) {
    nf = 2;
  } else if (f < 3.5) {
    nf = 3;
  } else if (f < 4.5) {
    nf = 4;
  } else if (f < 5.5) {
    nf = 5;
  } else if (f < 6.5) {
    nf = 6;
  } else {
    nf = 8;
  }
  value = nf * exp10;
  return exponent >= -20 ? +value.toFixed(exponent < 0 ? -exponent : 0) : value;
}
function round(value, precision) {
  if (precision == null) {
    precision = 10;
  }
  precision = Math.min(Math.max(0, precision), 20);
  var v = (+value).toFixed(precision);
  return +v;
}
function getPrecision(value) {
  var str = value.toString();
  var eIndex = str.indexOf("e");
  if (eIndex > 0) {
    var precision = +str.slice(eIndex + 1);
    return precision < 0 ? -precision : 0;
  } else {
    var dotIndex = str.indexOf(".");
    return dotIndex < 0 ? 0 : str.length - 1 - dotIndex;
  }
}
function getMaxMin(dataList, maxKey, minKey) {
  var maxMin = [Number.MIN_SAFE_INTEGER, Number.MAX_SAFE_INTEGER];
  dataList.forEach(function(data) {
    var _a2, _b;
    maxMin[0] = Math.max((_a2 = data[maxKey]) !== null && _a2 !== void 0 ? _a2 : data, maxMin[0]);
    maxMin[1] = Math.min((_b = data[minKey]) !== null && _b !== void 0 ? _b : data, maxMin[1]);
  });
  return maxMin;
}
function log10(value) {
  return Math.log(value) / Math.log(10);
}
function index10(value) {
  return Math.pow(10, value);
}
function getDefaultVisibleRange() {
  return { from: 0, to: 0, realFrom: 0, realTo: 0 };
}
var BarSpaceLimitConstants = {
  MIN: 1,
  MAX: 50
};
var DEFAULT_BAR_SPACE = 8;
var DEFAULT_OFFSET_RIGHT_DISTANCE = 80;
var GAP_BAR_SPACE_RATIO = 0.88;
var SCALE_MULTIPLIER = 10;
var TimeScaleStore = (
  /** @class */
  function() {
    function TimeScaleStore2(chartStore) {
      this._dateTimeFormat = this._buildDateTimeFormat();
      this._zoomEnabled = true;
      this._scrollEnabled = true;
      this._totalBarSpace = 0;
      this._barSpace = DEFAULT_BAR_SPACE;
      this._offsetRightDistance = DEFAULT_OFFSET_RIGHT_DISTANCE;
      this._startLastBarRightSideDiffBarCount = 0;
      this._scrollLimitRole = 0;
      this._minVisibleBarCount = { left: 2, right: 2 };
      this._maxOffsetDistance = { left: 50, right: 50 };
      this._visibleRange = getDefaultVisibleRange();
      this._chartStore = chartStore;
      this._gapBarSpace = this._calcGapBarSpace();
      this._lastBarRightSideDiffBarCount = this._offsetRightDistance / this._barSpace;
    }
    TimeScaleStore2.prototype._calcGapBarSpace = function() {
      var gapBarSpace;
      if (this._barSpace > 3) {
        gapBarSpace = Math.floor(this._barSpace * GAP_BAR_SPACE_RATIO);
      } else {
        gapBarSpace = Math.floor(this._barSpace);
        if (gapBarSpace === this._barSpace) {
          gapBarSpace--;
        }
      }
      if (gapBarSpace % 2 === 0) {
        gapBarSpace--;
      }
      gapBarSpace = Math.max(1, gapBarSpace);
      return gapBarSpace;
    };
    TimeScaleStore2.prototype.adjustVisibleRange = function() {
      var _a2, _b;
      var dataList = this._chartStore.getDataList();
      var totalBarCount = dataList.length;
      var visibleBarCount = this._totalBarSpace / this._barSpace;
      var leftMinVisibleBarCount;
      var rightMinVisibleBarCount;
      if (this._scrollLimitRole === 1) {
        leftMinVisibleBarCount = (this._totalBarSpace - this._maxOffsetDistance.right) / this._barSpace;
        rightMinVisibleBarCount = (this._totalBarSpace - this._maxOffsetDistance.left) / this._barSpace;
      } else {
        leftMinVisibleBarCount = this._minVisibleBarCount.left;
        rightMinVisibleBarCount = this._minVisibleBarCount.right;
      }
      leftMinVisibleBarCount = Math.max(0, leftMinVisibleBarCount);
      rightMinVisibleBarCount = Math.max(0, rightMinVisibleBarCount);
      var maxRightOffsetBarCount = visibleBarCount - Math.min(leftMinVisibleBarCount, totalBarCount);
      if (this._lastBarRightSideDiffBarCount > maxRightOffsetBarCount) {
        this._lastBarRightSideDiffBarCount = maxRightOffsetBarCount;
      }
      var minRightOffsetBarCount = -totalBarCount + Math.min(rightMinVisibleBarCount, totalBarCount);
      if (this._lastBarRightSideDiffBarCount < minRightOffsetBarCount) {
        this._lastBarRightSideDiffBarCount = minRightOffsetBarCount;
      }
      var to2 = Math.round(this._lastBarRightSideDiffBarCount + totalBarCount + 0.5);
      var realTo = to2;
      if (to2 > totalBarCount) {
        to2 = totalBarCount;
      }
      var from = Math.round(to2 - visibleBarCount) - 1;
      if (from < 0) {
        from = 0;
      }
      var realFrom = this._lastBarRightSideDiffBarCount > 0 ? Math.round(totalBarCount + this._lastBarRightSideDiffBarCount - visibleBarCount) - 1 : from;
      this._visibleRange = { from, to: to2, realFrom, realTo };
      this._chartStore.getActionStore().execute(ActionType.OnVisibleRangeChange, this._visibleRange);
      this._chartStore.adjustVisibleDataList();
      if (from === 0) {
        var firstData = dataList[0];
        this._chartStore.executeLoadMoreCallback((_a2 = firstData === null || firstData === void 0 ? void 0 : firstData.timestamp) !== null && _a2 !== void 0 ? _a2 : null);
        this._chartStore.executeLoadDataCallback({
          type: LoadDataType.Forward,
          data: firstData !== null && firstData !== void 0 ? firstData : null
        });
      }
      if (to2 === totalBarCount) {
        this._chartStore.executeLoadDataCallback({
          type: LoadDataType.Backward,
          data: (_b = dataList[totalBarCount - 1]) !== null && _b !== void 0 ? _b : null
        });
      }
    };
    TimeScaleStore2.prototype.getDateTimeFormat = function() {
      return this._dateTimeFormat;
    };
    TimeScaleStore2.prototype._buildDateTimeFormat = function(timezone) {
      var options = {
        hour12: false,
        year: "numeric",
        month: "2-digit",
        day: "2-digit",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit"
      };
      if (isString(timezone)) {
        options.timeZone = timezone;
      }
      var dateTimeFormat = null;
      try {
        dateTimeFormat = new Intl.DateTimeFormat("en", options);
      } catch (e) {
        logWarn("", "", "Timezone is error!!!");
      }
      return dateTimeFormat;
    };
    TimeScaleStore2.prototype.setTimezone = function(timezone) {
      var dateTimeFormat = this._buildDateTimeFormat(timezone);
      if (dateTimeFormat !== null) {
        this._dateTimeFormat = dateTimeFormat;
      }
    };
    TimeScaleStore2.prototype.getTimezone = function() {
      return this._dateTimeFormat.resolvedOptions().timeZone;
    };
    TimeScaleStore2.prototype.getBarSpace = function() {
      return {
        bar: this._barSpace,
        halfBar: this._barSpace / 2,
        gapBar: this._gapBarSpace,
        halfGapBar: Math.floor(this._gapBarSpace / 2)
      };
    };
    TimeScaleStore2.prototype.setBarSpace = function(barSpace, adjustBeforeFunc) {
      if (barSpace < BarSpaceLimitConstants.MIN || barSpace > BarSpaceLimitConstants.MAX || this._barSpace === barSpace) {
        return;
      }
      this._barSpace = barSpace;
      this._gapBarSpace = this._calcGapBarSpace();
      adjustBeforeFunc === null || adjustBeforeFunc === void 0 ? void 0 : adjustBeforeFunc();
      this.adjustVisibleRange();
      this._chartStore.getTooltipStore().recalculateCrosshair(true);
      this._chartStore.getChart().adjustPaneViewport(false, true, true, true);
    };
    TimeScaleStore2.prototype.setTotalBarSpace = function(totalSpace) {
      if (this._totalBarSpace !== totalSpace) {
        this._totalBarSpace = totalSpace;
        this.adjustVisibleRange();
        this._chartStore.getTooltipStore().recalculateCrosshair(true);
      }
      return this;
    };
    TimeScaleStore2.prototype.setOffsetRightDistance = function(distance, isUpdate) {
      this._offsetRightDistance = this._scrollLimitRole === 1 ? Math.min(this._maxOffsetDistance.right, distance) : distance;
      this._lastBarRightSideDiffBarCount = this._offsetRightDistance / this._barSpace;
      if (isUpdate !== null && isUpdate !== void 0 ? isUpdate : false) {
        this.adjustVisibleRange();
        this._chartStore.getTooltipStore().recalculateCrosshair(true);
        this._chartStore.getChart().adjustPaneViewport(false, true, true, true);
      }
      return this;
    };
    TimeScaleStore2.prototype.resetOffsetRightDistance = function() {
      this.setOffsetRightDistance(this._offsetRightDistance);
    };
    TimeScaleStore2.prototype.getInitialOffsetRightDistance = function() {
      return this._offsetRightDistance;
    };
    TimeScaleStore2.prototype.getOffsetRightDistance = function() {
      return Math.max(0, this._lastBarRightSideDiffBarCount * this._barSpace);
    };
    TimeScaleStore2.prototype.getLastBarRightSideDiffBarCount = function() {
      return this._lastBarRightSideDiffBarCount;
    };
    TimeScaleStore2.prototype.setLastBarRightSideDiffBarCount = function(barCount) {
      this._lastBarRightSideDiffBarCount = barCount;
      return this;
    };
    TimeScaleStore2.prototype.setMaxOffsetLeftDistance = function(distance) {
      this._scrollLimitRole = 1;
      this._maxOffsetDistance.left = distance;
      return this;
    };
    TimeScaleStore2.prototype.setMaxOffsetRightDistance = function(distance) {
      this._scrollLimitRole = 1;
      this._maxOffsetDistance.right = distance;
      return this;
    };
    TimeScaleStore2.prototype.setLeftMinVisibleBarCount = function(barCount) {
      this._scrollLimitRole = 0;
      this._minVisibleBarCount.left = barCount;
      return this;
    };
    TimeScaleStore2.prototype.setRightMinVisibleBarCount = function(barCount) {
      this._scrollLimitRole = 0;
      this._minVisibleBarCount.right = barCount;
      return this;
    };
    TimeScaleStore2.prototype.getVisibleRange = function() {
      return this._visibleRange;
    };
    TimeScaleStore2.prototype.startScroll = function() {
      this._startLastBarRightSideDiffBarCount = this._lastBarRightSideDiffBarCount;
    };
    TimeScaleStore2.prototype.scroll = function(distance) {
      if (!this._scrollEnabled) {
        return;
      }
      var distanceBarCount = distance / this._barSpace;
      var prevLastBarRightSideDistance = this._lastBarRightSideDiffBarCount * this._barSpace;
      this._lastBarRightSideDiffBarCount = this._startLastBarRightSideDiffBarCount - distanceBarCount;
      this.adjustVisibleRange();
      this._chartStore.getTooltipStore().recalculateCrosshair(true);
      this._chartStore.getChart().adjustPaneViewport(false, true, true, true);
      var realDistance = Math.round(prevLastBarRightSideDistance - this._lastBarRightSideDiffBarCount * this._barSpace);
      if (realDistance !== 0) {
        this._chartStore.getActionStore().execute(ActionType.OnScroll, { distance: realDistance });
      }
    };
    TimeScaleStore2.prototype.getDataByDataIndex = function(dataIndex) {
      var _a2;
      return (_a2 = this._chartStore.getDataList()[dataIndex]) !== null && _a2 !== void 0 ? _a2 : null;
    };
    TimeScaleStore2.prototype.coordinateToFloatIndex = function(x) {
      var dataCount = this._chartStore.getDataList().length;
      var deltaFromRight = (this._totalBarSpace - x) / this._barSpace;
      var index = dataCount + this._lastBarRightSideDiffBarCount - deltaFromRight;
      return Math.round(index * 1e6) / 1e6;
    };
    TimeScaleStore2.prototype.dataIndexToTimestamp = function(dataIndex) {
      var _a2;
      var data = this.getDataByDataIndex(dataIndex);
      return (_a2 = data === null || data === void 0 ? void 0 : data.timestamp) !== null && _a2 !== void 0 ? _a2 : null;
    };
    TimeScaleStore2.prototype.timestampToDataIndex = function(timestamp) {
      var dataList = this._chartStore.getDataList();
      if (dataList.length === 0) {
        return 0;
      }
      return binarySearchNearest(dataList, "timestamp", timestamp);
    };
    TimeScaleStore2.prototype.dataIndexToCoordinate = function(dataIndex) {
      var dataCount = this._chartStore.getDataList().length;
      var deltaFromRight = dataCount + this._lastBarRightSideDiffBarCount - dataIndex;
      return Math.floor(this._totalBarSpace - (deltaFromRight - 0.5) * this._barSpace);
    };
    TimeScaleStore2.prototype.coordinateToDataIndex = function(x) {
      return Math.ceil(this.coordinateToFloatIndex(x)) - 1;
    };
    TimeScaleStore2.prototype.zoom = function(scale, coordinate) {
      var _this = this;
      var _a2;
      if (!this._zoomEnabled) {
        return;
      }
      var zoomCoordinate = coordinate !== null && coordinate !== void 0 ? coordinate : null;
      if (!isNumber(zoomCoordinate === null || zoomCoordinate === void 0 ? void 0 : zoomCoordinate.x)) {
        var crosshair = this._chartStore.getTooltipStore().getCrosshair();
        zoomCoordinate = { x: (_a2 = crosshair === null || crosshair === void 0 ? void 0 : crosshair.x) !== null && _a2 !== void 0 ? _a2 : this._totalBarSpace / 2 };
      }
      var x = zoomCoordinate.x;
      var floatIndex = this.coordinateToFloatIndex(x);
      var prevBarSpace = this._barSpace;
      var barSpace = this._barSpace + scale * (this._barSpace / SCALE_MULTIPLIER);
      this.setBarSpace(barSpace, function() {
        _this._lastBarRightSideDiffBarCount += floatIndex - _this.coordinateToFloatIndex(x);
      });
      var realScale = this._barSpace / prevBarSpace;
      if (realScale !== 1) {
        this._chartStore.getActionStore().execute(ActionType.OnZoom, { scale: realScale });
      }
    };
    TimeScaleStore2.prototype.setZoomEnabled = function(enabled) {
      this._zoomEnabled = enabled;
      return this;
    };
    TimeScaleStore2.prototype.getZoomEnabled = function() {
      return this._zoomEnabled;
    };
    TimeScaleStore2.prototype.setScrollEnabled = function(enabled) {
      this._scrollEnabled = enabled;
      return this;
    };
    TimeScaleStore2.prototype.getScrollEnabled = function() {
      return this._scrollEnabled;
    };
    TimeScaleStore2.prototype.clear = function() {
      this._visibleRange = getDefaultVisibleRange();
    };
    return TimeScaleStore2;
  }()
);
var averagePrice = {
  name: "AVP",
  shortName: "AVP",
  series: IndicatorSeries.Price,
  precision: 2,
  figures: [
    { key: "avp", title: "AVP: ", type: "line" }
  ],
  calc: function(dataList) {
    var totalTurnover = 0;
    var totalVolume = 0;
    return dataList.map(function(kLineData) {
      var _a2, _b;
      var avp = {};
      var turnover = (_a2 = kLineData === null || kLineData === void 0 ? void 0 : kLineData.turnover) !== null && _a2 !== void 0 ? _a2 : 0;
      var volume2 = (_b = kLineData === null || kLineData === void 0 ? void 0 : kLineData.volume) !== null && _b !== void 0 ? _b : 0;
      totalTurnover += turnover;
      totalVolume += volume2;
      if (totalVolume !== 0) {
        avp.avp = totalTurnover / totalVolume;
      }
      return avp;
    });
  }
};
var awesomeOscillator = {
  name: "AO",
  shortName: "AO",
  calcParams: [5, 34],
  figures: [{
    key: "ao",
    title: "AO: ",
    type: "bar",
    baseValue: 0,
    styles: function(data, indicator, defaultStyles) {
      var _a2, _b, _c2, _d;
      var prev = data.prev, current = data.current;
      var prevAo = (_b = (_a2 = prev.indicatorData) === null || _a2 === void 0 ? void 0 : _a2.ao) !== null && _b !== void 0 ? _b : Number.MIN_SAFE_INTEGER;
      var currentAo = (_d = (_c2 = current.indicatorData) === null || _c2 === void 0 ? void 0 : _c2.ao) !== null && _d !== void 0 ? _d : Number.MIN_SAFE_INTEGER;
      var color;
      if (currentAo > prevAo) {
        color = formatValue(indicator.styles, "bars[0].upColor", defaultStyles.bars[0].upColor);
      } else {
        color = formatValue(indicator.styles, "bars[0].downColor", defaultStyles.bars[0].downColor);
      }
      var style = currentAo > prevAo ? PolygonType.Stroke : PolygonType.Fill;
      return { color, style, borderColor: color };
    }
  }],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var maxPeriod = Math.max(params[0], params[1]);
    var shortSum = 0;
    var longSum = 0;
    var short = 0;
    var long = 0;
    return dataList.map(function(kLineData, i) {
      var ao2 = {};
      var middle = (kLineData.low + kLineData.high) / 2;
      shortSum += middle;
      longSum += middle;
      if (i >= params[0] - 1) {
        short = shortSum / params[0];
        var agoKLineData = dataList[i - (params[0] - 1)];
        shortSum -= (agoKLineData.low + agoKLineData.high) / 2;
      }
      if (i >= params[1] - 1) {
        long = longSum / params[1];
        var agoKLineData = dataList[i - (params[1] - 1)];
        longSum -= (agoKLineData.low + agoKLineData.high) / 2;
      }
      if (i >= maxPeriod - 1) {
        ao2.ao = short - long;
      }
      return ao2;
    });
  }
};
var bias = {
  name: "BIAS",
  shortName: "BIAS",
  calcParams: [6, 12, 24],
  figures: [
    { key: "bias1", title: "BIAS6: ", type: "line" },
    { key: "bias2", title: "BIAS12: ", type: "line" },
    { key: "bias3", title: "BIAS24: ", type: "line" }
  ],
  regenerateFigures: function(params) {
    return params.map(function(p, i) {
      return { key: "bias".concat(i + 1), title: "BIAS".concat(p, ": "), type: "line" };
    });
  },
  calc: function(dataList, indicator) {
    var params = indicator.calcParams, figures2 = indicator.figures;
    var closeSums = [];
    return dataList.map(function(kLineData, i) {
      var bias2 = {};
      var close = kLineData.close;
      params.forEach(function(p, index) {
        var _a2;
        closeSums[index] = ((_a2 = closeSums[index]) !== null && _a2 !== void 0 ? _a2 : 0) + close;
        if (i >= p - 1) {
          var mean = closeSums[index] / params[index];
          bias2[figures2[index].key] = (close - mean) / mean * 100;
          closeSums[index] -= dataList[i - (p - 1)].close;
        }
      });
      return bias2;
    });
  }
};
function getBollMd(dataList, ma2) {
  var dataSize = dataList.length;
  var sum = 0;
  dataList.forEach(function(data) {
    var closeMa = data.close - ma2;
    sum += closeMa * closeMa;
  });
  sum = Math.abs(sum);
  return Math.sqrt(sum / dataSize);
}
var bollingerBands = {
  name: "BOLL",
  shortName: "BOLL",
  series: IndicatorSeries.Price,
  calcParams: [20, 2],
  precision: 2,
  shouldOhlc: true,
  figures: [
    { key: "up", title: "UP: ", type: "line" },
    { key: "mid", title: "MID: ", type: "line" },
    { key: "dn", title: "DN: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var p = params[0] - 1;
    var closeSum = 0;
    return dataList.map(function(kLineData, i) {
      var close = kLineData.close;
      var boll = {};
      closeSum += close;
      if (i >= p) {
        boll.mid = closeSum / params[0];
        var md = getBollMd(dataList.slice(i - p, i + 1), boll.mid);
        boll.up = boll.mid + params[1] * md;
        boll.dn = boll.mid - params[1] * md;
        closeSum -= dataList[i - p].close;
      }
      return boll;
    });
  }
};
var brar = {
  name: "BRAR",
  shortName: "BRAR",
  calcParams: [26],
  figures: [
    { key: "br", title: "BR: ", type: "line" },
    { key: "ar", title: "AR: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var hcy = 0;
    var cyl = 0;
    var ho2 = 0;
    var ol2 = 0;
    return dataList.map(function(kLineData, i) {
      var _a2, _b;
      var brar2 = {};
      var high = kLineData.high;
      var low = kLineData.low;
      var open = kLineData.open;
      var prevClose = ((_a2 = dataList[i - 1]) !== null && _a2 !== void 0 ? _a2 : kLineData).close;
      ho2 += high - open;
      ol2 += open - low;
      hcy += high - prevClose;
      cyl += prevClose - low;
      if (i >= params[0] - 1) {
        if (ol2 !== 0) {
          brar2.ar = ho2 / ol2 * 100;
        } else {
          brar2.ar = 0;
        }
        if (cyl !== 0) {
          brar2.br = hcy / cyl * 100;
        } else {
          brar2.br = 0;
        }
        var agoKLineData = dataList[i - (params[0] - 1)];
        var agoHigh = agoKLineData.high;
        var agoLow = agoKLineData.low;
        var agoOpen = agoKLineData.open;
        var agoPreClose = ((_b = dataList[i - params[0]]) !== null && _b !== void 0 ? _b : dataList[i - (params[0] - 1)]).close;
        hcy -= agoHigh - agoPreClose;
        cyl -= agoPreClose - agoLow;
        ho2 -= agoHigh - agoOpen;
        ol2 -= agoOpen - agoLow;
      }
      return brar2;
    });
  }
};
var bullAndBearIndex = {
  name: "BBI",
  shortName: "BBI",
  series: IndicatorSeries.Price,
  precision: 2,
  calcParams: [3, 6, 12, 24],
  shouldOhlc: true,
  figures: [
    { key: "bbi", title: "BBI: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var maxPeriod = Math.max.apply(Math, __spreadArray([], __read(params), false));
    var closeSums = [];
    var mas = [];
    return dataList.map(function(kLineData, i) {
      var bbi = {};
      var close = kLineData.close;
      params.forEach(function(p, index) {
        var _a2;
        closeSums[index] = ((_a2 = closeSums[index]) !== null && _a2 !== void 0 ? _a2 : 0) + close;
        if (i >= p - 1) {
          mas[index] = closeSums[index] / p;
          closeSums[index] -= dataList[i - (p - 1)].close;
        }
      });
      if (i >= maxPeriod - 1) {
        var maSum_1 = 0;
        mas.forEach(function(ma2) {
          maSum_1 += ma2;
        });
        bbi.bbi = maSum_1 / 4;
      }
      return bbi;
    });
  }
};
var commodityChannelIndex = {
  name: "CCI",
  shortName: "CCI",
  calcParams: [20],
  figures: [
    { key: "cci", title: "CCI: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var p = params[0] - 1;
    var tpSum = 0;
    var tpList = [];
    return dataList.map(function(kLineData, i) {
      var cci = {};
      var tp = (kLineData.high + kLineData.low + kLineData.close) / 3;
      tpSum += tp;
      tpList.push(tp);
      if (i >= p) {
        var maTp_1 = tpSum / params[0];
        var sliceTpList = tpList.slice(i - p, i + 1);
        var sum_1 = 0;
        sliceTpList.forEach(function(tp2) {
          sum_1 += Math.abs(tp2 - maTp_1);
        });
        var md = sum_1 / params[0];
        cci.cci = md !== 0 ? (tp - maTp_1) / md / 0.015 : 0;
        var agoTp = (dataList[i - p].high + dataList[i - p].low + dataList[i - p].close) / 3;
        tpSum -= agoTp;
      }
      return cci;
    });
  }
};
var currentRatio = {
  name: "CR",
  shortName: "CR",
  calcParams: [26, 10, 20, 40, 60],
  figures: [
    { key: "cr", title: "CR: ", type: "line" },
    { key: "ma1", title: "MA1: ", type: "line" },
    { key: "ma2", title: "MA2: ", type: "line" },
    { key: "ma3", title: "MA3: ", type: "line" },
    { key: "ma4", title: "MA4: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var ma1ForwardPeriod = Math.ceil(params[1] / 2.5 + 1);
    var ma2ForwardPeriod = Math.ceil(params[2] / 2.5 + 1);
    var ma3ForwardPeriod = Math.ceil(params[3] / 2.5 + 1);
    var ma4ForwardPeriod = Math.ceil(params[4] / 2.5 + 1);
    var ma1Sum = 0;
    var ma1List = [];
    var ma2Sum = 0;
    var ma2List = [];
    var ma3Sum = 0;
    var ma3List = [];
    var ma4Sum = 0;
    var ma4List = [];
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2, _b, _c2, _d, _e2;
      var cr2 = {};
      var prevData = (_a2 = dataList[i - 1]) !== null && _a2 !== void 0 ? _a2 : kLineData;
      var prevMid = (prevData.high + prevData.close + prevData.low + prevData.open) / 4;
      var highSubPreMid = Math.max(0, kLineData.high - prevMid);
      var preMidSubLow = Math.max(0, prevMid - kLineData.low);
      if (i >= params[0] - 1) {
        if (preMidSubLow !== 0) {
          cr2.cr = highSubPreMid / preMidSubLow * 100;
        } else {
          cr2.cr = 0;
        }
        ma1Sum += cr2.cr;
        ma2Sum += cr2.cr;
        ma3Sum += cr2.cr;
        ma4Sum += cr2.cr;
        if (i >= params[0] + params[1] - 2) {
          ma1List.push(ma1Sum / params[1]);
          if (i >= params[0] + params[1] + ma1ForwardPeriod - 3) {
            cr2.ma1 = ma1List[ma1List.length - 1 - ma1ForwardPeriod];
          }
          ma1Sum -= (_b = result[i - (params[1] - 1)].cr) !== null && _b !== void 0 ? _b : 0;
        }
        if (i >= params[0] + params[2] - 2) {
          ma2List.push(ma2Sum / params[2]);
          if (i >= params[0] + params[2] + ma2ForwardPeriod - 3) {
            cr2.ma2 = ma2List[ma2List.length - 1 - ma2ForwardPeriod];
          }
          ma2Sum -= (_c2 = result[i - (params[2] - 1)].cr) !== null && _c2 !== void 0 ? _c2 : 0;
        }
        if (i >= params[0] + params[3] - 2) {
          ma3List.push(ma3Sum / params[3]);
          if (i >= params[0] + params[3] + ma3ForwardPeriod - 3) {
            cr2.ma3 = ma3List[ma3List.length - 1 - ma3ForwardPeriod];
          }
          ma3Sum -= (_d = result[i - (params[3] - 1)].cr) !== null && _d !== void 0 ? _d : 0;
        }
        if (i >= params[0] + params[4] - 2) {
          ma4List.push(ma4Sum / params[4]);
          if (i >= params[0] + params[4] + ma4ForwardPeriod - 3) {
            cr2.ma4 = ma4List[ma4List.length - 1 - ma4ForwardPeriod];
          }
          ma4Sum -= (_e2 = result[i - (params[4] - 1)].cr) !== null && _e2 !== void 0 ? _e2 : 0;
        }
      }
      result.push(cr2);
    });
    return result;
  }
};
var differentOfMovingAverage = {
  name: "DMA",
  shortName: "DMA",
  calcParams: [10, 50, 10],
  figures: [
    { key: "dma", title: "DMA: ", type: "line" },
    { key: "ama", title: "AMA: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var maxPeriod = Math.max(params[0], params[1]);
    var closeSum1 = 0;
    var closeSum2 = 0;
    var dmaSum = 0;
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2;
      var dma = {};
      var close = kLineData.close;
      closeSum1 += close;
      closeSum2 += close;
      var ma1 = 0;
      var ma2 = 0;
      if (i >= params[0] - 1) {
        ma1 = closeSum1 / params[0];
        closeSum1 -= dataList[i - (params[0] - 1)].close;
      }
      if (i >= params[1] - 1) {
        ma2 = closeSum2 / params[1];
        closeSum2 -= dataList[i - (params[1] - 1)].close;
      }
      if (i >= maxPeriod - 1) {
        var dif = ma1 - ma2;
        dma.dma = dif;
        dmaSum += dif;
        if (i >= maxPeriod + params[2] - 2) {
          dma.ama = dmaSum / params[2];
          dmaSum -= (_a2 = result[i - (params[2] - 1)].dma) !== null && _a2 !== void 0 ? _a2 : 0;
        }
      }
      result.push(dma);
    });
    return result;
  }
};
var directionalMovementIndex = {
  name: "DMI",
  shortName: "DMI",
  calcParams: [14, 6],
  figures: [
    { key: "pdi", title: "PDI: ", type: "line" },
    { key: "mdi", title: "MDI: ", type: "line" },
    { key: "adx", title: "ADX: ", type: "line" },
    { key: "adxr", title: "ADXR: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var trSum = 0;
    var hSum = 0;
    var lSum = 0;
    var mtr = 0;
    var dmp = 0;
    var dmm = 0;
    var dxSum = 0;
    var adx = 0;
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2, _b;
      var dmi = {};
      var prevKLineData = (_a2 = dataList[i - 1]) !== null && _a2 !== void 0 ? _a2 : kLineData;
      var preClose = prevKLineData.close;
      var high = kLineData.high;
      var low = kLineData.low;
      var hl2 = high - low;
      var hcy = Math.abs(high - preClose);
      var lcy = Math.abs(preClose - low);
      var hhy = high - prevKLineData.high;
      var lyl = prevKLineData.low - low;
      var tr2 = Math.max(Math.max(hl2, hcy), lcy);
      var h = hhy > 0 && hhy > lyl ? hhy : 0;
      var l10 = lyl > 0 && lyl > hhy ? lyl : 0;
      trSum += tr2;
      hSum += h;
      lSum += l10;
      if (i >= params[0] - 1) {
        if (i > params[0] - 1) {
          mtr = mtr - mtr / params[0] + tr2;
          dmp = dmp - dmp / params[0] + h;
          dmm = dmm - dmm / params[0] + l10;
        } else {
          mtr = trSum;
          dmp = hSum;
          dmm = lSum;
        }
        var pdi = 0;
        var mdi = 0;
        if (mtr !== 0) {
          pdi = dmp * 100 / mtr;
          mdi = dmm * 100 / mtr;
        }
        dmi.pdi = pdi;
        dmi.mdi = mdi;
        var dx = 0;
        if (mdi + pdi !== 0) {
          dx = Math.abs(mdi - pdi) / (mdi + pdi) * 100;
        }
        dxSum += dx;
        if (i >= params[0] * 2 - 2) {
          if (i > params[0] * 2 - 2) {
            adx = (adx * (params[0] - 1) + dx) / params[0];
          } else {
            adx = dxSum / params[0];
          }
          dmi.adx = adx;
          if (i >= params[0] * 2 + params[1] - 3) {
            dmi.adxr = (((_b = result[i - (params[1] - 1)].adx) !== null && _b !== void 0 ? _b : 0) + adx) / 2;
          }
        }
      }
      result.push(dmi);
    });
    return result;
  }
};
var easeOfMovementValue = {
  name: "EMV",
  shortName: "EMV",
  calcParams: [14, 9],
  figures: [
    { key: "emv", title: "EMV: ", type: "line" },
    { key: "maEmv", title: "MAEMV: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var emvValueSum = 0;
    var emvValueList = [];
    return dataList.map(function(kLineData, i) {
      var _a2;
      var emv = {};
      if (i > 0) {
        var prevKLineData = dataList[i - 1];
        var high = kLineData.high;
        var low = kLineData.low;
        var volume2 = (_a2 = kLineData.volume) !== null && _a2 !== void 0 ? _a2 : 0;
        var distanceMoved = (high + low) / 2 - (prevKLineData.high + prevKLineData.low) / 2;
        if (volume2 === 0 || high - low === 0) {
          emv.emv = 0;
        } else {
          var ratio = volume2 / 1e8 / (high - low);
          emv.emv = distanceMoved / ratio;
        }
        emvValueSum += emv.emv;
        emvValueList.push(emv.emv);
        if (i >= params[0]) {
          emv.maEmv = emvValueSum / params[0];
          emvValueSum -= emvValueList[i - params[0]];
        }
      }
      return emv;
    });
  }
};
var exponentialMovingAverage = {
  name: "EMA",
  shortName: "EMA",
  series: IndicatorSeries.Price,
  calcParams: [6, 12, 20],
  precision: 2,
  shouldOhlc: true,
  figures: [
    { key: "ema1", title: "EMA6: ", type: "line" },
    { key: "ema2", title: "EMA12: ", type: "line" },
    { key: "ema3", title: "EMA20: ", type: "line" }
  ],
  regenerateFigures: function(params) {
    return params.map(function(p, i) {
      return { key: "ema".concat(i + 1), title: "EMA".concat(p, ": "), type: "line" };
    });
  },
  calc: function(dataList, indicator) {
    var params = indicator.calcParams, figures2 = indicator.figures;
    var closeSum = 0;
    var emaValues = [];
    return dataList.map(function(kLineData, i) {
      var ema = {};
      var close = kLineData.close;
      closeSum += close;
      params.forEach(function(p, index) {
        if (i >= p - 1) {
          if (i > p - 1) {
            emaValues[index] = (2 * close + (p - 1) * emaValues[index]) / (p + 1);
          } else {
            emaValues[index] = closeSum / p;
          }
          ema[figures2[index].key] = emaValues[index];
        }
      });
      return ema;
    });
  }
};
var momentum = {
  name: "MTM",
  shortName: "MTM",
  calcParams: [12, 6],
  figures: [
    { key: "mtm", title: "MTM: ", type: "line" },
    { key: "maMtm", title: "MAMTM: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var mtmSum = 0;
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2;
      var mtm = {};
      if (i >= params[0]) {
        var close_1 = kLineData.close;
        var agoClose = dataList[i - params[0]].close;
        mtm.mtm = close_1 - agoClose;
        mtmSum += mtm.mtm;
        if (i >= params[0] + params[1] - 1) {
          mtm.maMtm = mtmSum / params[1];
          mtmSum -= (_a2 = result[i - (params[1] - 1)].mtm) !== null && _a2 !== void 0 ? _a2 : 0;
        }
      }
      result.push(mtm);
    });
    return result;
  }
};
var movingAverage = {
  name: "MA",
  shortName: "MA",
  series: IndicatorSeries.Price,
  calcParams: [5, 10, 30, 60],
  precision: 2,
  shouldOhlc: true,
  figures: [
    { key: "ma5", title: "MA5: ", type: "line" },
    { key: "ma10", title: "MA10: ", type: "line" },
    { key: "ma30", title: "MA30: ", type: "line" },
    { key: "ma60", title: "MA60: ", type: "line" }
  ],
  regenerateFigures: function(params) {
    return params.map(function(p, i) {
      return { key: "ma".concat(i + 1), title: "MA".concat(p, ": "), type: "line" };
    });
  },
  calc: function(dataList, indicator) {
    var params = indicator.calcParams, figures2 = indicator.figures;
    var closeSums = [];
    return dataList.map(function(kLineData, i) {
      var ma2 = {};
      var close = kLineData.close;
      params.forEach(function(p, index) {
        var _a2;
        closeSums[index] = ((_a2 = closeSums[index]) !== null && _a2 !== void 0 ? _a2 : 0) + close;
        if (i >= p - 1) {
          ma2[figures2[index].key] = closeSums[index] / p;
          closeSums[index] -= dataList[i - (p - 1)].close;
        }
      });
      return ma2;
    });
  }
};
var movingAverageConvergenceDivergence = {
  name: "MACD",
  shortName: "MACD",
  calcParams: [12, 26, 9],
  figures: [
    { key: "dif", title: "DIF: ", type: "line" },
    { key: "dea", title: "DEA: ", type: "line" },
    {
      key: "macd",
      title: "MACD: ",
      type: "bar",
      baseValue: 0,
      styles: function(data, indicator, defaultStyles) {
        var _a2, _b, _c2, _d;
        var prev = data.prev, current = data.current;
        var prevMacd = (_b = (_a2 = prev.indicatorData) === null || _a2 === void 0 ? void 0 : _a2.macd) !== null && _b !== void 0 ? _b : Number.MIN_SAFE_INTEGER;
        var currentMacd = (_d = (_c2 = current.indicatorData) === null || _c2 === void 0 ? void 0 : _c2.macd) !== null && _d !== void 0 ? _d : Number.MIN_SAFE_INTEGER;
        var color;
        if (currentMacd > 0) {
          color = formatValue(indicator.styles, "bars[0].upColor", defaultStyles.bars[0].upColor);
        } else if (currentMacd < 0) {
          color = formatValue(indicator.styles, "bars[0].downColor", defaultStyles.bars[0].downColor);
        } else {
          color = formatValue(indicator.styles, "bars[0].noChangeColor", defaultStyles.bars[0].noChangeColor);
        }
        var style = prevMacd < currentMacd ? PolygonType.Stroke : PolygonType.Fill;
        return { style, color, borderColor: color };
      }
    }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var closeSum = 0;
    var emaShort;
    var emaLong;
    var dif = 0;
    var difSum = 0;
    var dea = 0;
    var maxPeriod = Math.max(params[0], params[1]);
    return dataList.map(function(kLineData, i) {
      var macd = {};
      var close = kLineData.close;
      closeSum += close;
      if (i >= params[0] - 1) {
        if (i > params[0] - 1) {
          emaShort = (2 * close + (params[0] - 1) * emaShort) / (params[0] + 1);
        } else {
          emaShort = closeSum / params[0];
        }
      }
      if (i >= params[1] - 1) {
        if (i > params[1] - 1) {
          emaLong = (2 * close + (params[1] - 1) * emaLong) / (params[1] + 1);
        } else {
          emaLong = closeSum / params[1];
        }
      }
      if (i >= maxPeriod - 1) {
        dif = emaShort - emaLong;
        macd.dif = dif;
        difSum += dif;
        if (i >= maxPeriod + params[2] - 2) {
          if (i > maxPeriod + params[2] - 2) {
            dea = (dif * 2 + dea * (params[2] - 1)) / (params[2] + 1);
          } else {
            dea = difSum / params[2];
          }
          macd.macd = (dif - dea) * 2;
          macd.dea = dea;
        }
      }
      return macd;
    });
  }
};
var onBalanceVolume = {
  name: "OBV",
  shortName: "OBV",
  calcParams: [30],
  figures: [
    { key: "obv", title: "OBV: ", type: "line" },
    { key: "maObv", title: "MAOBV: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var obvSum = 0;
    var oldObv = 0;
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2, _b, _c2, _d;
      var prevKLineData = (_a2 = dataList[i - 1]) !== null && _a2 !== void 0 ? _a2 : kLineData;
      if (kLineData.close < prevKLineData.close) {
        oldObv -= (_b = kLineData.volume) !== null && _b !== void 0 ? _b : 0;
      } else if (kLineData.close > prevKLineData.close) {
        oldObv += (_c2 = kLineData.volume) !== null && _c2 !== void 0 ? _c2 : 0;
      }
      var obv = { obv: oldObv };
      obvSum += oldObv;
      if (i >= params[0] - 1) {
        obv.maObv = obvSum / params[0];
        obvSum -= (_d = result[i - (params[0] - 1)].obv) !== null && _d !== void 0 ? _d : 0;
      }
      result.push(obv);
    });
    return result;
  }
};
var priceAndVolumeTrend = {
  name: "PVT",
  shortName: "PVT",
  figures: [
    { key: "pvt", title: "PVT: ", type: "line" }
  ],
  calc: function(dataList) {
    var sum = 0;
    return dataList.map(function(kLineData, i) {
      var _a2, _b;
      var pvt = {};
      var close = kLineData.close;
      var volume2 = (_a2 = kLineData.volume) !== null && _a2 !== void 0 ? _a2 : 1;
      var prevClose = ((_b = dataList[i - 1]) !== null && _b !== void 0 ? _b : kLineData).close;
      var x = 0;
      var total = prevClose * volume2;
      if (total !== 0) {
        x = (close - prevClose) / total;
      }
      sum += x;
      pvt.pvt = sum;
      return pvt;
    });
  }
};
var psychologicalLine = {
  name: "PSY",
  shortName: "PSY",
  calcParams: [12, 6],
  figures: [
    { key: "psy", title: "PSY: ", type: "line" },
    { key: "maPsy", title: "MAPSY: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var upCount = 0;
    var psySum = 0;
    var upList = [];
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2, _b;
      var psy = {};
      var prevClose = ((_a2 = dataList[i - 1]) !== null && _a2 !== void 0 ? _a2 : kLineData).close;
      var upFlag = kLineData.close - prevClose > 0 ? 1 : 0;
      upList.push(upFlag);
      upCount += upFlag;
      if (i >= params[0] - 1) {
        psy.psy = upCount / params[0] * 100;
        psySum += psy.psy;
        if (i >= params[0] + params[1] - 2) {
          psy.maPsy = psySum / params[1];
          psySum -= (_b = result[i - (params[1] - 1)].psy) !== null && _b !== void 0 ? _b : 0;
        }
        upCount -= upList[i - (params[0] - 1)];
      }
      result.push(psy);
    });
    return result;
  }
};
var rateOfChange = {
  name: "ROC",
  shortName: "ROC",
  calcParams: [12, 6],
  figures: [
    { key: "roc", title: "ROC: ", type: "line" },
    { key: "maRoc", title: "MAROC: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var result = [];
    var rocSum = 0;
    dataList.forEach(function(kLineData, i) {
      var _a2, _b;
      var roc = {};
      if (i >= params[0] - 1) {
        var close_1 = kLineData.close;
        var agoClose = ((_a2 = dataList[i - params[0]]) !== null && _a2 !== void 0 ? _a2 : dataList[i - (params[0] - 1)]).close;
        if (agoClose !== 0) {
          roc.roc = (close_1 - agoClose) / agoClose * 100;
        } else {
          roc.roc = 0;
        }
        rocSum += roc.roc;
        if (i >= params[0] - 1 + params[1] - 1) {
          roc.maRoc = rocSum / params[1];
          rocSum -= (_b = result[i - (params[1] - 1)].roc) !== null && _b !== void 0 ? _b : 0;
        }
      }
      result.push(roc);
    });
    return result;
  }
};
var relativeStrengthIndex = {
  name: "RSI",
  shortName: "RSI",
  calcParams: [6, 12, 24],
  figures: [
    { key: "rsi1", title: "RSI1: ", type: "line" },
    { key: "rsi2", title: "RSI2: ", type: "line" },
    { key: "rsi3", title: "RSI3: ", type: "line" }
  ],
  regenerateFigures: function(params) {
    return params.map(function(_, index) {
      var num = index + 1;
      return { key: "rsi".concat(num), title: "RSI".concat(num, ": "), type: "line" };
    });
  },
  calc: function(dataList, indicator) {
    var params = indicator.calcParams, figures2 = indicator.figures;
    var sumCloseAs = [];
    var sumCloseBs = [];
    return dataList.map(function(kLineData, i) {
      var _a2;
      var rsi = {};
      var prevClose = ((_a2 = dataList[i - 1]) !== null && _a2 !== void 0 ? _a2 : kLineData).close;
      var tmp = kLineData.close - prevClose;
      params.forEach(function(p, index) {
        var _a3, _b, _c2;
        if (tmp > 0) {
          sumCloseAs[index] = ((_a3 = sumCloseAs[index]) !== null && _a3 !== void 0 ? _a3 : 0) + tmp;
        } else {
          sumCloseBs[index] = ((_b = sumCloseBs[index]) !== null && _b !== void 0 ? _b : 0) + Math.abs(tmp);
        }
        if (i >= p - 1) {
          if (sumCloseBs[index] !== 0) {
            rsi[figures2[index].key] = 100 - 100 / (1 + sumCloseAs[index] / sumCloseBs[index]);
          } else {
            rsi[figures2[index].key] = 0;
          }
          var agoData = dataList[i - (p - 1)];
          var agoPreData = (_c2 = dataList[i - p]) !== null && _c2 !== void 0 ? _c2 : agoData;
          var agoTmp = agoData.close - agoPreData.close;
          if (agoTmp > 0) {
            sumCloseAs[index] -= agoTmp;
          } else {
            sumCloseBs[index] -= Math.abs(agoTmp);
          }
        }
      });
      return rsi;
    });
  }
};
var simpleMovingAverage = {
  name: "SMA",
  shortName: "SMA",
  series: IndicatorSeries.Price,
  calcParams: [12, 2],
  precision: 2,
  figures: [
    { key: "sma", title: "SMA: ", type: "line" }
  ],
  shouldOhlc: true,
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var closeSum = 0;
    var smaValue = 0;
    return dataList.map(function(kLineData, i) {
      var sma = {};
      var close = kLineData.close;
      closeSum += close;
      if (i >= params[0] - 1) {
        if (i > params[0] - 1) {
          smaValue = (close * params[1] + smaValue * (params[0] - params[1] + 1)) / (params[0] + 1);
        } else {
          smaValue = closeSum / params[0];
        }
        sma.sma = smaValue;
      }
      return sma;
    });
  }
};
var stoch = {
  name: "KDJ",
  shortName: "KDJ",
  calcParams: [9, 3, 3],
  figures: [
    { key: "k", title: "K: ", type: "line" },
    { key: "d", title: "D: ", type: "line" },
    { key: "j", title: "J: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2, _b, _c2, _d;
      var kdj = {};
      var close = kLineData.close;
      if (i >= params[0] - 1) {
        var lhn = getMaxMin(dataList.slice(i - (params[0] - 1), i + 1), "high", "low");
        var hn2 = lhn[0];
        var ln2 = lhn[1];
        var hnSubLn = hn2 - ln2;
        var rsv = (close - ln2) / (hnSubLn === 0 ? 1 : hnSubLn) * 100;
        kdj.k = ((params[1] - 1) * ((_b = (_a2 = result[i - 1]) === null || _a2 === void 0 ? void 0 : _a2.k) !== null && _b !== void 0 ? _b : 50) + rsv) / params[1];
        kdj.d = ((params[2] - 1) * ((_d = (_c2 = result[i - 1]) === null || _c2 === void 0 ? void 0 : _c2.d) !== null && _d !== void 0 ? _d : 50) + kdj.k) / params[2];
        kdj.j = 3 * kdj.k - 2 * kdj.d;
      }
      result.push(kdj);
    });
    return result;
  }
};
var stopAndReverse = {
  name: "SAR",
  shortName: "SAR",
  series: IndicatorSeries.Price,
  calcParams: [2, 2, 20],
  precision: 2,
  shouldOhlc: true,
  figures: [
    {
      key: "sar",
      title: "SAR: ",
      type: "circle",
      styles: function(data, indicator, defaultStyles) {
        var _a2, _b;
        var current = data.current;
        var sar = (_b = (_a2 = current.indicatorData) === null || _a2 === void 0 ? void 0 : _a2.sar) !== null && _b !== void 0 ? _b : Number.MIN_SAFE_INTEGER;
        var kLineData = current.kLineData;
        var halfHL = ((kLineData === null || kLineData === void 0 ? void 0 : kLineData.high) + (kLineData === null || kLineData === void 0 ? void 0 : kLineData.low)) / 2;
        var color = sar < halfHL ? formatValue(indicator.styles, "circles[0].upColor", defaultStyles.circles[0].upColor) : formatValue(indicator.styles, "circles[0].downColor", defaultStyles.circles[0].downColor);
        return { color };
      }
    }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var startAf = params[0] / 100;
    var step = params[1] / 100;
    var maxAf = params[2] / 100;
    var af = startAf;
    var ep = -100;
    var isIncreasing = false;
    var sar = 0;
    return dataList.map(function(kLineData, i) {
      var preSar = sar;
      var high = kLineData.high;
      var low = kLineData.low;
      if (isIncreasing) {
        if (ep === -100 || ep < high) {
          ep = high;
          af = Math.min(af + step, maxAf);
        }
        sar = preSar + af * (ep - preSar);
        var lowMin = Math.min(dataList[Math.max(1, i) - 1].low, low);
        if (sar > kLineData.low) {
          sar = ep;
          af = startAf;
          ep = -100;
          isIncreasing = !isIncreasing;
        } else if (sar > lowMin) {
          sar = lowMin;
        }
      } else {
        if (ep === -100 || ep > low) {
          ep = low;
          af = Math.min(af + step, maxAf);
        }
        sar = preSar + af * (ep - preSar);
        var highMax = Math.max(dataList[Math.max(1, i) - 1].high, high);
        if (sar < kLineData.high) {
          sar = ep;
          af = 0;
          ep = -100;
          isIncreasing = !isIncreasing;
        } else if (sar < highMax) {
          sar = highMax;
        }
      }
      return { sar };
    });
  }
};
var tripleExponentiallySmoothedAverage = {
  name: "TRIX",
  shortName: "TRIX",
  calcParams: [12, 9],
  figures: [
    { key: "trix", title: "TRIX: ", type: "line" },
    { key: "maTrix", title: "MATRIX: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var closeSum = 0;
    var ema1;
    var ema2;
    var oldTr;
    var ema1Sum = 0;
    var ema2Sum = 0;
    var trixSum = 0;
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2;
      var trix = {};
      var close = kLineData.close;
      closeSum += close;
      if (i >= params[0] - 1) {
        if (i > params[0] - 1) {
          ema1 = (2 * close + (params[0] - 1) * ema1) / (params[0] + 1);
        } else {
          ema1 = closeSum / params[0];
        }
        ema1Sum += ema1;
        if (i >= params[0] * 2 - 2) {
          if (i > params[0] * 2 - 2) {
            ema2 = (2 * ema1 + (params[0] - 1) * ema2) / (params[0] + 1);
          } else {
            ema2 = ema1Sum / params[0];
          }
          ema2Sum += ema2;
          if (i >= params[0] * 3 - 3) {
            var tr2 = void 0;
            var trixValue = 0;
            if (i > params[0] * 3 - 3) {
              tr2 = (2 * ema2 + (params[0] - 1) * oldTr) / (params[0] + 1);
              trixValue = (tr2 - oldTr) / oldTr * 100;
            } else {
              tr2 = ema2Sum / params[0];
            }
            oldTr = tr2;
            trix.trix = trixValue;
            trixSum += trixValue;
            if (i >= params[0] * 3 + params[1] - 4) {
              trix.maTrix = trixSum / params[1];
              trixSum -= (_a2 = result[i - (params[1] - 1)].trix) !== null && _a2 !== void 0 ? _a2 : 0;
            }
          }
        }
      }
      result.push(trix);
    });
    return result;
  }
};
function getVolumeFigure() {
  return {
    key: "volume",
    title: "VOLUME: ",
    type: "bar",
    baseValue: 0,
    styles: function(data, indicator, defaultStyles) {
      var kLineData = data.current.kLineData;
      var color = formatValue(indicator.styles, "bars[0].noChangeColor", defaultStyles.bars[0].noChangeColor);
      if (isValid(kLineData)) {
        if (kLineData.close > kLineData.open) {
          color = formatValue(indicator.styles, "bars[0].upColor", defaultStyles.bars[0].upColor);
        } else if (kLineData.close < kLineData.open) {
          color = formatValue(indicator.styles, "bars[0].downColor", defaultStyles.bars[0].downColor);
        }
      }
      return { color };
    }
  };
}
var volume = {
  name: "VOL",
  shortName: "VOL",
  series: IndicatorSeries.Volume,
  calcParams: [5, 10, 20],
  shouldFormatBigNumber: true,
  precision: 0,
  minValue: 0,
  figures: [
    { key: "ma1", title: "MA5: ", type: "line" },
    { key: "ma2", title: "MA10: ", type: "line" },
    { key: "ma3", title: "MA20: ", type: "line" },
    getVolumeFigure()
  ],
  regenerateFigures: function(params) {
    var figures2 = params.map(function(p, i) {
      return { key: "ma".concat(i + 1), title: "MA".concat(p, ": "), type: "line" };
    });
    figures2.push(getVolumeFigure());
    return figures2;
  },
  calc: function(dataList, indicator) {
    var params = indicator.calcParams, figures2 = indicator.figures;
    var volSums = [];
    return dataList.map(function(kLineData, i) {
      var _a2;
      var volume2 = (_a2 = kLineData.volume) !== null && _a2 !== void 0 ? _a2 : 0;
      var vol = { volume: volume2 };
      params.forEach(function(p, index) {
        var _a3, _b;
        volSums[index] = ((_a3 = volSums[index]) !== null && _a3 !== void 0 ? _a3 : 0) + volume2;
        if (i >= p - 1) {
          vol[figures2[index].key] = volSums[index] / p;
          volSums[index] -= (_b = dataList[i - (p - 1)].volume) !== null && _b !== void 0 ? _b : 0;
        }
      });
      return vol;
    });
  }
};
var volumeRatio = {
  name: "VR",
  shortName: "VR",
  calcParams: [26, 6],
  figures: [
    { key: "vr", title: "VR: ", type: "line" },
    { key: "maVr", title: "MAVR: ", type: "line" }
  ],
  calc: function(dataList, indicator) {
    var params = indicator.calcParams;
    var uvs = 0;
    var dvs = 0;
    var pvs = 0;
    var vrSum = 0;
    var result = [];
    dataList.forEach(function(kLineData, i) {
      var _a2, _b, _c2, _d, _e2;
      var vr2 = {};
      var close = kLineData.close;
      var preClose = ((_a2 = dataList[i - 1]) !== null && _a2 !== void 0 ? _a2 : kLineData).close;
      var volume2 = (_b = kLineData.volume) !== null && _b !== void 0 ? _b : 0;
      if (close > preClose) {
        uvs += volume2;
      } else if (close < preClose) {
        dvs += volume2;
      } else {
        pvs += volume2;
      }
      if (i >= params[0] - 1) {
        var halfPvs = pvs / 2;
        if (dvs + halfPvs === 0) {
          vr2.vr = 0;
        } else {
          vr2.vr = (uvs + halfPvs) / (dvs + halfPvs) * 100;
        }
        vrSum += vr2.vr;
        if (i >= params[0] + params[1] - 2) {
          vr2.maVr = vrSum / params[1];
          vrSum -= (_c2 = result[i - (params[1] - 1)].vr) !== null && _c2 !== void 0 ? _c2 : 0;
        }
        var agoData = dataList[i - (params[0] - 1)];
        var agoPreData = (_d = dataList[i - params[0]]) !== null && _d !== void 0 ? _d : agoData;
        var agoClose = agoData.close;
        var agoVolume = (_e2 = agoData.volume) !== null && _e2 !== void 0 ? _e2 : 0;
        if (agoClose > agoPreData.close) {
          uvs -= agoVolume;
        } else if (agoClose < agoPreData.close) {
          dvs -= agoVolume;
        } else {
          pvs -= agoVolume;
        }
      }
      result.push(vr2);
    });
    return result;
  }
};
var williamsR = {
  name: "WR",
  shortName: "WR",
  calcParams: [6, 10, 14],
  figures: [
    { key: "wr1", title: "WR1: ", type: "line" },
    { key: "wr2", title: "WR2: ", type: "line" },
    { key: "wr3", title: "WR3: ", type: "line" }
  ],
  regenerateFigures: function(params) {
    return params.map(function(_, i) {
      return { key: "wr".concat(i + 1), title: "WR".concat(i + 1, ": "), type: "line" };
    });
  },
  calc: function(dataList, indicator) {
    var params = indicator.calcParams, figures2 = indicator.figures;
    return dataList.map(function(kLineData, i) {
      var wr2 = {};
      var close = kLineData.close;
      params.forEach(function(param, index) {
        var p = param - 1;
        if (i >= p) {
          var hln = getMaxMin(dataList.slice(i - p, i + 1), "high", "low");
          var hn2 = hln[0];
          var ln2 = hln[1];
          var hnSubLn = hn2 - ln2;
          wr2[figures2[index].key] = hnSubLn === 0 ? 0 : (close - hn2) / hnSubLn * 100;
        }
      });
      return wr2;
    });
  }
};
var indicators = {};
var extensions$2 = [
  averagePrice,
  awesomeOscillator,
  bias,
  bollingerBands,
  brar,
  bullAndBearIndex,
  commodityChannelIndex,
  currentRatio,
  differentOfMovingAverage,
  directionalMovementIndex,
  easeOfMovementValue,
  exponentialMovingAverage,
  momentum,
  movingAverage,
  movingAverageConvergenceDivergence,
  onBalanceVolume,
  priceAndVolumeTrend,
  psychologicalLine,
  rateOfChange,
  relativeStrengthIndex,
  simpleMovingAverage,
  stoch,
  stopAndReverse,
  tripleExponentiallySmoothedAverage,
  volume,
  volumeRatio,
  williamsR
];
extensions$2.forEach(function(indicator) {
  indicators[indicator.name] = IndicatorImp.extend(indicator);
});
function getIndicatorClass(name) {
  var _a2;
  return (_a2 = indicators[name]) !== null && _a2 !== void 0 ? _a2 : null;
}
var IndicatorStore = (
  /** @class */
  function() {
    function IndicatorStore2(chartStore) {
      this._instances = /* @__PURE__ */ new Map();
      this._chartStore = chartStore;
    }
    IndicatorStore2.prototype._overrideInstance = function(instance, indicator) {
      var shortName = indicator.shortName, series = indicator.series, calcParams = indicator.calcParams, precision = indicator.precision, figures2 = indicator.figures, minValue = indicator.minValue, maxValue = indicator.maxValue, shouldOhlc = indicator.shouldOhlc, shouldFormatBigNumber = indicator.shouldFormatBigNumber, visible = indicator.visible, zLevel = indicator.zLevel, styles2 = indicator.styles, extendData = indicator.extendData, regenerateFigures = indicator.regenerateFigures, createTooltipDataSource = indicator.createTooltipDataSource, draw = indicator.draw, calc = indicator.calc;
      var updateFlag = false;
      if (isString(shortName) && instance.setShortName(shortName)) {
        updateFlag = true;
      }
      if (isValid(series) && instance.setSeries(series)) {
        updateFlag = true;
      }
      var calcFlag = false;
      if (isArray(calcParams) && instance.setCalcParams(calcParams)) {
        updateFlag = true;
        calcFlag = true;
      }
      if (isArray(figures2) && instance.setFigures(figures2)) {
        updateFlag = true;
        calcFlag = true;
      }
      if (minValue !== void 0 && instance.setMinValue(minValue)) {
        updateFlag = true;
      }
      if (maxValue !== void 0 && instance.setMinValue(maxValue)) {
        updateFlag = true;
      }
      if (isNumber(precision) && instance.setPrecision(precision)) {
        updateFlag = true;
      }
      if (isBoolean(shouldOhlc) && instance.setShouldOhlc(shouldOhlc)) {
        updateFlag = true;
      }
      if (isBoolean(shouldFormatBigNumber) && instance.setShouldFormatBigNumber(shouldFormatBigNumber)) {
        updateFlag = true;
      }
      if (isBoolean(visible) && instance.setVisible(visible)) {
        updateFlag = true;
      }
      var sortFlag = false;
      if (isNumber(zLevel) && instance.setZLevel(zLevel)) {
        updateFlag = true;
        sortFlag = true;
      }
      if (isValid(styles2) && instance.setStyles(styles2)) {
        updateFlag = true;
      }
      if (extendData !== void 0 && instance.setExtendData(extendData)) {
        updateFlag = true;
        calcFlag = true;
      }
      if (regenerateFigures !== void 0 && instance.setRegenerateFigures(regenerateFigures)) {
        updateFlag = true;
      }
      if (createTooltipDataSource !== void 0 && instance.setCreateTooltipDataSource(createTooltipDataSource)) {
        updateFlag = true;
      }
      if (draw !== void 0 && instance.setDraw(draw)) {
        updateFlag = true;
      }
      if (isFunction(calc)) {
        instance.calc = calc;
        calcFlag = true;
      }
      return [updateFlag, calcFlag, sortFlag];
    };
    IndicatorStore2.prototype._sort = function(paneId) {
      var _a2;
      if (isString(paneId)) {
        (_a2 = this._instances.get(paneId)) === null || _a2 === void 0 ? void 0 : _a2.sort(function(i12, i22) {
          return i12.zLevel - i22.zLevel;
        });
      } else {
        this._instances.forEach(function(paneInstances) {
          paneInstances.sort(function(i12, i22) {
            return i12.zLevel - i22.zLevel;
          });
        });
      }
    };
    IndicatorStore2.prototype.addInstance = function(indicator, paneId, isStack) {
      return __awaiter(this, void 0, void 0, function() {
        var name, paneInstances, instance_1, IndicatorClazz, instance;
        return __generator(this, function(_a2) {
          switch (_a2.label) {
            case 0:
              name = indicator.name;
              paneInstances = this._instances.get(paneId);
              if (!isValid(paneInstances)) return [3, 2];
              instance_1 = paneInstances.find(function(ins) {
                return ins.name === name;
              });
              if (!isValid(instance_1)) return [3, 2];
              return [4, Promise.reject(new Error("Duplicate indicators."))];
            case 1:
              return [2, _a2.sent()];
            case 2:
              if (!isValid(paneInstances)) {
                paneInstances = [];
              }
              IndicatorClazz = getIndicatorClass(name);
              instance = new IndicatorClazz();
              this.synchronizeSeriesPrecision(instance);
              this._overrideInstance(instance, indicator);
              if (!isStack) {
                paneInstances = [];
              }
              paneInstances.push(instance);
              this._instances.set(paneId, paneInstances);
              this._sort(paneId);
              return [4, instance.calcIndicator(this._chartStore.getDataList())];
            case 3:
              return [2, _a2.sent()];
          }
        });
      });
    };
    IndicatorStore2.prototype.getInstances = function(paneId) {
      var _a2;
      return (_a2 = this._instances.get(paneId)) !== null && _a2 !== void 0 ? _a2 : [];
    };
    IndicatorStore2.prototype.removeInstance = function(paneId, name) {
      var _a2;
      var removed = false;
      var paneInstances = this._instances.get(paneId);
      if (isValid(paneInstances)) {
        if (isString(name)) {
          var index = paneInstances.findIndex(function(ins) {
            return ins.name === name;
          });
          if (index > -1) {
            paneInstances.splice(index, 1);
            removed = true;
          }
        } else {
          this._instances.set(paneId, []);
          removed = true;
        }
        if (((_a2 = this._instances.get(paneId)) === null || _a2 === void 0 ? void 0 : _a2.length) === 0) {
          this._instances.delete(paneId);
        }
      }
      return removed;
    };
    IndicatorStore2.prototype.hasInstances = function(paneId) {
      return this._instances.has(paneId);
    };
    IndicatorStore2.prototype.calcInstance = function(name, paneId) {
      return __awaiter(this, void 0, void 0, function() {
        var tasks, paneInstances, instance, result;
        var _this = this;
        return __generator(this, function(_a2) {
          switch (_a2.label) {
            case 0:
              tasks = [];
              if (isString(name)) {
                if (isString(paneId)) {
                  paneInstances = this._instances.get(paneId);
                  if (isValid(paneInstances)) {
                    instance = paneInstances.find(function(ins) {
                      return ins.name === name;
                    });
                    if (isValid(instance)) {
                      tasks.push(instance.calcIndicator(this._chartStore.getDataList()));
                    }
                  }
                } else {
                  this._instances.forEach(function(paneInstances2) {
                    var instance2 = paneInstances2.find(function(ins) {
                      return ins.name === name;
                    });
                    if (isValid(instance2)) {
                      tasks.push(instance2.calcIndicator(_this._chartStore.getDataList()));
                    }
                  });
                }
              } else {
                this._instances.forEach(function(paneInstances2) {
                  paneInstances2.forEach(function(instance2) {
                    tasks.push(instance2.calcIndicator(_this._chartStore.getDataList()));
                  });
                });
              }
              return [4, Promise.all(tasks)];
            case 1:
              result = _a2.sent();
              return [2, result.includes(true)];
          }
        });
      });
    };
    IndicatorStore2.prototype.getInstanceByPaneId = function(paneId, name) {
      var _a2, _b;
      var createMapping = function(instances2) {
        var mapping2 = /* @__PURE__ */ new Map();
        instances2.forEach(function(ins) {
          mapping2.set(ins.name, ins);
        });
        return mapping2;
      };
      if (isString(paneId)) {
        var paneInstances = (_a2 = this._instances.get(paneId)) !== null && _a2 !== void 0 ? _a2 : [];
        if (isString(name)) {
          return (_b = paneInstances === null || paneInstances === void 0 ? void 0 : paneInstances.find(function(ins) {
            return ins.name === name;
          })) !== null && _b !== void 0 ? _b : null;
        }
        return createMapping(paneInstances);
      }
      var mapping = /* @__PURE__ */ new Map();
      this._instances.forEach(function(instances2, paneId2) {
        mapping.set(paneId2, createMapping(instances2));
      });
      return mapping;
    };
    IndicatorStore2.prototype.synchronizeSeriesPrecision = function(indicator) {
      var _a2 = this._chartStore.getPrecision(), pricePrecision = _a2.price, volumePrecision = _a2.volume;
      var synchronize = function(instance) {
        switch (instance.series) {
          case IndicatorSeries.Price: {
            instance.setPrecision(pricePrecision, true);
            break;
          }
          case IndicatorSeries.Volume: {
            instance.setPrecision(volumePrecision, true);
            break;
          }
        }
      };
      if (isValid(indicator)) {
        synchronize(indicator);
      } else {
        this._instances.forEach(function(paneInstances) {
          paneInstances.forEach(function(instance) {
            synchronize(instance);
          });
        });
      }
    };
    IndicatorStore2.prototype.override = function(indicator, paneId) {
      return __awaiter(this, void 0, void 0, function() {
        var name, instances2, paneInstances, onlyUpdateFlag, tasks, sortFlag, result;
        var _this = this;
        return __generator(this, function(_a2) {
          switch (_a2.label) {
            case 0:
              name = indicator.name;
              instances2 = /* @__PURE__ */ new Map();
              if (paneId !== null) {
                paneInstances = this._instances.get(paneId);
                if (isValid(paneInstances)) {
                  instances2.set(paneId, paneInstances);
                }
              } else {
                instances2 = this._instances;
              }
              onlyUpdateFlag = false;
              tasks = [];
              sortFlag = false;
              instances2.forEach(function(paneInstances2) {
                var instance = paneInstances2.find(function(ins) {
                  return ins.name === name;
                });
                if (isValid(instance)) {
                  var overrideResult = _this._overrideInstance(instance, indicator);
                  if (overrideResult[2]) {
                    sortFlag = true;
                  }
                  if (overrideResult[1]) {
                    tasks.push(instance.calcIndicator(_this._chartStore.getDataList()));
                  } else {
                    if (overrideResult[0]) {
                      onlyUpdateFlag = true;
                    }
                  }
                }
              });
              if (sortFlag) {
                this._sort();
              }
              return [4, Promise.all(tasks)];
            case 1:
              result = _a2.sent();
              return [2, [onlyUpdateFlag, result.includes(true)]];
          }
        });
      });
    };
    return IndicatorStore2;
  }()
);
var TooltipStore = (
  /** @class */
  function() {
    function TooltipStore2(chartStore) {
      this._crosshair = {};
      this._activeIcon = null;
      this._chartStore = chartStore;
    }
    TooltipStore2.prototype.setCrosshair = function(crosshair, options) {
      var _a2 = options !== null && options !== void 0 ? options : {}, notInvalidate = _a2.notInvalidate, notExecuteAction = _a2.notExecuteAction;
      var dataList = this._chartStore.getDataList();
      var cr2 = crosshair !== null && crosshair !== void 0 ? crosshair : {};
      var realDataIndex;
      var dataIndex;
      if (isNumber(cr2.x)) {
        realDataIndex = this._chartStore.getTimeScaleStore().coordinateToDataIndex(cr2.x);
        if (realDataIndex < 0) {
          dataIndex = 0;
        } else if (realDataIndex > dataList.length - 1) {
          dataIndex = dataList.length - 1;
        } else {
          dataIndex = realDataIndex;
        }
      } else {
        realDataIndex = dataList.length - 1;
        dataIndex = realDataIndex;
      }
      var kLineData = dataList[dataIndex];
      var realX = this._chartStore.getTimeScaleStore().dataIndexToCoordinate(realDataIndex);
      var prevCrosshair = { x: this._crosshair.x, y: this._crosshair.y, paneId: this._crosshair.paneId };
      this._crosshair = __assign(__assign({}, cr2), { realX, kLineData, realDataIndex, dataIndex });
      if (prevCrosshair.x !== cr2.x || prevCrosshair.y !== cr2.y || prevCrosshair.paneId !== cr2.paneId) {
        if (kLineData !== null && !(notExecuteAction !== null && notExecuteAction !== void 0 ? notExecuteAction : false)) {
          this._chartStore.getChart().crosshairChange(this._crosshair);
        }
        if (!(notInvalidate !== null && notInvalidate !== void 0 ? notInvalidate : false)) {
          this._chartStore.getChart().updatePane(
            1
            /* UpdateLevel.Overlay */
          );
        }
      }
    };
    TooltipStore2.prototype.recalculateCrosshair = function(notInvalidate) {
      this.setCrosshair(this._crosshair, { notInvalidate });
    };
    TooltipStore2.prototype.getCrosshair = function() {
      return this._crosshair;
    };
    TooltipStore2.prototype.setActiveIcon = function(icon) {
      this._activeIcon = icon !== null && icon !== void 0 ? icon : null;
    };
    TooltipStore2.prototype.getActiveIcon = function() {
      return this._activeIcon;
    };
    TooltipStore2.prototype.clear = function() {
      this.setCrosshair({}, { notInvalidate: true });
      this.setActiveIcon();
    };
    return TooltipStore2;
  }()
);
var fibonacciLine = {
  name: "fibonacciLine",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var _b;
    var coordinates = _a2.coordinates, bounding = _a2.bounding, overlay = _a2.overlay, precision = _a2.precision, thousandsSeparator = _a2.thousandsSeparator, decimalFoldThreshold = _a2.decimalFoldThreshold, yAxis = _a2.yAxis;
    var points = overlay.points;
    if (coordinates.length > 0) {
      var currentPrecision_1 = ((_b = yAxis === null || yAxis === void 0 ? void 0 : yAxis.isInCandle()) !== null && _b !== void 0 ? _b : true) ? precision.price : precision.excludePriceVolumeMax;
      var lines_1 = [];
      var texts_1 = [];
      var startX_1 = 0;
      var endX_1 = bounding.width;
      if (coordinates.length > 1 && isNumber(points[0].value) && isNumber(points[1].value)) {
        var percents = [1, 0.786, 0.618, 0.5, 0.382, 0.236, 0];
        var yDif_1 = coordinates[0].y - coordinates[1].y;
        var valueDif_1 = points[0].value - points[1].value;
        percents.forEach(function(percent) {
          var _a3;
          var y = coordinates[1].y + yDif_1 * percent;
          var value = formatFoldDecimal(formatThousands((((_a3 = points[1].value) !== null && _a3 !== void 0 ? _a3 : 0) + valueDif_1 * percent).toFixed(currentPrecision_1), thousandsSeparator), decimalFoldThreshold);
          lines_1.push({ coordinates: [{ x: startX_1, y }, { x: endX_1, y }] });
          texts_1.push({
            x: startX_1,
            y,
            text: "".concat(value, " (").concat((percent * 100).toFixed(1), "%)"),
            baseline: "bottom"
          });
        });
      }
      return [
        {
          type: "line",
          attrs: lines_1
        },
        {
          type: "text",
          isCheckEvent: false,
          attrs: texts_1
        }
      ];
    }
    return [];
  }
};
var horizontalRayLine = {
  name: "horizontalRayLine",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates, bounding = _a2.bounding;
    var coordinate = { x: 0, y: coordinates[0].y };
    if (isValid(coordinates[1]) && coordinates[0].x < coordinates[1].x) {
      coordinate.x = bounding.width;
    }
    return [
      {
        type: "line",
        attrs: { coordinates: [coordinates[0], coordinate] }
      }
    ];
  },
  performEventPressedMove: function(_a2) {
    var points = _a2.points, performPoint = _a2.performPoint;
    points[0].value = performPoint.value;
    points[1].value = performPoint.value;
  },
  performEventMoveForDrawing: function(_a2) {
    var currentStep = _a2.currentStep, points = _a2.points, performPoint = _a2.performPoint;
    if (currentStep === 2) {
      points[0].value = performPoint.value;
    }
  }
};
var horizontalSegment = {
  name: "horizontalSegment",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates;
    var lines = [];
    if (coordinates.length === 2) {
      lines.push({ coordinates });
    }
    return [
      {
        type: "line",
        attrs: lines
      }
    ];
  },
  performEventPressedMove: function(_a2) {
    var points = _a2.points, performPoint = _a2.performPoint;
    points[0].value = performPoint.value;
    points[1].value = performPoint.value;
  },
  performEventMoveForDrawing: function(_a2) {
    var currentStep = _a2.currentStep, points = _a2.points, performPoint = _a2.performPoint;
    if (currentStep === 2) {
      points[0].value = performPoint.value;
    }
  }
};
var horizontalStraightLine = {
  name: "horizontalStraightLine",
  totalStep: 2,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates, bounding = _a2.bounding;
    return [{
      type: "line",
      attrs: {
        coordinates: [
          {
            x: 0,
            y: coordinates[0].y
          },
          {
            x: bounding.width,
            y: coordinates[0].y
          }
        ]
      }
    }];
  }
};
var Eventful = (
  /** @class */
  function() {
    function Eventful2() {
      this._children = [];
      this._callbacks = /* @__PURE__ */ new Map();
    }
    Eventful2.prototype.registerEvent = function(name, callback) {
      this._callbacks.set(name, callback);
      return this;
    };
    Eventful2.prototype.onEvent = function(name, event, other) {
      var callback = this._callbacks.get(name);
      if (isValid(callback) && this.checkEventOn(event)) {
        return callback(event, other);
      }
      return false;
    };
    Eventful2.prototype.checkEventOn = function(event) {
      var e_1, _a2;
      try {
        for (var _b = __values(this._children), _c2 = _b.next(); !_c2.done; _c2 = _b.next()) {
          var eventful = _c2.value;
          if (eventful.checkEventOn(event)) {
            return true;
          }
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (_c2 && !_c2.done && (_a2 = _b.return)) _a2.call(_b);
        } finally {
          if (e_1) throw e_1.error;
        }
      }
      return false;
    };
    Eventful2.prototype.dispatchEvent = function(name, event, other) {
      var start = this._children.length - 1;
      if (start > -1) {
        for (var i = start; i > -1; i--) {
          if (this._children[i].dispatchEvent(name, event, other)) {
            return true;
          }
        }
      }
      return this.onEvent(name, event, other);
    };
    Eventful2.prototype.addChild = function(eventful) {
      this._children.push(eventful);
      return this;
    };
    Eventful2.prototype.clear = function() {
      this._children = [];
    };
    return Eventful2;
  }()
);
var DEVIATION = 2;
var FigureImp = (
  /** @class */
  function(_super) {
    __extends(FigureImp2, _super);
    function FigureImp2(figure) {
      var _this = _super.call(this) || this;
      _this.attrs = figure.attrs;
      _this.styles = figure.styles;
      return _this;
    }
    FigureImp2.prototype.checkEventOn = function(event) {
      return this.checkEventOnImp(event, this.attrs, this.styles);
    };
    FigureImp2.prototype.setAttrs = function(attrs) {
      this.attrs = attrs;
      return this;
    };
    FigureImp2.prototype.setStyles = function(styles2) {
      this.styles = styles2;
      return this;
    };
    FigureImp2.prototype.draw = function(ctx) {
      this.drawImp(ctx, this.attrs, this.styles);
    };
    FigureImp2.extend = function(figure) {
      var Custom = (
        /** @class */
        function(_super2) {
          __extends(Custom2, _super2);
          function Custom2() {
            return _super2 !== null && _super2.apply(this, arguments) || this;
          }
          Custom2.prototype.checkEventOnImp = function(coordinate, attrs, styles2) {
            return figure.checkEventOn(coordinate, attrs, styles2);
          };
          Custom2.prototype.drawImp = function(ctx, attrs, styles2) {
            figure.draw(ctx, attrs, styles2);
          };
          return Custom2;
        }(FigureImp2)
      );
      return Custom;
    };
    return FigureImp2;
  }(Eventful)
);
function checkCoordinateOnLine(coordinate, attrs) {
  var lines = [];
  lines = lines.concat(attrs);
  for (var i = 0; i < lines.length; i++) {
    var coordinates = lines[i].coordinates;
    if (coordinates.length > 1) {
      for (var i_1 = 1; i_1 < coordinates.length; i_1++) {
        var prevCoordinate = coordinates[i_1 - 1];
        var currentCoordinate = coordinates[i_1];
        if (prevCoordinate.x === currentCoordinate.x) {
          if (Math.abs(prevCoordinate.y - coordinate.y) + Math.abs(currentCoordinate.y - coordinate.y) - Math.abs(prevCoordinate.y - currentCoordinate.y) < DEVIATION + DEVIATION && Math.abs(coordinate.x - prevCoordinate.x) < DEVIATION) {
            return true;
          }
        } else {
          var kb = getLinearSlopeIntercept(prevCoordinate, currentCoordinate);
          var y = getLinearYFromSlopeIntercept(kb, coordinate);
          var yDif = Math.abs(y - coordinate.y);
          if (Math.abs(prevCoordinate.x - coordinate.x) + Math.abs(currentCoordinate.x - coordinate.x) - Math.abs(prevCoordinate.x - currentCoordinate.x) < DEVIATION + DEVIATION && yDif * yDif / (kb[0] * kb[0] + 1) < DEVIATION * DEVIATION) {
            return true;
          }
        }
      }
    }
  }
  return false;
}
function getLinearYFromSlopeIntercept(kb, coordinate) {
  if (kb !== null) {
    return coordinate.x * kb[0] + kb[1];
  }
  return coordinate.y;
}
function getLinearYFromCoordinates(coordinate1, coordinate2, targetCoordinate) {
  var kb = getLinearSlopeIntercept(coordinate1, coordinate2);
  return getLinearYFromSlopeIntercept(kb, targetCoordinate);
}
function getLinearSlopeIntercept(coordinate1, coordinate2) {
  var difX = coordinate1.x - coordinate2.x;
  if (difX !== 0) {
    var k = (coordinate1.y - coordinate2.y) / difX;
    var b = coordinate1.y - k * coordinate1.x;
    return [k, b];
  }
  return null;
}
function lineTo(ctx, coordinates, smooth) {
  var length = coordinates.length;
  var smoothParam = isNumber(smooth) ? smooth > 0 && smooth < 1 ? smooth : 0 : smooth ? 0.5 : 0;
  if (smoothParam > 0 && length > 2) {
    var cpx0 = coordinates[0].x;
    var cpy0 = coordinates[0].y;
    for (var i = 1; i < length - 1; i++) {
      var prevCoordinate = coordinates[i - 1];
      var coordinate = coordinates[i];
      var nextCoordinate = coordinates[i + 1];
      var dx01 = coordinate.x - prevCoordinate.x;
      var dy01 = coordinate.y - prevCoordinate.y;
      var dx12 = nextCoordinate.x - coordinate.x;
      var dy12 = nextCoordinate.y - coordinate.y;
      var dx02 = nextCoordinate.x - prevCoordinate.x;
      var dy02 = nextCoordinate.y - prevCoordinate.y;
      var prevSegmentLength = Math.sqrt(dx01 * dx01 + dy01 * dy01);
      var nextSegmentLength = Math.sqrt(dx12 * dx12 + dy12 * dy12);
      var segmentLengthRatio = nextSegmentLength / (nextSegmentLength + prevSegmentLength);
      var nextCpx = coordinate.x + dx02 * smoothParam * segmentLengthRatio;
      var nextCpy = coordinate.y + dy02 * smoothParam * segmentLengthRatio;
      nextCpx = Math.min(nextCpx, Math.max(nextCoordinate.x, coordinate.x));
      nextCpy = Math.min(nextCpy, Math.max(nextCoordinate.y, coordinate.y));
      nextCpx = Math.max(nextCpx, Math.min(nextCoordinate.x, coordinate.x));
      nextCpy = Math.max(nextCpy, Math.min(nextCoordinate.y, coordinate.y));
      dx02 = nextCpx - coordinate.x;
      dy02 = nextCpy - coordinate.y;
      var cpx1 = coordinate.x - dx02 * prevSegmentLength / nextSegmentLength;
      var cpy1 = coordinate.y - dy02 * prevSegmentLength / nextSegmentLength;
      cpx1 = Math.min(cpx1, Math.max(prevCoordinate.x, coordinate.x));
      cpy1 = Math.min(cpy1, Math.max(prevCoordinate.y, coordinate.y));
      cpx1 = Math.max(cpx1, Math.min(prevCoordinate.x, coordinate.x));
      cpy1 = Math.max(cpy1, Math.min(prevCoordinate.y, coordinate.y));
      dx02 = coordinate.x - cpx1;
      dy02 = coordinate.y - cpy1;
      nextCpx = coordinate.x + dx02 * nextSegmentLength / prevSegmentLength;
      nextCpy = coordinate.y + dy02 * nextSegmentLength / prevSegmentLength;
      ctx.bezierCurveTo(cpx0, cpy0, cpx1, cpy1, coordinate.x, coordinate.y);
      cpx0 = nextCpx;
      cpy0 = nextCpy;
    }
    var lastCoordinate = coordinates[length - 1];
    ctx.bezierCurveTo(cpx0, cpy0, lastCoordinate.x, lastCoordinate.y, lastCoordinate.x, lastCoordinate.y);
  } else {
    for (var i = 1; i < length; i++) {
      ctx.lineTo(coordinates[i].x, coordinates[i].y);
    }
  }
}
function drawLine(ctx, attrs, styles2) {
  var lines = [];
  lines = lines.concat(attrs);
  var _a2 = styles2.style, style = _a2 === void 0 ? LineType.Solid : _a2, _b = styles2.smooth, smooth = _b === void 0 ? false : _b, _c2 = styles2.size, size = _c2 === void 0 ? 1 : _c2, _d = styles2.color, color = _d === void 0 ? "currentColor" : _d, _e2 = styles2.dashedValue, dashedValue = _e2 === void 0 ? [2, 2] : _e2;
  ctx.lineWidth = size;
  ctx.strokeStyle = color;
  if (style === LineType.Dashed) {
    ctx.setLineDash(dashedValue);
  } else {
    ctx.setLineDash([]);
  }
  var correction = size % 2 === 1 ? 0.5 : 0;
  lines.forEach(function(_a3) {
    var coordinates = _a3.coordinates;
    if (coordinates.length > 1) {
      if (coordinates.length === 2 && (coordinates[0].x === coordinates[1].x || coordinates[0].y === coordinates[1].y)) {
        ctx.beginPath();
        if (coordinates[0].x === coordinates[1].x) {
          ctx.moveTo(coordinates[0].x + correction, coordinates[0].y);
          ctx.lineTo(coordinates[1].x + correction, coordinates[1].y);
        } else {
          ctx.moveTo(coordinates[0].x, coordinates[0].y + correction);
          ctx.lineTo(coordinates[1].x, coordinates[1].y + correction);
        }
        ctx.stroke();
        ctx.closePath();
      } else {
        ctx.save();
        if (size % 2 === 1) {
          ctx.translate(0.5, 0.5);
        }
        ctx.beginPath();
        ctx.moveTo(coordinates[0].x, coordinates[0].y);
        lineTo(ctx, coordinates, smooth);
        ctx.stroke();
        ctx.closePath();
        ctx.restore();
      }
    }
  });
}
var line = {
  name: "line",
  checkEventOn: checkCoordinateOnLine,
  draw: function(ctx, attrs, styles2) {
    drawLine(ctx, attrs, styles2);
  }
};
function getParallelLines(coordinates, bounding, extendParallelLineCount) {
  var count = extendParallelLineCount !== null && extendParallelLineCount !== void 0 ? extendParallelLineCount : 0;
  var lines = [];
  if (coordinates.length > 1) {
    if (coordinates[0].x === coordinates[1].x) {
      var startY = 0;
      var endY = bounding.height;
      lines.push({ coordinates: [{ x: coordinates[0].x, y: startY }, { x: coordinates[0].x, y: endY }] });
      if (coordinates.length > 2) {
        lines.push({ coordinates: [{ x: coordinates[2].x, y: startY }, { x: coordinates[2].x, y: endY }] });
        var distance = coordinates[0].x - coordinates[2].x;
        for (var i = 0; i < count; i++) {
          var d10 = distance * (i + 1);
          lines.push({ coordinates: [{ x: coordinates[0].x + d10, y: startY }, { x: coordinates[0].x + d10, y: endY }] });
        }
      }
    } else {
      var startX = 0;
      var endX = bounding.width;
      var kb = getLinearSlopeIntercept(coordinates[0], coordinates[1]);
      var k = kb[0];
      var b = kb[1];
      lines.push({ coordinates: [{ x: startX, y: startX * k + b }, { x: endX, y: endX * k + b }] });
      if (coordinates.length > 2) {
        var b12 = coordinates[2].y - k * coordinates[2].x;
        lines.push({ coordinates: [{ x: startX, y: startX * k + b12 }, { x: endX, y: endX * k + b12 }] });
        var distance = b - b12;
        for (var i = 0; i < count; i++) {
          var b22 = b + distance * (i + 1);
          lines.push({ coordinates: [{ x: startX, y: startX * k + b22 }, { x: endX, y: endX * k + b22 }] });
        }
      }
    }
  }
  return lines;
}
var parallelStraightLine = {
  name: "parallelStraightLine",
  totalStep: 4,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates, bounding = _a2.bounding;
    return [
      {
        type: "line",
        attrs: getParallelLines(coordinates, bounding)
      }
    ];
  }
};
var priceChannelLine = {
  name: "priceChannelLine",
  totalStep: 4,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates, bounding = _a2.bounding;
    return [
      {
        type: "line",
        attrs: getParallelLines(coordinates, bounding, 1)
      }
    ];
  }
};
var priceLine = {
  name: "priceLine",
  totalStep: 2,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var _b;
    var coordinates = _a2.coordinates, bounding = _a2.bounding, precision = _a2.precision, overlay = _a2.overlay, thousandsSeparator = _a2.thousandsSeparator, decimalFoldThreshold = _a2.decimalFoldThreshold, yAxis = _a2.yAxis;
    var _c2 = overlay.points[0].value, value = _c2 === void 0 ? 0 : _c2;
    var currentPrecision = ((_b = yAxis === null || yAxis === void 0 ? void 0 : yAxis.isInCandle()) !== null && _b !== void 0 ? _b : true) ? precision.price : precision.excludePriceVolumeMax;
    return [
      {
        type: "line",
        attrs: { coordinates: [coordinates[0], { x: bounding.width, y: coordinates[0].y }] }
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: {
          x: coordinates[0].x,
          y: coordinates[0].y,
          text: formatFoldDecimal(formatThousands(value.toFixed(currentPrecision), thousandsSeparator), decimalFoldThreshold),
          baseline: "bottom"
        }
      }
    ];
  }
};
function getRayLine(coordinates, bounding) {
  if (coordinates.length > 1) {
    var coordinate = void 0;
    if (coordinates[0].x === coordinates[1].x && coordinates[0].y !== coordinates[1].y) {
      if (coordinates[0].y < coordinates[1].y) {
        coordinate = {
          x: coordinates[0].x,
          y: bounding.height
        };
      } else {
        coordinate = {
          x: coordinates[0].x,
          y: 0
        };
      }
    } else if (coordinates[0].x > coordinates[1].x) {
      coordinate = {
        x: 0,
        y: getLinearYFromCoordinates(coordinates[0], coordinates[1], { x: 0, y: coordinates[0].y })
      };
    } else {
      coordinate = {
        x: bounding.width,
        y: getLinearYFromCoordinates(coordinates[0], coordinates[1], { x: bounding.width, y: coordinates[0].y })
      };
    }
    return { coordinates: [coordinates[0], coordinate] };
  }
  return [];
}
var rayLine = {
  name: "rayLine",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates, bounding = _a2.bounding;
    return [
      {
        type: "line",
        attrs: getRayLine(coordinates, bounding)
      }
    ];
  }
};
var segment = {
  name: "segment",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates;
    if (coordinates.length === 2) {
      return [
        {
          type: "line",
          attrs: { coordinates }
        }
      ];
    }
    return [];
  }
};
var straightLine = {
  name: "straightLine",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates, bounding = _a2.bounding;
    if (coordinates.length === 2) {
      if (coordinates[0].x === coordinates[1].x) {
        return [
          {
            type: "line",
            attrs: {
              coordinates: [
                {
                  x: coordinates[0].x,
                  y: 0
                },
                {
                  x: coordinates[0].x,
                  y: bounding.height
                }
              ]
            }
          }
        ];
      }
      return [
        {
          type: "line",
          attrs: {
            coordinates: [
              {
                x: 0,
                y: getLinearYFromCoordinates(coordinates[0], coordinates[1], { x: 0, y: coordinates[0].y })
              },
              {
                x: bounding.width,
                y: getLinearYFromCoordinates(coordinates[0], coordinates[1], { x: bounding.width, y: coordinates[0].y })
              }
            ]
          }
        }
      ];
    }
    return [];
  }
};
var verticalRayLine = {
  name: "verticalRayLine",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates, bounding = _a2.bounding;
    if (coordinates.length === 2) {
      var coordinate = { x: coordinates[0].x, y: 0 };
      if (coordinates[0].y < coordinates[1].y) {
        coordinate.y = bounding.height;
      }
      return [
        {
          type: "line",
          attrs: { coordinates: [coordinates[0], coordinate] }
        }
      ];
    }
    return [];
  },
  performEventPressedMove: function(_a2) {
    var points = _a2.points, performPoint = _a2.performPoint;
    points[0].timestamp = performPoint.timestamp;
    points[0].dataIndex = performPoint.dataIndex;
    points[1].timestamp = performPoint.timestamp;
    points[1].dataIndex = performPoint.dataIndex;
  },
  performEventMoveForDrawing: function(_a2) {
    var currentStep = _a2.currentStep, points = _a2.points, performPoint = _a2.performPoint;
    if (currentStep === 2) {
      points[0].timestamp = performPoint.timestamp;
      points[0].dataIndex = performPoint.dataIndex;
    }
  }
};
var verticalSegment = {
  name: "verticalSegment",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates;
    if (coordinates.length === 2) {
      return [
        {
          type: "line",
          attrs: { coordinates }
        }
      ];
    }
    return [];
  },
  performEventPressedMove: function(_a2) {
    var points = _a2.points, performPoint = _a2.performPoint;
    points[0].timestamp = performPoint.timestamp;
    points[0].dataIndex = performPoint.dataIndex;
    points[1].timestamp = performPoint.timestamp;
    points[1].dataIndex = performPoint.dataIndex;
  },
  performEventMoveForDrawing: function(_a2) {
    var currentStep = _a2.currentStep, points = _a2.points, performPoint = _a2.performPoint;
    if (currentStep === 2) {
      points[0].timestamp = performPoint.timestamp;
      points[0].dataIndex = performPoint.dataIndex;
    }
  }
};
var verticalStraightLine = {
  name: "verticalStraightLine",
  totalStep: 2,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: function(_a2) {
    var coordinates = _a2.coordinates, bounding = _a2.bounding;
    return [
      {
        type: "line",
        attrs: {
          coordinates: [
            {
              x: coordinates[0].x,
              y: 0
            },
            {
              x: coordinates[0].x,
              y: bounding.height
            }
          ]
        }
      }
    ];
  }
};
var simpleAnnotation = {
  name: "simpleAnnotation",
  totalStep: 2,
  styles: {
    line: { style: LineType.Dashed }
  },
  createPointFigures: function(_a2) {
    var _b;
    var overlay = _a2.overlay, coordinates = _a2.coordinates;
    var text2;
    if (isValid(overlay.extendData)) {
      if (!isFunction(overlay.extendData)) {
        text2 = (_b = overlay.extendData) !== null && _b !== void 0 ? _b : "";
      } else {
        text2 = overlay.extendData(overlay);
      }
    }
    var startX = coordinates[0].x;
    var startY = coordinates[0].y - 6;
    var lineEndY = startY - 50;
    var arrowEndY = lineEndY - 5;
    return [
      {
        type: "line",
        attrs: { coordinates: [{ x: startX, y: startY }, { x: startX, y: lineEndY }] },
        ignoreEvent: true
      },
      {
        type: "polygon",
        attrs: { coordinates: [{ x: startX, y: lineEndY }, { x: startX - 4, y: arrowEndY }, { x: startX + 4, y: arrowEndY }] },
        ignoreEvent: true
      },
      {
        type: "text",
        attrs: { x: startX, y: arrowEndY, text: text2 !== null && text2 !== void 0 ? text2 : "", align: "center", baseline: "bottom" },
        ignoreEvent: true
      }
    ];
  }
};
var simpleTag = {
  name: "simpleTag",
  totalStep: 2,
  styles: {
    line: { style: LineType.Dashed }
  },
  createPointFigures: function(_a2) {
    var bounding = _a2.bounding, coordinates = _a2.coordinates;
    return {
      type: "line",
      attrs: {
        coordinates: [
          { x: 0, y: coordinates[0].y },
          { x: bounding.width, y: coordinates[0].y }
        ]
      },
      ignoreEvent: true
    };
  },
  createYAxisFigures: function(_a2) {
    var _b, _c2;
    var overlay = _a2.overlay, coordinates = _a2.coordinates, bounding = _a2.bounding, yAxis = _a2.yAxis, precision = _a2.precision;
    var isFromZero = (_b = yAxis === null || yAxis === void 0 ? void 0 : yAxis.isFromZero()) !== null && _b !== void 0 ? _b : false;
    var textAlign;
    var x;
    if (isFromZero) {
      textAlign = "left";
      x = 0;
    } else {
      textAlign = "right";
      x = bounding.width;
    }
    var text2;
    if (isValid(overlay.extendData)) {
      if (!isFunction(overlay.extendData)) {
        text2 = (_c2 = overlay.extendData) !== null && _c2 !== void 0 ? _c2 : "";
      } else {
        text2 = overlay.extendData(overlay);
      }
    }
    if (!isValid(text2) && isNumber(overlay.points[0].value)) {
      text2 = formatPrecision(overlay.points[0].value, precision.price);
    }
    return { type: "text", attrs: { x, y: coordinates[0].y, text: text2 !== null && text2 !== void 0 ? text2 : "", align: textAlign, baseline: "middle" } };
  }
};
var overlays = {};
var extensions$1 = [
  fibonacciLine,
  horizontalRayLine,
  horizontalSegment,
  horizontalStraightLine,
  parallelStraightLine,
  priceChannelLine,
  priceLine,
  rayLine,
  segment,
  straightLine,
  verticalRayLine,
  verticalSegment,
  verticalStraightLine,
  simpleAnnotation,
  simpleTag
];
extensions$1.forEach(function(template) {
  overlays[template.name] = OverlayImp.extend(template);
});
function registerOverlay(template) {
  overlays[template.name] = OverlayImp.extend(template);
}
function getOverlayInnerClass(name) {
  var _a2;
  return (_a2 = overlays[name]) !== null && _a2 !== void 0 ? _a2 : null;
}
var PANE_MIN_HEIGHT = 30;
var PANE_DEFAULT_HEIGHT = 100;
var PaneIdConstants = {
  CANDLE: "candle_pane",
  INDICATOR: "indicator_pane_",
  X_AXIS: "x_axis_pane"
};
var OverlayStore = (
  /** @class */
  function() {
    function OverlayStore2(chartStore) {
      this._instances = /* @__PURE__ */ new Map();
      this._progressInstanceInfo = null;
      this._pressedInstanceInfo = {
        paneId: "",
        instance: null,
        figureType: 0,
        figureKey: "",
        figureIndex: -1,
        attrsIndex: -1
      };
      this._hoverInstanceInfo = {
        paneId: "",
        instance: null,
        figureType: 0,
        figureKey: "",
        figureIndex: -1,
        attrsIndex: -1
      };
      this._clickInstanceInfo = {
        paneId: "",
        instance: null,
        figureType: 0,
        figureKey: "",
        figureIndex: -1,
        attrsIndex: -1
      };
      this._chartStore = chartStore;
    }
    OverlayStore2.prototype._overrideInstance = function(instance, overlay) {
      var id = overlay.id, groupId = overlay.groupId, points = overlay.points, styles2 = overlay.styles, lock = overlay.lock, visible = overlay.visible, zLevel = overlay.zLevel, mode = overlay.mode, modeSensitivity = overlay.modeSensitivity, extendData = overlay.extendData, onDrawStart = overlay.onDrawStart, onDrawing = overlay.onDrawing, onDrawEnd = overlay.onDrawEnd, onClick = overlay.onClick, onDoubleClick = overlay.onDoubleClick, onRightClick = overlay.onRightClick, onPressedMoveStart = overlay.onPressedMoveStart, onPressedMoving = overlay.onPressedMoving, onPressedMoveEnd = overlay.onPressedMoveEnd, onMouseEnter = overlay.onMouseEnter, onMouseLeave = overlay.onMouseLeave, onRemoved = overlay.onRemoved, onSelected = overlay.onSelected, onDeselected = overlay.onDeselected;
      var updateFlag = false;
      var sortFlag = false;
      if (isString(id)) {
        instance.setId(id);
      }
      if (isString(groupId)) {
        instance.setGroupId(groupId);
      }
      if (isArray(points) && instance.setPoints(points)) {
        updateFlag = true;
      }
      if (isValid(styles2) && instance.setStyles(styles2)) {
        updateFlag = true;
      }
      if (isBoolean(lock)) {
        instance.setLock(lock);
      }
      if (isBoolean(visible) && instance.setVisible(visible)) {
        updateFlag = true;
      }
      if (isNumber(zLevel) && instance.setZLevel(zLevel)) {
        updateFlag = true;
        sortFlag = true;
      }
      if (isValid(mode)) {
        instance.setMode(mode);
      }
      if (isNumber(modeSensitivity)) {
        instance.setModeSensitivity(modeSensitivity);
      }
      if (extendData !== void 0 && instance.setExtendData(extendData)) {
        updateFlag = true;
      }
      if (onDrawStart !== void 0) {
        instance.setOnDrawStartCallback(onDrawStart);
      }
      if (onDrawing !== void 0) {
        instance.setOnDrawingCallback(onDrawing);
      }
      if (onDrawEnd !== void 0) {
        instance.setOnDrawEndCallback(onDrawEnd);
      }
      if (onClick !== void 0) {
        instance.setOnClickCallback(onClick);
      }
      if (onDoubleClick !== void 0) {
        instance.setOnDoubleClickCallback(onDoubleClick);
      }
      if (onRightClick !== void 0) {
        instance.setOnRightClickCallback(onRightClick);
      }
      if (onPressedMoveStart !== void 0) {
        instance.setOnPressedMoveStartCallback(onPressedMoveStart);
      }
      if (onPressedMoving !== void 0) {
        instance.setOnPressedMovingCallback(onPressedMoving);
      }
      if (onPressedMoveEnd !== void 0) {
        instance.setOnPressedMoveEndCallback(onPressedMoveEnd);
      }
      if (onMouseEnter !== void 0) {
        instance.setOnMouseEnterCallback(onMouseEnter);
      }
      if (onMouseLeave !== void 0) {
        instance.setOnMouseLeaveCallback(onMouseLeave);
      }
      if (onRemoved !== void 0) {
        instance.setOnRemovedCallback(onRemoved);
      }
      if (onSelected !== void 0) {
        instance.setOnSelectedCallback(onSelected);
      }
      if (onDeselected !== void 0) {
        instance.setOnDeselectedCallback(onDeselected);
      }
      return [updateFlag, sortFlag];
    };
    OverlayStore2.prototype.getInstanceById = function(id) {
      var e_1, _a2;
      try {
        for (var _b = __values(this._instances), _c2 = _b.next(); !_c2.done; _c2 = _b.next()) {
          var entry = _c2.value;
          var paneShapes = entry[1];
          var overlay = paneShapes.find(function(s) {
            return s.id === id;
          });
          if (isValid(overlay)) {
            return overlay;
          }
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (_c2 && !_c2.done && (_a2 = _b.return)) _a2.call(_b);
        } finally {
          if (e_1) throw e_1.error;
        }
      }
      if (this._progressInstanceInfo !== null) {
        if (this._progressInstanceInfo.instance.id === id) {
          return this._progressInstanceInfo.instance;
        }
      }
      return null;
    };
    OverlayStore2.prototype._sort = function(paneId) {
      var _a2;
      if (isString(paneId)) {
        (_a2 = this._instances.get(paneId)) === null || _a2 === void 0 ? void 0 : _a2.sort(function(o12, o22) {
          return o12.zLevel - o22.zLevel;
        });
      } else {
        this._instances.forEach(function(paneInstances) {
          paneInstances.sort(function(o12, o22) {
            return o12.zLevel - o22.zLevel;
          });
        });
      }
    };
    OverlayStore2.prototype.addInstances = function(overlays2, paneId, appointPaneFlag) {
      var _this = this;
      var ids = overlays2.map(function(overlay) {
        var _a2, _b, _c2, _d;
        var id = (_a2 = overlay.id) !== null && _a2 !== void 0 ? _a2 : createId(OVERLAY_ID_PREFIX);
        if (_this.getInstanceById(id) === null) {
          var OverlayClazz = getOverlayInnerClass(overlay.name);
          if (OverlayClazz !== null) {
            var instance = new OverlayClazz();
            instance.setPaneId(paneId);
            var groupId = (_b = overlay.groupId) !== null && _b !== void 0 ? _b : id;
            overlay.id = id;
            overlay.groupId = groupId;
            _this._overrideInstance(instance, overlay);
            if (instance.isDrawing()) {
              _this._progressInstanceInfo = { paneId, instance, appointPaneFlag };
            } else {
              if (!_this._instances.has(paneId)) {
                _this._instances.set(paneId, []);
              }
              (_c2 = _this._instances.get(paneId)) === null || _c2 === void 0 ? void 0 : _c2.push(instance);
            }
            if (instance.isStart()) {
              (_d = instance.onDrawStart) === null || _d === void 0 ? void 0 : _d.call(instance, { overlay: instance });
            }
            return id;
          }
        }
        return null;
      });
      if (ids.some(function(id) {
        return id !== null;
      })) {
        this._sort();
        var chart = this._chartStore.getChart();
        chart.updatePane(1, paneId);
        chart.updatePane(1, PaneIdConstants.X_AXIS);
      }
      return ids;
    };
    OverlayStore2.prototype.getProgressInstanceInfo = function() {
      return this._progressInstanceInfo;
    };
    OverlayStore2.prototype.progressInstanceComplete = function() {
      var _a2;
      if (this._progressInstanceInfo !== null) {
        var _b = this._progressInstanceInfo, instance = _b.instance, paneId = _b.paneId;
        if (!instance.isDrawing()) {
          if (!this._instances.has(paneId)) {
            this._instances.set(paneId, []);
          }
          (_a2 = this._instances.get(paneId)) === null || _a2 === void 0 ? void 0 : _a2.push(instance);
          this._sort(paneId);
          this._progressInstanceInfo = null;
        }
      }
    };
    OverlayStore2.prototype.updateProgressInstanceInfo = function(paneId, appointPaneFlag) {
      if (this._progressInstanceInfo !== null) {
        if (isBoolean(appointPaneFlag) && appointPaneFlag) {
          this._progressInstanceInfo.appointPaneFlag = appointPaneFlag;
        }
        this._progressInstanceInfo.paneId = paneId;
        this._progressInstanceInfo.instance.setPaneId(paneId);
      }
    };
    OverlayStore2.prototype.getInstances = function(paneId) {
      var _a2;
      if (!isString(paneId)) {
        var instances_1 = [];
        this._instances.forEach(function(paneInstances) {
          instances_1 = instances_1.concat(paneInstances);
        });
        return instances_1;
      }
      return (_a2 = this._instances.get(paneId)) !== null && _a2 !== void 0 ? _a2 : [];
    };
    OverlayStore2.prototype.override = function(overlay) {
      var _this = this;
      var id = overlay.id, groupId = overlay.groupId, name = overlay.name;
      var updateFlag = false;
      var sortFlag = false;
      var setFlag = function(instance2) {
        var flags = _this._overrideInstance(instance2, overlay);
        if (flags[0]) {
          updateFlag = true;
        }
        if (flags[1]) {
          sortFlag = true;
        }
      };
      if (isString(id)) {
        var instance = this.getInstanceById(id);
        if (instance !== null) {
          setFlag(instance);
        }
      } else {
        var nameValid_1 = isString(name);
        var groupIdValid_1 = isString(groupId);
        this._instances.forEach(function(paneInstances) {
          paneInstances.forEach(function(instance2) {
            if (nameValid_1 && instance2.name === name || groupIdValid_1 && instance2.groupId === groupId || !nameValid_1 && !groupIdValid_1) {
              setFlag(instance2);
            }
          });
        });
        if (this._progressInstanceInfo !== null) {
          var progressInstance = this._progressInstanceInfo.instance;
          if (nameValid_1 && progressInstance.name === name || groupIdValid_1 && progressInstance.groupId === groupId || !nameValid_1 && !groupIdValid_1) {
            setFlag(progressInstance);
          }
        }
      }
      if (sortFlag) {
        this._sort();
      }
      if (updateFlag) {
        this._chartStore.getChart().updatePane(
          1
          /* UpdateLevel.Overlay */
        );
      }
    };
    OverlayStore2.prototype.removeInstance = function(overlayRemove) {
      var e_2, _a2;
      var _b;
      var match = function(remove, overlay) {
        if (isString(remove.id)) {
          if (overlay.id !== remove.id) {
            return false;
          }
        } else {
          if (isString(remove.groupId)) {
            if (overlay.groupId !== remove.groupId) {
              return false;
            }
          } else {
            if (isString(remove.name)) {
              if (overlay.name !== remove.name) {
                return false;
              }
            }
          }
        }
        return true;
      };
      var updatePaneIds = [];
      var overlayRemoveValid = isValid(overlayRemove);
      if (this._progressInstanceInfo !== null) {
        var instance = this._progressInstanceInfo.instance;
        if (!overlayRemoveValid || overlayRemoveValid && match(overlayRemove, instance)) {
          updatePaneIds.push(this._progressInstanceInfo.paneId);
          (_b = instance.onRemoved) === null || _b === void 0 ? void 0 : _b.call(instance, { overlay: instance });
          this._progressInstanceInfo = null;
        }
      }
      if (overlayRemoveValid) {
        var instances2 = /* @__PURE__ */ new Map();
        var _loop_1 = function(entry2) {
          var paneInstances = entry2[1];
          var newPaneInstances = paneInstances.filter(function(instance2) {
            var _a3;
            if (match(overlayRemove, instance2)) {
              if (!updatePaneIds.includes(entry2[0])) {
                updatePaneIds.push(entry2[0]);
              }
              (_a3 = instance2.onRemoved) === null || _a3 === void 0 ? void 0 : _a3.call(instance2, { overlay: instance2 });
              return false;
            }
            return true;
          });
          if (newPaneInstances.length > 0) {
            instances2.set(entry2[0], newPaneInstances);
          }
        };
        try {
          for (var _c2 = __values(this._instances), _d = _c2.next(); !_d.done; _d = _c2.next()) {
            var entry = _d.value;
            _loop_1(entry);
          }
        } catch (e_2_1) {
          e_2 = { error: e_2_1 };
        } finally {
          try {
            if (_d && !_d.done && (_a2 = _c2.return)) _a2.call(_c2);
          } finally {
            if (e_2) throw e_2.error;
          }
        }
        this._instances = instances2;
      } else {
        this._instances.forEach(function(paneInstances, paneId) {
          updatePaneIds.push(paneId);
          paneInstances.forEach(function(instance2) {
            var _a3;
            (_a3 = instance2.onRemoved) === null || _a3 === void 0 ? void 0 : _a3.call(instance2, { overlay: instance2 });
          });
        });
        this._instances.clear();
      }
      if (updatePaneIds.length > 0) {
        var chart_1 = this._chartStore.getChart();
        updatePaneIds.forEach(function(paneId) {
          chart_1.updatePane(1, paneId);
        });
        chart_1.updatePane(1, PaneIdConstants.X_AXIS);
      }
    };
    OverlayStore2.prototype.setPressedInstanceInfo = function(info) {
      this._pressedInstanceInfo = info;
    };
    OverlayStore2.prototype.getPressedInstanceInfo = function() {
      return this._pressedInstanceInfo;
    };
    OverlayStore2.prototype.updatePointPosition = function(dataChangeLength, type) {
      if (dataChangeLength > 0) {
        var dataList_1 = this._chartStore.getDataList();
        this._instances.forEach(function(overlays2) {
          overlays2.forEach(function(o) {
            var points = o.points;
            points.forEach(function(point) {
              if (!isValid(point.timestamp) && isValid(point.dataIndex)) {
                if (type === LoadDataType.Forward) {
                  point.dataIndex = point.dataIndex + dataChangeLength;
                }
                var data = dataList_1[point.dataIndex];
                point.timestamp = data === null || data === void 0 ? void 0 : data.timestamp;
              }
            });
          });
        });
      }
    };
    OverlayStore2.prototype.setHoverInstanceInfo = function(info, event) {
      var _a2, _b;
      var _c2 = this._hoverInstanceInfo, instance = _c2.instance, figureType = _c2.figureType, figureKey = _c2.figureKey, figureIndex = _c2.figureIndex;
      if ((instance === null || instance === void 0 ? void 0 : instance.id) !== ((_a2 = info.instance) === null || _a2 === void 0 ? void 0 : _a2.id) || figureType !== info.figureType || figureIndex !== info.figureIndex) {
        this._hoverInstanceInfo = info;
        if ((instance === null || instance === void 0 ? void 0 : instance.id) !== ((_b = info.instance) === null || _b === void 0 ? void 0 : _b.id)) {
          var ignoreUpdateFlag = false;
          var sortFlag = false;
          if (instance !== null) {
            sortFlag = true;
            if (isFunction(instance.onMouseLeave)) {
              instance.onMouseLeave(__assign({ overlay: instance, figureKey, figureIndex }, event));
              ignoreUpdateFlag = true;
            }
          }
          if (info.instance !== null) {
            sortFlag = true;
            if (isFunction(info.instance.onMouseEnter)) {
              info.instance.onMouseEnter(__assign({ overlay: info.instance, figureKey: info.figureKey, figureIndex: info.figureIndex }, event));
              ignoreUpdateFlag = true;
            }
          }
          if (sortFlag) {
            this._sort();
          }
          if (!ignoreUpdateFlag) {
            this._chartStore.getChart().updatePane(
              1
              /* UpdateLevel.Overlay */
            );
          }
        }
      }
    };
    OverlayStore2.prototype.getHoverInstanceInfo = function() {
      return this._hoverInstanceInfo;
    };
    OverlayStore2.prototype.setClickInstanceInfo = function(info, event) {
      var _a2, _b, _c2, _d, _e2, _f, _g, _h, _j;
      var _k = this._clickInstanceInfo, paneId = _k.paneId, instance = _k.instance, figureType = _k.figureType, figureKey = _k.figureKey, figureIndex = _k.figureIndex;
      if (!((_b = (_a2 = info.instance) === null || _a2 === void 0 ? void 0 : _a2.isDrawing()) !== null && _b !== void 0 ? _b : false)) {
        (_d = (_c2 = info.instance) === null || _c2 === void 0 ? void 0 : _c2.onClick) === null || _d === void 0 ? void 0 : _d.call(_c2, __assign({ overlay: info.instance, figureKey: info.figureKey, figureIndex: info.figureIndex }, event));
      }
      if ((instance === null || instance === void 0 ? void 0 : instance.id) !== ((_e2 = info.instance) === null || _e2 === void 0 ? void 0 : _e2.id) || figureType !== info.figureType || figureIndex !== info.figureIndex) {
        this._clickInstanceInfo = info;
        if ((instance === null || instance === void 0 ? void 0 : instance.id) !== ((_f = info.instance) === null || _f === void 0 ? void 0 : _f.id)) {
          (_g = instance === null || instance === void 0 ? void 0 : instance.onDeselected) === null || _g === void 0 ? void 0 : _g.call(instance, __assign({ overlay: instance, figureKey, figureIndex }, event));
          (_j = (_h = info.instance) === null || _h === void 0 ? void 0 : _h.onSelected) === null || _j === void 0 ? void 0 : _j.call(_h, __assign({ overlay: info.instance, figureKey: info.figureKey, figureIndex: info.figureIndex }, event));
          var chart = this._chartStore.getChart();
          chart.updatePane(1, info.paneId);
          if (paneId !== info.paneId) {
            chart.updatePane(1, paneId);
          }
          chart.updatePane(1, PaneIdConstants.X_AXIS);
        }
      }
    };
    OverlayStore2.prototype.getClickInstanceInfo = function() {
      return this._clickInstanceInfo;
    };
    OverlayStore2.prototype.isEmpty = function() {
      return this._instances.size === 0 && this._progressInstanceInfo === null;
    };
    OverlayStore2.prototype.isDrawing = function() {
      var _a2, _b;
      return this._progressInstanceInfo !== null && ((_b = (_a2 = this._progressInstanceInfo) === null || _a2 === void 0 ? void 0 : _a2.instance.isDrawing()) !== null && _b !== void 0 ? _b : false);
    };
    return OverlayStore2;
  }()
);
var ActionStore = (
  /** @class */
  function() {
    function ActionStore2() {
      this._actions = /* @__PURE__ */ new Map();
    }
    ActionStore2.prototype.execute = function(type, data) {
      var _a2;
      (_a2 = this._actions.get(type)) === null || _a2 === void 0 ? void 0 : _a2.execute(data);
    };
    ActionStore2.prototype.subscribe = function(type, callback) {
      var _a2;
      if (!this._actions.has(type)) {
        this._actions.set(type, new Delegate());
      }
      (_a2 = this._actions.get(type)) === null || _a2 === void 0 ? void 0 : _a2.subscribe(callback);
    };
    ActionStore2.prototype.unsubscribe = function(type, callback) {
      var action = this._actions.get(type);
      if (isValid(action)) {
        action.unsubscribe(callback);
        if (action.isEmpty()) {
          this._actions.delete(type);
        }
      }
    };
    ActionStore2.prototype.has = function(type) {
      var action = this._actions.get(type);
      return isValid(action) && !action.isEmpty();
    };
    return ActionStore2;
  }()
);
var light = {
  grid: {
    horizontal: {
      color: "#EDEDED"
    },
    vertical: {
      color: "#EDEDED"
    }
  },
  candle: {
    priceMark: {
      high: {
        color: "#76808F"
      },
      low: {
        color: "#76808F"
      }
    },
    tooltip: {
      rect: {
        color: "#FEFEFE",
        borderColor: "#F2F3F5"
      },
      text: {
        color: "#76808F"
      }
    }
  },
  indicator: {
    tooltip: {
      text: {
        color: "#76808F"
      }
    }
  },
  xAxis: {
    axisLine: {
      color: "#DDDDDD"
    },
    tickText: {
      color: "#76808F"
    },
    tickLine: {
      color: "#DDDDDD"
    }
  },
  yAxis: {
    axisLine: {
      color: "#DDDDDD"
    },
    tickText: {
      color: "#76808F"
    },
    tickLine: {
      color: "#DDDDDD"
    }
  },
  separator: {
    color: "#DDDDDD"
  },
  crosshair: {
    horizontal: {
      line: {
        color: "#76808F"
      },
      text: {
        borderColor: "#686D76",
        backgroundColor: "#686D76"
      }
    },
    vertical: {
      line: {
        color: "#76808F"
      },
      text: {
        borderColor: "#686D76",
        backgroundColor: "#686D76"
      }
    }
  }
};
var dark = {
  grid: {
    horizontal: {
      color: "#292929"
    },
    vertical: {
      color: "#292929"
    }
  },
  candle: {
    priceMark: {
      high: {
        color: "#929AA5"
      },
      low: {
        color: "#929AA5"
      }
    },
    tooltip: {
      rect: {
        color: "rgba(10, 10, 10, .6)",
        borderColor: "rgba(10, 10, 10, .6)"
      },
      text: {
        color: "#929AA5"
      }
    }
  },
  indicator: {
    tooltip: {
      text: {
        color: "#929AA5"
      }
    }
  },
  xAxis: {
    axisLine: {
      color: "#333333"
    },
    tickText: {
      color: "#929AA5"
    },
    tickLine: {
      color: "#333333"
    }
  },
  yAxis: {
    axisLine: {
      color: "#333333"
    },
    tickText: {
      color: "#929AA5"
    },
    tickLine: {
      color: "#333333"
    }
  },
  separator: {
    color: "#333333"
  },
  crosshair: {
    horizontal: {
      line: {
        color: "#929AA5"
      },
      text: {
        borderColor: "#373a40",
        backgroundColor: "#373a40"
      }
    },
    vertical: {
      line: {
        color: "#929AA5"
      },
      text: {
        borderColor: "#373a40",
        backgroundColor: "#373a40"
      }
    }
  }
};
var styles = {
  light,
  dark
};
function getStyles(name) {
  var _a2;
  return (_a2 = styles[name]) !== null && _a2 !== void 0 ? _a2 : null;
}
var ChartStore = (
  /** @class */
  function() {
    function ChartStore2(chart, options) {
      this._styles = getDefaultStyles();
      this._customApi = getDefaultCustomApi();
      this._locale = defaultLocale;
      this._precision = { price: 2, volume: 0 };
      this._thousandsSeparator = ",";
      this._decimalFoldThreshold = 3;
      this._dataList = [];
      this._loadMoreCallback = null;
      this._loadDataCallback = null;
      this._loading = true;
      this._forwardMore = true;
      this._backwardMore = true;
      this._timeScaleStore = new TimeScaleStore(this);
      this._indicatorStore = new IndicatorStore(this);
      this._overlayStore = new OverlayStore(this);
      this._tooltipStore = new TooltipStore(this);
      this._actionStore = new ActionStore();
      this._visibleDataList = [];
      this._chart = chart;
      this.setOptions(options);
    }
    ChartStore2.prototype.adjustVisibleDataList = function() {
      this._visibleDataList = [];
      var _a2 = this._timeScaleStore.getVisibleRange(), realFrom = _a2.realFrom, realTo = _a2.realTo;
      for (var i = realFrom; i < realTo; i++) {
        var kLineData = this._dataList[i];
        var x = this._timeScaleStore.dataIndexToCoordinate(i);
        this._visibleDataList.push({
          dataIndex: i,
          x,
          data: kLineData
        });
      }
    };
    ChartStore2.prototype.setOptions = function(options) {
      var _a2, _b, _c2, _d;
      if (isValid(options)) {
        var locale = options.locale, timezone = options.timezone, styles2 = options.styles, customApi = options.customApi, thousandsSeparator = options.thousandsSeparator, decimalFoldThreshold = options.decimalFoldThreshold;
        if (isString(locale)) {
          this._locale = locale;
        }
        if (isString(timezone)) {
          this._timeScaleStore.setTimezone(timezone);
        }
        if (isValid(styles2)) {
          var ss2 = null;
          if (isString(styles2)) {
            ss2 = getStyles(styles2);
          } else {
            ss2 = styles2;
          }
          merge(this._styles, ss2);
          if (isArray((_b = (_a2 = ss2 === null || ss2 === void 0 ? void 0 : ss2.candle) === null || _a2 === void 0 ? void 0 : _a2.tooltip) === null || _b === void 0 ? void 0 : _b.custom)) {
            this._styles.candle.tooltip.custom = (_d = (_c2 = ss2 === null || ss2 === void 0 ? void 0 : ss2.candle) === null || _c2 === void 0 ? void 0 : _c2.tooltip) === null || _d === void 0 ? void 0 : _d.custom;
          }
        }
        if (isValid(customApi)) {
          merge(this._customApi, customApi);
        }
        if (isString(thousandsSeparator)) {
          this._thousandsSeparator = thousandsSeparator;
        }
        if (isNumber(decimalFoldThreshold) && decimalFoldThreshold > 0) {
          this._decimalFoldThreshold = decimalFoldThreshold;
        }
      }
      return this;
    };
    ChartStore2.prototype.getStyles = function() {
      return this._styles;
    };
    ChartStore2.prototype.getLocale = function() {
      return this._locale;
    };
    ChartStore2.prototype.getCustomApi = function() {
      return this._customApi;
    };
    ChartStore2.prototype.getThousandsSeparator = function() {
      return this._thousandsSeparator;
    };
    ChartStore2.prototype.getDecimalFoldThreshold = function() {
      return this._decimalFoldThreshold;
    };
    ChartStore2.prototype.getPrecision = function() {
      return this._precision;
    };
    ChartStore2.prototype.setPrecision = function(precision) {
      this._precision = precision;
      this._indicatorStore.synchronizeSeriesPrecision();
      return this;
    };
    ChartStore2.prototype.getDataList = function() {
      return this._dataList;
    };
    ChartStore2.prototype.getVisibleFirstData = function() {
      var _a2;
      var from = this._timeScaleStore.getVisibleRange().from;
      return (_a2 = this._dataList[from]) !== null && _a2 !== void 0 ? _a2 : null;
    };
    ChartStore2.prototype.getVisibleDataList = function() {
      return this._visibleDataList;
    };
    ChartStore2.prototype.addData = function(data, type, more) {
      return __awaiter(this, void 0, void 0, function() {
        var success, adjustFlag, dataLengthChange, dataCount, timestamp, lastDataTimestamp, lastBarRightSideDiffBarCount;
        return __generator(this, function(_b) {
          switch (_b.label) {
            case 0:
              success = false;
              adjustFlag = false;
              dataLengthChange = 0;
              if (isArray(data)) {
                dataLengthChange = data.length;
                switch (type) {
                  case LoadDataType.Init: {
                    this.clear();
                    this._dataList = data;
                    this._forwardMore = more !== null && more !== void 0 ? more : true;
                    this._timeScaleStore.resetOffsetRightDistance();
                    adjustFlag = true;
                    break;
                  }
                  case LoadDataType.Backward: {
                    this._dataList = this._dataList.concat(data);
                    this._backwardMore = more !== null && more !== void 0 ? more : false;
                    adjustFlag = dataLengthChange > 0;
                    break;
                  }
                  case LoadDataType.Forward: {
                    this._dataList = data.concat(this._dataList);
                    this._forwardMore = more !== null && more !== void 0 ? more : false;
                    adjustFlag = dataLengthChange > 0;
                  }
                }
                this._loading = false;
                success = true;
              } else {
                dataCount = this._dataList.length;
                timestamp = data.timestamp;
                lastDataTimestamp = formatValue(this._dataList[dataCount - 1], "timestamp", 0);
                if (timestamp > lastDataTimestamp) {
                  this._dataList.push(data);
                  lastBarRightSideDiffBarCount = this._timeScaleStore.getLastBarRightSideDiffBarCount();
                  if (lastBarRightSideDiffBarCount < 0) {
                    this._timeScaleStore.setLastBarRightSideDiffBarCount(--lastBarRightSideDiffBarCount);
                  }
                  dataLengthChange = 1;
                  success = true;
                  adjustFlag = true;
                } else if (timestamp === lastDataTimestamp) {
                  this._dataList[dataCount - 1] = data;
                  success = true;
                  adjustFlag = true;
                }
              }
              if (!success) return [3, 5];
              _b.label = 1;
            case 1:
              _b.trys.push([1, 4, , 5]);
              this._overlayStore.updatePointPosition(dataLengthChange, type);
              if (!adjustFlag) return [3, 3];
              this._timeScaleStore.adjustVisibleRange();
              this._tooltipStore.recalculateCrosshair(true);
              return [4, this._indicatorStore.calcInstance()];
            case 2:
              _b.sent();
              this._chart.adjustPaneViewport(false, true, true, true);
              _b.label = 3;
            case 3:
              this._actionStore.execute(ActionType.OnDataReady);
              return [3, 5];
            case 4:
              _b.sent();
              return [3, 5];
            case 5:
              return [
                2
                /*return*/
              ];
          }
        });
      });
    };
    ChartStore2.prototype.setLoadMoreCallback = function(callback) {
      this._loadMoreCallback = callback;
    };
    ChartStore2.prototype.executeLoadMoreCallback = function(timestamp) {
      if (this._forwardMore && !this._loading && isValid(this._loadMoreCallback)) {
        this._loading = true;
        this._loadMoreCallback(timestamp);
      }
    };
    ChartStore2.prototype.setLoadDataCallback = function(callback) {
      this._loadDataCallback = callback;
    };
    ChartStore2.prototype.executeLoadDataCallback = function(params) {
      var _this = this;
      if (!this._loading && isValid(this._loadDataCallback) && (this._forwardMore && params.type === LoadDataType.Forward || this._backwardMore && params.type === LoadDataType.Backward)) {
        var cb = function(data, more) {
          _this.addData(data, params.type, more).then(function() {
          }).catch(function() {
          });
        };
        this._loading = true;
        this._loadDataCallback(__assign(__assign({}, params), { callback: cb }));
      }
    };
    ChartStore2.prototype.clear = function() {
      this._forwardMore = true;
      this._backwardMore = true;
      this._loading = true;
      this._dataList = [];
      this._visibleDataList = [];
      this._timeScaleStore.clear();
      this._tooltipStore.clear();
    };
    ChartStore2.prototype.getTimeScaleStore = function() {
      return this._timeScaleStore;
    };
    ChartStore2.prototype.getIndicatorStore = function() {
      return this._indicatorStore;
    };
    ChartStore2.prototype.getOverlayStore = function() {
      return this._overlayStore;
    };
    ChartStore2.prototype.getTooltipStore = function() {
      return this._tooltipStore;
    };
    ChartStore2.prototype.getActionStore = function() {
      return this._actionStore;
    };
    ChartStore2.prototype.getChart = function() {
      return this._chart;
    };
    return ChartStore2;
  }()
);
var WidgetNameConstants = {
  MAIN: "main",
  X_AXIS: "xAxis",
  Y_AXIS: "yAxis",
  SEPARATOR: "separator"
};
var REAL_SEPARATOR_HEIGHT = 7;
function isSupportedDevicePixelContentBox() {
  return __awaiter(this, void 0, void 0, function() {
    return __generator(this, function(_a2) {
      switch (_a2.label) {
        case 0:
          return [4, new Promise(function(resolve) {
            var ro2 = new ResizeObserver(function(entries) {
              resolve(entries.every(function(entry) {
                return "devicePixelContentBoxSize" in entry;
              }));
              ro2.disconnect();
            });
            ro2.observe(document.body, { box: "device-pixel-content-box" });
          }).catch(function() {
            return false;
          })];
        case 1:
          return [2, _a2.sent()];
      }
    });
  });
}
var Canvas = (
  /** @class */
  function() {
    function Canvas2(style, listener) {
      var _this = this;
      this._supportedDevicePixelContentBox = false;
      this._width = 0;
      this._height = 0;
      this._pixelWidth = 0;
      this._pixelHeight = 0;
      this._nextPixelWidth = 0;
      this._nextPixelHeight = 0;
      this._requestAnimationId = DEFAULT_REQUEST_ID;
      this._mediaQueryListener = function() {
        var pixelRatio = getPixelRatio(_this._element);
        _this._nextPixelWidth = Math.round(_this._element.clientWidth * pixelRatio);
        _this._nextPixelHeight = Math.round(_this._element.clientHeight * pixelRatio);
        _this._resetPixelRatio();
      };
      this._listener = listener;
      this._element = createDom("canvas", style);
      this._ctx = this._element.getContext("2d", { willReadFrequently: true });
      isSupportedDevicePixelContentBox().then(function(result) {
        _this._supportedDevicePixelContentBox = result;
        if (result) {
          _this._resizeObserver = new ResizeObserver(function(entries) {
            var _a2;
            var entry = entries.find(function(entry2) {
              return entry2.target === _this._element;
            });
            var size = (_a2 = entry === null || entry === void 0 ? void 0 : entry.devicePixelContentBoxSize) === null || _a2 === void 0 ? void 0 : _a2[0];
            if (isValid(size)) {
              _this._nextPixelWidth = size.inlineSize;
              _this._nextPixelHeight = size.blockSize;
              if (_this._pixelWidth !== _this._nextPixelWidth || _this._pixelHeight !== _this._nextPixelHeight) {
                _this._resetPixelRatio();
              }
            }
          });
          _this._resizeObserver.observe(_this._element, { box: "device-pixel-content-box" });
        } else {
          _this._mediaQueryList = window.matchMedia("(resolution: ".concat(getPixelRatio(_this._element), "dppx)"));
          _this._mediaQueryList.addListener(_this._mediaQueryListener);
        }
      }).catch(function(_) {
        return false;
      });
    }
    Canvas2.prototype._resetPixelRatio = function() {
      var _this = this;
      this._executeListener(function() {
        var width = _this._element.clientWidth;
        var height = _this._element.clientHeight;
        var horizontalPixelRatio = _this._nextPixelWidth / width;
        var verticalPixelRatio = _this._nextPixelHeight / height;
        _this._width = width;
        _this._height = height;
        _this._pixelWidth = _this._nextPixelWidth;
        _this._pixelHeight = _this._nextPixelHeight;
        _this._element.width = _this._nextPixelWidth;
        _this._element.height = _this._nextPixelHeight;
        _this._ctx.scale(horizontalPixelRatio, verticalPixelRatio);
      });
    };
    Canvas2.prototype._executeListener = function(fn2) {
      var _this = this;
      if (this._requestAnimationId === DEFAULT_REQUEST_ID) {
        this._requestAnimationId = requestAnimationFrame(function() {
          _this._ctx.clearRect(0, 0, _this._width, _this._height);
          fn2 === null || fn2 === void 0 ? void 0 : fn2();
          _this._listener();
          _this._requestAnimationId = DEFAULT_REQUEST_ID;
        });
      }
    };
    Canvas2.prototype.update = function(w, h) {
      if (this._width !== w || this._height !== h) {
        this._element.style.width = "".concat(w, "px");
        this._element.style.height = "".concat(h, "px");
        if (!this._supportedDevicePixelContentBox) {
          var pixelRatio = getPixelRatio(this._element);
          this._nextPixelWidth = Math.round(w * pixelRatio);
          this._nextPixelHeight = Math.round(h * pixelRatio);
          this._resetPixelRatio();
        }
      } else {
        this._executeListener();
      }
    };
    Canvas2.prototype.getElement = function() {
      return this._element;
    };
    Canvas2.prototype.getContext = function() {
      return this._ctx;
    };
    Canvas2.prototype.destroy = function() {
      if (isValid(this._resizeObserver)) {
        this._resizeObserver.unobserve(this._element);
      }
      if (isValid(this._mediaQueryList)) {
        this._mediaQueryList.removeListener(this._mediaQueryListener);
      }
    };
    return Canvas2;
  }()
);
function createDefaultBounding(bounding) {
  var defaultBounding = {
    width: 0,
    height: 0,
    left: 0,
    right: 0,
    top: 0,
    bottom: 0
  };
  if (isValid(bounding)) {
    merge(defaultBounding, bounding);
  }
  return defaultBounding;
}
var Widget = (
  /** @class */
  function(_super) {
    __extends(Widget2, _super);
    function Widget2(rootContainer, pane) {
      var _this = _super.call(this) || this;
      _this._bounding = createDefaultBounding();
      _this._pane = pane;
      _this._rootContainer = rootContainer;
      _this._container = _this.createContainer();
      rootContainer.appendChild(_this._container);
      return _this;
    }
    Widget2.prototype.setBounding = function(bounding) {
      merge(this._bounding, bounding);
      return this;
    };
    Widget2.prototype.getContainer = function() {
      return this._container;
    };
    Widget2.prototype.getBounding = function() {
      return this._bounding;
    };
    Widget2.prototype.getPane = function() {
      return this._pane;
    };
    Widget2.prototype.update = function(level) {
      this.updateImp(
        this._container,
        this._bounding,
        level !== null && level !== void 0 ? level : 3
        /* UpdateLevel.Drawer */
      );
    };
    Widget2.prototype.destroy = function() {
      this._rootContainer.removeChild(this._container);
    };
    return Widget2;
  }(Eventful)
);
var DrawWidget = (
  /** @class */
  function(_super) {
    __extends(DrawWidget2, _super);
    function DrawWidget2(rootContainer, pane) {
      var _this = _super.call(this, rootContainer, pane) || this;
      _this._mainCanvas = new Canvas({
        position: "absolute",
        top: "0",
        left: "0",
        zIndex: "2",
        boxSizing: "border-box"
      }, function() {
        _this.updateMain(_this._mainCanvas.getContext());
      });
      _this._overlayCanvas = new Canvas({
        position: "absolute",
        top: "0",
        left: "0",
        zIndex: "2",
        boxSizing: "border-box"
      }, function() {
        _this.updateOverlay(_this._overlayCanvas.getContext());
      });
      var container = _this.getContainer();
      container.appendChild(_this._mainCanvas.getElement());
      container.appendChild(_this._overlayCanvas.getElement());
      return _this;
    }
    DrawWidget2.prototype.createContainer = function() {
      return createDom("div", {
        margin: "0",
        padding: "0",
        position: "absolute",
        top: "0",
        overflow: "hidden",
        boxSizing: "border-box",
        zIndex: "1"
      });
    };
    DrawWidget2.prototype.updateImp = function(container, bounding, level) {
      var width = bounding.width, height = bounding.height, left = bounding.left;
      container.style.left = "".concat(left, "px");
      var l10 = level;
      var w = container.clientWidth;
      var h = container.clientHeight;
      if (width !== w || height !== h) {
        container.style.width = "".concat(width, "px");
        container.style.height = "".concat(height, "px");
        l10 = 3;
      }
      switch (l10) {
        case 0: {
          this._mainCanvas.update(width, height);
          break;
        }
        case 1: {
          this._overlayCanvas.update(width, height);
          break;
        }
        case 3:
        case 4: {
          this._mainCanvas.update(width, height);
          this._overlayCanvas.update(width, height);
          break;
        }
      }
    };
    DrawWidget2.prototype.destroy = function() {
      this._mainCanvas.destroy();
      this._overlayCanvas.destroy();
    };
    DrawWidget2.prototype.getImage = function(includeOverlay) {
      var _a2 = this.getBounding(), width = _a2.width, height = _a2.height;
      var canvas = createDom("canvas", {
        width: "".concat(width, "px"),
        height: "".concat(height, "px"),
        boxSizing: "border-box"
      });
      var ctx = canvas.getContext("2d");
      var pixelRatio = getPixelRatio(canvas);
      canvas.width = width * pixelRatio;
      canvas.height = height * pixelRatio;
      ctx.scale(pixelRatio, pixelRatio);
      ctx.drawImage(this._mainCanvas.getElement(), 0, 0, width, height);
      if (includeOverlay) {
        ctx.drawImage(this._overlayCanvas.getElement(), 0, 0, width, height);
      }
      return canvas;
    };
    return DrawWidget2;
  }(Widget)
);
function isTransparent(color) {
  return color === "transparent" || color === "none" || /^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(color) || /^[hH][Ss][Ll][Aa]\(([\s]*(360｜3[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(color);
}
function checkCoordinateOnCircle(coordinate, attrs) {
  var circles = [];
  circles = circles.concat(attrs);
  for (var i = 0; i < circles.length; i++) {
    var _a2 = circles[i], x = _a2.x, y = _a2.y, r = _a2.r;
    var difX = coordinate.x - x;
    var difY = coordinate.y - y;
    if (!(difX * difX + difY * difY > r * r)) {
      return true;
    }
  }
  return false;
}
function drawCircle(ctx, attrs, styles2) {
  var circles = [];
  circles = circles.concat(attrs);
  var _a2 = styles2.style, style = _a2 === void 0 ? PolygonType.Fill : _a2, _b = styles2.color, color = _b === void 0 ? "currentColor" : _b, _c2 = styles2.borderSize, borderSize = _c2 === void 0 ? 1 : _c2, _d = styles2.borderColor, borderColor = _d === void 0 ? "currentColor" : _d, _e2 = styles2.borderStyle, borderStyle = _e2 === void 0 ? LineType.Solid : _e2, _f = styles2.borderDashedValue, borderDashedValue = _f === void 0 ? [2, 2] : _f;
  var solid = (style === PolygonType.Fill || styles2.style === PolygonType.StrokeFill) && (!isString(color) || !isTransparent(color));
  if (solid) {
    ctx.fillStyle = color;
    circles.forEach(function(_a3) {
      var x = _a3.x, y = _a3.y, r = _a3.r;
      ctx.beginPath();
      ctx.arc(x, y, r, 0, Math.PI * 2);
      ctx.closePath();
      ctx.fill();
    });
  }
  if ((style === PolygonType.Stroke || styles2.style === PolygonType.StrokeFill) && borderSize > 0 && !isTransparent(borderColor)) {
    ctx.strokeStyle = borderColor;
    ctx.lineWidth = borderSize;
    if (borderStyle === LineType.Dashed) {
      ctx.setLineDash(borderDashedValue);
    } else {
      ctx.setLineDash([]);
    }
    circles.forEach(function(_a3) {
      var x = _a3.x, y = _a3.y, r = _a3.r;
      if (!solid || r > borderSize) {
        ctx.beginPath();
        ctx.arc(x, y, r, 0, Math.PI * 2);
        ctx.closePath();
        ctx.stroke();
      }
    });
  }
}
var circle = {
  name: "circle",
  checkEventOn: checkCoordinateOnCircle,
  draw: function(ctx, attrs, styles2) {
    drawCircle(ctx, attrs, styles2);
  }
};
function checkCoordinateOnPolygon(coordinate, attrs) {
  var polygons = [];
  polygons = polygons.concat(attrs);
  for (var i = 0; i < polygons.length; i++) {
    var on2 = false;
    var coordinates = polygons[i].coordinates;
    for (var i_1 = 0, j = coordinates.length - 1; i_1 < coordinates.length; j = i_1++) {
      if (coordinates[i_1].y > coordinate.y !== coordinates[j].y > coordinate.y && coordinate.x < (coordinates[j].x - coordinates[i_1].x) * (coordinate.y - coordinates[i_1].y) / (coordinates[j].y - coordinates[i_1].y) + coordinates[i_1].x) {
        on2 = !on2;
      }
    }
    if (on2) {
      return true;
    }
  }
  return false;
}
function drawPolygon(ctx, attrs, styles2) {
  var polygons = [];
  polygons = polygons.concat(attrs);
  var _a2 = styles2.style, style = _a2 === void 0 ? PolygonType.Fill : _a2, _b = styles2.color, color = _b === void 0 ? "currentColor" : _b, _c2 = styles2.borderSize, borderSize = _c2 === void 0 ? 1 : _c2, _d = styles2.borderColor, borderColor = _d === void 0 ? "currentColor" : _d, _e2 = styles2.borderStyle, borderStyle = _e2 === void 0 ? LineType.Solid : _e2, _f = styles2.borderDashedValue, borderDashedValue = _f === void 0 ? [2, 2] : _f;
  if ((style === PolygonType.Fill || styles2.style === PolygonType.StrokeFill) && (!isString(color) || !isTransparent(color))) {
    ctx.fillStyle = color;
    polygons.forEach(function(_a3) {
      var coordinates = _a3.coordinates;
      ctx.beginPath();
      ctx.moveTo(coordinates[0].x, coordinates[0].y);
      for (var i = 1; i < coordinates.length; i++) {
        ctx.lineTo(coordinates[i].x, coordinates[i].y);
      }
      ctx.closePath();
      ctx.fill();
    });
  }
  if ((style === PolygonType.Stroke || styles2.style === PolygonType.StrokeFill) && borderSize > 0 && !isTransparent(borderColor)) {
    ctx.strokeStyle = borderColor;
    ctx.lineWidth = borderSize;
    if (borderStyle === LineType.Dashed) {
      ctx.setLineDash(borderDashedValue);
    } else {
      ctx.setLineDash([]);
    }
    polygons.forEach(function(_a3) {
      var coordinates = _a3.coordinates;
      ctx.beginPath();
      ctx.moveTo(coordinates[0].x, coordinates[0].y);
      for (var i = 1; i < coordinates.length; i++) {
        ctx.lineTo(coordinates[i].x, coordinates[i].y);
      }
      ctx.closePath();
      ctx.stroke();
    });
  }
}
var polygon = {
  name: "polygon",
  checkEventOn: checkCoordinateOnPolygon,
  draw: function(ctx, attrs, styles2) {
    drawPolygon(ctx, attrs, styles2);
  }
};
function checkCoordinateOnRect(coordinate, attrs) {
  var rects = [];
  rects = rects.concat(attrs);
  for (var i = 0; i < rects.length; i++) {
    var rect_1 = rects[i];
    var x = rect_1.x;
    var width = rect_1.width;
    if (width < DEVIATION * 2) {
      x -= DEVIATION;
      width = DEVIATION * 2;
    }
    var y = rect_1.y;
    var height = rect_1.height;
    if (height < DEVIATION * 2) {
      y -= DEVIATION;
      height = DEVIATION * 2;
    }
    if (coordinate.x >= x && coordinate.x <= x + width && coordinate.y >= y && coordinate.y <= y + height) {
      return true;
    }
  }
  return false;
}
function drawRect(ctx, attrs, styles2) {
  var _a2;
  var rects = [];
  rects = rects.concat(attrs);
  var _b = styles2.style, style = _b === void 0 ? PolygonType.Fill : _b, _c2 = styles2.color, color = _c2 === void 0 ? "transparent" : _c2, _d = styles2.borderSize, borderSize = _d === void 0 ? 1 : _d, _e2 = styles2.borderColor, borderColor = _e2 === void 0 ? "transparent" : _e2, _f = styles2.borderStyle, borderStyle = _f === void 0 ? LineType.Solid : _f, _g = styles2.borderRadius, r = _g === void 0 ? 0 : _g, _h = styles2.borderDashedValue, borderDashedValue = _h === void 0 ? [2, 2] : _h;
  var draw = (_a2 = ctx.roundRect) !== null && _a2 !== void 0 ? _a2 : ctx.rect;
  var solid = (style === PolygonType.Fill || styles2.style === PolygonType.StrokeFill) && (!isString(color) || !isTransparent(color));
  if (solid) {
    ctx.fillStyle = color;
    rects.forEach(function(_a3) {
      var x = _a3.x, y = _a3.y, w = _a3.width, h = _a3.height;
      ctx.beginPath();
      draw.call(ctx, x, y, w, h, r);
      ctx.closePath();
      ctx.fill();
    });
  }
  if ((style === PolygonType.Stroke || styles2.style === PolygonType.StrokeFill) && borderSize > 0 && !isTransparent(borderColor)) {
    ctx.strokeStyle = borderColor;
    ctx.fillStyle = borderColor;
    ctx.lineWidth = borderSize;
    if (borderStyle === LineType.Dashed) {
      ctx.setLineDash(borderDashedValue);
    } else {
      ctx.setLineDash([]);
    }
    var correction_1 = borderSize % 2 === 1 ? 0.5 : 0;
    var doubleCorrection_1 = Math.round(correction_1 * 2);
    rects.forEach(function(_a3) {
      var x = _a3.x, y = _a3.y, w = _a3.width, h = _a3.height;
      if (w > borderSize * 2 && h > borderSize * 2) {
        ctx.beginPath();
        draw.call(ctx, x + correction_1, y + correction_1, w - doubleCorrection_1, h - doubleCorrection_1, r);
        ctx.closePath();
        ctx.stroke();
      } else {
        if (!solid) {
          ctx.fillRect(x, y, w, h);
        }
      }
    });
  }
}
var rect = {
  name: "rect",
  checkEventOn: checkCoordinateOnRect,
  draw: function(ctx, attrs, styles2) {
    drawRect(ctx, attrs, styles2);
  }
};
function getTextRect(attrs, styles2) {
  var _a2 = styles2.size, size = _a2 === void 0 ? 12 : _a2, _b = styles2.paddingLeft, paddingLeft = _b === void 0 ? 0 : _b, _c2 = styles2.paddingTop, paddingTop = _c2 === void 0 ? 0 : _c2, _d = styles2.paddingRight, paddingRight = _d === void 0 ? 0 : _d, _e2 = styles2.paddingBottom, paddingBottom = _e2 === void 0 ? 0 : _e2, _f = styles2.weight, weight = _f === void 0 ? "normal" : _f, family = styles2.family;
  var x = attrs.x, y = attrs.y, text2 = attrs.text, _g = attrs.align, align = _g === void 0 ? "left" : _g, _h = attrs.baseline, baseline = _h === void 0 ? "top" : _h, w = attrs.width, h = attrs.height;
  var width = w !== null && w !== void 0 ? w : paddingLeft + calcTextWidth(text2, size, weight, family) + paddingRight;
  var height = h !== null && h !== void 0 ? h : paddingTop + size + paddingBottom;
  var startX;
  switch (align) {
    case "left":
    case "start": {
      startX = x;
      break;
    }
    case "right":
    case "end": {
      startX = x - width;
      break;
    }
    default: {
      startX = x - width / 2;
      break;
    }
  }
  var startY;
  switch (baseline) {
    case "top":
    case "hanging": {
      startY = y;
      break;
    }
    case "bottom":
    case "ideographic":
    case "alphabetic": {
      startY = y - height;
      break;
    }
    default: {
      startY = y - height / 2;
      break;
    }
  }
  return { x: startX, y: startY, width, height };
}
function checkCoordinateOnText(coordinate, attrs, styles2) {
  var texts = [];
  texts = texts.concat(attrs);
  for (var i = 0; i < texts.length; i++) {
    var _a2 = getTextRect(texts[i], styles2), x = _a2.x, y = _a2.y, width = _a2.width, height = _a2.height;
    if (coordinate.x >= x && coordinate.x <= x + width && coordinate.y >= y && coordinate.y <= y + height) {
      return true;
    }
  }
  return false;
}
function drawText(ctx, attrs, styles2) {
  var texts = [];
  texts = texts.concat(attrs);
  var _a2 = styles2.color, color = _a2 === void 0 ? "currentColor" : _a2, _b = styles2.size, size = _b === void 0 ? 12 : _b, family = styles2.family, weight = styles2.weight, _c2 = styles2.paddingLeft, paddingLeft = _c2 === void 0 ? 0 : _c2, _d = styles2.paddingTop, paddingTop = _d === void 0 ? 0 : _d, _e2 = styles2.paddingRight, paddingRight = _e2 === void 0 ? 0 : _e2;
  var rects = texts.map(function(text2) {
    return getTextRect(text2, styles2);
  });
  drawRect(ctx, rects, __assign(__assign({}, styles2), { color: styles2.backgroundColor }));
  ctx.textAlign = "left";
  ctx.textBaseline = "top";
  ctx.font = createFont(size, weight, family);
  ctx.fillStyle = color;
  texts.forEach(function(text2, index) {
    var rect2 = rects[index];
    ctx.fillText(text2.text, rect2.x + paddingLeft, rect2.y + paddingTop, rect2.width - paddingLeft - paddingRight);
  });
}
var text = {
  name: "text",
  checkEventOn: checkCoordinateOnText,
  draw: function(ctx, attrs, styles2) {
    drawText(ctx, attrs, styles2);
  }
};
var rectText = text;
var drawRectText = drawText;
function getDistance(coordinate1, coordinate2) {
  var xDif = coordinate1.x - coordinate2.x;
  var yDif = coordinate1.y - coordinate2.y;
  return Math.sqrt(xDif * xDif + yDif * yDif);
}
function checkCoordinateOnArc(coordinate, attrs) {
  var arcs = [];
  arcs = arcs.concat(attrs);
  for (var i = 0; i < arcs.length; i++) {
    var arc_1 = arcs[i];
    if (Math.abs(getDistance(coordinate, arc_1) - arc_1.r) < DEVIATION) {
      var r = arc_1.r, startAngle = arc_1.startAngle, endAngle = arc_1.endAngle;
      var startCoordinateX = r * Math.cos(startAngle) + arc_1.x;
      var startCoordinateY = r * Math.sin(startAngle) + arc_1.y;
      var endCoordinateX = r * Math.cos(endAngle) + arc_1.x;
      var endCoordinateY = r * Math.sin(endAngle) + arc_1.y;
      if (coordinate.x <= Math.max(startCoordinateX, endCoordinateX) + DEVIATION && coordinate.x >= Math.min(startCoordinateX, endCoordinateX) - DEVIATION && coordinate.y <= Math.max(startCoordinateY, endCoordinateY) + DEVIATION && coordinate.y >= Math.min(startCoordinateY, endCoordinateY) - DEVIATION) {
        return true;
      }
    }
  }
  return false;
}
function drawArc(ctx, attrs, styles2) {
  var arcs = [];
  arcs = arcs.concat(attrs);
  var _a2 = styles2.style, style = _a2 === void 0 ? LineType.Solid : _a2, _b = styles2.size, size = _b === void 0 ? 1 : _b, _c2 = styles2.color, color = _c2 === void 0 ? "currentColor" : _c2, _d = styles2.dashedValue, dashedValue = _d === void 0 ? [2, 2] : _d;
  ctx.lineWidth = size;
  ctx.strokeStyle = color;
  if (style === LineType.Dashed) {
    ctx.setLineDash(dashedValue);
  } else {
    ctx.setLineDash([]);
  }
  arcs.forEach(function(_a3) {
    var x = _a3.x, y = _a3.y, r = _a3.r, startAngle = _a3.startAngle, endAngle = _a3.endAngle;
    ctx.beginPath();
    ctx.arc(x, y, r, startAngle, endAngle);
    ctx.stroke();
    ctx.closePath();
  });
}
var arc = {
  name: "arc",
  checkEventOn: checkCoordinateOnArc,
  draw: function(ctx, attrs, styles2) {
    drawArc(ctx, attrs, styles2);
  }
};
var figures = {};
var extensions = [circle, line, polygon, rect, text, rectText, arc];
extensions.forEach(function(figure) {
  figures[figure.name] = FigureImp.extend(figure);
});
function getInnerFigureClass(name) {
  var _a2;
  return (_a2 = figures[name]) !== null && _a2 !== void 0 ? _a2 : null;
}
var View = (
  /** @class */
  function(_super) {
    __extends(View2, _super);
    function View2(widget) {
      var _this = _super.call(this) || this;
      _this._widget = widget;
      return _this;
    }
    View2.prototype.getWidget = function() {
      return this._widget;
    };
    View2.prototype.createFigure = function(figure, eventHandler) {
      var FigureClazz = getInnerFigureClass(figure.name);
      if (FigureClazz !== null) {
        var instance = new FigureClazz(figure);
        if (isValid(eventHandler)) {
          for (var key in eventHandler) {
            if (eventHandler.hasOwnProperty(key)) {
              instance.registerEvent(key, eventHandler[key]);
            }
          }
          this.addChild(instance);
        }
        return instance;
      }
      return null;
    };
    View2.prototype.draw = function(ctx) {
      this.clear();
      this.drawImp(ctx);
    };
    return View2;
  }(Eventful)
);
var GridView = (
  /** @class */
  function(_super) {
    __extends(GridView2, _super);
    function GridView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    GridView2.prototype.drawImp = function(ctx) {
      var _a2, _b;
      var widget = this.getWidget();
      var pane = this.getWidget().getPane();
      var chart = pane.getChart();
      var bounding = widget.getBounding();
      var gridStyles = chart.getStyles().grid;
      var show = gridStyles.show;
      if (show) {
        ctx.save();
        ctx.globalCompositeOperation = "destination-over";
        var horizontalStyles = gridStyles.horizontal;
        var horizontalShow = horizontalStyles.show;
        if (horizontalShow) {
          var yAxis = pane.getAxisComponent();
          var attrs = yAxis.getTicks().map(function(tick) {
            return {
              coordinates: [
                { x: 0, y: tick.coord },
                { x: bounding.width, y: tick.coord }
              ]
            };
          });
          (_a2 = this.createFigure({
            name: "line",
            attrs,
            styles: horizontalStyles
          })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
        }
        var verticalStyles = gridStyles.vertical;
        var verticalShow = verticalStyles.show;
        if (verticalShow) {
          var xAxis = chart.getXAxisPane().getAxisComponent();
          var attrs = xAxis.getTicks().map(function(tick) {
            return {
              coordinates: [
                { x: tick.coord, y: 0 },
                { x: tick.coord, y: bounding.height }
              ]
            };
          });
          (_b = this.createFigure({
            name: "line",
            attrs,
            styles: verticalStyles
          })) === null || _b === void 0 ? void 0 : _b.draw(ctx);
        }
        ctx.restore();
      }
    };
    return GridView2;
  }(View)
);
var ChildrenView = (
  /** @class */
  function(_super) {
    __extends(ChildrenView2, _super);
    function ChildrenView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ChildrenView2.prototype.eachChildren = function(childCallback) {
      var pane = this.getWidget().getPane();
      var chartStore = pane.getChart().getChartStore();
      var visibleDataList = chartStore.getVisibleDataList();
      var barSpace = chartStore.getTimeScaleStore().getBarSpace();
      visibleDataList.forEach(function(data, index) {
        childCallback(data, barSpace, index);
      });
    };
    return ChildrenView2;
  }(View)
);
var CandleBarView = (
  /** @class */
  function(_super) {
    __extends(CandleBarView2, _super);
    function CandleBarView2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this._boundCandleBarClickEvent = function(data) {
        return function() {
          _this.getWidget().getPane().getChart().getChartStore().getActionStore().execute(ActionType.OnCandleBarClick, data);
          return false;
        };
      };
      return _this;
    }
    CandleBarView2.prototype.drawImp = function(ctx) {
      var _this = this;
      var pane = this.getWidget().getPane();
      var isMain = pane.getId() === PaneIdConstants.CANDLE;
      var chartStore = pane.getChart().getChartStore();
      var candleBarOptions = this.getCandleBarOptions(chartStore);
      if (candleBarOptions !== null) {
        var ohlcSize_1 = 0;
        var halfOhlcSize_1 = 0;
        if (candleBarOptions.type === CandleType.Ohlc) {
          var gapBar = chartStore.getTimeScaleStore().getBarSpace().gapBar;
          ohlcSize_1 = Math.min(Math.max(Math.round(gapBar * 0.2), 1), 8);
          if (ohlcSize_1 > 2 && ohlcSize_1 % 2 === 1) {
            ohlcSize_1--;
          }
          halfOhlcSize_1 = Math.floor(halfOhlcSize_1 / 2);
        }
        var yAxis_1 = pane.getAxisComponent();
        this.eachChildren(function(data, barSpace) {
          var kLineData = data.data, x = data.x;
          if (isValid(kLineData)) {
            var open_1 = kLineData.open, high = kLineData.high, low = kLineData.low, close_1 = kLineData.close;
            var type = candleBarOptions.type, styles2 = candleBarOptions.styles;
            var colors = [];
            if (close_1 > open_1) {
              colors[0] = styles2.upColor;
              colors[1] = styles2.upBorderColor;
              colors[2] = styles2.upWickColor;
            } else if (close_1 < open_1) {
              colors[0] = styles2.downColor;
              colors[1] = styles2.downBorderColor;
              colors[2] = styles2.downWickColor;
            } else {
              colors[0] = styles2.noChangeColor;
              colors[1] = styles2.noChangeBorderColor;
              colors[2] = styles2.noChangeWickColor;
            }
            var openY = yAxis_1.convertToPixel(open_1);
            var closeY = yAxis_1.convertToPixel(close_1);
            var priceY = [
              openY,
              closeY,
              yAxis_1.convertToPixel(high),
              yAxis_1.convertToPixel(low)
            ];
            priceY.sort(function(a, b) {
              return a - b;
            });
            var rects = [];
            switch (type) {
              case CandleType.CandleSolid: {
                rects = _this._createSolidBar(x, priceY, barSpace, colors);
                break;
              }
              case CandleType.CandleStroke: {
                rects = _this._createStrokeBar(x, priceY, barSpace, colors);
                break;
              }
              case CandleType.CandleUpStroke: {
                if (close_1 > open_1) {
                  rects = _this._createStrokeBar(x, priceY, barSpace, colors);
                } else {
                  rects = _this._createSolidBar(x, priceY, barSpace, colors);
                }
                break;
              }
              case CandleType.CandleDownStroke: {
                if (open_1 > close_1) {
                  rects = _this._createStrokeBar(x, priceY, barSpace, colors);
                } else {
                  rects = _this._createSolidBar(x, priceY, barSpace, colors);
                }
                break;
              }
              case CandleType.Ohlc: {
                rects = [
                  {
                    name: "rect",
                    attrs: [
                      {
                        x: x - halfOhlcSize_1,
                        y: priceY[0],
                        width: ohlcSize_1,
                        height: priceY[3] - priceY[0]
                      },
                      {
                        x: x - barSpace.halfGapBar,
                        y: openY + ohlcSize_1 > priceY[3] ? priceY[3] - ohlcSize_1 : openY,
                        width: barSpace.halfGapBar,
                        height: ohlcSize_1
                      },
                      {
                        x: x + halfOhlcSize_1,
                        y: closeY + ohlcSize_1 > priceY[3] ? priceY[3] - ohlcSize_1 : closeY,
                        width: barSpace.halfGapBar - halfOhlcSize_1,
                        height: ohlcSize_1
                      }
                    ],
                    styles: { color: colors[0] }
                  }
                ];
                break;
              }
            }
            rects.forEach(function(rect2) {
              var _a2;
              var handler;
              if (isMain) {
                handler = {
                  mouseClickEvent: _this._boundCandleBarClickEvent(data)
                };
              }
              (_a2 = _this.createFigure(rect2, handler)) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
            });
          }
        });
      }
    };
    CandleBarView2.prototype.getCandleBarOptions = function(chartStore) {
      var candleStyles = chartStore.getStyles().candle;
      return {
        type: candleStyles.type,
        styles: candleStyles.bar
      };
    };
    CandleBarView2.prototype._createSolidBar = function(x, priceY, barSpace, colors) {
      return [
        {
          name: "rect",
          attrs: {
            x,
            y: priceY[0],
            width: 1,
            height: priceY[3] - priceY[0]
          },
          styles: { color: colors[2] }
        },
        {
          name: "rect",
          attrs: {
            x: x - barSpace.halfGapBar,
            y: priceY[1],
            width: barSpace.gapBar,
            height: Math.max(1, priceY[2] - priceY[1])
          },
          styles: {
            style: PolygonType.StrokeFill,
            color: colors[0],
            borderColor: colors[1]
          }
        }
      ];
    };
    CandleBarView2.prototype._createStrokeBar = function(x, priceY, barSpace, colors) {
      return [
        {
          name: "rect",
          attrs: [
            {
              x,
              y: priceY[0],
              width: 1,
              height: priceY[1] - priceY[0]
            },
            {
              x,
              y: priceY[2],
              width: 1,
              height: priceY[3] - priceY[2]
            }
          ],
          styles: { color: colors[2] }
        },
        {
          name: "rect",
          attrs: {
            x: x - barSpace.halfGapBar,
            y: priceY[1],
            width: barSpace.gapBar,
            height: Math.max(1, priceY[2] - priceY[1])
          },
          styles: {
            style: PolygonType.Stroke,
            borderColor: colors[1]
          }
        }
      ];
    };
    return CandleBarView2;
  }(ChildrenView)
);
var IndicatorView = (
  /** @class */
  function(_super) {
    __extends(IndicatorView2, _super);
    function IndicatorView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    IndicatorView2.prototype.getCandleBarOptions = function(chartStore) {
      var e_1, _a2;
      var pane = this.getWidget().getPane();
      var yAxis = pane.getAxisComponent();
      if (!yAxis.isInCandle()) {
        var indicators2 = chartStore.getIndicatorStore().getInstances(pane.getId());
        try {
          for (var indicators_1 = __values(indicators2), indicators_1_1 = indicators_1.next(); !indicators_1_1.done; indicators_1_1 = indicators_1.next()) {
            var indicator = indicators_1_1.value;
            if (indicator.shouldOhlc && indicator.visible) {
              var indicatorStyles = indicator.styles;
              var defaultStyles = chartStore.getStyles().indicator;
              var upColor = formatValue(indicatorStyles, "ohlc.upColor", defaultStyles.ohlc.upColor);
              var downColor = formatValue(indicatorStyles, "ohlc.downColor", defaultStyles.ohlc.downColor);
              var noChangeColor = formatValue(indicatorStyles, "ohlc.noChangeColor", defaultStyles.ohlc.noChangeColor);
              return {
                type: CandleType.Ohlc,
                styles: {
                  upColor,
                  downColor,
                  noChangeColor,
                  upBorderColor: upColor,
                  downBorderColor: downColor,
                  noChangeBorderColor: noChangeColor,
                  upWickColor: upColor,
                  downWickColor: downColor,
                  noChangeWickColor: noChangeColor
                }
              };
            }
          }
        } catch (e_1_1) {
          e_1 = { error: e_1_1 };
        } finally {
          try {
            if (indicators_1_1 && !indicators_1_1.done && (_a2 = indicators_1.return)) _a2.call(indicators_1);
          } finally {
            if (e_1) throw e_1.error;
          }
        }
      }
      return null;
    };
    IndicatorView2.prototype.drawImp = function(ctx) {
      var _this = this;
      _super.prototype.drawImp.call(this, ctx);
      var widget = this.getWidget();
      var pane = widget.getPane();
      var chart = pane.getChart();
      var bounding = widget.getBounding();
      var xAxis = chart.getXAxisPane().getAxisComponent();
      var yAxis = pane.getAxisComponent();
      var chartStore = chart.getChartStore();
      var dataList = chartStore.getDataList();
      var timeScaleStore = chartStore.getTimeScaleStore();
      var visibleRange = timeScaleStore.getVisibleRange();
      var indicators2 = chartStore.getIndicatorStore().getInstances(pane.getId());
      var defaultStyles = chartStore.getStyles().indicator;
      ctx.save();
      indicators2.forEach(function(indicator) {
        var _a2;
        if (indicator.visible) {
          if (indicator.zLevel < 0) {
            ctx.globalCompositeOperation = "destination-over";
          } else {
            ctx.globalCompositeOperation = "source-over";
          }
          var isCover = false;
          if (indicator.draw !== null) {
            ctx.save();
            isCover = (_a2 = indicator.draw({
              ctx,
              kLineDataList: dataList,
              indicator,
              visibleRange,
              bounding,
              barSpace: timeScaleStore.getBarSpace(),
              defaultStyles,
              xAxis,
              yAxis
            })) !== null && _a2 !== void 0 ? _a2 : false;
            ctx.restore();
          }
          if (!isCover) {
            var result_1 = indicator.result;
            var lines_1 = [];
            _this.eachChildren(function(data, barSpace) {
              var _a3, _b, _c2;
              var halfGapBar = barSpace.halfGapBar;
              var dataIndex = data.dataIndex, x = data.x;
              var prevX = xAxis.convertToPixel(dataIndex - 1);
              var nextX = xAxis.convertToPixel(dataIndex + 1);
              var prevData = (_a3 = result_1[dataIndex - 1]) !== null && _a3 !== void 0 ? _a3 : null;
              var currentData = (_b = result_1[dataIndex]) !== null && _b !== void 0 ? _b : null;
              var nextData = (_c2 = result_1[dataIndex + 1]) !== null && _c2 !== void 0 ? _c2 : null;
              var prevCoordinate = { x: prevX };
              var currentCoordinate = { x };
              var nextCoordinate = { x: nextX };
              indicator.figures.forEach(function(_a4) {
                var key = _a4.key;
                var prevValue = prevData === null || prevData === void 0 ? void 0 : prevData[key];
                if (isNumber(prevValue)) {
                  prevCoordinate[key] = yAxis.convertToPixel(prevValue);
                }
                var currentValue = currentData === null || currentData === void 0 ? void 0 : currentData[key];
                if (isNumber(currentValue)) {
                  currentCoordinate[key] = yAxis.convertToPixel(currentValue);
                }
                var nextValue = nextData === null || nextData === void 0 ? void 0 : nextData[key];
                if (isNumber(nextValue)) {
                  nextCoordinate[key] = yAxis.convertToPixel(nextValue);
                }
              });
              eachFigures(dataList, indicator, dataIndex, defaultStyles, function(figure, figureStyles, figureIndex) {
                var _a4, _b2, _c3;
                if (isValid(currentData === null || currentData === void 0 ? void 0 : currentData[figure.key])) {
                  var valueY = currentCoordinate[figure.key];
                  var attrs = (_a4 = figure.attrs) === null || _a4 === void 0 ? void 0 : _a4.call(figure, {
                    data: { prev: prevData, current: currentData, next: nextData },
                    coordinate: { prev: prevCoordinate, current: currentCoordinate, next: nextCoordinate },
                    bounding,
                    barSpace,
                    xAxis,
                    yAxis
                  });
                  if (!isValid(attrs)) {
                    switch (figure.type) {
                      case "circle": {
                        attrs = { x, y: valueY, r: Math.max(1, halfGapBar) };
                        break;
                      }
                      case "rect":
                      case "bar": {
                        var baseValue = (_b2 = figure.baseValue) !== null && _b2 !== void 0 ? _b2 : yAxis.getRange().from;
                        var baseValueY = yAxis.convertToPixel(baseValue);
                        var height = Math.abs(baseValueY - valueY);
                        if (baseValue !== (currentData === null || currentData === void 0 ? void 0 : currentData[figure.key])) {
                          height = Math.max(1, height);
                        }
                        var y = void 0;
                        if (valueY > baseValueY) {
                          y = baseValueY;
                        } else {
                          y = valueY;
                        }
                        attrs = {
                          x: x - halfGapBar,
                          y,
                          width: Math.max(1, halfGapBar * 2),
                          height
                        };
                        break;
                      }
                      case "line": {
                        if (!isValid(lines_1[figureIndex])) {
                          lines_1[figureIndex] = [];
                        }
                        if (isNumber(currentCoordinate[figure.key]) && isNumber(nextCoordinate[figure.key])) {
                          lines_1[figureIndex].push({
                            coordinates: [
                              { x: currentCoordinate.x, y: currentCoordinate[figure.key] },
                              { x: nextCoordinate.x, y: nextCoordinate[figure.key] }
                            ],
                            styles: figureStyles
                          });
                        }
                        break;
                      }
                    }
                  }
                  var type = figure.type;
                  if (isValid(attrs) && type !== "line") {
                    (_c3 = _this.createFigure({
                      name: type === "bar" ? "rect" : type,
                      attrs,
                      styles: figureStyles
                    })) === null || _c3 === void 0 ? void 0 : _c3.draw(ctx);
                  }
                }
              });
            });
            lines_1.forEach(function(items) {
              if (items.length > 1) {
                var mergeLines = [
                  {
                    coordinates: [items[0].coordinates[0], items[0].coordinates[1]],
                    styles: items[0].styles
                  }
                ];
                for (var i = 1; i < items.length; i++) {
                  var lastMergeLine = mergeLines[mergeLines.length - 1];
                  var current = items[i];
                  var lastMergeLineLastCoordinate = lastMergeLine.coordinates[lastMergeLine.coordinates.length - 1];
                  if (lastMergeLineLastCoordinate.x === current.coordinates[0].x && lastMergeLineLastCoordinate.y === current.coordinates[0].y && lastMergeLine.styles.style === current.styles.style && lastMergeLine.styles.color === current.styles.color && lastMergeLine.styles.size === current.styles.size && lastMergeLine.styles.smooth === current.styles.smooth && lastMergeLine.styles.dashedValue[0] === current.styles.dashedValue[0] && lastMergeLine.styles.dashedValue[1] === current.styles.dashedValue[1]) {
                    lastMergeLine.coordinates.push(current.coordinates[1]);
                  } else {
                    mergeLines.push({
                      coordinates: [current.coordinates[0], current.coordinates[1]],
                      styles: current.styles
                    });
                  }
                }
                mergeLines.forEach(function(_a3) {
                  var _b;
                  var coordinates = _a3.coordinates, styles2 = _a3.styles;
                  (_b = _this.createFigure({
                    name: "line",
                    attrs: { coordinates },
                    styles: styles2
                  })) === null || _b === void 0 ? void 0 : _b.draw(ctx);
                });
              }
            });
          }
        }
      });
      ctx.restore();
    };
    return IndicatorView2;
  }(CandleBarView)
);
var CrosshairLineView = (
  /** @class */
  function(_super) {
    __extends(CrosshairLineView2, _super);
    function CrosshairLineView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CrosshairLineView2.prototype.drawImp = function(ctx) {
      var widget = this.getWidget();
      var pane = widget.getPane();
      var bounding = widget.getBounding();
      var chartStore = widget.getPane().getChart().getChartStore();
      var crosshair = chartStore.getTooltipStore().getCrosshair();
      var styles2 = chartStore.getStyles().crosshair;
      if (isString(crosshair.paneId) && styles2.show) {
        if (crosshair.paneId === pane.getId()) {
          var y = crosshair.y;
          this._drawLine(ctx, [
            { x: 0, y },
            { x: bounding.width, y }
          ], styles2.horizontal);
        }
        var x = crosshair.realX;
        this._drawLine(ctx, [
          { x, y: 0 },
          { x, y: bounding.height }
        ], styles2.vertical);
      }
    };
    CrosshairLineView2.prototype._drawLine = function(ctx, coordinates, styles2) {
      var _a2;
      if (styles2.show) {
        var lineStyles = styles2.line;
        if (lineStyles.show) {
          (_a2 = this.createFigure({
            name: "line",
            attrs: { coordinates },
            styles: lineStyles
          })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
        }
      }
    };
    return CrosshairLineView2;
  }(View)
);
var IndicatorTooltipView = (
  /** @class */
  function(_super) {
    __extends(IndicatorTooltipView2, _super);
    function IndicatorTooltipView2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this._boundIconClickEvent = function(currentIcon) {
        return function() {
          var pane = _this.getWidget().getPane();
          pane.getChart().getChartStore().getActionStore().execute(ActionType.OnTooltipIconClick, __assign({}, currentIcon));
          return true;
        };
      };
      _this._boundIconMouseMoveEvent = function(currentIconInfo) {
        return function() {
          var pane = _this.getWidget().getPane();
          var tooltipStore = pane.getChart().getChartStore().getTooltipStore();
          tooltipStore.setActiveIcon(__assign({}, currentIconInfo));
          return true;
        };
      };
      return _this;
    }
    IndicatorTooltipView2.prototype.drawImp = function(ctx) {
      var widget = this.getWidget();
      var pane = widget.getPane();
      var chartStore = pane.getChart().getChartStore();
      var crosshair = chartStore.getTooltipStore().getCrosshair();
      if (isValid(crosshair.kLineData)) {
        var bounding = widget.getBounding();
        var customApi = chartStore.getCustomApi();
        var thousandsSeparator = chartStore.getThousandsSeparator();
        var decimalFoldThreshold = chartStore.getDecimalFoldThreshold();
        var indicators2 = chartStore.getIndicatorStore().getInstances(pane.getId());
        var activeIcon = chartStore.getTooltipStore().getActiveIcon();
        var defaultStyles = chartStore.getStyles().indicator;
        var _a2 = defaultStyles.tooltip, offsetLeft = _a2.offsetLeft, offsetTop = _a2.offsetTop, offsetRight = _a2.offsetRight;
        this.drawIndicatorTooltip(ctx, pane.getId(), chartStore.getDataList(), crosshair, activeIcon, indicators2, customApi, thousandsSeparator, decimalFoldThreshold, offsetLeft, offsetTop, bounding.width - offsetRight, defaultStyles);
      }
    };
    IndicatorTooltipView2.prototype.drawIndicatorTooltip = function(ctx, paneId, dataList, crosshair, activeTooltipIcon, indicators2, customApi, thousandsSeparator, decimalFoldThreshold, left, top, maxWidth, styles2) {
      var _this = this;
      var tooltipStyles = styles2.tooltip;
      if (this.isDrawTooltip(crosshair, tooltipStyles)) {
        var tooltipTextStyles_1 = tooltipStyles.text;
        indicators2.forEach(function(indicator) {
          var prevRowHeight = 0;
          var coordinate = { x: left, y: top };
          var _a2 = _this.getIndicatorTooltipData(dataList, crosshair, indicator, customApi, thousandsSeparator, decimalFoldThreshold, styles2), name = _a2.name, calcParamsText = _a2.calcParamsText, legends = _a2.values, icons = _a2.icons;
          var nameValid = name.length > 0;
          var legendValid = legends.length > 0;
          if (nameValid || legendValid) {
            var _b = __read(_this.classifyTooltipIcons(icons), 3), leftIcons = _b[0], middleIcons = _b[1], rightIcons = _b[2];
            prevRowHeight = _this.drawStandardTooltipIcons(ctx, activeTooltipIcon, leftIcons, coordinate, paneId, indicator.name, left, prevRowHeight, maxWidth);
            if (nameValid) {
              var text2 = name;
              if (calcParamsText.length > 0) {
                text2 = "".concat(text2).concat(calcParamsText);
              }
              prevRowHeight = _this.drawStandardTooltipLegends(ctx, [
                {
                  title: { text: "", color: tooltipTextStyles_1.color },
                  value: { text: text2, color: tooltipTextStyles_1.color }
                }
              ], coordinate, left, prevRowHeight, maxWidth, tooltipTextStyles_1);
            }
            prevRowHeight = _this.drawStandardTooltipIcons(ctx, activeTooltipIcon, middleIcons, coordinate, paneId, indicator.name, left, prevRowHeight, maxWidth);
            if (legendValid) {
              prevRowHeight = _this.drawStandardTooltipLegends(ctx, legends, coordinate, left, prevRowHeight, maxWidth, tooltipStyles.text);
            }
            prevRowHeight = _this.drawStandardTooltipIcons(ctx, activeTooltipIcon, rightIcons, coordinate, paneId, indicator.name, left, prevRowHeight, maxWidth);
            top = coordinate.y + prevRowHeight;
          }
        });
      }
      return top;
    };
    IndicatorTooltipView2.prototype.drawStandardTooltipIcons = function(ctx, activeIcon, icons, coordinate, paneId, indicatorName, left, prevRowHeight, maxWidth) {
      var _this = this;
      if (icons.length > 0) {
        var width_1 = 0;
        var height_1 = 0;
        icons.forEach(function(icon) {
          var _a2 = icon.marginLeft, marginLeft = _a2 === void 0 ? 0 : _a2, _b = icon.marginTop, marginTop = _b === void 0 ? 0 : _b, _c2 = icon.marginRight, marginRight = _c2 === void 0 ? 0 : _c2, _d = icon.marginBottom, marginBottom = _d === void 0 ? 0 : _d, _e2 = icon.paddingLeft, paddingLeft = _e2 === void 0 ? 0 : _e2, _f = icon.paddingTop, paddingTop = _f === void 0 ? 0 : _f, _g = icon.paddingRight, paddingRight = _g === void 0 ? 0 : _g, _h = icon.paddingBottom, paddingBottom = _h === void 0 ? 0 : _h, size = icon.size, fontFamily = icon.fontFamily, text2 = icon.icon;
          ctx.font = createFont(size, "normal", fontFamily);
          width_1 += marginLeft + paddingLeft + ctx.measureText(text2).width + paddingRight + marginRight;
          height_1 = Math.max(height_1, marginTop + paddingTop + size + paddingBottom + marginBottom);
        });
        if (coordinate.x + width_1 > maxWidth) {
          coordinate.x = left;
          coordinate.y += prevRowHeight;
          prevRowHeight = height_1;
        } else {
          prevRowHeight = Math.max(prevRowHeight, height_1);
        }
        icons.forEach(function(icon) {
          var _a2;
          var _b = icon.marginLeft, marginLeft = _b === void 0 ? 0 : _b, _c2 = icon.marginTop, marginTop = _c2 === void 0 ? 0 : _c2, _d = icon.marginRight, marginRight = _d === void 0 ? 0 : _d, _e2 = icon.paddingLeft, paddingLeft = _e2 === void 0 ? 0 : _e2, _f = icon.paddingTop, paddingTop = _f === void 0 ? 0 : _f, _g = icon.paddingRight, paddingRight = _g === void 0 ? 0 : _g, _h = icon.paddingBottom, paddingBottom = _h === void 0 ? 0 : _h, color = icon.color, activeColor = icon.activeColor, size = icon.size, fontFamily = icon.fontFamily, text2 = icon.icon, backgroundColor = icon.backgroundColor, activeBackgroundColor = icon.activeBackgroundColor;
          var active = (activeIcon === null || activeIcon === void 0 ? void 0 : activeIcon.paneId) === paneId && (activeIcon === null || activeIcon === void 0 ? void 0 : activeIcon.indicatorName) === indicatorName && (activeIcon === null || activeIcon === void 0 ? void 0 : activeIcon.iconId) === icon.id;
          (_a2 = _this.createFigure({
            name: "text",
            attrs: { text: text2, x: coordinate.x + marginLeft, y: coordinate.y + marginTop },
            styles: {
              paddingLeft,
              paddingTop,
              paddingRight,
              paddingBottom,
              color: active ? activeColor : color,
              size,
              family: fontFamily,
              backgroundColor: active ? activeBackgroundColor : backgroundColor
            }
          }, {
            mouseClickEvent: _this._boundIconClickEvent({ paneId, indicatorName, iconId: icon.id }),
            mouseMoveEvent: _this._boundIconMouseMoveEvent({ paneId, indicatorName, iconId: icon.id })
          })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
          coordinate.x += marginLeft + paddingLeft + ctx.measureText(text2).width + paddingRight + marginRight;
        });
      }
      return prevRowHeight;
    };
    IndicatorTooltipView2.prototype.drawStandardTooltipLegends = function(ctx, legends, coordinate, left, prevRowHeight, maxWidth, styles2) {
      var _this = this;
      if (legends.length > 0) {
        var marginLeft_1 = styles2.marginLeft, marginTop_1 = styles2.marginTop, marginRight_1 = styles2.marginRight, marginBottom_1 = styles2.marginBottom, size_1 = styles2.size, family_1 = styles2.family, weight_1 = styles2.weight;
        ctx.font = createFont(size_1, weight_1, family_1);
        legends.forEach(function(data) {
          var _a2, _b;
          var title = data.title;
          var value = data.value;
          var titleTextWidth = ctx.measureText(title.text).width;
          var valueTextWidth = ctx.measureText(value.text).width;
          var totalTextWidth = titleTextWidth + valueTextWidth;
          var h = marginTop_1 + size_1 + marginBottom_1;
          if (coordinate.x + marginLeft_1 + totalTextWidth + marginRight_1 > maxWidth) {
            coordinate.x = left;
            coordinate.y += prevRowHeight;
            prevRowHeight = h;
          } else {
            prevRowHeight = Math.max(prevRowHeight, h);
          }
          if (title.text.length > 0) {
            (_a2 = _this.createFigure({
              name: "text",
              attrs: { x: coordinate.x + marginLeft_1, y: coordinate.y + marginTop_1, text: title.text },
              styles: { color: title.color, size: size_1, family: family_1, weight: weight_1 }
            })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
          }
          (_b = _this.createFigure({
            name: "text",
            attrs: { x: coordinate.x + marginLeft_1 + titleTextWidth, y: coordinate.y + marginTop_1, text: value.text },
            styles: { color: value.color, size: size_1, family: family_1, weight: weight_1 }
          })) === null || _b === void 0 ? void 0 : _b.draw(ctx);
          coordinate.x += marginLeft_1 + totalTextWidth + marginRight_1;
        });
      }
      return prevRowHeight;
    };
    IndicatorTooltipView2.prototype.isDrawTooltip = function(crosshair, styles2) {
      var showRule = styles2.showRule;
      return showRule === TooltipShowRule.Always || showRule === TooltipShowRule.FollowCross && isString(crosshair.paneId);
    };
    IndicatorTooltipView2.prototype.getIndicatorTooltipData = function(dataList, crosshair, indicator, customApi, thousandsSeparator, decimalFoldThreshold, styles2) {
      var _a2, _b;
      var tooltipStyles = styles2.tooltip;
      var name = tooltipStyles.showName ? indicator.shortName : "";
      var calcParamsText = "";
      var calcParams = indicator.calcParams;
      if (calcParams.length > 0 && tooltipStyles.showParams) {
        calcParamsText = "(".concat(calcParams.join(","), ")");
      }
      var tooltipData = { name, calcParamsText, values: [], icons: tooltipStyles.icons };
      var dataIndex = crosshair.dataIndex;
      var result = (_a2 = indicator.result) !== null && _a2 !== void 0 ? _a2 : [];
      var legends = [];
      if (indicator.visible) {
        var indicatorData_1 = (_b = result[dataIndex]) !== null && _b !== void 0 ? _b : {};
        eachFigures(dataList, indicator, dataIndex, styles2, function(figure, figureStyles) {
          var _a3;
          if (isString(figure.title)) {
            var color = figureStyles.color;
            var value = (_a3 = indicatorData_1[figure.key]) !== null && _a3 !== void 0 ? _a3 : tooltipStyles.defaultValue;
            if (isNumber(value)) {
              value = formatPrecision(value, indicator.precision);
              if (indicator.shouldFormatBigNumber) {
                value = customApi.formatBigNumber(value);
              }
              value = formatFoldDecimal(formatThousands(value, thousandsSeparator), decimalFoldThreshold);
            }
            legends.push({ title: { text: figure.title, color }, value: { text: value, color } });
          }
        });
        tooltipData.values = legends;
      }
      if (indicator.createTooltipDataSource !== null) {
        var widget = this.getWidget();
        var pane = widget.getPane();
        var chartStore = pane.getChart().getChartStore();
        var _c2 = indicator.createTooltipDataSource({
          kLineDataList: dataList,
          indicator,
          visibleRange: chartStore.getTimeScaleStore().getVisibleRange(),
          bounding: widget.getBounding(),
          crosshair,
          defaultStyles: styles2,
          xAxis: pane.getChart().getXAxisPane().getAxisComponent(),
          yAxis: pane.getAxisComponent()
        }), customName = _c2.name, customCalcParamsText = _c2.calcParamsText, customLegends = _c2.values, customIcons = _c2.icons;
        if (isString(customName) && tooltipStyles.showName) {
          tooltipData.name = customName;
        }
        if (isString(customCalcParamsText) && tooltipStyles.showParams) {
          tooltipData.calcParamsText = customCalcParamsText;
        }
        if (isValid(customIcons)) {
          tooltipData.icons = customIcons;
        }
        if (isValid(customLegends) && indicator.visible) {
          var optimizedLegends_1 = [];
          var color_1 = styles2.tooltip.text.color;
          customLegends.forEach(function(data) {
            var _a3;
            var title = { text: "", color: color_1 };
            if (isObject(data.title)) {
              title = data.title;
            } else {
              title.text = data.title;
            }
            var value = { text: "", color: color_1 };
            if (isObject(data.value)) {
              value = data.value;
            } else {
              value.text = (_a3 = data.value) !== null && _a3 !== void 0 ? _a3 : tooltipStyles.defaultValue;
            }
            if (isNumber(value.text)) {
              var text2 = formatPrecision(value.text, indicator.precision);
              if (indicator.shouldFormatBigNumber) {
                text2 = customApi.formatBigNumber(text2);
              }
              text2 = formatFoldDecimal(formatThousands(text2, thousandsSeparator), decimalFoldThreshold);
              value.text = text2;
            }
            optimizedLegends_1.push({ title, value });
          });
          tooltipData.values = optimizedLegends_1;
        }
      }
      return tooltipData;
    };
    IndicatorTooltipView2.prototype.classifyTooltipIcons = function(icons) {
      var leftIcons = [];
      var middleIcons = [];
      var rightIcons = [];
      icons.forEach(function(icon) {
        switch (icon.position) {
          case TooltipIconPosition.Left: {
            leftIcons.push(icon);
            break;
          }
          case TooltipIconPosition.Middle: {
            middleIcons.push(icon);
            break;
          }
          case TooltipIconPosition.Right: {
            rightIcons.push(icon);
            break;
          }
        }
      });
      return [leftIcons, middleIcons, rightIcons];
    };
    return IndicatorTooltipView2;
  }(View)
);
var OverlayView = (
  /** @class */
  function(_super) {
    __extends(OverlayView2, _super);
    function OverlayView2(widget) {
      var _this = _super.call(this, widget) || this;
      _this._initEvent();
      return _this;
    }
    OverlayView2.prototype._initEvent = function() {
      var _this = this;
      var pane = this.getWidget().getPane();
      var paneId = pane.getId();
      var overlayStore = pane.getChart().getChartStore().getOverlayStore();
      this.registerEvent("mouseMoveEvent", function(event) {
        var _a2;
        var progressInstanceInfo = overlayStore.getProgressInstanceInfo();
        if (progressInstanceInfo !== null) {
          var overlay = progressInstanceInfo.instance;
          var progressInstancePaneId = progressInstanceInfo.paneId;
          if (overlay.isStart()) {
            overlayStore.updateProgressInstanceInfo(paneId);
            progressInstancePaneId = paneId;
          }
          var index = overlay.points.length - 1;
          var key = "".concat(OVERLAY_FIGURE_KEY_PREFIX, "point_").concat(index);
          if (overlay.isDrawing() && progressInstancePaneId === paneId) {
            overlay.eventMoveForDrawing(_this._coordinateToPoint(progressInstanceInfo.instance, event));
            (_a2 = overlay.onDrawing) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, __assign({ overlay, figureKey: key, figureIndex: index }, event));
          }
          return _this._figureMouseMoveEvent(overlay, 1, key, index, 0)(event);
        }
        overlayStore.setHoverInstanceInfo({
          paneId,
          instance: null,
          figureType: 0,
          figureKey: "",
          figureIndex: -1,
          attrsIndex: -1
        }, event);
        return false;
      }).registerEvent("mouseClickEvent", function(event) {
        var _a2, _b;
        var progressInstanceInfo = overlayStore.getProgressInstanceInfo();
        if (progressInstanceInfo !== null) {
          var overlay = progressInstanceInfo.instance;
          var progressInstancePaneId = progressInstanceInfo.paneId;
          if (overlay.isStart()) {
            overlayStore.updateProgressInstanceInfo(paneId, true);
            progressInstancePaneId = paneId;
          }
          var index = overlay.points.length - 1;
          var key = "".concat(OVERLAY_FIGURE_KEY_PREFIX, "point_").concat(index);
          if (overlay.isDrawing() && progressInstancePaneId === paneId) {
            overlay.eventMoveForDrawing(_this._coordinateToPoint(overlay, event));
            (_a2 = overlay.onDrawing) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, __assign({ overlay, figureKey: key, figureIndex: index }, event));
            overlay.nextStep();
            if (!overlay.isDrawing()) {
              overlayStore.progressInstanceComplete();
              (_b = overlay.onDrawEnd) === null || _b === void 0 ? void 0 : _b.call(overlay, __assign({ overlay, figureKey: key, figureIndex: index }, event));
            }
          }
          return _this._figureMouseClickEvent(overlay, 1, key, index, 0)(event);
        }
        overlayStore.setClickInstanceInfo({
          paneId,
          instance: null,
          figureType: 0,
          figureKey: "",
          figureIndex: -1,
          attrsIndex: -1
        }, event);
        return false;
      }).registerEvent("mouseDoubleClickEvent", function(event) {
        var _a2;
        var progressInstanceInfo = overlayStore.getProgressInstanceInfo();
        if (progressInstanceInfo !== null) {
          var overlay = progressInstanceInfo.instance;
          var progressInstancePaneId = progressInstanceInfo.paneId;
          if (overlay.isDrawing() && progressInstancePaneId === paneId) {
            overlay.forceComplete();
            if (!overlay.isDrawing()) {
              overlayStore.progressInstanceComplete();
              var index_1 = overlay.points.length - 1;
              var key = "".concat(OVERLAY_FIGURE_KEY_PREFIX, "point_").concat(index_1);
              (_a2 = overlay.onDrawEnd) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, __assign({ overlay, figureKey: key, figureIndex: index_1 }, event));
            }
          }
          var index = overlay.points.length - 1;
          return _this._figureMouseClickEvent(overlay, 1, "".concat(OVERLAY_FIGURE_KEY_PREFIX, "point_").concat(index), index, 0)(event);
        }
        return false;
      }).registerEvent("mouseRightClickEvent", function(event) {
        var progressInstanceInfo = overlayStore.getProgressInstanceInfo();
        if (progressInstanceInfo !== null) {
          var overlay = progressInstanceInfo.instance;
          if (overlay.isDrawing()) {
            var index = overlay.points.length - 1;
            return _this._figureMouseRightClickEvent(overlay, 1, "".concat(OVERLAY_FIGURE_KEY_PREFIX, "point_").concat(index), index, 0)(event);
          }
        }
        return false;
      }).registerEvent("mouseUpEvent", function(event) {
        var _a2;
        var _b = overlayStore.getPressedInstanceInfo(), instance = _b.instance, figureIndex = _b.figureIndex, figureKey = _b.figureKey;
        if (instance !== null) {
          (_a2 = instance.onPressedMoveEnd) === null || _a2 === void 0 ? void 0 : _a2.call(instance, __assign({ overlay: instance, figureKey, figureIndex }, event));
        }
        overlayStore.setPressedInstanceInfo({
          paneId,
          instance: null,
          figureType: 0,
          figureKey: "",
          figureIndex: -1,
          attrsIndex: -1
        });
        return false;
      }).registerEvent("pressedMouseMoveEvent", function(event) {
        var _a2, _b;
        var _c2 = overlayStore.getPressedInstanceInfo(), instance = _c2.instance, figureType = _c2.figureType, figureIndex = _c2.figureIndex, figureKey = _c2.figureKey;
        if (instance !== null) {
          if (!instance.lock) {
            if (!((_b = (_a2 = instance.onPressedMoving) === null || _a2 === void 0 ? void 0 : _a2.call(instance, __assign({ overlay: instance, figureIndex, figureKey }, event))) !== null && _b !== void 0 ? _b : false)) {
              var point = _this._coordinateToPoint(instance, event);
              if (figureType === 1) {
                instance.eventPressedPointMove(point, figureIndex);
              } else {
                instance.eventPressedOtherMove(point, _this.getWidget().getPane().getChart().getChartStore().getTimeScaleStore());
              }
            }
          }
          return true;
        }
        return false;
      });
    };
    OverlayView2.prototype._createFigureEvents = function(overlay, figureType, figureKey, figureIndex, attrsIndex, ignoreEvent) {
      var eventHandler;
      if (!overlay.isDrawing()) {
        var eventTypes = [];
        if (isValid(ignoreEvent)) {
          if (isBoolean(ignoreEvent)) {
            if (ignoreEvent) {
              eventTypes = getAllOverlayFigureIgnoreEventTypes();
            }
          } else {
            eventTypes = ignoreEvent;
          }
        }
        if (eventTypes.length === 0) {
          return {
            mouseMoveEvent: this._figureMouseMoveEvent(overlay, figureType, figureKey, figureIndex, attrsIndex),
            mouseDownEvent: this._figureMouseDownEvent(overlay, figureType, figureKey, figureIndex, attrsIndex),
            mouseClickEvent: this._figureMouseClickEvent(overlay, figureType, figureKey, figureIndex, attrsIndex),
            mouseRightClickEvent: this._figureMouseRightClickEvent(overlay, figureType, figureKey, figureIndex, attrsIndex),
            mouseDoubleClickEvent: this._figureMouseDoubleClickEvent(overlay, figureType, figureKey, figureIndex, attrsIndex)
          };
        }
        eventHandler = {};
        if (!eventTypes.includes("mouseMoveEvent") && !eventTypes.includes("touchMoveEvent")) {
          eventHandler.mouseMoveEvent = this._figureMouseMoveEvent(overlay, figureType, figureKey, figureIndex, attrsIndex);
        }
        if (!eventTypes.includes("mouseDownEvent") && !eventTypes.includes("touchStartEvent")) {
          eventHandler.mouseDownEvent = this._figureMouseDownEvent(overlay, figureType, figureKey, figureIndex, attrsIndex);
        }
        if (!eventTypes.includes("mouseClickEvent") && !eventTypes.includes("tapEvent")) {
          eventHandler.mouseClickEvent = this._figureMouseClickEvent(overlay, figureType, figureKey, figureIndex, attrsIndex);
        }
        if (!eventTypes.includes("mouseDoubleClickEvent") && !eventTypes.includes("doubleTapEvent")) {
          eventHandler.mouseDoubleClickEvent = this._figureMouseDoubleClickEvent(overlay, figureType, figureKey, figureIndex, attrsIndex);
        }
        if (!eventTypes.includes("mouseRightClickEvent")) {
          eventHandler.mouseRightClickEvent = this._figureMouseRightClickEvent(overlay, figureType, figureKey, figureIndex, attrsIndex);
        }
      }
      return eventHandler;
    };
    OverlayView2.prototype._figureMouseMoveEvent = function(overlay, figureType, figureKey, figureIndex, attrsIndex) {
      var _this = this;
      return function(event) {
        var pane = _this.getWidget().getPane();
        var overlayStore = pane.getChart().getChartStore().getOverlayStore();
        overlayStore.setHoverInstanceInfo({ paneId: pane.getId(), instance: overlay, figureType, figureKey, figureIndex, attrsIndex }, event);
        return true;
      };
    };
    OverlayView2.prototype._figureMouseDownEvent = function(overlay, figureType, figureKey, figureIndex, attrsIndex) {
      var _this = this;
      return function(event) {
        var _a2;
        var pane = _this.getWidget().getPane();
        var paneId = pane.getId();
        var overlayStore = pane.getChart().getChartStore().getOverlayStore();
        overlay.startPressedMove(_this._coordinateToPoint(overlay, event));
        (_a2 = overlay.onPressedMoveStart) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, __assign({ overlay, figureIndex, figureKey }, event));
        overlayStore.setPressedInstanceInfo({ paneId, instance: overlay, figureType, figureKey, figureIndex, attrsIndex });
        return true;
      };
    };
    OverlayView2.prototype._figureMouseClickEvent = function(overlay, figureType, figureKey, figureIndex, attrsIndex) {
      var _this = this;
      return function(event) {
        var pane = _this.getWidget().getPane();
        var paneId = pane.getId();
        var overlayStore = pane.getChart().getChartStore().getOverlayStore();
        overlayStore.setClickInstanceInfo({ paneId, instance: overlay, figureType, figureKey, figureIndex, attrsIndex }, event);
        return true;
      };
    };
    OverlayView2.prototype._figureMouseDoubleClickEvent = function(overlay, _figureType, figureKey, figureIndex, _attrsIndex) {
      return function(event) {
        var _a2;
        (_a2 = overlay.onDoubleClick) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, __assign(__assign({}, event), { figureIndex, figureKey, overlay }));
        return true;
      };
    };
    OverlayView2.prototype._figureMouseRightClickEvent = function(overlay, _figureType, figureKey, figureIndex, _attrsIndex) {
      var _this = this;
      return function(event) {
        var _a2, _b;
        if (!((_b = (_a2 = overlay.onRightClick) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, __assign({ overlay, figureIndex, figureKey }, event))) !== null && _b !== void 0 ? _b : false)) {
          var pane = _this.getWidget().getPane();
          var overlayStore = pane.getChart().getChartStore().getOverlayStore();
          overlayStore.removeInstance(overlay);
        }
        return true;
      };
    };
    OverlayView2.prototype._coordinateToPoint = function(overlay, coordinate) {
      var _a2;
      var point = {};
      var pane = this.getWidget().getPane();
      var chart = pane.getChart();
      var paneId = pane.getId();
      var timeScaleStore = chart.getChartStore().getTimeScaleStore();
      if (this.coordinateToPointTimestampDataIndexFlag()) {
        var xAxis = chart.getXAxisPane().getAxisComponent();
        var dataIndex = xAxis.convertFromPixel(coordinate.x);
        var timestamp = (_a2 = timeScaleStore.dataIndexToTimestamp(dataIndex)) !== null && _a2 !== void 0 ? _a2 : void 0;
        point.dataIndex = dataIndex;
        point.timestamp = timestamp;
      }
      if (this.coordinateToPointValueFlag()) {
        var yAxis = pane.getAxisComponent();
        var value = yAxis.convertFromPixel(coordinate.y);
        if (overlay.mode !== OverlayMode.Normal && paneId === PaneIdConstants.CANDLE && isNumber(point.dataIndex)) {
          var kLineData = timeScaleStore.getDataByDataIndex(point.dataIndex);
          if (kLineData !== null) {
            var modeSensitivity = overlay.modeSensitivity;
            if (value > kLineData.high) {
              if (overlay.mode === OverlayMode.WeakMagnet) {
                var highY = yAxis.convertToPixel(kLineData.high);
                var buffValue = yAxis.convertFromPixel(highY - modeSensitivity);
                if (value < buffValue) {
                  value = kLineData.high;
                }
              } else {
                value = kLineData.high;
              }
            } else if (value < kLineData.low) {
              if (overlay.mode === OverlayMode.WeakMagnet) {
                var lowY = yAxis.convertToPixel(kLineData.low);
                var buffValue = yAxis.convertFromPixel(lowY - modeSensitivity);
                if (value > buffValue) {
                  value = kLineData.low;
                }
              } else {
                value = kLineData.low;
              }
            } else {
              var max = Math.max(kLineData.open, kLineData.close);
              var min = Math.min(kLineData.open, kLineData.close);
              if (value > max) {
                if (value - max < kLineData.high - value) {
                  value = max;
                } else {
                  value = kLineData.high;
                }
              } else if (value < min) {
                if (value - kLineData.low < min - value) {
                  value = kLineData.low;
                } else {
                  value = min;
                }
              } else if (max - value < value - min) {
                value = max;
              } else {
                value = min;
              }
            }
          }
        }
        point.value = value;
      }
      return point;
    };
    OverlayView2.prototype.coordinateToPointValueFlag = function() {
      return true;
    };
    OverlayView2.prototype.coordinateToPointTimestampDataIndexFlag = function() {
      return true;
    };
    OverlayView2.prototype.dispatchEvent = function(name, event, other) {
      if (this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()) {
        return this.onEvent(name, event, other);
      }
      return _super.prototype.dispatchEvent.call(this, name, event, other);
    };
    OverlayView2.prototype.checkEventOn = function() {
      return true;
    };
    OverlayView2.prototype.drawImp = function(ctx) {
      var _this = this;
      var widget = this.getWidget();
      var pane = widget.getPane();
      var paneId = pane.getId();
      var chart = pane.getChart();
      var yAxis = pane.getAxisComponent();
      var xAxis = chart.getXAxisPane().getAxisComponent();
      var bounding = widget.getBounding();
      var chartStore = chart.getChartStore();
      var customApi = chartStore.getCustomApi();
      var thousandsSeparator = chartStore.getThousandsSeparator();
      var decimalFoldThreshold = chartStore.getDecimalFoldThreshold();
      var timeScaleStore = chartStore.getTimeScaleStore();
      var dateTimeFormat = timeScaleStore.getDateTimeFormat();
      var barSpace = timeScaleStore.getBarSpace();
      var precision = chartStore.getPrecision();
      var defaultStyles = chartStore.getStyles().overlay;
      var overlayStore = chartStore.getOverlayStore();
      var hoverInstanceInfo = overlayStore.getHoverInstanceInfo();
      var clickInstanceInfo = overlayStore.getClickInstanceInfo();
      var overlays2 = this.getCompleteOverlays(overlayStore, paneId);
      var paneIndicators = chartStore.getIndicatorStore().getInstances(paneId);
      var overlayPrecision = paneIndicators.reduce(function(prev, indicator) {
        var precision2 = indicator.precision;
        prev[indicator.name] = precision2;
        prev.max = Math.max(prev.max, precision2);
        prev.min = Math.min(prev.min, precision2);
        prev.excludePriceVolumeMax = Math.max(prev.excludePriceVolumeMax, precision2);
        prev.excludePriceVolumeMin = Math.min(prev.excludePriceVolumeMin, precision2);
        return prev;
      }, __assign(__assign({}, precision), { max: Math.max(precision.price, precision.volume), min: Math.min(precision.price, precision.volume), excludePriceVolumeMax: Number.MIN_SAFE_INTEGER, excludePriceVolumeMin: Number.MAX_SAFE_INTEGER }));
      overlays2.forEach(function(overlay2) {
        if (overlay2.visible) {
          _this._drawOverlay(ctx, overlay2, bounding, barSpace, overlayPrecision, dateTimeFormat, customApi, thousandsSeparator, decimalFoldThreshold, defaultStyles, xAxis, yAxis, hoverInstanceInfo, clickInstanceInfo, timeScaleStore);
        }
      });
      var progressInstanceInfo = overlayStore.getProgressInstanceInfo();
      if (progressInstanceInfo !== null) {
        var overlay = this.getProgressOverlay(progressInstanceInfo, paneId);
        if (overlay !== null && overlay.visible) {
          this._drawOverlay(ctx, overlay, bounding, barSpace, overlayPrecision, dateTimeFormat, customApi, thousandsSeparator, decimalFoldThreshold, defaultStyles, xAxis, yAxis, hoverInstanceInfo, clickInstanceInfo, timeScaleStore);
        }
      }
    };
    OverlayView2.prototype._drawOverlay = function(ctx, overlay, bounding, barSpace, precision, dateTimeFormat, customApi, thousandsSeparator, decimalFoldThreshold, defaultStyles, xAxis, yAxis, hoverInstanceInfo, clickInstanceInfo, timeScaleStore) {
      var points = overlay.points;
      var coordinates = points.map(function(point) {
        var _a2, _b;
        var dataIndex = point.dataIndex;
        if (isNumber(point.timestamp)) {
          dataIndex = timeScaleStore.timestampToDataIndex(point.timestamp);
        }
        var coordinate = { x: 0, y: 0 };
        if (isNumber(dataIndex)) {
          coordinate.x = (_a2 = xAxis === null || xAxis === void 0 ? void 0 : xAxis.convertToPixel(dataIndex)) !== null && _a2 !== void 0 ? _a2 : 0;
        }
        if (isNumber(point.value)) {
          coordinate.y = (_b = yAxis === null || yAxis === void 0 ? void 0 : yAxis.convertToPixel(point.value)) !== null && _b !== void 0 ? _b : 0;
        }
        return coordinate;
      });
      if (coordinates.length > 0) {
        var figures2 = new Array().concat(this.getFigures(overlay, coordinates, bounding, barSpace, precision, thousandsSeparator, decimalFoldThreshold, dateTimeFormat, defaultStyles, xAxis, yAxis));
        this.drawFigures(ctx, overlay, figures2, defaultStyles);
      }
      this.drawDefaultFigures(ctx, overlay, coordinates, bounding, precision, dateTimeFormat, customApi, thousandsSeparator, decimalFoldThreshold, defaultStyles, xAxis, yAxis, hoverInstanceInfo, clickInstanceInfo);
    };
    OverlayView2.prototype.drawFigures = function(ctx, overlay, figures2, defaultStyles) {
      var _this = this;
      figures2.forEach(function(figure, figureIndex) {
        var type = figure.type, styles2 = figure.styles, attrs = figure.attrs, ignoreEvent = figure.ignoreEvent;
        var attrsArray = [].concat(attrs);
        attrsArray.forEach(function(ats, attrsIndex) {
          var _a2, _b, _c2;
          var events = _this._createFigureEvents(overlay, 2, (_a2 = figure.key) !== null && _a2 !== void 0 ? _a2 : "", figureIndex, attrsIndex, ignoreEvent);
          var ss2 = __assign(__assign(__assign({}, defaultStyles[type]), (_b = overlay.styles) === null || _b === void 0 ? void 0 : _b[type]), styles2);
          (_c2 = _this.createFigure({
            name: type,
            attrs: ats,
            styles: ss2
          }, events)) === null || _c2 === void 0 ? void 0 : _c2.draw(ctx);
        });
      });
    };
    OverlayView2.prototype.getCompleteOverlays = function(overlayStore, paneId) {
      return overlayStore.getInstances(paneId);
    };
    OverlayView2.prototype.getProgressOverlay = function(info, paneId) {
      if (info.paneId === paneId) {
        return info.instance;
      }
      return null;
    };
    OverlayView2.prototype.getFigures = function(overlay, coordinates, bounding, barSpace, precision, thousandsSeparator, decimalFoldThreshold, dateTimeFormat, defaultStyles, xAxis, yAxis) {
      var _a2, _b;
      return (_b = (_a2 = overlay.createPointFigures) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, { overlay, coordinates, bounding, barSpace, precision, thousandsSeparator, decimalFoldThreshold, dateTimeFormat, defaultStyles, xAxis, yAxis })) !== null && _b !== void 0 ? _b : [];
    };
    OverlayView2.prototype.drawDefaultFigures = function(ctx, overlay, coordinates, _bounding, _precision, _dateTimeFormat, _customApi, _thousandsSeparator, _drawDefaultFigures, defaultStyles, _xAxis, _yAxis, hoverInstanceInfo, clickInstanceInfo) {
      var _this = this;
      var _a2, _b;
      if (overlay.needDefaultPointFigure) {
        if (((_a2 = hoverInstanceInfo.instance) === null || _a2 === void 0 ? void 0 : _a2.id) === overlay.id && hoverInstanceInfo.figureType !== 0 || ((_b = clickInstanceInfo.instance) === null || _b === void 0 ? void 0 : _b.id) === overlay.id && clickInstanceInfo.figureType !== 0) {
          var styles2 = overlay.styles;
          var pointStyles_1 = __assign(__assign({}, defaultStyles.point), styles2 === null || styles2 === void 0 ? void 0 : styles2.point);
          coordinates.forEach(function(_a3, index) {
            var _b2, _c2, _d;
            var x = _a3.x, y = _a3.y;
            var radius = pointStyles_1.radius;
            var color = pointStyles_1.color;
            var borderColor = pointStyles_1.borderColor;
            var borderSize = pointStyles_1.borderSize;
            if (((_b2 = hoverInstanceInfo.instance) === null || _b2 === void 0 ? void 0 : _b2.id) === overlay.id && hoverInstanceInfo.figureType === 1 && hoverInstanceInfo.figureIndex === index) {
              radius = pointStyles_1.activeRadius;
              color = pointStyles_1.activeColor;
              borderColor = pointStyles_1.activeBorderColor;
              borderSize = pointStyles_1.activeBorderSize;
            }
            (_c2 = _this.createFigure({
              name: "circle",
              attrs: { x, y, r: radius + borderSize },
              styles: { color: borderColor }
            }, _this._createFigureEvents(overlay, 1, "".concat(OVERLAY_FIGURE_KEY_PREFIX, "point_").concat(index), index, 0))) === null || _c2 === void 0 ? void 0 : _c2.draw(ctx);
            (_d = _this.createFigure({
              name: "circle",
              attrs: { x, y, r: radius },
              styles: { color }
            })) === null || _d === void 0 ? void 0 : _d.draw(ctx);
          });
        }
      }
    };
    return OverlayView2;
  }(View)
);
var IndicatorWidget = (
  /** @class */
  function(_super) {
    __extends(IndicatorWidget2, _super);
    function IndicatorWidget2(rootContainer, pane) {
      var _this = _super.call(this, rootContainer, pane) || this;
      _this._gridView = new GridView(_this);
      _this._indicatorView = new IndicatorView(_this);
      _this._crosshairLineView = new CrosshairLineView(_this);
      _this._tooltipView = _this.createTooltipView();
      _this._overlayView = new OverlayView(_this);
      _this.addChild(_this._tooltipView);
      _this.addChild(_this._overlayView);
      _this.getContainer().style.cursor = "crosshair";
      _this.registerEvent("mouseMoveEvent", function() {
        pane.getChart().getChartStore().getTooltipStore().setActiveIcon();
        return false;
      });
      return _this;
    }
    IndicatorWidget2.prototype.getName = function() {
      return WidgetNameConstants.MAIN;
    };
    IndicatorWidget2.prototype.updateMain = function(ctx) {
      this.updateMainContent(ctx);
      this._indicatorView.draw(ctx);
      this._gridView.draw(ctx);
    };
    IndicatorWidget2.prototype.createTooltipView = function() {
      return new IndicatorTooltipView(this);
    };
    IndicatorWidget2.prototype.updateMainContent = function(_ctx) {
    };
    IndicatorWidget2.prototype.updateOverlay = function(ctx) {
      this._overlayView.draw(ctx);
      this._crosshairLineView.draw(ctx);
      this._tooltipView.draw(ctx);
    };
    return IndicatorWidget2;
  }(DrawWidget)
);
var CandleAreaView = (
  /** @class */
  function(_super) {
    __extends(CandleAreaView2, _super);
    function CandleAreaView2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this._ripplePoint = _this.createFigure({
        name: "circle",
        attrs: {
          x: 0,
          y: 0,
          r: 0
        },
        styles: {
          style: "fill"
        }
      });
      _this._animationFrameTime = 0;
      _this._animation = new Animation({ iterationCount: Infinity }).doFrame(function(time) {
        _this._animationFrameTime = time;
        var pane = _this.getWidget().getPane();
        pane.getChart().updatePane(0, pane.getId());
      });
      return _this;
    }
    CandleAreaView2.prototype.drawImp = function(ctx) {
      var _a2, _b, _c2;
      var widget = this.getWidget();
      var pane = widget.getPane();
      var chart = pane.getChart();
      var dataList = chart.getDataList();
      var lastDataIndex = dataList.length - 1;
      var bounding = widget.getBounding();
      var yAxis = pane.getAxisComponent();
      var styles2 = chart.getStyles().candle.area;
      var coordinates = [];
      var minY = Number.MAX_SAFE_INTEGER;
      var areaStartX = Number.MIN_SAFE_INTEGER;
      var ripplePointCoordinate = null;
      this.eachChildren(function(data) {
        var kLineData = data.data, x = data.x;
        var value = kLineData === null || kLineData === void 0 ? void 0 : kLineData[styles2.value];
        if (isNumber(value)) {
          var y = yAxis.convertToPixel(value);
          if (areaStartX === Number.MIN_SAFE_INTEGER) {
            areaStartX = x;
          }
          coordinates.push({ x, y });
          minY = Math.min(minY, y);
          if (data.dataIndex === lastDataIndex) {
            ripplePointCoordinate = { x, y };
          }
        }
      });
      if (coordinates.length > 0) {
        (_a2 = this.createFigure({
          name: "line",
          attrs: { coordinates },
          styles: {
            color: styles2.lineColor,
            size: styles2.lineSize,
            smooth: styles2.smooth
          }
        })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
        var backgroundColor = styles2.backgroundColor;
        var color = void 0;
        if (isArray(backgroundColor)) {
          var gradient_1 = ctx.createLinearGradient(0, bounding.height, 0, minY);
          try {
            backgroundColor.forEach(function(_a3) {
              var offset = _a3.offset, color2 = _a3.color;
              gradient_1.addColorStop(offset, color2);
            });
          } catch (e) {
          }
          color = gradient_1;
        } else {
          color = backgroundColor;
        }
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.moveTo(areaStartX, bounding.height);
        ctx.lineTo(coordinates[0].x, coordinates[0].y);
        lineTo(ctx, coordinates, styles2.smooth);
        ctx.lineTo(coordinates[coordinates.length - 1].x, bounding.height);
        ctx.closePath();
        ctx.fill();
      }
      var pointStyles = styles2.point;
      if (pointStyles.show && isValid(ripplePointCoordinate)) {
        (_b = this.createFigure({
          name: "circle",
          attrs: {
            x: ripplePointCoordinate.x,
            y: ripplePointCoordinate.y,
            r: pointStyles.radius
          },
          styles: {
            style: "fill",
            color: pointStyles.color
          }
        })) === null || _b === void 0 ? void 0 : _b.draw(ctx);
        var rippleRadius = pointStyles.rippleRadius;
        if (pointStyles.animation) {
          rippleRadius = pointStyles.radius + this._animationFrameTime / pointStyles.animationDuration * (pointStyles.rippleRadius - pointStyles.radius);
          this._animation.setDuration(pointStyles.animationDuration).start();
        }
        (_c2 = this._ripplePoint) === null || _c2 === void 0 ? void 0 : _c2.setAttrs({
          x: ripplePointCoordinate.x,
          y: ripplePointCoordinate.y,
          r: rippleRadius
        }).setStyles({ style: "fill", color: pointStyles.rippleColor }).draw(ctx);
      } else {
        this.stopAnimation();
      }
    };
    CandleAreaView2.prototype.stopAnimation = function() {
      this._animation.stop();
    };
    return CandleAreaView2;
  }(ChildrenView)
);
var CandleHighLowPriceView = (
  /** @class */
  function(_super) {
    __extends(CandleHighLowPriceView2, _super);
    function CandleHighLowPriceView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CandleHighLowPriceView2.prototype.drawImp = function(ctx) {
      var widget = this.getWidget();
      var pane = widget.getPane();
      var chartStore = pane.getChart().getChartStore();
      var priceMarkStyles = chartStore.getStyles().candle.priceMark;
      var highPriceMarkStyles = priceMarkStyles.high;
      var lowPriceMarkStyles = priceMarkStyles.low;
      if (priceMarkStyles.show && (highPriceMarkStyles.show || lowPriceMarkStyles.show)) {
        var thousandsSeparator = chartStore.getThousandsSeparator();
        var decimalFoldThreshold = chartStore.getDecimalFoldThreshold();
        var precision = chartStore.getPrecision();
        var yAxis = pane.getAxisComponent();
        var high_1 = Number.MIN_SAFE_INTEGER;
        var highX_1 = 0;
        var low_1 = Number.MAX_SAFE_INTEGER;
        var lowX_1 = 0;
        this.eachChildren(function(data) {
          var kLineData = data.data, x = data.x;
          if (isValid(kLineData)) {
            if (high_1 < kLineData.high) {
              high_1 = kLineData.high;
              highX_1 = x;
            }
            if (low_1 > kLineData.low) {
              low_1 = kLineData.low;
              lowX_1 = x;
            }
          }
        });
        var highY = yAxis.convertToPixel(high_1);
        var lowY = yAxis.convertToPixel(low_1);
        if (highPriceMarkStyles.show && high_1 !== Number.MIN_SAFE_INTEGER) {
          this._drawMark(ctx, formatFoldDecimal(formatThousands(formatPrecision(high_1, precision.price), thousandsSeparator), decimalFoldThreshold), { x: highX_1, y: highY }, highY < lowY ? [-2, -5] : [2, 5], highPriceMarkStyles);
        }
        if (lowPriceMarkStyles.show && low_1 !== Number.MAX_SAFE_INTEGER) {
          this._drawMark(ctx, formatFoldDecimal(formatThousands(formatPrecision(low_1, precision.price), thousandsSeparator), decimalFoldThreshold), { x: lowX_1, y: lowY }, highY < lowY ? [2, 5] : [-2, -5], lowPriceMarkStyles);
        }
      }
    };
    CandleHighLowPriceView2.prototype._drawMark = function(ctx, text2, coordinate, offsets, styles2) {
      var _a2, _b, _c2;
      var startX = coordinate.x;
      var startY = coordinate.y + offsets[0];
      (_a2 = this.createFigure({
        name: "line",
        attrs: {
          coordinates: [
            { x: startX - 2, y: startY + offsets[0] },
            { x: startX, y: startY },
            { x: startX + 2, y: startY + offsets[0] }
          ]
        },
        styles: { color: styles2.color }
      })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
      var lineEndX;
      var textStartX;
      var textAlign;
      var width = this.getWidget().getBounding().width;
      if (startX > width / 2) {
        lineEndX = startX - 5;
        textStartX = lineEndX - styles2.textOffset;
        textAlign = "right";
      } else {
        lineEndX = startX + 5;
        textAlign = "left";
        textStartX = lineEndX + styles2.textOffset;
      }
      var y = startY + offsets[1];
      (_b = this.createFigure({
        name: "line",
        attrs: {
          coordinates: [
            { x: startX, y: startY },
            { x: startX, y },
            { x: lineEndX, y }
          ]
        },
        styles: { color: styles2.color }
      })) === null || _b === void 0 ? void 0 : _b.draw(ctx);
      (_c2 = this.createFigure({
        name: "text",
        attrs: {
          x: textStartX,
          y,
          text: text2,
          align: textAlign,
          baseline: "middle"
        },
        styles: {
          color: styles2.color,
          size: styles2.textSize,
          family: styles2.textFamily,
          weight: styles2.textWeight
        }
      })) === null || _c2 === void 0 ? void 0 : _c2.draw(ctx);
    };
    return CandleHighLowPriceView2;
  }(ChildrenView)
);
var CandleLastPriceView = (
  /** @class */
  function(_super) {
    __extends(CandleLastPriceView2, _super);
    function CandleLastPriceView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CandleLastPriceView2.prototype.drawImp = function(ctx) {
      var _a2;
      var widget = this.getWidget();
      var pane = widget.getPane();
      var bounding = widget.getBounding();
      var chartStore = pane.getChart().getChartStore();
      var priceMarkStyles = chartStore.getStyles().candle.priceMark;
      var lastPriceMarkStyles = priceMarkStyles.last;
      var lastPriceMarkLineStyles = lastPriceMarkStyles.line;
      if (priceMarkStyles.show && lastPriceMarkStyles.show && lastPriceMarkLineStyles.show) {
        var yAxis = pane.getAxisComponent();
        var dataList = chartStore.getDataList();
        var data = dataList[dataList.length - 1];
        if (data != null) {
          var close_1 = data.close, open_1 = data.open;
          var priceY = yAxis.convertToNicePixel(close_1);
          var color = void 0;
          if (close_1 > open_1) {
            color = lastPriceMarkStyles.upColor;
          } else if (close_1 < open_1) {
            color = lastPriceMarkStyles.downColor;
          } else {
            color = lastPriceMarkStyles.noChangeColor;
          }
          (_a2 = this.createFigure({
            name: "line",
            attrs: {
              coordinates: [
                { x: 0, y: priceY },
                { x: bounding.width, y: priceY }
              ]
            },
            styles: {
              style: lastPriceMarkLineStyles.style,
              color,
              size: lastPriceMarkLineStyles.size,
              dashedValue: lastPriceMarkLineStyles.dashedValue
            }
          })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
        }
      }
    };
    return CandleLastPriceView2;
  }(View)
);
var zhCN = {
  time: "时间：",
  open: "开：",
  high: "高：",
  low: "低：",
  close: "收：",
  volume: "成交量：",
  turnover: "成交额：",
  change: "涨幅："
};
var enUS = {
  time: "Time: ",
  open: "Open: ",
  high: "High: ",
  low: "Low: ",
  close: "Close: ",
  volume: "Volume: ",
  turnover: "Turnover: ",
  change: "Change: "
};
var locales = {
  "zh-CN": zhCN,
  "en-US": enUS
};
function i18n(key, locale) {
  var _a2, _b;
  return (_b = (_a2 = locales[locale]) === null || _a2 === void 0 ? void 0 : _a2[key]) !== null && _b !== void 0 ? _b : key;
}
var CandleTooltipView = (
  /** @class */
  function(_super) {
    __extends(CandleTooltipView2, _super);
    function CandleTooltipView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CandleTooltipView2.prototype.drawImp = function(ctx) {
      var widget = this.getWidget();
      var pane = widget.getPane();
      var paneId = pane.getId();
      var chartStore = pane.getChart().getChartStore();
      var crosshair = chartStore.getTooltipStore().getCrosshair();
      if (isValid(crosshair.kLineData)) {
        var bounding = widget.getBounding();
        var yAxisBounding = pane.getYAxisWidget().getBounding();
        var dataList = chartStore.getDataList();
        var precision = chartStore.getPrecision();
        var locale = chartStore.getLocale();
        var customApi = chartStore.getCustomApi();
        var thousandsSeparator = chartStore.getThousandsSeparator();
        var decimalFoldThreshold = chartStore.getDecimalFoldThreshold();
        var activeIcon = chartStore.getTooltipStore().getActiveIcon();
        var indicators2 = chartStore.getIndicatorStore().getInstances(pane.getId());
        var dateTimeFormat = chartStore.getTimeScaleStore().getDateTimeFormat();
        var styles2 = chartStore.getStyles();
        var candleStyles = styles2.candle;
        var indicatorStyles = styles2.indicator;
        if (candleStyles.tooltip.showType === TooltipShowType.Rect && indicatorStyles.tooltip.showType === TooltipShowType.Rect) {
          var isDrawCandleTooltip = this.isDrawTooltip(crosshair, candleStyles.tooltip);
          var isDrawIndicatorTooltip = this.isDrawTooltip(crosshair, indicatorStyles.tooltip);
          this._drawRectTooltip(ctx, dataList, indicators2, bounding, yAxisBounding, crosshair, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, isDrawCandleTooltip, isDrawIndicatorTooltip, candleStyles.tooltip.offsetTop, styles2);
        } else if (candleStyles.tooltip.showType === TooltipShowType.Standard && indicatorStyles.tooltip.showType === TooltipShowType.Standard) {
          var _a2 = candleStyles.tooltip, offsetLeft = _a2.offsetLeft, offsetTop = _a2.offsetTop, offsetRight = _a2.offsetRight;
          var maxWidth = bounding.width - offsetRight;
          var top_1 = this._drawCandleStandardTooltip(ctx, dataList, paneId, crosshair, activeIcon, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, offsetLeft, offsetTop, maxWidth, candleStyles);
          this.drawIndicatorTooltip(ctx, paneId, dataList, crosshair, activeIcon, indicators2, customApi, thousandsSeparator, decimalFoldThreshold, offsetLeft, top_1, maxWidth, indicatorStyles);
        } else if (candleStyles.tooltip.showType === TooltipShowType.Rect && indicatorStyles.tooltip.showType === TooltipShowType.Standard) {
          var _b = candleStyles.tooltip, offsetLeft = _b.offsetLeft, offsetTop = _b.offsetTop, offsetRight = _b.offsetRight;
          var maxWidth = bounding.width - offsetRight;
          var top_2 = this.drawIndicatorTooltip(ctx, paneId, dataList, crosshair, activeIcon, indicators2, customApi, thousandsSeparator, decimalFoldThreshold, offsetLeft, offsetTop, maxWidth, indicatorStyles);
          var isDrawCandleTooltip = this.isDrawTooltip(crosshair, candleStyles.tooltip);
          this._drawRectTooltip(ctx, dataList, indicators2, bounding, yAxisBounding, crosshair, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, isDrawCandleTooltip, false, top_2, styles2);
        } else {
          var _c2 = candleStyles.tooltip, offsetLeft = _c2.offsetLeft, offsetTop = _c2.offsetTop, offsetRight = _c2.offsetRight;
          var maxWidth = bounding.width - offsetRight;
          var top_3 = this._drawCandleStandardTooltip(ctx, dataList, paneId, crosshair, activeIcon, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, offsetLeft, offsetTop, maxWidth, candleStyles);
          var isDrawIndicatorTooltip = this.isDrawTooltip(crosshair, indicatorStyles.tooltip);
          this._drawRectTooltip(ctx, dataList, indicators2, bounding, yAxisBounding, crosshair, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, false, isDrawIndicatorTooltip, top_3, styles2);
        }
      }
    };
    CandleTooltipView2.prototype._drawCandleStandardTooltip = function(ctx, dataList, paneId, crosshair, activeTooltipIcon, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, left, top, maxWidth, styles2) {
      var _a2, _b, _c2;
      var tooltipStyles = styles2.tooltip;
      var tooltipTextStyles = tooltipStyles.text;
      var prevRowHeight = 0;
      var coordinate = { x: left, y: top };
      if (this.isDrawTooltip(crosshair, tooltipStyles)) {
        var dataIndex = (_a2 = crosshair.dataIndex) !== null && _a2 !== void 0 ? _a2 : 0;
        var legends = this._getCandleTooltipLegends({ prev: (_b = dataList[dataIndex - 1]) !== null && _b !== void 0 ? _b : null, current: crosshair.kLineData, next: (_c2 = dataList[dataIndex + 1]) !== null && _c2 !== void 0 ? _c2 : null }, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, styles2);
        var _d = __read(this.classifyTooltipIcons(tooltipStyles.icons), 3), leftIcons = _d[0], middleIcons = _d[1], rightIcons = _d[2];
        prevRowHeight = this.drawStandardTooltipIcons(ctx, activeTooltipIcon, leftIcons, coordinate, paneId, "", left, prevRowHeight, maxWidth);
        prevRowHeight = this.drawStandardTooltipIcons(ctx, activeTooltipIcon, middleIcons, coordinate, paneId, "", left, prevRowHeight, maxWidth);
        if (legends.length > 0) {
          prevRowHeight = this.drawStandardTooltipLegends(ctx, legends, coordinate, left, prevRowHeight, maxWidth, tooltipTextStyles);
        }
        prevRowHeight = this.drawStandardTooltipIcons(ctx, activeTooltipIcon, rightIcons, coordinate, paneId, "", left, prevRowHeight, maxWidth);
      }
      return coordinate.y + prevRowHeight;
    };
    CandleTooltipView2.prototype._drawRectTooltip = function(ctx, dataList, indicators2, bounding, yAxisBounding, crosshair, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, isDrawCandleTooltip, isDrawIndicatorTooltip, top, styles2) {
      var _this = this;
      var _a2, _b, _c2, _d, _e2;
      var candleStyles = styles2.candle;
      var indicatorStyles = styles2.indicator;
      var candleTooltipStyles = candleStyles.tooltip;
      var indicatorTooltipStyles = indicatorStyles.tooltip;
      if (isDrawCandleTooltip || isDrawIndicatorTooltip) {
        var dataIndex = (_a2 = crosshair.dataIndex) !== null && _a2 !== void 0 ? _a2 : 0;
        var candleLegends = this._getCandleTooltipLegends({ prev: (_b = dataList[dataIndex - 1]) !== null && _b !== void 0 ? _b : null, current: crosshair.kLineData, next: (_c2 = dataList[dataIndex + 1]) !== null && _c2 !== void 0 ? _c2 : null }, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, candleStyles);
        var offsetLeft = candleTooltipStyles.offsetLeft, offsetTop = candleTooltipStyles.offsetTop, offsetRight = candleTooltipStyles.offsetRight, offsetBottom = candleTooltipStyles.offsetBottom;
        var _f = candleTooltipStyles.text, baseTextMarginLeft_1 = _f.marginLeft, baseTextMarginRight_1 = _f.marginRight, baseTextMarginTop_1 = _f.marginTop, baseTextMarginBottom_1 = _f.marginBottom, baseTextSize_1 = _f.size, baseTextWeight_1 = _f.weight, baseTextFamily_1 = _f.family;
        var _g = candleTooltipStyles.rect, rectPosition = _g.position, rectPaddingLeft = _g.paddingLeft, rectPaddingRight_1 = _g.paddingRight, rectPaddingTop = _g.paddingTop, rectPaddingBottom = _g.paddingBottom, rectOffsetLeft = _g.offsetLeft, rectOffsetRight = _g.offsetRight, rectOffsetTop = _g.offsetTop, rectOffsetBottom = _g.offsetBottom, rectBorderSize_1 = _g.borderSize, rectBorderRadius = _g.borderRadius, rectBorderColor = _g.borderColor, rectBackgroundColor = _g.color;
        var maxTextWidth_1 = 0;
        var rectWidth_1 = 0;
        var rectHeight_1 = 0;
        if (isDrawCandleTooltip) {
          ctx.font = createFont(baseTextSize_1, baseTextWeight_1, baseTextFamily_1);
          candleLegends.forEach(function(data) {
            var title = data.title;
            var value = data.value;
            var text2 = "".concat(title.text).concat(value.text);
            var labelWidth = ctx.measureText(text2).width + baseTextMarginLeft_1 + baseTextMarginRight_1;
            maxTextWidth_1 = Math.max(maxTextWidth_1, labelWidth);
          });
          rectHeight_1 += (baseTextMarginBottom_1 + baseTextMarginTop_1 + baseTextSize_1) * candleLegends.length;
        }
        var _h = indicatorTooltipStyles.text, indicatorTextMarginLeft_1 = _h.marginLeft, indicatorTextMarginRight_1 = _h.marginRight, indicatorTextMarginTop_1 = _h.marginTop, indicatorTextMarginBottom_1 = _h.marginBottom, indicatorTextSize_1 = _h.size, indicatorTextWeight_1 = _h.weight, indicatorTextFamily_1 = _h.family;
        var indicatorLegendsArray_1 = [];
        if (isDrawIndicatorTooltip) {
          ctx.font = createFont(indicatorTextSize_1, indicatorTextWeight_1, indicatorTextFamily_1);
          indicators2.forEach(function(indicator) {
            var _a3;
            var tooltipDataValues = (_a3 = _this.getIndicatorTooltipData(dataList, crosshair, indicator, customApi, thousandsSeparator, decimalFoldThreshold, indicatorStyles).values) !== null && _a3 !== void 0 ? _a3 : [];
            indicatorLegendsArray_1.push(tooltipDataValues);
            tooltipDataValues.forEach(function(data) {
              var title = data.title;
              var value = data.value;
              var text2 = "".concat(title.text).concat(value.text);
              var textWidth = ctx.measureText(text2).width + indicatorTextMarginLeft_1 + indicatorTextMarginRight_1;
              maxTextWidth_1 = Math.max(maxTextWidth_1, textWidth);
              rectHeight_1 += indicatorTextMarginTop_1 + indicatorTextMarginBottom_1 + indicatorTextSize_1;
            });
          });
        }
        rectWidth_1 += maxTextWidth_1;
        if (rectWidth_1 !== 0 && rectHeight_1 !== 0) {
          rectWidth_1 += rectBorderSize_1 * 2 + rectPaddingLeft + rectPaddingRight_1;
          rectHeight_1 += rectBorderSize_1 * 2 + rectPaddingTop + rectPaddingBottom;
          var centerX = bounding.width / 2;
          var isPointer = rectPosition === CandleTooltipRectPosition.Pointer && crosshair.paneId === PaneIdConstants.CANDLE;
          var isLeft = ((_d = crosshair.realX) !== null && _d !== void 0 ? _d : 0) > centerX;
          var rectX_1 = 0;
          if (isPointer) {
            var realX = crosshair.realX;
            if (isLeft) {
              rectX_1 = realX - rectOffsetRight - rectWidth_1;
            } else {
              rectX_1 = realX + rectOffsetLeft;
            }
          } else {
            if (isLeft) {
              rectX_1 = rectOffsetLeft + offsetLeft;
              if (styles2.yAxis.inside && styles2.yAxis.position === YAxisPosition.Left) {
                rectX_1 += yAxisBounding.width;
              }
            } else {
              rectX_1 = bounding.width - rectOffsetRight - rectWidth_1 - offsetRight;
              if (styles2.yAxis.inside && styles2.yAxis.position === YAxisPosition.Right) {
                rectX_1 -= yAxisBounding.width;
              }
            }
          }
          var rectY = top + rectOffsetTop;
          if (isPointer) {
            var y = crosshair.y;
            rectY = y - rectHeight_1 / 2;
            if (rectY + rectHeight_1 > bounding.height - rectOffsetBottom - offsetBottom) {
              rectY = bounding.height - rectOffsetBottom - rectHeight_1 - offsetBottom;
            }
            if (rectY < top + rectOffsetTop) {
              rectY = top + rectOffsetTop + offsetTop;
            }
          }
          (_e2 = this.createFigure({
            name: "rect",
            attrs: {
              x: rectX_1,
              y: rectY,
              width: rectWidth_1,
              height: rectHeight_1
            },
            styles: {
              style: PolygonType.StrokeFill,
              color: rectBackgroundColor,
              borderColor: rectBorderColor,
              borderSize: rectBorderSize_1,
              borderRadius: rectBorderRadius
            }
          })) === null || _e2 === void 0 ? void 0 : _e2.draw(ctx);
          var candleTextX_1 = rectX_1 + rectBorderSize_1 + rectPaddingLeft + baseTextMarginLeft_1;
          var textY_1 = rectY + rectBorderSize_1 + rectPaddingTop;
          if (isDrawCandleTooltip) {
            candleLegends.forEach(function(data) {
              var _a3, _b2;
              textY_1 += baseTextMarginTop_1;
              var title = data.title;
              (_a3 = _this.createFigure({
                name: "text",
                attrs: {
                  x: candleTextX_1,
                  y: textY_1,
                  text: title.text
                },
                styles: {
                  color: title.color,
                  size: baseTextSize_1,
                  family: baseTextFamily_1,
                  weight: baseTextWeight_1
                }
              })) === null || _a3 === void 0 ? void 0 : _a3.draw(ctx);
              var value = data.value;
              (_b2 = _this.createFigure({
                name: "text",
                attrs: {
                  x: rectX_1 + rectWidth_1 - rectBorderSize_1 - baseTextMarginRight_1 - rectPaddingRight_1,
                  y: textY_1,
                  text: value.text,
                  align: "right"
                },
                styles: {
                  color: value.color,
                  size: baseTextSize_1,
                  family: baseTextFamily_1,
                  weight: baseTextWeight_1
                }
              })) === null || _b2 === void 0 ? void 0 : _b2.draw(ctx);
              textY_1 += baseTextSize_1 + baseTextMarginBottom_1;
            });
          }
          if (isDrawIndicatorTooltip) {
            var indicatorTextX_1 = rectX_1 + rectBorderSize_1 + rectPaddingLeft + indicatorTextMarginLeft_1;
            indicatorLegendsArray_1.forEach(function(legends) {
              legends.forEach(function(data) {
                var _a3, _b2;
                textY_1 += indicatorTextMarginTop_1;
                var title = data.title;
                var value = data.value;
                (_a3 = _this.createFigure({
                  name: "text",
                  attrs: {
                    x: indicatorTextX_1,
                    y: textY_1,
                    text: title.text
                  },
                  styles: {
                    color: title.color,
                    size: indicatorTextSize_1,
                    family: indicatorTextFamily_1,
                    weight: indicatorTextWeight_1
                  }
                })) === null || _a3 === void 0 ? void 0 : _a3.draw(ctx);
                (_b2 = _this.createFigure({
                  name: "text",
                  attrs: {
                    x: rectX_1 + rectWidth_1 - rectBorderSize_1 - indicatorTextMarginRight_1 - rectPaddingRight_1,
                    y: textY_1,
                    text: value.text,
                    align: "right"
                  },
                  styles: {
                    color: value.color,
                    size: indicatorTextSize_1,
                    family: indicatorTextFamily_1,
                    weight: indicatorTextWeight_1
                  }
                })) === null || _b2 === void 0 ? void 0 : _b2.draw(ctx);
                textY_1 += indicatorTextSize_1 + indicatorTextMarginBottom_1;
              });
            });
          }
        }
      }
    };
    CandleTooltipView2.prototype._getCandleTooltipLegends = function(data, precision, dateTimeFormat, locale, customApi, thousandsSeparator, decimalFoldThreshold, styles2) {
      var _a2, _b, _c2, _d, _e2;
      var tooltipStyles = styles2.tooltip;
      var textColor2 = tooltipStyles.text.color;
      var current = data.current;
      var prevClose = (_b = (_a2 = data.prev) === null || _a2 === void 0 ? void 0 : _a2.close) !== null && _b !== void 0 ? _b : current.close;
      var changeValue = current.close - prevClose;
      var pricePrecision = precision.price, volumePrecision = precision.volume;
      var mapping = {
        "{time}": customApi.formatDate(dateTimeFormat, current.timestamp, "YYYY-MM-DD HH:mm", FormatDateType.Tooltip),
        "{open}": formatFoldDecimal(formatThousands(formatPrecision(current.open, pricePrecision), thousandsSeparator), decimalFoldThreshold),
        "{high}": formatFoldDecimal(formatThousands(formatPrecision(current.high, pricePrecision), thousandsSeparator), decimalFoldThreshold),
        "{low}": formatFoldDecimal(formatThousands(formatPrecision(current.low, pricePrecision), thousandsSeparator), decimalFoldThreshold),
        "{close}": formatFoldDecimal(formatThousands(formatPrecision(current.close, pricePrecision), thousandsSeparator), decimalFoldThreshold),
        "{volume}": formatFoldDecimal(formatThousands(customApi.formatBigNumber(formatPrecision((_c2 = current.volume) !== null && _c2 !== void 0 ? _c2 : tooltipStyles.defaultValue, volumePrecision)), thousandsSeparator), decimalFoldThreshold),
        "{turnover}": formatFoldDecimal(formatThousands(formatPrecision((_d = current.turnover) !== null && _d !== void 0 ? _d : tooltipStyles.defaultValue, pricePrecision), thousandsSeparator), decimalFoldThreshold),
        "{change}": prevClose === 0 ? tooltipStyles.defaultValue : "".concat(formatThousands(formatPrecision(changeValue / prevClose * 100), thousandsSeparator), "%")
      };
      var legends = (_e2 = isFunction(tooltipStyles.custom) ? tooltipStyles.custom(data, styles2) : tooltipStyles.custom) !== null && _e2 !== void 0 ? _e2 : [];
      return legends.map(function(_a3) {
        var _b2;
        var title = _a3.title, value = _a3.value;
        var t = { text: "", color: "" };
        if (isObject(title)) {
          t = __assign({}, title);
        } else {
          t.text = title;
          t.color = textColor2;
        }
        t.text = i18n(t.text, locale);
        var v = { text: tooltipStyles.defaultValue, color: "" };
        if (isObject(value)) {
          v = __assign({}, value);
        } else {
          v.text = value;
          v.color = textColor2;
        }
        var match = v.text.match(/{(\S*)}/);
        if (match !== null && match.length > 1) {
          var key = "{".concat(match[1], "}");
          v.text = v.text.replace(key, (_b2 = mapping[key]) !== null && _b2 !== void 0 ? _b2 : tooltipStyles.defaultValue);
          if (key === "{change}") {
            v.color = changeValue === 0 ? styles2.priceMark.last.noChangeColor : changeValue > 0 ? styles2.priceMark.last.upColor : styles2.priceMark.last.downColor;
          }
        }
        return { title: t, value: v };
      });
    };
    return CandleTooltipView2;
  }(IndicatorTooltipView)
);
var CandleWidget = (
  /** @class */
  function(_super) {
    __extends(CandleWidget2, _super);
    function CandleWidget2(rootContainer, pane) {
      var _this = _super.call(this, rootContainer, pane) || this;
      _this._candleBarView = new CandleBarView(_this);
      _this._candleAreaView = new CandleAreaView(_this);
      _this._candleHighLowPriceView = new CandleHighLowPriceView(_this);
      _this._candleLastPriceLineView = new CandleLastPriceView(_this);
      _this.addChild(_this._candleBarView);
      return _this;
    }
    CandleWidget2.prototype.updateMainContent = function(ctx) {
      var candleStyles = this.getPane().getChart().getStyles().candle;
      if (candleStyles.type !== CandleType.Area) {
        this._candleBarView.draw(ctx);
        this._candleHighLowPriceView.draw(ctx);
        this._candleAreaView.stopAnimation();
      } else {
        this._candleAreaView.draw(ctx);
      }
      this._candleLastPriceLineView.draw(ctx);
    };
    CandleWidget2.prototype.createTooltipView = function() {
      return new CandleTooltipView(this);
    };
    return CandleWidget2;
  }(IndicatorWidget)
);
var AxisView = (
  /** @class */
  function(_super) {
    __extends(AxisView2, _super);
    function AxisView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    AxisView2.prototype.drawImp = function(ctx) {
      var _this = this;
      var _a2, _b;
      var widget = this.getWidget();
      var pane = widget.getPane();
      var bounding = widget.getBounding();
      var axis = pane.getAxisComponent();
      var styles2 = this.getAxisStyles(pane.getChart().getStyles());
      if (styles2.show) {
        if (styles2.axisLine.show) {
          (_a2 = this.createFigure({
            name: "line",
            attrs: this.createAxisLine(bounding, styles2),
            styles: styles2.axisLine
          })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
        }
        var ticks = axis.getTicks();
        if (styles2.tickLine.show) {
          var lines = this.createTickLines(ticks, bounding, styles2);
          lines.forEach(function(line2) {
            var _a3;
            (_a3 = _this.createFigure({
              name: "line",
              attrs: line2,
              styles: styles2.tickLine
            })) === null || _a3 === void 0 ? void 0 : _a3.draw(ctx);
          });
        }
        if (styles2.tickText.show) {
          var texts = this.createTickTexts(ticks, bounding, styles2);
          (_b = this.createFigure({
            name: "text",
            attrs: texts,
            styles: styles2.tickText
          })) === null || _b === void 0 ? void 0 : _b.draw(ctx);
        }
      }
    };
    return AxisView2;
  }(View)
);
var YAxisView = (
  /** @class */
  function(_super) {
    __extends(YAxisView2, _super);
    function YAxisView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    YAxisView2.prototype.getAxisStyles = function(styles2) {
      return styles2.yAxis;
    };
    YAxisView2.prototype.createAxisLine = function(bounding, styles2) {
      var yAxis = this.getWidget().getPane().getAxisComponent();
      var size = styles2.axisLine.size;
      var x;
      if (yAxis.isFromZero()) {
        x = 0;
      } else {
        x = bounding.width - size;
      }
      return {
        coordinates: [
          { x, y: 0 },
          { x, y: bounding.height }
        ]
      };
    };
    YAxisView2.prototype.createTickLines = function(ticks, bounding, styles2) {
      var yAxis = this.getWidget().getPane().getAxisComponent();
      var axisLineStyles = styles2.axisLine;
      var tickLineStyles = styles2.tickLine;
      var startX = 0;
      var endX = 0;
      if (yAxis.isFromZero()) {
        startX = 0;
        if (axisLineStyles.show) {
          startX += axisLineStyles.size;
        }
        endX = startX + tickLineStyles.length;
      } else {
        startX = bounding.width;
        if (axisLineStyles.show) {
          startX -= axisLineStyles.size;
        }
        endX = startX - tickLineStyles.length;
      }
      return ticks.map(function(tick) {
        return {
          coordinates: [
            { x: startX, y: tick.coord },
            { x: endX, y: tick.coord }
          ]
        };
      });
    };
    YAxisView2.prototype.createTickTexts = function(ticks, bounding, styles2) {
      var yAxis = this.getWidget().getPane().getAxisComponent();
      var axisLineStyles = styles2.axisLine;
      var tickLineStyles = styles2.tickLine;
      var tickTextStyles = styles2.tickText;
      var x = 0;
      if (yAxis.isFromZero()) {
        x = tickTextStyles.marginStart;
        if (axisLineStyles.show) {
          x += axisLineStyles.size;
        }
        if (tickLineStyles.show) {
          x += tickLineStyles.length;
        }
      } else {
        x = bounding.width - tickTextStyles.marginEnd;
        if (axisLineStyles.show) {
          x -= axisLineStyles.size;
        }
        if (tickLineStyles.show) {
          x -= tickLineStyles.length;
        }
      }
      var textAlign = this.getWidget().getPane().getAxisComponent().isFromZero() ? "left" : "right";
      return ticks.map(function(tick) {
        return {
          x,
          y: tick.coord,
          text: tick.text,
          align: textAlign,
          baseline: "middle"
        };
      });
    };
    return YAxisView2;
  }(AxisView)
);
var CandleLastPriceLabelView = (
  /** @class */
  function(_super) {
    __extends(CandleLastPriceLabelView2, _super);
    function CandleLastPriceLabelView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CandleLastPriceLabelView2.prototype.drawImp = function(ctx) {
      var _a2;
      var widget = this.getWidget();
      var pane = widget.getPane();
      var bounding = widget.getBounding();
      var chartStore = pane.getChart().getChartStore();
      var priceMarkStyles = chartStore.getStyles().candle.priceMark;
      var lastPriceMarkStyles = priceMarkStyles.last;
      var lastPriceMarkTextStyles = lastPriceMarkStyles.text;
      if (priceMarkStyles.show && lastPriceMarkStyles.show && lastPriceMarkTextStyles.show) {
        var precision = chartStore.getPrecision();
        var yAxis = pane.getAxisComponent();
        var dataList = chartStore.getDataList();
        var data = dataList[dataList.length - 1];
        if (isValid(data)) {
          var close_1 = data.close, open_1 = data.open;
          var priceY = yAxis.convertToNicePixel(close_1);
          var backgroundColor = void 0;
          if (close_1 > open_1) {
            backgroundColor = lastPriceMarkStyles.upColor;
          } else if (close_1 < open_1) {
            backgroundColor = lastPriceMarkStyles.downColor;
          } else {
            backgroundColor = lastPriceMarkStyles.noChangeColor;
          }
          var text2 = void 0;
          if (yAxis.getType() === YAxisType.Percentage) {
            var fromData = chartStore.getVisibleFirstData();
            var fromClose = fromData.close;
            text2 = "".concat(((close_1 - fromClose) / fromClose * 100).toFixed(2), "%");
          } else {
            text2 = formatPrecision(close_1, precision.price);
          }
          text2 = formatFoldDecimal(formatThousands(text2, chartStore.getThousandsSeparator()), chartStore.getDecimalFoldThreshold());
          var x = void 0;
          var textAlgin = void 0;
          if (yAxis.isFromZero()) {
            x = 0;
            textAlgin = "left";
          } else {
            x = bounding.width;
            textAlgin = "right";
          }
          (_a2 = this.createFigure({
            name: "text",
            attrs: {
              x,
              y: priceY,
              text: text2,
              align: textAlgin,
              baseline: "middle"
            },
            styles: __assign(__assign({}, lastPriceMarkTextStyles), { backgroundColor })
          })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
        }
      }
    };
    return CandleLastPriceLabelView2;
  }(View)
);
var IndicatorLastValueView = (
  /** @class */
  function(_super) {
    __extends(IndicatorLastValueView2, _super);
    function IndicatorLastValueView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    IndicatorLastValueView2.prototype.drawImp = function(ctx) {
      var _this = this;
      var widget = this.getWidget();
      var pane = widget.getPane();
      var bounding = widget.getBounding();
      var chartStore = pane.getChart().getChartStore();
      var customApi = chartStore.getCustomApi();
      var defaultStyles = chartStore.getStyles().indicator;
      var lastValueMarkStyles = defaultStyles.lastValueMark;
      var lastValueMarkTextStyles = lastValueMarkStyles.text;
      if (lastValueMarkStyles.show) {
        var yAxis_1 = pane.getAxisComponent();
        var dataList_1 = chartStore.getDataList();
        var dataIndex_1 = dataList_1.length - 1;
        var indicators2 = chartStore.getIndicatorStore().getInstances(pane.getId());
        var thousandsSeparator_1 = chartStore.getThousandsSeparator();
        var decimalFoldThreshold_1 = chartStore.getDecimalFoldThreshold();
        indicators2.forEach(function(indicator) {
          var result = indicator.result;
          var indicatorData = result[dataIndex_1];
          if (isValid(indicatorData) && indicator.visible) {
            var precision_1 = indicator.precision;
            eachFigures(dataList_1, indicator, dataIndex_1, defaultStyles, function(figure, figureStyles) {
              var _a2;
              var value = indicatorData[figure.key];
              if (isNumber(value)) {
                var y = yAxis_1.convertToNicePixel(value);
                var text2 = formatPrecision(value, precision_1);
                if (indicator.shouldFormatBigNumber) {
                  text2 = customApi.formatBigNumber(text2);
                }
                text2 = formatFoldDecimal(formatThousands(text2, thousandsSeparator_1), decimalFoldThreshold_1);
                var x = void 0;
                var textAlign = void 0;
                if (yAxis_1.isFromZero()) {
                  x = 0;
                  textAlign = "left";
                } else {
                  x = bounding.width;
                  textAlign = "right";
                }
                (_a2 = _this.createFigure({
                  name: "text",
                  attrs: {
                    x,
                    y,
                    text: text2,
                    align: textAlign,
                    baseline: "middle"
                  },
                  styles: __assign(__assign({}, lastValueMarkTextStyles), { backgroundColor: figureStyles.color })
                })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
              }
            });
          }
        });
      }
    };
    return IndicatorLastValueView2;
  }(View)
);
var OverlayYAxisView = (
  /** @class */
  function(_super) {
    __extends(OverlayYAxisView2, _super);
    function OverlayYAxisView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    OverlayYAxisView2.prototype.coordinateToPointTimestampDataIndexFlag = function() {
      return false;
    };
    OverlayYAxisView2.prototype.drawDefaultFigures = function(ctx, overlay, coordinates, bounding, precision, dateTimeFormat, customApi, thousandsSeparator, decimalFoldThreshold, defaultStyles, xAxis, yAxis, _hoverInstanceInfo, clickInstanceInfo) {
      this.drawFigures(ctx, overlay, this.getDefaultFigures(overlay, coordinates, bounding, precision, dateTimeFormat, customApi, thousandsSeparator, decimalFoldThreshold, xAxis, yAxis, clickInstanceInfo), defaultStyles);
    };
    OverlayYAxisView2.prototype.getDefaultFigures = function(overlay, coordinates, bounding, precision, _dateTimeFormat, _customApi, thousandsSeparator, decimalFoldThreshold, _xAxis, yAxis, clickInstanceInfo) {
      var _a2, _b;
      var figures2 = [];
      if (overlay.needDefaultYAxisFigure && overlay.id === ((_a2 = clickInstanceInfo.instance) === null || _a2 === void 0 ? void 0 : _a2.id) && clickInstanceInfo.paneId === this.getWidget().getPane().getId()) {
        var topY_1 = Number.MAX_SAFE_INTEGER;
        var bottomY_1 = Number.MIN_SAFE_INTEGER;
        var isFromZero = (_b = yAxis === null || yAxis === void 0 ? void 0 : yAxis.isFromZero()) !== null && _b !== void 0 ? _b : false;
        var textAlign_1;
        var x_1;
        if (isFromZero) {
          textAlign_1 = "left";
          x_1 = 0;
        } else {
          textAlign_1 = "right";
          x_1 = bounding.width;
        }
        coordinates.forEach(function(coordinate, index) {
          var point = overlay.points[index];
          if (isNumber(point.value)) {
            topY_1 = Math.min(topY_1, coordinate.y);
            bottomY_1 = Math.max(bottomY_1, coordinate.y);
            var text2 = formatFoldDecimal(formatThousands(formatPrecision(point.value, precision.price), thousandsSeparator), decimalFoldThreshold);
            figures2.push({ type: "text", attrs: { x: x_1, y: coordinate.y, text: text2, align: textAlign_1, baseline: "middle" }, ignoreEvent: true });
          }
        });
        if (coordinates.length > 1) {
          figures2.unshift({ type: "rect", attrs: { x: 0, y: topY_1, width: bounding.width, height: bottomY_1 - topY_1 }, ignoreEvent: true });
        }
      }
      return figures2;
    };
    OverlayYAxisView2.prototype.getFigures = function(overlay, coordinates, bounding, barSpace, precision, thousandsSeparator, decimalFoldThreshold, dateTimeFormat, defaultStyles, xAxis, yAxis) {
      var _a2, _b;
      return (_b = (_a2 = overlay.createYAxisFigures) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, { overlay, coordinates, bounding, barSpace, precision, thousandsSeparator, decimalFoldThreshold, dateTimeFormat, defaultStyles, xAxis, yAxis })) !== null && _b !== void 0 ? _b : [];
    };
    return OverlayYAxisView2;
  }(OverlayView)
);
var CrosshairHorizontalLabelView = (
  /** @class */
  function(_super) {
    __extends(CrosshairHorizontalLabelView2, _super);
    function CrosshairHorizontalLabelView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CrosshairHorizontalLabelView2.prototype.drawImp = function(ctx) {
      var _a2;
      var widget = this.getWidget();
      var pane = widget.getPane();
      var bounding = widget.getBounding();
      var chartStore = widget.getPane().getChart().getChartStore();
      var crosshair = chartStore.getTooltipStore().getCrosshair();
      var styles2 = chartStore.getStyles().crosshair;
      if (isString(crosshair.paneId) && this.compare(crosshair, pane.getId())) {
        if (styles2.show) {
          var directionStyles = this.getDirectionStyles(styles2);
          var textStyles = directionStyles.text;
          if (directionStyles.show && textStyles.show) {
            var axis = pane.getAxisComponent();
            var text2 = this.getText(crosshair, chartStore, axis);
            ctx.font = createFont(textStyles.size, textStyles.weight, textStyles.family);
            (_a2 = this.createFigure({
              name: "text",
              attrs: this.getTextAttrs(text2, ctx.measureText(text2).width, crosshair, bounding, axis, textStyles),
              styles: textStyles
            })) === null || _a2 === void 0 ? void 0 : _a2.draw(ctx);
          }
        }
      }
    };
    CrosshairHorizontalLabelView2.prototype.compare = function(crosshair, paneId) {
      return crosshair.paneId === paneId;
    };
    CrosshairHorizontalLabelView2.prototype.getDirectionStyles = function(styles2) {
      return styles2.horizontal;
    };
    CrosshairHorizontalLabelView2.prototype.getText = function(crosshair, chartStore, axis) {
      var yAxis = axis;
      var value = axis.convertFromPixel(crosshair.y);
      var text2;
      if (yAxis.getType() === YAxisType.Percentage) {
        var fromData = chartStore.getVisibleFirstData();
        text2 = "".concat(((value - fromData.close) / fromData.close * 100).toFixed(2), "%");
      } else {
        var indicators2 = chartStore.getIndicatorStore().getInstances(crosshair.paneId);
        var precision_1 = 0;
        var shouldFormatBigNumber_1 = false;
        if (yAxis.isInCandle()) {
          precision_1 = chartStore.getPrecision().price;
        } else {
          indicators2.forEach(function(indicator) {
            precision_1 = Math.max(indicator.precision, precision_1);
            if (!shouldFormatBigNumber_1) {
              shouldFormatBigNumber_1 = indicator.shouldFormatBigNumber;
            }
          });
        }
        text2 = formatPrecision(value, precision_1);
        if (shouldFormatBigNumber_1) {
          text2 = chartStore.getCustomApi().formatBigNumber(text2);
        }
      }
      return formatFoldDecimal(formatThousands(text2, chartStore.getThousandsSeparator()), chartStore.getDecimalFoldThreshold());
    };
    CrosshairHorizontalLabelView2.prototype.getTextAttrs = function(text2, _textWidth, crosshair, bounding, axis, _styles) {
      var yAxis = axis;
      var x;
      var textAlign;
      if (yAxis.isFromZero()) {
        x = 0;
        textAlign = "left";
      } else {
        x = bounding.width;
        textAlign = "right";
      }
      return { x, y: crosshair.y, text: text2, align: textAlign, baseline: "middle" };
    };
    return CrosshairHorizontalLabelView2;
  }(View)
);
var YAxisWidget = (
  /** @class */
  function(_super) {
    __extends(YAxisWidget2, _super);
    function YAxisWidget2(rootContainer, pane) {
      var _this = _super.call(this, rootContainer, pane) || this;
      _this._yAxisView = new YAxisView(_this);
      _this._candleLastPriceLabelView = new CandleLastPriceLabelView(_this);
      _this._indicatorLastValueView = new IndicatorLastValueView(_this);
      _this._overlayYAxisView = new OverlayYAxisView(_this);
      _this._crosshairHorizontalLabelView = new CrosshairHorizontalLabelView(_this);
      _this.getContainer().style.cursor = "ns-resize";
      _this.addChild(_this._overlayYAxisView);
      return _this;
    }
    YAxisWidget2.prototype.getName = function() {
      return WidgetNameConstants.Y_AXIS;
    };
    YAxisWidget2.prototype.updateMain = function(ctx) {
      this._yAxisView.draw(ctx);
      if (this.getPane().getAxisComponent().isInCandle()) {
        this._candleLastPriceLabelView.draw(ctx);
      }
      this._indicatorLastValueView.draw(ctx);
    };
    YAxisWidget2.prototype.updateOverlay = function(ctx) {
      this._overlayYAxisView.draw(ctx);
      this._crosshairHorizontalLabelView.draw(ctx);
    };
    return YAxisWidget2;
  }(DrawWidget)
);
var AxisImp = (
  /** @class */
  function() {
    function AxisImp2(parent) {
      this._range = { from: 0, to: 0, range: 0, realFrom: 0, realTo: 0, realRange: 0 };
      this._prevRange = { from: 0, to: 0, range: 0, realFrom: 0, realTo: 0, realRange: 0 };
      this._ticks = [];
      this._autoCalcTickFlag = true;
      this._parent = parent;
    }
    AxisImp2.prototype.getParent = function() {
      return this._parent;
    };
    AxisImp2.prototype.buildTicks = function(force) {
      if (this._autoCalcTickFlag) {
        this._range = this.calcRange();
      }
      if (this._prevRange.from !== this._range.from || this._prevRange.to !== this._range.to || force) {
        this._prevRange = this._range;
        var defaultTicks = this.optimalTicks(this._calcTicks());
        this._ticks = this.createTicks({
          range: this._range,
          bounding: this.getSelfBounding(),
          defaultTicks
        });
        return true;
      }
      return false;
    };
    AxisImp2.prototype.getTicks = function() {
      return this._ticks;
    };
    AxisImp2.prototype.getScrollZoomEnabled = function() {
      var _a2;
      return (_a2 = this.getParent().getOptions().axisOptions.scrollZoomEnabled) !== null && _a2 !== void 0 ? _a2 : true;
    };
    AxisImp2.prototype.setRange = function(range) {
      this._autoCalcTickFlag = false;
      this._range = range;
    };
    AxisImp2.prototype.getRange = function() {
      return this._range;
    };
    AxisImp2.prototype.setAutoCalcTickFlag = function(flag) {
      this._autoCalcTickFlag = flag;
    };
    AxisImp2.prototype.getAutoCalcTickFlag = function() {
      return this._autoCalcTickFlag;
    };
    AxisImp2.prototype._calcTicks = function() {
      var _a2 = this._range, realFrom = _a2.realFrom, realTo = _a2.realTo, realRange = _a2.realRange;
      var ticks = [];
      if (realRange >= 0) {
        var _b = __read(this._calcTickInterval(realRange), 2), interval = _b[0], precision = _b[1];
        var first = round(Math.ceil(realFrom / interval) * interval, precision);
        var last = round(Math.floor(realTo / interval) * interval, precision);
        var n = 0;
        var f = first;
        if (interval !== 0) {
          while (f <= last) {
            var v = f.toFixed(precision);
            ticks[n] = { text: v, coord: 0, value: v };
            ++n;
            f += interval;
          }
        }
      }
      return ticks;
    };
    AxisImp2.prototype._calcTickInterval = function(range) {
      var interval = nice(range / 8);
      var precision = getPrecision(interval);
      return [interval, precision];
    };
    return AxisImp2;
  }()
);
var YAxisImp = (
  /** @class */
  function(_super) {
    __extends(YAxisImp2, _super);
    function YAxisImp2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    YAxisImp2.prototype.calcRange = function() {
      var _a2, _b, _c2, _d;
      var parent = this.getParent();
      var chart = parent.getChart();
      var chartStore = chart.getChartStore();
      var min = Number.MAX_SAFE_INTEGER;
      var max = Number.MIN_SAFE_INTEGER;
      var figuresResultList = [];
      var shouldOhlc = false;
      var specifyMin = Number.MAX_SAFE_INTEGER;
      var specifyMax = Number.MIN_SAFE_INTEGER;
      var indicatorPrecision = Number.MAX_SAFE_INTEGER;
      var indicators2 = chartStore.getIndicatorStore().getInstances(parent.getId());
      indicators2.forEach(function(indicator) {
        var _a3, _b2, _c3;
        if (!shouldOhlc) {
          shouldOhlc = (_a3 = indicator.shouldOhlc) !== null && _a3 !== void 0 ? _a3 : false;
        }
        indicatorPrecision = Math.min(indicatorPrecision, indicator.precision);
        if (isNumber(indicator.minValue)) {
          specifyMin = Math.min(specifyMin, indicator.minValue);
        }
        if (isNumber(indicator.maxValue)) {
          specifyMax = Math.max(specifyMax, indicator.maxValue);
        }
        figuresResultList.push({
          figures: (_b2 = indicator.figures) !== null && _b2 !== void 0 ? _b2 : [],
          result: (_c3 = indicator.result) !== null && _c3 !== void 0 ? _c3 : []
        });
      });
      var precision = 4;
      var inCandle = this.isInCandle();
      if (inCandle) {
        var pricePrecision = chartStore.getPrecision().price;
        if (indicatorPrecision !== Number.MAX_SAFE_INTEGER) {
          precision = Math.min(indicatorPrecision, pricePrecision);
        } else {
          precision = pricePrecision;
        }
      } else {
        if (indicatorPrecision !== Number.MAX_SAFE_INTEGER) {
          precision = indicatorPrecision;
        }
      }
      var visibleDataList = chartStore.getVisibleDataList();
      var candleStyles = chart.getStyles().candle;
      var isArea = candleStyles.type === CandleType.Area;
      var areaValueKey = candleStyles.area.value;
      var shouldCompareHighLow = inCandle && !isArea || !inCandle && shouldOhlc;
      visibleDataList.forEach(function(_a3) {
        var dataIndex = _a3.dataIndex, data = _a3.data;
        if (isValid(data)) {
          if (shouldCompareHighLow) {
            min = Math.min(min, data.low);
            max = Math.max(max, data.high);
          }
          if (inCandle && isArea) {
            var value = data[areaValueKey];
            if (isNumber(value)) {
              min = Math.min(min, value);
              max = Math.max(max, value);
            }
          }
        }
        figuresResultList.forEach(function(_a4) {
          var _b2;
          var figures2 = _a4.figures, result = _a4.result;
          var indicatorData = (_b2 = result[dataIndex]) !== null && _b2 !== void 0 ? _b2 : {};
          figures2.forEach(function(figure) {
            var value2 = indicatorData[figure.key];
            if (isNumber(value2)) {
              min = Math.min(min, value2);
              max = Math.max(max, value2);
            }
          });
        });
      });
      if (min !== Number.MAX_SAFE_INTEGER && max !== Number.MIN_SAFE_INTEGER) {
        min = Math.min(specifyMin, min);
        max = Math.max(specifyMax, max);
      } else {
        min = 0;
        max = 10;
      }
      var type = this.getType();
      var dif;
      switch (type) {
        case YAxisType.Percentage: {
          var fromData = chartStore.getVisibleFirstData();
          if (isValid(fromData) && isNumber(fromData.close)) {
            min = (min - fromData.close) / fromData.close * 100;
            max = (max - fromData.close) / fromData.close * 100;
          }
          dif = Math.pow(10, -2);
          break;
        }
        case YAxisType.Log: {
          min = log10(min);
          max = log10(max);
          dif = 0.05 * index10(-precision);
          break;
        }
        default: {
          dif = index10(-precision);
        }
      }
      if (min === max || Math.abs(min - max) < dif) {
        var minCheck = specifyMin === min;
        var maxCheck = specifyMax === max;
        min = minCheck ? min : maxCheck ? min - 8 * dif : min - 4 * dif;
        max = maxCheck ? max : minCheck ? max + 8 * dif : max + 4 * dif;
      }
      var height = (_b = (_a2 = this.getParent().getYAxisWidget()) === null || _a2 === void 0 ? void 0 : _a2.getBounding().height) !== null && _b !== void 0 ? _b : 0;
      var paneGap = parent.getOptions().gap;
      var topRate = (_c2 = paneGap === null || paneGap === void 0 ? void 0 : paneGap.top) !== null && _c2 !== void 0 ? _c2 : 0.2;
      if (topRate >= 1) {
        topRate = topRate / height;
      }
      var bottomRate = (_d = paneGap === null || paneGap === void 0 ? void 0 : paneGap.bottom) !== null && _d !== void 0 ? _d : 0.1;
      if (bottomRate >= 1) {
        bottomRate = bottomRate / height;
      }
      var range = Math.abs(max - min);
      min = min - range * bottomRate;
      max = max + range * topRate;
      range = Math.abs(max - min);
      var realMin;
      var realMax;
      var realRange;
      if (type === YAxisType.Log) {
        realMin = index10(min);
        realMax = index10(max);
        realRange = Math.abs(realMax - realMin);
      } else {
        realMin = min;
        realMax = max;
        realRange = range;
      }
      return {
        from: min,
        to: max,
        range,
        realFrom: realMin,
        realTo: realMax,
        realRange
      };
    };
    YAxisImp2.prototype._innerConvertToPixel = function(value) {
      var _a2, _b;
      var height = (_b = (_a2 = this.getParent().getYAxisWidget()) === null || _a2 === void 0 ? void 0 : _a2.getBounding().height) !== null && _b !== void 0 ? _b : 0;
      var _c2 = this.getRange(), from = _c2.from, range = _c2.range;
      var rate = (value - from) / range;
      return this.isReverse() ? Math.round(rate * height) : Math.round((1 - rate) * height);
    };
    YAxisImp2.prototype.isInCandle = function() {
      return this.getParent().getId() === PaneIdConstants.CANDLE;
    };
    YAxisImp2.prototype.getType = function() {
      if (this.isInCandle()) {
        return this.getParent().getChart().getStyles().yAxis.type;
      }
      return YAxisType.Normal;
    };
    YAxisImp2.prototype.getPosition = function() {
      return this.getParent().getChart().getStyles().yAxis.position;
    };
    YAxisImp2.prototype.isReverse = function() {
      if (this.isInCandle()) {
        return this.getParent().getChart().getStyles().yAxis.reverse;
      }
      return false;
    };
    YAxisImp2.prototype.isFromZero = function() {
      var yAxisStyles = this.getParent().getChart().getStyles().yAxis;
      var inside = yAxisStyles.inside;
      return yAxisStyles.position === YAxisPosition.Left && inside || yAxisStyles.position === YAxisPosition.Right && !inside;
    };
    YAxisImp2.prototype.optimalTicks = function(ticks) {
      var _this = this;
      var _a2, _b;
      var pane = this.getParent();
      var height = (_b = (_a2 = pane.getYAxisWidget()) === null || _a2 === void 0 ? void 0 : _a2.getBounding().height) !== null && _b !== void 0 ? _b : 0;
      var chartStore = pane.getChart().getChartStore();
      var customApi = chartStore.getCustomApi();
      var optimalTicks = [];
      var type = this.getType();
      var indicators2 = chartStore.getIndicatorStore().getInstances(pane.getId());
      var thousandsSeparator = chartStore.getThousandsSeparator();
      var decimalFoldThreshold = chartStore.getDecimalFoldThreshold();
      var precision = 0;
      var shouldFormatBigNumber = false;
      if (this.isInCandle()) {
        precision = chartStore.getPrecision().price;
      } else {
        indicators2.forEach(function(tech) {
          precision = Math.max(precision, tech.precision);
          if (!shouldFormatBigNumber) {
            shouldFormatBigNumber = tech.shouldFormatBigNumber;
          }
        });
      }
      var textHeight = chartStore.getStyles().xAxis.tickText.size;
      var validY;
      ticks.forEach(function(_a3) {
        var value = _a3.value;
        var v;
        var y = _this._innerConvertToPixel(+value);
        switch (type) {
          case YAxisType.Percentage: {
            v = "".concat(formatPrecision(value, 2), "%");
            break;
          }
          case YAxisType.Log: {
            y = _this._innerConvertToPixel(log10(+value));
            v = formatPrecision(value, precision);
            break;
          }
          default: {
            v = formatPrecision(value, precision);
            if (shouldFormatBigNumber) {
              v = customApi.formatBigNumber(value);
            }
            break;
          }
        }
        v = formatFoldDecimal(formatThousands(v, thousandsSeparator), decimalFoldThreshold);
        var validYNumber = isNumber(validY);
        if (y > textHeight && y < height - textHeight && (validYNumber && Math.abs(validY - y) > textHeight * 2 || !validYNumber)) {
          optimalTicks.push({ text: v, coord: y, value });
          validY = y;
        }
      });
      return optimalTicks;
    };
    YAxisImp2.prototype.getAutoSize = function() {
      var pane = this.getParent();
      var chart = pane.getChart();
      var styles2 = chart.getStyles();
      var yAxisStyles = styles2.yAxis;
      var width = yAxisStyles.size;
      if (width !== "auto") {
        return width;
      }
      var chartStore = chart.getChartStore();
      var customApi = chartStore.getCustomApi();
      var yAxisWidth = 0;
      if (yAxisStyles.show) {
        if (yAxisStyles.axisLine.show) {
          yAxisWidth += yAxisStyles.axisLine.size;
        }
        if (yAxisStyles.tickLine.show) {
          yAxisWidth += yAxisStyles.tickLine.length;
        }
        if (yAxisStyles.tickText.show) {
          var textWidth_1 = 0;
          this.getTicks().forEach(function(tick) {
            textWidth_1 = Math.max(textWidth_1, calcTextWidth(tick.text, yAxisStyles.tickText.size, yAxisStyles.tickText.weight, yAxisStyles.tickText.family));
          });
          yAxisWidth += yAxisStyles.tickText.marginStart + yAxisStyles.tickText.marginEnd + textWidth_1;
        }
      }
      var crosshairStyles = styles2.crosshair;
      var crosshairVerticalTextWidth = 0;
      if (crosshairStyles.show && crosshairStyles.horizontal.show && crosshairStyles.horizontal.text.show) {
        var indicators2 = chartStore.getIndicatorStore().getInstances(pane.getId());
        var techPrecision_1 = 0;
        var shouldFormatBigNumber_1 = false;
        indicators2.forEach(function(tech) {
          techPrecision_1 = Math.max(tech.precision, techPrecision_1);
          if (!shouldFormatBigNumber_1) {
            shouldFormatBigNumber_1 = tech.shouldFormatBigNumber;
          }
        });
        var precision = 2;
        if (this.getType() !== YAxisType.Percentage) {
          if (this.isInCandle()) {
            var pricePrecision = chartStore.getPrecision().price;
            var lastValueMarkStyles = styles2.indicator.lastValueMark;
            if (lastValueMarkStyles.show && lastValueMarkStyles.text.show) {
              precision = Math.max(techPrecision_1, pricePrecision);
            } else {
              precision = pricePrecision;
            }
          } else {
            precision = techPrecision_1;
          }
        }
        var valueText = formatPrecision(this.getRange().to, precision);
        if (shouldFormatBigNumber_1) {
          valueText = customApi.formatBigNumber(valueText);
        }
        valueText = formatFoldDecimal(valueText, chartStore.getDecimalFoldThreshold());
        crosshairVerticalTextWidth += crosshairStyles.horizontal.text.paddingLeft + crosshairStyles.horizontal.text.paddingRight + crosshairStyles.horizontal.text.borderSize * 2 + calcTextWidth(valueText, crosshairStyles.horizontal.text.size, crosshairStyles.horizontal.text.weight, crosshairStyles.horizontal.text.family);
      }
      return Math.max(yAxisWidth, crosshairVerticalTextWidth);
    };
    YAxisImp2.prototype.getSelfBounding = function() {
      return this.getParent().getYAxisWidget().getBounding();
    };
    YAxisImp2.prototype.convertFromPixel = function(pixel) {
      var _a2, _b;
      var height = (_b = (_a2 = this.getParent().getYAxisWidget()) === null || _a2 === void 0 ? void 0 : _a2.getBounding().height) !== null && _b !== void 0 ? _b : 0;
      var _c2 = this.getRange(), from = _c2.from, range = _c2.range;
      var rate = this.isReverse() ? pixel / height : 1 - pixel / height;
      var value = rate * range + from;
      switch (this.getType()) {
        case YAxisType.Percentage: {
          var fromData = this.getParent().getChart().getChartStore().getVisibleFirstData();
          if (isValid(fromData) && isNumber(fromData.close)) {
            return fromData.close * value / 100 + fromData.close;
          }
          return 0;
        }
        case YAxisType.Log: {
          return index10(value);
        }
        default: {
          return value;
        }
      }
    };
    YAxisImp2.prototype.convertToRealValue = function(value) {
      var v = value;
      if (this.getType() === YAxisType.Log) {
        v = index10(value);
      }
      return v;
    };
    YAxisImp2.prototype.convertToPixel = function(value) {
      var v = value;
      switch (this.getType()) {
        case YAxisType.Percentage: {
          var fromData = this.getParent().getChart().getChartStore().getVisibleFirstData();
          if (isValid(fromData) && isNumber(fromData.close)) {
            v = (value - fromData.close) / fromData.close * 100;
          }
          break;
        }
        case YAxisType.Log: {
          v = log10(value);
          break;
        }
        default: {
          v = value;
        }
      }
      return this._innerConvertToPixel(v);
    };
    YAxisImp2.prototype.convertToNicePixel = function(value) {
      var _a2, _b;
      var height = (_b = (_a2 = this.getParent().getYAxisWidget()) === null || _a2 === void 0 ? void 0 : _a2.getBounding().height) !== null && _b !== void 0 ? _b : 0;
      var pixel = this.convertToPixel(value);
      return Math.round(Math.max(height * 0.05, Math.min(pixel, height * 0.98)));
    };
    YAxisImp2.extend = function(template) {
      var Custom = (
        /** @class */
        function(_super2) {
          __extends(Custom2, _super2);
          function Custom2() {
            return _super2 !== null && _super2.apply(this, arguments) || this;
          }
          Custom2.prototype.createTicks = function(params) {
            return template.createTicks(params);
          };
          return Custom2;
        }(YAxisImp2)
      );
      return Custom;
    };
    return YAxisImp2;
  }(AxisImp)
);
var defaultYAxis = {
  name: "default",
  createTicks: function(_a2) {
    var defaultTicks = _a2.defaultTicks;
    return defaultTicks;
  }
};
var yAxises = {
  default: YAxisImp.extend(defaultYAxis)
};
function getYAxisClass(name) {
  var _a2;
  return (_a2 = yAxises[name]) !== null && _a2 !== void 0 ? _a2 : yAxises.default;
}
var Pane = (
  /** @class */
  function() {
    function Pane2(rootContainer, afterElement, chart, id) {
      this._bounding = createDefaultBounding();
      this._chart = chart;
      this._id = id;
      this._init(rootContainer, afterElement);
    }
    Pane2.prototype._init = function(rootContainer, afterElement) {
      this._rootContainer = rootContainer;
      this._container = createDom("div", {
        width: "100%",
        margin: "0",
        padding: "0",
        position: "relative",
        overflow: "hidden",
        boxSizing: "border-box"
      });
      if (afterElement !== null) {
        rootContainer.insertBefore(this._container, afterElement);
      } else {
        rootContainer.appendChild(this._container);
      }
    };
    Pane2.prototype.getContainer = function() {
      return this._container;
    };
    Pane2.prototype.getId = function() {
      return this._id;
    };
    Pane2.prototype.getChart = function() {
      return this._chart;
    };
    Pane2.prototype.getBounding = function() {
      return this._bounding;
    };
    Pane2.prototype.update = function(level) {
      if (this._bounding.height !== this._container.clientHeight) {
        this._container.style.height = "".concat(this._bounding.height, "px");
      }
      this.updateImp(level !== null && level !== void 0 ? level : 3, this._container, this._bounding);
    };
    Pane2.prototype.destroy = function() {
      this._rootContainer.removeChild(this._container);
    };
    return Pane2;
  }()
);
var DrawPane = (
  /** @class */
  function(_super) {
    __extends(DrawPane2, _super);
    function DrawPane2(rootContainer, afterElement, chart, id, options) {
      var _this = _super.call(this, rootContainer, afterElement, chart, id) || this;
      _this._yAxisWidget = null;
      _this._options = { minHeight: PANE_MIN_HEIGHT, dragEnabled: true, gap: { top: 0.2, bottom: 0.1 }, axisOptions: { name: "default", scrollZoomEnabled: true } };
      var container = _this.getContainer();
      _this._mainWidget = _this.createMainWidget(container);
      _this._yAxisWidget = _this.createYAxisWidget(container);
      _this.setOptions(options);
      return _this;
    }
    DrawPane2.prototype.setOptions = function(options) {
      var _a2, _b, _c2;
      var name = (_a2 = options.axisOptions) === null || _a2 === void 0 ? void 0 : _a2.name;
      if (this._options.axisOptions.name !== name && isString(name) || !isValid(this._axis)) {
        this._axis = this.createAxisComponent(name !== null && name !== void 0 ? name : "default");
      }
      merge(this._options, options);
      var container;
      var cursor;
      if (this.getId() === PaneIdConstants.X_AXIS) {
        container = this.getMainWidget().getContainer();
        cursor = "ew-resize";
      } else {
        container = this.getYAxisWidget().getContainer();
        cursor = "ns-resize";
      }
      if ((_c2 = (_b = options.axisOptions) === null || _b === void 0 ? void 0 : _b.scrollZoomEnabled) !== null && _c2 !== void 0 ? _c2 : true) {
        container.style.cursor = cursor;
      } else {
        container.style.cursor = "default";
      }
      return this;
    };
    DrawPane2.prototype.getOptions = function() {
      return this._options;
    };
    DrawPane2.prototype.getAxisComponent = function() {
      return this._axis;
    };
    DrawPane2.prototype.setBounding = function(rootBounding, mainBounding, yAxisBounding) {
      var _a2, _b;
      merge(this.getBounding(), rootBounding);
      var contentBounding = {};
      if (isValid(rootBounding.height)) {
        contentBounding.height = rootBounding.height;
      }
      if (isValid(rootBounding.top)) {
        contentBounding.top = rootBounding.top;
      }
      this._mainWidget.setBounding(contentBounding);
      (_a2 = this._yAxisWidget) === null || _a2 === void 0 ? void 0 : _a2.setBounding(contentBounding);
      if (isValid(mainBounding)) {
        this._mainWidget.setBounding(mainBounding);
      }
      if (isValid(yAxisBounding)) {
        (_b = this._yAxisWidget) === null || _b === void 0 ? void 0 : _b.setBounding(yAxisBounding);
      }
      return this;
    };
    DrawPane2.prototype.getMainWidget = function() {
      return this._mainWidget;
    };
    DrawPane2.prototype.getYAxisWidget = function() {
      return this._yAxisWidget;
    };
    DrawPane2.prototype.updateImp = function(level) {
      var _a2;
      this._mainWidget.update(level);
      (_a2 = this._yAxisWidget) === null || _a2 === void 0 ? void 0 : _a2.update(level);
    };
    DrawPane2.prototype.destroy = function() {
      var _a2;
      _super.prototype.destroy.call(this);
      this._mainWidget.destroy();
      (_a2 = this._yAxisWidget) === null || _a2 === void 0 ? void 0 : _a2.destroy();
    };
    DrawPane2.prototype.getImage = function(includeOverlay) {
      var _a2 = this.getBounding(), width = _a2.width, height = _a2.height;
      var canvas = createDom("canvas", {
        width: "".concat(width, "px"),
        height: "".concat(height, "px"),
        boxSizing: "border-box"
      });
      var ctx = canvas.getContext("2d");
      var pixelRatio = getPixelRatio(canvas);
      canvas.width = width * pixelRatio;
      canvas.height = height * pixelRatio;
      ctx.scale(pixelRatio, pixelRatio);
      var mainBounding = this._mainWidget.getBounding();
      ctx.drawImage(this._mainWidget.getImage(includeOverlay), mainBounding.left, 0, mainBounding.width, mainBounding.height);
      if (this._yAxisWidget !== null) {
        var yAxisBounding = this._yAxisWidget.getBounding();
        ctx.drawImage(this._yAxisWidget.getImage(includeOverlay), yAxisBounding.left, 0, yAxisBounding.width, yAxisBounding.height);
      }
      return canvas;
    };
    DrawPane2.prototype.createYAxisWidget = function(_container) {
      return null;
    };
    return DrawPane2;
  }(Pane)
);
var IndicatorPane = (
  /** @class */
  function(_super) {
    __extends(IndicatorPane2, _super);
    function IndicatorPane2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    IndicatorPane2.prototype.createAxisComponent = function(name) {
      var YAxisClass = getYAxisClass(name !== null && name !== void 0 ? name : "default");
      return new YAxisClass(this);
    };
    IndicatorPane2.prototype.createMainWidget = function(container) {
      return new IndicatorWidget(container, this);
    };
    IndicatorPane2.prototype.createYAxisWidget = function(container) {
      return new YAxisWidget(container, this);
    };
    return IndicatorPane2;
  }(DrawPane)
);
var CandlePane = (
  /** @class */
  function(_super) {
    __extends(CandlePane2, _super);
    function CandlePane2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CandlePane2.prototype.createMainWidget = function(container) {
      return new CandleWidget(container, this);
    };
    return CandlePane2;
  }(IndicatorPane)
);
var XAxisView = (
  /** @class */
  function(_super) {
    __extends(XAxisView2, _super);
    function XAxisView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    XAxisView2.prototype.getAxisStyles = function(styles2) {
      return styles2.xAxis;
    };
    XAxisView2.prototype.createAxisLine = function(bounding) {
      return {
        coordinates: [
          { x: 0, y: 0 },
          { x: bounding.width, y: 0 }
        ]
      };
    };
    XAxisView2.prototype.createTickLines = function(ticks, _bounding, styles2) {
      var tickLineStyles = styles2.tickLine;
      var axisLineSize = styles2.axisLine.size;
      return ticks.map(function(tick) {
        return {
          coordinates: [
            { x: tick.coord, y: 0 },
            { x: tick.coord, y: axisLineSize + tickLineStyles.length }
          ]
        };
      });
    };
    XAxisView2.prototype.createTickTexts = function(ticks, _bounding, styles2) {
      var tickTickStyles = styles2.tickText;
      var axisLineSize = styles2.axisLine.size;
      var tickLineLength = styles2.tickLine.length;
      return ticks.map(function(tick) {
        return {
          x: tick.coord,
          y: axisLineSize + tickLineLength + tickTickStyles.marginStart,
          text: tick.text,
          align: "center",
          baseline: "top"
        };
      });
    };
    return XAxisView2;
  }(AxisView)
);
var OverlayXAxisView = (
  /** @class */
  function(_super) {
    __extends(OverlayXAxisView2, _super);
    function OverlayXAxisView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    OverlayXAxisView2.prototype.coordinateToPointTimestampDataIndexFlag = function() {
      return true;
    };
    OverlayXAxisView2.prototype.coordinateToPointValueFlag = function() {
      return false;
    };
    OverlayXAxisView2.prototype.getCompleteOverlays = function(overlayStore) {
      return overlayStore.getInstances();
    };
    OverlayXAxisView2.prototype.getProgressOverlay = function(info) {
      return info.instance;
    };
    OverlayXAxisView2.prototype.getDefaultFigures = function(overlay, coordinates, bounding, _precision, dateTimeFormat, customApi, _thousandsSeparator, _decimalFoldThreshold, _xAxis, _yAxis, clickInstanceInfo) {
      var _a2;
      var figures2 = [];
      if (overlay.needDefaultXAxisFigure && overlay.id === ((_a2 = clickInstanceInfo.instance) === null || _a2 === void 0 ? void 0 : _a2.id)) {
        var leftX_1 = Number.MAX_SAFE_INTEGER;
        var rightX_1 = Number.MIN_SAFE_INTEGER;
        coordinates.forEach(function(coordinate, index) {
          leftX_1 = Math.min(leftX_1, coordinate.x);
          rightX_1 = Math.max(rightX_1, coordinate.x);
          var point = overlay.points[index];
          if (isNumber(point.timestamp)) {
            var text2 = customApi.formatDate(dateTimeFormat, point.timestamp, "YYYY-MM-DD HH:mm", FormatDateType.Crosshair);
            figures2.push({ type: "text", attrs: { x: coordinate.x, y: 0, text: text2, align: "center" }, ignoreEvent: true });
          }
        });
        if (coordinates.length > 1) {
          figures2.unshift({ type: "rect", attrs: { x: leftX_1, y: 0, width: rightX_1 - leftX_1, height: bounding.height }, ignoreEvent: true });
        }
      }
      return figures2;
    };
    OverlayXAxisView2.prototype.getFigures = function(overlay, coordinates, bounding, barSpace, precision, thousandsSeparator, decimalFoldThreshold, dateTimeFormat, defaultStyles, xAxis, yAxis) {
      var _a2, _b;
      return (_b = (_a2 = overlay.createXAxisFigures) === null || _a2 === void 0 ? void 0 : _a2.call(overlay, { overlay, coordinates, bounding, barSpace, precision, thousandsSeparator, decimalFoldThreshold, dateTimeFormat, defaultStyles, xAxis, yAxis })) !== null && _b !== void 0 ? _b : [];
    };
    return OverlayXAxisView2;
  }(OverlayYAxisView)
);
var CrosshairVerticalLabelView = (
  /** @class */
  function(_super) {
    __extends(CrosshairVerticalLabelView2, _super);
    function CrosshairVerticalLabelView2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CrosshairVerticalLabelView2.prototype.compare = function(crosshair) {
      return isValid(crosshair.kLineData) && crosshair.dataIndex === crosshair.realDataIndex;
    };
    CrosshairVerticalLabelView2.prototype.getDirectionStyles = function(styles2) {
      return styles2.vertical;
    };
    CrosshairVerticalLabelView2.prototype.getText = function(crosshair, chartStore) {
      var _a2;
      var timestamp = (_a2 = crosshair.kLineData) === null || _a2 === void 0 ? void 0 : _a2.timestamp;
      return chartStore.getCustomApi().formatDate(chartStore.getTimeScaleStore().getDateTimeFormat(), timestamp, "YYYY-MM-DD HH:mm", FormatDateType.Crosshair);
    };
    CrosshairVerticalLabelView2.prototype.getTextAttrs = function(text2, textWidth, crosshair, bounding, _axis, styles2) {
      var x = crosshair.realX;
      var optimalX;
      var align = "center";
      if (x - textWidth / 2 - styles2.paddingLeft < 0) {
        optimalX = 0;
        align = "left";
      } else if (x + textWidth / 2 + styles2.paddingRight > bounding.width) {
        optimalX = bounding.width;
        align = "right";
      } else {
        optimalX = x;
      }
      return { x: optimalX, y: 0, text: text2, align, baseline: "top" };
    };
    return CrosshairVerticalLabelView2;
  }(CrosshairHorizontalLabelView)
);
var XAxisWidget = (
  /** @class */
  function(_super) {
    __extends(XAxisWidget2, _super);
    function XAxisWidget2(rootContainer, pane) {
      var _this = _super.call(this, rootContainer, pane) || this;
      _this._xAxisView = new XAxisView(_this);
      _this._overlayXAxisView = new OverlayXAxisView(_this);
      _this._crosshairVerticalLabelView = new CrosshairVerticalLabelView(_this);
      _this.getContainer().style.cursor = "ew-resize";
      _this.addChild(_this._overlayXAxisView);
      return _this;
    }
    XAxisWidget2.prototype.getName = function() {
      return WidgetNameConstants.X_AXIS;
    };
    XAxisWidget2.prototype.updateMain = function(ctx) {
      this._xAxisView.draw(ctx);
    };
    XAxisWidget2.prototype.updateOverlay = function(ctx) {
      this._overlayXAxisView.draw(ctx);
      this._crosshairVerticalLabelView.draw(ctx);
    };
    return XAxisWidget2;
  }(DrawWidget)
);
var XAxisImp = (
  /** @class */
  function(_super) {
    __extends(XAxisImp2, _super);
    function XAxisImp2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    XAxisImp2.prototype.calcRange = function() {
      var chartStore = this.getParent().getChart().getChartStore();
      var _a2 = chartStore.getTimeScaleStore().getVisibleRange(), from = _a2.from, to2 = _a2.to;
      var af = from;
      var at2 = to2 - 1;
      var range = to2 - from;
      return {
        from: af,
        to: at2,
        range,
        realFrom: af,
        realTo: at2,
        realRange: range
      };
    };
    XAxisImp2.prototype.optimalTicks = function(ticks) {
      var _a2, _b;
      var chart = this.getParent().getChart();
      var chartStore = chart.getChartStore();
      var formatDate2 = chartStore.getCustomApi().formatDate;
      var optimalTicks = [];
      var tickLength = ticks.length;
      var dataList = chartStore.getDataList();
      if (tickLength > 0) {
        var dateTimeFormat = chartStore.getTimeScaleStore().getDateTimeFormat();
        var tickTextStyles = chart.getStyles().xAxis.tickText;
        var defaultLabelWidth = calcTextWidth("00-00 00:00", tickTextStyles.size, tickTextStyles.weight, tickTextStyles.family);
        var pos = parseInt(ticks[0].value, 10);
        var x = this.convertToPixel(pos);
        var tickCountDif = 1;
        if (tickLength > 1) {
          var nextPos = parseInt(ticks[1].value, 10);
          var nextX = this.convertToPixel(nextPos);
          var xDif = Math.abs(nextX - x);
          if (xDif < defaultLabelWidth) {
            tickCountDif = Math.ceil(defaultLabelWidth / xDif);
          }
        }
        for (var i = 0; i < tickLength; i += tickCountDif) {
          var pos_1 = parseInt(ticks[i].value, 10);
          var kLineData = dataList[pos_1];
          var timestamp = kLineData.timestamp;
          var text2 = formatDate2(dateTimeFormat, timestamp, "HH:mm", FormatDateType.XAxis);
          if (i !== 0) {
            var prevPos = parseInt(ticks[i - tickCountDif].value, 10);
            var prevKLineData = dataList[prevPos];
            var prevTimestamp = prevKLineData.timestamp;
            text2 = (_a2 = this._optimalTickLabel(formatDate2, dateTimeFormat, timestamp, prevTimestamp)) !== null && _a2 !== void 0 ? _a2 : text2;
          }
          var x_1 = this.convertToPixel(pos_1);
          optimalTicks.push({ text: text2, coord: x_1, value: timestamp });
        }
        var optimalTickLength = optimalTicks.length;
        if (optimalTickLength === 1) {
          optimalTicks[0].text = formatDate2(dateTimeFormat, optimalTicks[0].value, "YYYY-MM-DD HH:mm", FormatDateType.XAxis);
        } else {
          var firstTimestamp = optimalTicks[0].value;
          var secondTimestamp = optimalTicks[1].value;
          if (isValid(optimalTicks[2])) {
            var thirdText = optimalTicks[2].text;
            if (/^[0-9]{2}-[0-9]{2}$/.test(thirdText)) {
              optimalTicks[0].text = formatDate2(dateTimeFormat, firstTimestamp, "MM-DD", FormatDateType.XAxis);
            } else if (/^[0-9]{4}-[0-9]{2}$/.test(thirdText)) {
              optimalTicks[0].text = formatDate2(dateTimeFormat, firstTimestamp, "YYYY-MM", FormatDateType.XAxis);
            } else if (/^[0-9]{4}$/.test(thirdText)) {
              optimalTicks[0].text = formatDate2(dateTimeFormat, firstTimestamp, "YYYY", FormatDateType.XAxis);
            }
          } else {
            optimalTicks[0].text = (_b = this._optimalTickLabel(formatDate2, dateTimeFormat, firstTimestamp, secondTimestamp)) !== null && _b !== void 0 ? _b : optimalTicks[0].text;
          }
        }
      }
      return optimalTicks;
    };
    XAxisImp2.prototype._optimalTickLabel = function(formatDate2, dateTimeFormat, timestamp, comparedTimestamp) {
      var year = formatDate2(dateTimeFormat, timestamp, "YYYY", FormatDateType.XAxis);
      var month = formatDate2(dateTimeFormat, timestamp, "YYYY-MM", FormatDateType.XAxis);
      var day = formatDate2(dateTimeFormat, timestamp, "MM-DD", FormatDateType.XAxis);
      if (year !== formatDate2(dateTimeFormat, comparedTimestamp, "YYYY", FormatDateType.XAxis)) {
        return year;
      } else if (month !== formatDate2(dateTimeFormat, comparedTimestamp, "YYYY-MM", FormatDateType.XAxis)) {
        return month;
      } else if (day !== formatDate2(dateTimeFormat, comparedTimestamp, "MM-DD", FormatDateType.XAxis)) {
        return day;
      }
      return null;
    };
    XAxisImp2.prototype.getAutoSize = function() {
      var styles2 = this.getParent().getChart().getStyles();
      var xAxisStyles = styles2.xAxis;
      var height = xAxisStyles.size;
      if (height !== "auto") {
        return height;
      }
      var crosshairStyles = styles2.crosshair;
      var xAxisHeight = 0;
      if (xAxisStyles.show) {
        if (xAxisStyles.axisLine.show) {
          xAxisHeight += xAxisStyles.axisLine.size;
        }
        if (xAxisStyles.tickLine.show) {
          xAxisHeight += xAxisStyles.tickLine.length;
        }
        if (xAxisStyles.tickText.show) {
          xAxisHeight += xAxisStyles.tickText.marginStart + xAxisStyles.tickText.marginEnd + xAxisStyles.tickText.size;
        }
      }
      var crosshairVerticalTextHeight = 0;
      if (crosshairStyles.show && crosshairStyles.vertical.show && crosshairStyles.vertical.text.show) {
        crosshairVerticalTextHeight += crosshairStyles.vertical.text.paddingTop + crosshairStyles.vertical.text.paddingBottom + crosshairStyles.vertical.text.borderSize * 2 + crosshairStyles.vertical.text.size;
      }
      return Math.max(xAxisHeight, crosshairVerticalTextHeight);
    };
    XAxisImp2.prototype.getSelfBounding = function() {
      return this.getParent().getMainWidget().getBounding();
    };
    XAxisImp2.prototype.convertTimestampFromPixel = function(pixel) {
      var timeScaleStore = this.getParent().getChart().getChartStore().getTimeScaleStore();
      var dataIndex = timeScaleStore.coordinateToDataIndex(pixel);
      return timeScaleStore.dataIndexToTimestamp(dataIndex);
    };
    XAxisImp2.prototype.convertTimestampToPixel = function(timestamp) {
      var timeScaleStore = this.getParent().getChart().getChartStore().getTimeScaleStore();
      var dataIndex = timeScaleStore.timestampToDataIndex(timestamp);
      return timeScaleStore.dataIndexToCoordinate(dataIndex);
    };
    XAxisImp2.prototype.convertFromPixel = function(pixel) {
      return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(pixel);
    };
    XAxisImp2.prototype.convertToPixel = function(value) {
      return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(value);
    };
    XAxisImp2.extend = function(template) {
      var Custom = (
        /** @class */
        function(_super2) {
          __extends(Custom2, _super2);
          function Custom2() {
            return _super2 !== null && _super2.apply(this, arguments) || this;
          }
          Custom2.prototype.createTicks = function(params) {
            return template.createTicks(params);
          };
          return Custom2;
        }(XAxisImp2)
      );
      return Custom;
    };
    return XAxisImp2;
  }(AxisImp)
);
var defaultXAxis = {
  name: "default",
  createTicks: function(_a2) {
    var defaultTicks = _a2.defaultTicks;
    return defaultTicks;
  }
};
var xAxises = {
  default: XAxisImp.extend(defaultXAxis)
};
function getXAxisClass(name) {
  var _a2;
  return (_a2 = xAxises[name]) !== null && _a2 !== void 0 ? _a2 : xAxises.default;
}
var XAxisPane = (
  /** @class */
  function(_super) {
    __extends(XAxisPane2, _super);
    function XAxisPane2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    XAxisPane2.prototype.createAxisComponent = function(name) {
      var XAxisClass = getXAxisClass(name);
      return new XAxisClass(this);
    };
    XAxisPane2.prototype.createMainWidget = function(container) {
      return new XAxisWidget(container, this);
    };
    return XAxisPane2;
  }(DrawPane)
);
function throttle(func, wait) {
  var previous = 0;
  return function() {
    var now = Date.now();
    if (now - previous > wait) {
      func.apply(this, arguments);
      previous = now;
    }
  };
}
var SeparatorWidget = (
  /** @class */
  function(_super) {
    __extends(SeparatorWidget2, _super);
    function SeparatorWidget2(rootContainer, pane) {
      var _this = _super.call(this, rootContainer, pane) || this;
      _this._dragFlag = false;
      _this._dragStartY = 0;
      _this._topPaneHeight = 0;
      _this._bottomPaneHeight = 0;
      _this._pressedMouseMoveEvent = throttle(_this._pressedTouchMouseMoveEvent, 20);
      _this.registerEvent("touchStartEvent", _this._mouseDownEvent.bind(_this)).registerEvent("touchMoveEvent", _this._pressedMouseMoveEvent.bind(_this)).registerEvent("touchEndEvent", _this._mouseUpEvent.bind(_this)).registerEvent("mouseDownEvent", _this._mouseDownEvent.bind(_this)).registerEvent("mouseUpEvent", _this._mouseUpEvent.bind(_this)).registerEvent("pressedMouseMoveEvent", _this._pressedMouseMoveEvent.bind(_this)).registerEvent("mouseEnterEvent", _this._mouseEnterEvent.bind(_this)).registerEvent("mouseLeaveEvent", _this._mouseLeaveEvent.bind(_this));
      return _this;
    }
    SeparatorWidget2.prototype.getName = function() {
      return WidgetNameConstants.SEPARATOR;
    };
    SeparatorWidget2.prototype.checkEventOn = function() {
      return true;
    };
    SeparatorWidget2.prototype._mouseDownEvent = function(event) {
      this._dragFlag = true;
      this._dragStartY = event.pageY;
      var pane = this.getPane();
      this._topPaneHeight = pane.getTopPane().getBounding().height;
      this._bottomPaneHeight = pane.getBottomPane().getBounding().height;
      return true;
    };
    SeparatorWidget2.prototype._mouseUpEvent = function() {
      this._dragFlag = false;
      return this._mouseLeaveEvent();
    };
    SeparatorWidget2.prototype._pressedTouchMouseMoveEvent = function(event) {
      var dragDistance = event.pageY - this._dragStartY;
      var currentPane = this.getPane();
      var topPane = currentPane.getTopPane();
      var bottomPane = currentPane.getBottomPane();
      var isUpDrag = dragDistance < 0;
      if (topPane !== null && (bottomPane === null || bottomPane === void 0 ? void 0 : bottomPane.getOptions().dragEnabled)) {
        var reducedPane = void 0;
        var increasedPane = void 0;
        var startDragReducedPaneHeight = void 0;
        var startDragIncreasedPaneHeight = void 0;
        if (isUpDrag) {
          reducedPane = topPane;
          increasedPane = bottomPane;
          startDragReducedPaneHeight = this._topPaneHeight;
          startDragIncreasedPaneHeight = this._bottomPaneHeight;
        } else {
          reducedPane = bottomPane;
          increasedPane = topPane;
          startDragReducedPaneHeight = this._bottomPaneHeight;
          startDragIncreasedPaneHeight = this._topPaneHeight;
        }
        var reducedPaneMinHeight = reducedPane.getOptions().minHeight;
        if (startDragReducedPaneHeight > reducedPaneMinHeight) {
          var reducedPaneHeight = Math.max(startDragReducedPaneHeight - Math.abs(dragDistance), reducedPaneMinHeight);
          var diffHeight = startDragReducedPaneHeight - reducedPaneHeight;
          reducedPane.setBounding({ height: reducedPaneHeight });
          increasedPane.setBounding({ height: startDragIncreasedPaneHeight + diffHeight });
          var chart = currentPane.getChart();
          chart.getChartStore().getActionStore().execute(ActionType.OnPaneDrag, { paneId: currentPane.getId() });
          chart.adjustPaneViewport(true, true, true, true, true);
        }
      }
      return true;
    };
    SeparatorWidget2.prototype._mouseEnterEvent = function() {
      var _a2;
      var pane = this.getPane();
      var bottomPane = pane.getBottomPane();
      if ((_a2 = bottomPane === null || bottomPane === void 0 ? void 0 : bottomPane.getOptions().dragEnabled) !== null && _a2 !== void 0 ? _a2 : false) {
        var chart = pane.getChart();
        var styles2 = chart.getStyles().separator;
        this.getContainer().style.background = styles2.activeBackgroundColor;
        return true;
      }
      return false;
    };
    SeparatorWidget2.prototype._mouseLeaveEvent = function() {
      if (!this._dragFlag) {
        this.getContainer().style.background = "";
        return true;
      }
      return false;
    };
    SeparatorWidget2.prototype.createContainer = function() {
      return createDom("div", {
        width: "100%",
        height: "".concat(REAL_SEPARATOR_HEIGHT, "px"),
        margin: "0",
        padding: "0",
        position: "absolute",
        top: "-3px",
        zIndex: "20",
        boxSizing: "border-box",
        cursor: "ns-resize"
      });
    };
    SeparatorWidget2.prototype.updateImp = function(container, _bounding, level) {
      if (level === 4 || level === 2) {
        var styles2 = this.getPane().getChart().getStyles().separator;
        container.style.top = "".concat(-Math.floor((REAL_SEPARATOR_HEIGHT - styles2.size) / 2), "px");
        container.style.height = "".concat(REAL_SEPARATOR_HEIGHT, "px");
      }
    };
    return SeparatorWidget2;
  }(Widget)
);
var SeparatorPane = (
  /** @class */
  function(_super) {
    __extends(SeparatorPane2, _super);
    function SeparatorPane2(rootContainer, afterElement, chart, id, topPane, bottomPane) {
      var _this = _super.call(this, rootContainer, afterElement, chart, id) || this;
      _this.getContainer().style.overflow = "";
      _this._topPane = topPane;
      _this._bottomPane = bottomPane;
      _this._separatorWidget = new SeparatorWidget(_this.getContainer(), _this);
      return _this;
    }
    SeparatorPane2.prototype.setBounding = function(rootBounding) {
      merge(this.getBounding(), rootBounding);
      return this;
    };
    SeparatorPane2.prototype.getTopPane = function() {
      return this._topPane;
    };
    SeparatorPane2.prototype.setTopPane = function(pane) {
      this._topPane = pane;
      return this;
    };
    SeparatorPane2.prototype.getBottomPane = function() {
      return this._bottomPane;
    };
    SeparatorPane2.prototype.setBottomPane = function(pane) {
      this._bottomPane = pane;
      return this;
    };
    SeparatorPane2.prototype.getWidget = function() {
      return this._separatorWidget;
    };
    SeparatorPane2.prototype.getImage = function(_includeOverlay) {
      var _a2 = this.getBounding(), width = _a2.width, height = _a2.height;
      var styles2 = this.getChart().getStyles().separator;
      var canvas = createDom("canvas", {
        width: "".concat(width, "px"),
        height: "".concat(height, "px"),
        boxSizing: "border-box"
      });
      var ctx = canvas.getContext("2d");
      var pixelRatio = getPixelRatio(canvas);
      canvas.width = width * pixelRatio;
      canvas.height = height * pixelRatio;
      ctx.scale(pixelRatio, pixelRatio);
      ctx.fillStyle = styles2.color;
      ctx.fillRect(0, 0, width, height);
      return canvas;
    };
    SeparatorPane2.prototype.updateImp = function(level, container, bounding) {
      if (level === 4 || level === 2) {
        var styles2 = this.getChart().getStyles().separator;
        container.style.backgroundColor = styles2.color;
        container.style.height = "".concat(bounding.height, "px");
        container.style.marginLeft = "".concat(bounding.left, "px");
        container.style.width = "".concat(bounding.width, "px");
        this._separatorWidget.update(level);
      }
    };
    return SeparatorPane2;
  }(Pane)
);
function isFF() {
  var _a2;
  if (typeof window === "undefined") {
    return false;
  }
  return ((_a2 = window.navigator.userAgent.toLowerCase().indexOf("firefox")) !== null && _a2 !== void 0 ? _a2 : -1) > -1;
}
function isIOS() {
  if (typeof window === "undefined") {
    return false;
  }
  return /iPhone|iPad|iPod/.test(window.navigator.platform);
}
var TOUCH_MIN_RADIUS = 10;
var SyntheticEvent = (
  /** @class */
  function() {
    function SyntheticEvent2(target, handler, options) {
      var _this = this;
      this._clickCount = 0;
      this._clickTimeoutId = null;
      this._clickCoordinate = { x: Number.NEGATIVE_INFINITY, y: Number.POSITIVE_INFINITY };
      this._tapCount = 0;
      this._tapTimeoutId = null;
      this._tapCoordinate = { x: Number.NEGATIVE_INFINITY, y: Number.POSITIVE_INFINITY };
      this._longTapTimeoutId = null;
      this._longTapActive = false;
      this._mouseMoveStartCoordinate = null;
      this._touchMoveStartCoordinate = null;
      this._touchMoveExceededManhattanDistance = false;
      this._cancelClick = false;
      this._cancelTap = false;
      this._unsubscribeOutsideMouseEvents = null;
      this._unsubscribeOutsideTouchEvents = null;
      this._unsubscribeMobileSafariEvents = null;
      this._unsubscribeMousemove = null;
      this._unsubscribeMouseWheel = null;
      this._unsubscribeContextMenu = null;
      this._unsubscribeRootMouseEvents = null;
      this._unsubscribeRootTouchEvents = null;
      this._startPinchMiddleCoordinate = null;
      this._startPinchDistance = 0;
      this._pinchPrevented = false;
      this._preventTouchDragProcess = false;
      this._mousePressed = false;
      this._lastTouchEventTimeStamp = 0;
      this._activeTouchId = null;
      this._acceptMouseLeave = !isIOS();
      this._onFirefoxOutsideMouseUp = function(mouseUpEvent) {
        _this._mouseUpHandler(mouseUpEvent);
      };
      this._onMobileSafariDoubleClick = function(dblClickEvent) {
        if (_this._firesTouchEvents(dblClickEvent)) {
          ++_this._tapCount;
          if (_this._tapTimeoutId !== null && _this._tapCount > 1) {
            var manhattanDistance = _this._mouseTouchMoveWithDownInfo(_this._getCoordinate(dblClickEvent), _this._tapCoordinate).manhattanDistance;
            if (manhattanDistance < 30 && !_this._cancelTap) {
              _this._processEvent(_this._makeCompatEvent(dblClickEvent), _this._handler.doubleTapEvent);
            }
            _this._resetTapTimeout();
          }
        } else {
          ++_this._clickCount;
          if (_this._clickTimeoutId !== null && _this._clickCount > 1) {
            var manhattanDistance = _this._mouseTouchMoveWithDownInfo(_this._getCoordinate(dblClickEvent), _this._clickCoordinate).manhattanDistance;
            if (manhattanDistance < 5 && !_this._cancelClick) {
              _this._processEvent(_this._makeCompatEvent(dblClickEvent), _this._handler.mouseDoubleClickEvent);
            }
            _this._resetClickTimeout();
          }
        }
      };
      this._target = target;
      this._handler = handler;
      this._options = options;
      this._init();
    }
    SyntheticEvent2.prototype.destroy = function() {
      if (this._unsubscribeOutsideMouseEvents !== null) {
        this._unsubscribeOutsideMouseEvents();
        this._unsubscribeOutsideMouseEvents = null;
      }
      if (this._unsubscribeOutsideTouchEvents !== null) {
        this._unsubscribeOutsideTouchEvents();
        this._unsubscribeOutsideTouchEvents = null;
      }
      if (this._unsubscribeMousemove !== null) {
        this._unsubscribeMousemove();
        this._unsubscribeMousemove = null;
      }
      if (this._unsubscribeMouseWheel !== null) {
        this._unsubscribeMouseWheel();
        this._unsubscribeMouseWheel = null;
      }
      if (this._unsubscribeContextMenu !== null) {
        this._unsubscribeContextMenu();
        this._unsubscribeContextMenu = null;
      }
      if (this._unsubscribeRootMouseEvents !== null) {
        this._unsubscribeRootMouseEvents();
        this._unsubscribeRootMouseEvents = null;
      }
      if (this._unsubscribeRootTouchEvents !== null) {
        this._unsubscribeRootTouchEvents();
        this._unsubscribeRootTouchEvents = null;
      }
      if (this._unsubscribeMobileSafariEvents !== null) {
        this._unsubscribeMobileSafariEvents();
        this._unsubscribeMobileSafariEvents = null;
      }
      this._clearLongTapTimeout();
      this._resetClickTimeout();
    };
    SyntheticEvent2.prototype._mouseEnterHandler = function(enterEvent) {
      var _this = this;
      var _a2, _b, _c2;
      (_a2 = this._unsubscribeMousemove) === null || _a2 === void 0 ? void 0 : _a2.call(this);
      (_b = this._unsubscribeMouseWheel) === null || _b === void 0 ? void 0 : _b.call(this);
      (_c2 = this._unsubscribeContextMenu) === null || _c2 === void 0 ? void 0 : _c2.call(this);
      var boundMouseMoveHandler = this._mouseMoveHandler.bind(this);
      this._unsubscribeMousemove = function() {
        _this._target.removeEventListener("mousemove", boundMouseMoveHandler);
      };
      this._target.addEventListener("mousemove", boundMouseMoveHandler);
      var boundMouseWheel = this._mouseWheelHandler.bind(this);
      this._unsubscribeMouseWheel = function() {
        _this._target.removeEventListener("wheel", boundMouseWheel);
      };
      this._target.addEventListener("wheel", boundMouseWheel, { passive: false });
      var boundContextMenu = this._contextMenuHandler.bind(this);
      this._unsubscribeContextMenu = function() {
        _this._target.removeEventListener("contextmenu", boundContextMenu);
      };
      this._target.addEventListener("contextmenu", boundContextMenu, { passive: false });
      if (this._firesTouchEvents(enterEvent)) {
        return;
      }
      this._processEvent(this._makeCompatEvent(enterEvent), this._handler.mouseEnterEvent);
      this._acceptMouseLeave = true;
    };
    SyntheticEvent2.prototype._resetClickTimeout = function() {
      if (this._clickTimeoutId !== null) {
        clearTimeout(this._clickTimeoutId);
      }
      this._clickCount = 0;
      this._clickTimeoutId = null;
      this._clickCoordinate = { x: Number.NEGATIVE_INFINITY, y: Number.POSITIVE_INFINITY };
    };
    SyntheticEvent2.prototype._resetTapTimeout = function() {
      if (this._tapTimeoutId !== null) {
        clearTimeout(this._tapTimeoutId);
      }
      this._tapCount = 0;
      this._tapTimeoutId = null;
      this._tapCoordinate = { x: Number.NEGATIVE_INFINITY, y: Number.POSITIVE_INFINITY };
    };
    SyntheticEvent2.prototype._mouseMoveHandler = function(moveEvent) {
      if (this._mousePressed || this._touchMoveStartCoordinate !== null) {
        return;
      }
      if (this._firesTouchEvents(moveEvent)) {
        return;
      }
      this._processEvent(this._makeCompatEvent(moveEvent), this._handler.mouseMoveEvent);
      this._acceptMouseLeave = true;
    };
    SyntheticEvent2.prototype._mouseWheelHandler = function(wheelEvent) {
      if (Math.abs(wheelEvent.deltaX) > Math.abs(wheelEvent.deltaY)) {
        if (!isValid(this._handler.mouseWheelHortEvent)) {
          return;
        }
        this._preventDefault(wheelEvent);
        if (Math.abs(wheelEvent.deltaX) === 0) {
          return;
        }
        this._handler.mouseWheelHortEvent(this._makeCompatEvent(wheelEvent), -wheelEvent.deltaX);
      } else {
        if (!isValid(this._handler.mouseWheelVertEvent)) {
          return;
        }
        var deltaY = -(wheelEvent.deltaY / 100);
        if (deltaY === 0) {
          return;
        }
        this._preventDefault(wheelEvent);
        switch (wheelEvent.deltaMode) {
          case wheelEvent.DOM_DELTA_PAGE:
            deltaY *= 120;
            break;
          case wheelEvent.DOM_DELTA_LINE:
            deltaY *= 32;
            break;
        }
        if (deltaY !== 0) {
          var scale = Math.sign(deltaY) * Math.min(1, Math.abs(deltaY));
          this._handler.mouseWheelVertEvent(this._makeCompatEvent(wheelEvent), scale);
        }
      }
    };
    SyntheticEvent2.prototype._contextMenuHandler = function(mouseEvent) {
      this._preventDefault(mouseEvent);
    };
    SyntheticEvent2.prototype._touchMoveHandler = function(moveEvent) {
      var touch = this._touchWithId(moveEvent.changedTouches, this._activeTouchId);
      if (touch === null) {
        return;
      }
      this._lastTouchEventTimeStamp = this._eventTimeStamp(moveEvent);
      if (this._startPinchMiddleCoordinate !== null) {
        return;
      }
      if (this._preventTouchDragProcess) {
        return;
      }
      this._pinchPrevented = true;
      var moveInfo = this._mouseTouchMoveWithDownInfo(this._getCoordinate(touch), this._touchMoveStartCoordinate);
      var xOffset = moveInfo.xOffset, yOffset = moveInfo.yOffset, manhattanDistance = moveInfo.manhattanDistance;
      if (!this._touchMoveExceededManhattanDistance && manhattanDistance < 5) {
        return;
      }
      if (!this._touchMoveExceededManhattanDistance) {
        var correctedXOffset = xOffset * 0.5;
        var isVertDrag = yOffset >= correctedXOffset && !this._options.treatVertDragAsPageScroll();
        var isHorzDrag = correctedXOffset > yOffset && !this._options.treatHorzDragAsPageScroll();
        if (!isVertDrag && !isHorzDrag) {
          this._preventTouchDragProcess = true;
        }
        this._touchMoveExceededManhattanDistance = true;
        this._cancelTap = true;
        this._clearLongTapTimeout();
        this._resetTapTimeout();
      }
      if (!this._preventTouchDragProcess) {
        this._processEvent(this._makeCompatEvent(moveEvent, touch), this._handler.touchMoveEvent);
      }
    };
    SyntheticEvent2.prototype._mouseMoveWithDownHandler = function(moveEvent) {
      if (moveEvent.button !== 0) {
        return;
      }
      var moveInfo = this._mouseTouchMoveWithDownInfo(this._getCoordinate(moveEvent), this._mouseMoveStartCoordinate);
      var manhattanDistance = moveInfo.manhattanDistance;
      if (manhattanDistance >= 5) {
        this._cancelClick = true;
        this._resetClickTimeout();
      }
      if (this._cancelClick) {
        this._processEvent(this._makeCompatEvent(moveEvent), this._handler.pressedMouseMoveEvent);
      }
    };
    SyntheticEvent2.prototype._mouseTouchMoveWithDownInfo = function(currentCoordinate, startCoordinate) {
      var xOffset = Math.abs(startCoordinate.x - currentCoordinate.x);
      var yOffset = Math.abs(startCoordinate.y - currentCoordinate.y);
      var manhattanDistance = xOffset + yOffset;
      return { xOffset, yOffset, manhattanDistance };
    };
    SyntheticEvent2.prototype._touchEndHandler = function(touchEndEvent) {
      var touch = this._touchWithId(touchEndEvent.changedTouches, this._activeTouchId);
      if (touch === null && touchEndEvent.touches.length === 0) {
        touch = touchEndEvent.changedTouches[0];
      }
      if (touch === null) {
        return;
      }
      this._activeTouchId = null;
      this._lastTouchEventTimeStamp = this._eventTimeStamp(touchEndEvent);
      this._clearLongTapTimeout();
      this._touchMoveStartCoordinate = null;
      if (this._unsubscribeRootTouchEvents !== null) {
        this._unsubscribeRootTouchEvents();
        this._unsubscribeRootTouchEvents = null;
      }
      var compatEvent = this._makeCompatEvent(touchEndEvent, touch);
      this._processEvent(compatEvent, this._handler.touchEndEvent);
      ++this._tapCount;
      if (this._tapTimeoutId !== null && this._tapCount > 1) {
        var manhattanDistance = this._mouseTouchMoveWithDownInfo(this._getCoordinate(touch), this._tapCoordinate).manhattanDistance;
        if (manhattanDistance < 30 && !this._cancelTap) {
          this._processEvent(compatEvent, this._handler.doubleTapEvent);
        }
        this._resetTapTimeout();
      } else {
        if (!this._cancelTap) {
          this._processEvent(compatEvent, this._handler.tapEvent);
          if (isValid(this._handler.tapEvent)) {
            this._preventDefault(touchEndEvent);
          }
        }
      }
      if (this._tapCount === 0) {
        this._preventDefault(touchEndEvent);
      }
      if (touchEndEvent.touches.length === 0) {
        if (this._longTapActive) {
          this._longTapActive = false;
          this._preventDefault(touchEndEvent);
        }
      }
    };
    SyntheticEvent2.prototype._mouseUpHandler = function(mouseUpEvent) {
      if (mouseUpEvent.button !== 0) {
        return;
      }
      var compatEvent = this._makeCompatEvent(mouseUpEvent);
      this._mouseMoveStartCoordinate = null;
      this._mousePressed = false;
      if (this._unsubscribeRootMouseEvents !== null) {
        this._unsubscribeRootMouseEvents();
        this._unsubscribeRootMouseEvents = null;
      }
      if (isFF()) {
        var rootElement = this._target.ownerDocument.documentElement;
        rootElement.removeEventListener("mouseleave", this._onFirefoxOutsideMouseUp);
      }
      if (this._firesTouchEvents(mouseUpEvent)) {
        return;
      }
      this._processEvent(compatEvent, this._handler.mouseUpEvent);
      ++this._clickCount;
      if (this._clickTimeoutId !== null && this._clickCount > 1) {
        var manhattanDistance = this._mouseTouchMoveWithDownInfo(this._getCoordinate(mouseUpEvent), this._clickCoordinate).manhattanDistance;
        if (manhattanDistance < 5 && !this._cancelClick) {
          this._processEvent(compatEvent, this._handler.mouseDoubleClickEvent);
        }
        this._resetClickTimeout();
      } else {
        if (!this._cancelClick) {
          this._processEvent(compatEvent, this._handler.mouseClickEvent);
        }
      }
    };
    SyntheticEvent2.prototype._clearLongTapTimeout = function() {
      if (this._longTapTimeoutId === null) {
        return;
      }
      clearTimeout(this._longTapTimeoutId);
      this._longTapTimeoutId = null;
    };
    SyntheticEvent2.prototype._touchStartHandler = function(downEvent) {
      if (this._activeTouchId !== null) {
        return;
      }
      var touch = downEvent.changedTouches[0];
      this._activeTouchId = touch.identifier;
      this._lastTouchEventTimeStamp = this._eventTimeStamp(downEvent);
      var rootElement = this._target.ownerDocument.documentElement;
      this._cancelTap = false;
      this._touchMoveExceededManhattanDistance = false;
      this._preventTouchDragProcess = false;
      this._touchMoveStartCoordinate = this._getCoordinate(touch);
      if (this._unsubscribeRootTouchEvents !== null) {
        this._unsubscribeRootTouchEvents();
        this._unsubscribeRootTouchEvents = null;
      }
      {
        var boundTouchMoveWithDownHandler_1 = this._touchMoveHandler.bind(this);
        var boundTouchEndHandler_1 = this._touchEndHandler.bind(this);
        this._unsubscribeRootTouchEvents = function() {
          rootElement.removeEventListener("touchmove", boundTouchMoveWithDownHandler_1);
          rootElement.removeEventListener("touchend", boundTouchEndHandler_1);
        };
        rootElement.addEventListener("touchmove", boundTouchMoveWithDownHandler_1, { passive: false });
        rootElement.addEventListener("touchend", boundTouchEndHandler_1, { passive: false });
        this._clearLongTapTimeout();
        this._longTapTimeoutId = setTimeout(
          this._longTapHandler.bind(this, downEvent),
          500
          /* Delay.LongTap */
        );
      }
      this._processEvent(this._makeCompatEvent(downEvent, touch), this._handler.touchStartEvent);
      if (this._tapTimeoutId === null) {
        this._tapCount = 0;
        this._tapTimeoutId = setTimeout(
          this._resetTapTimeout.bind(this),
          500
          /* Delay.ResetClick */
        );
        this._tapCoordinate = this._getCoordinate(touch);
      }
    };
    SyntheticEvent2.prototype._mouseDownHandler = function(downEvent) {
      if (downEvent.button === 2) {
        this._preventDefault(downEvent);
        this._processEvent(this._makeCompatEvent(downEvent), this._handler.mouseRightClickEvent);
        return;
      }
      if (downEvent.button !== 0) {
        return;
      }
      var rootElement = this._target.ownerDocument.documentElement;
      if (isFF()) {
        rootElement.addEventListener("mouseleave", this._onFirefoxOutsideMouseUp);
      }
      this._cancelClick = false;
      this._mouseMoveStartCoordinate = this._getCoordinate(downEvent);
      if (this._unsubscribeRootMouseEvents !== null) {
        this._unsubscribeRootMouseEvents();
        this._unsubscribeRootMouseEvents = null;
      }
      {
        var boundMouseMoveWithDownHandler_1 = this._mouseMoveWithDownHandler.bind(this);
        var boundMouseUpHandler_1 = this._mouseUpHandler.bind(this);
        this._unsubscribeRootMouseEvents = function() {
          rootElement.removeEventListener("mousemove", boundMouseMoveWithDownHandler_1);
          rootElement.removeEventListener("mouseup", boundMouseUpHandler_1);
        };
        rootElement.addEventListener("mousemove", boundMouseMoveWithDownHandler_1);
        rootElement.addEventListener("mouseup", boundMouseUpHandler_1);
      }
      this._mousePressed = true;
      if (this._firesTouchEvents(downEvent)) {
        return;
      }
      this._processEvent(this._makeCompatEvent(downEvent), this._handler.mouseDownEvent);
      if (this._clickTimeoutId === null) {
        this._clickCount = 0;
        this._clickTimeoutId = setTimeout(
          this._resetClickTimeout.bind(this),
          500
          /* Delay.ResetClick */
        );
        this._clickCoordinate = this._getCoordinate(downEvent);
      }
    };
    SyntheticEvent2.prototype._init = function() {
      var _this = this;
      this._target.addEventListener("mouseenter", this._mouseEnterHandler.bind(this));
      this._target.addEventListener("touchcancel", this._clearLongTapTimeout.bind(this));
      {
        var doc_1 = this._target.ownerDocument;
        var outsideHandler_1 = function(event) {
          if (_this._handler.mouseDownOutsideEvent == null) {
            return;
          }
          if (event.composed && _this._target.contains(event.composedPath()[0])) {
            return;
          }
          if (event.target !== null && _this._target.contains(event.target)) {
            return;
          }
          _this._handler.mouseDownOutsideEvent({ x: 0, y: 0, pageX: 0, pageY: 0 });
        };
        this._unsubscribeOutsideTouchEvents = function() {
          doc_1.removeEventListener("touchstart", outsideHandler_1);
        };
        this._unsubscribeOutsideMouseEvents = function() {
          doc_1.removeEventListener("mousedown", outsideHandler_1);
        };
        doc_1.addEventListener("mousedown", outsideHandler_1);
        doc_1.addEventListener("touchstart", outsideHandler_1, { passive: true });
      }
      if (isIOS()) {
        this._unsubscribeMobileSafariEvents = function() {
          _this._target.removeEventListener("dblclick", _this._onMobileSafariDoubleClick);
        };
        this._target.addEventListener("dblclick", this._onMobileSafariDoubleClick);
      }
      this._target.addEventListener("mouseleave", this._mouseLeaveHandler.bind(this));
      this._target.addEventListener("touchstart", this._touchStartHandler.bind(this), { passive: true });
      this._target.addEventListener("mousedown", function(e) {
        if (e.button === 1) {
          e.preventDefault();
          return false;
        }
        return void 0;
      });
      this._target.addEventListener("mousedown", this._mouseDownHandler.bind(this));
      this._initPinch();
      this._target.addEventListener("touchmove", function() {
      }, { passive: false });
    };
    SyntheticEvent2.prototype._initPinch = function() {
      var _this = this;
      if (!isValid(this._handler.pinchStartEvent) && !isValid(this._handler.pinchEvent) && !isValid(this._handler.pinchEndEvent)) {
        return;
      }
      this._target.addEventListener("touchstart", function(event) {
        _this._checkPinchState(event.touches);
      }, { passive: true });
      this._target.addEventListener("touchmove", function(event) {
        if (event.touches.length !== 2 || _this._startPinchMiddleCoordinate === null) {
          return;
        }
        if (isValid(_this._handler.pinchEvent)) {
          var currentDistance = _this._getTouchDistance(event.touches[0], event.touches[1]);
          var scale = currentDistance / _this._startPinchDistance;
          _this._handler.pinchEvent(__assign(__assign({}, _this._startPinchMiddleCoordinate), { pageX: 0, pageY: 0 }), scale);
          _this._preventDefault(event);
        }
      }, { passive: false });
      this._target.addEventListener("touchend", function(event) {
        _this._checkPinchState(event.touches);
      });
    };
    SyntheticEvent2.prototype._checkPinchState = function(touches) {
      if (touches.length === 1) {
        this._pinchPrevented = false;
      }
      if (touches.length !== 2 || this._pinchPrevented || this._longTapActive) {
        this._stopPinch();
      } else {
        this._startPinch(touches);
      }
    };
    SyntheticEvent2.prototype._startPinch = function(touches) {
      var _a2;
      var box = (_a2 = this._target.getBoundingClientRect()) !== null && _a2 !== void 0 ? _a2 : { left: 0, top: 0 };
      this._startPinchMiddleCoordinate = {
        x: (touches[0].clientX - box.left + (touches[1].clientX - box.left)) / 2,
        y: (touches[0].clientY - box.top + (touches[1].clientY - box.top)) / 2
      };
      this._startPinchDistance = this._getTouchDistance(touches[0], touches[1]);
      if (isValid(this._handler.pinchStartEvent)) {
        this._handler.pinchStartEvent({ x: 0, y: 0, pageX: 0, pageY: 0 });
      }
      this._clearLongTapTimeout();
    };
    SyntheticEvent2.prototype._stopPinch = function() {
      if (this._startPinchMiddleCoordinate === null) {
        return;
      }
      this._startPinchMiddleCoordinate = null;
      if (isValid(this._handler.pinchEndEvent)) {
        this._handler.pinchEndEvent({ x: 0, y: 0, pageX: 0, pageY: 0 });
      }
    };
    SyntheticEvent2.prototype._mouseLeaveHandler = function(event) {
      var _a2, _b, _c2;
      (_a2 = this._unsubscribeMousemove) === null || _a2 === void 0 ? void 0 : _a2.call(this);
      (_b = this._unsubscribeMouseWheel) === null || _b === void 0 ? void 0 : _b.call(this);
      (_c2 = this._unsubscribeContextMenu) === null || _c2 === void 0 ? void 0 : _c2.call(this);
      if (this._firesTouchEvents(event)) {
        return;
      }
      if (!this._acceptMouseLeave) {
        return;
      }
      this._processEvent(this._makeCompatEvent(event), this._handler.mouseLeaveEvent);
      this._acceptMouseLeave = !isIOS();
    };
    SyntheticEvent2.prototype._longTapHandler = function(event) {
      var touch = this._touchWithId(event.touches, this._activeTouchId);
      if (touch === null) {
        return;
      }
      this._processEvent(this._makeCompatEvent(event, touch), this._handler.longTapEvent);
      this._cancelTap = true;
      this._longTapActive = true;
    };
    SyntheticEvent2.prototype._firesTouchEvents = function(e) {
      var _a2;
      if (isValid((_a2 = e.sourceCapabilities) === null || _a2 === void 0 ? void 0 : _a2.firesTouchEvents)) {
        return e.sourceCapabilities.firesTouchEvents;
      }
      return this._eventTimeStamp(e) < this._lastTouchEventTimeStamp + 500;
    };
    SyntheticEvent2.prototype._processEvent = function(event, callback) {
      callback === null || callback === void 0 ? void 0 : callback.call(this._handler, event);
    };
    SyntheticEvent2.prototype._makeCompatEvent = function(event, touch) {
      var _this = this;
      var _a2;
      var eventLike = touch !== null && touch !== void 0 ? touch : event;
      var box = (_a2 = this._target.getBoundingClientRect()) !== null && _a2 !== void 0 ? _a2 : { left: 0, top: 0 };
      return {
        x: eventLike.clientX - box.left,
        y: eventLike.clientY - box.top,
        pageX: eventLike.pageX,
        pageY: eventLike.pageY,
        isTouch: !event.type.startsWith("mouse") && event.type !== "contextmenu" && event.type !== "click" && event.type !== "wheel",
        preventDefault: function() {
          if (event.type !== "touchstart") {
            _this._preventDefault(event);
          }
        }
      };
    };
    SyntheticEvent2.prototype._getTouchDistance = function(p12, p22) {
      var xDiff = p12.clientX - p22.clientX;
      var yDiff = p12.clientY - p22.clientY;
      return Math.sqrt(xDiff * xDiff + yDiff * yDiff);
    };
    SyntheticEvent2.prototype._preventDefault = function(event) {
      if (event.cancelable) {
        event.preventDefault();
      }
    };
    SyntheticEvent2.prototype._getCoordinate = function(eventLike) {
      return {
        x: eventLike.pageX,
        y: eventLike.pageY
      };
    };
    SyntheticEvent2.prototype._eventTimeStamp = function(e) {
      var _a2;
      return (_a2 = e.timeStamp) !== null && _a2 !== void 0 ? _a2 : performance.now();
    };
    SyntheticEvent2.prototype._touchWithId = function(touches, id) {
      for (var i = 0; i < touches.length; ++i) {
        if (touches[i].identifier === id) {
          return touches[i];
        }
      }
      return null;
    };
    return SyntheticEvent2;
  }()
);
var Event = (
  /** @class */
  function() {
    function Event2(container, chart) {
      var _this = this;
      this._flingStartTime = (/* @__PURE__ */ new Date()).getTime();
      this._flingScrollRequestId = null;
      this._startScrollCoordinate = null;
      this._touchCoordinate = null;
      this._touchCancelCrosshair = false;
      this._touchZoomed = false;
      this._pinchScale = 1;
      this._mouseDownWidget = null;
      this._prevYAxisRange = null;
      this._xAxisStartScaleCoordinate = null;
      this._xAxisStartScaleDistance = 0;
      this._xAxisScale = 1;
      this._yAxisStartScaleDistance = 0;
      this._mouseMoveTriggerWidgetInfo = { pane: null, widget: null };
      this._boundKeyBoardDownEvent = function(event) {
        if (event.shiftKey) {
          switch (event.code) {
            case "Equal": {
              _this._chart.getChartStore().getTimeScaleStore().zoom(0.5);
              break;
            }
            case "Minus": {
              _this._chart.getChartStore().getTimeScaleStore().zoom(-0.5);
              break;
            }
            case "ArrowLeft": {
              var timeScaleStore = _this._chart.getChartStore().getTimeScaleStore();
              timeScaleStore.startScroll();
              timeScaleStore.scroll(-3 * timeScaleStore.getBarSpace().bar);
              break;
            }
            case "ArrowRight": {
              var timeScaleStore = _this._chart.getChartStore().getTimeScaleStore();
              timeScaleStore.startScroll();
              timeScaleStore.scroll(3 * timeScaleStore.getBarSpace().bar);
              break;
            }
          }
        }
      };
      this._container = container;
      this._chart = chart;
      this._event = new SyntheticEvent(container, this, {
        treatVertDragAsPageScroll: function() {
          return false;
        },
        treatHorzDragAsPageScroll: function() {
          return false;
        }
      });
      container.addEventListener("keydown", this._boundKeyBoardDownEvent);
    }
    Event2.prototype.pinchStartEvent = function() {
      this._touchZoomed = true;
      this._pinchScale = 1;
      return true;
    };
    Event2.prototype.pinchEvent = function(e, scale) {
      var _a2 = this._findWidgetByEvent(e), pane = _a2.pane, widget = _a2.widget;
      if ((pane === null || pane === void 0 ? void 0 : pane.getId()) !== PaneIdConstants.X_AXIS && (widget === null || widget === void 0 ? void 0 : widget.getName()) === WidgetNameConstants.MAIN) {
        var event_1 = this._makeWidgetEvent(e, widget);
        var zoomScale = (scale - this._pinchScale) * 5;
        this._pinchScale = scale;
        this._chart.getChartStore().getTimeScaleStore().zoom(zoomScale, { x: event_1.x, y: event_1.y });
        return true;
      }
      return false;
    };
    Event2.prototype.mouseWheelHortEvent = function(_, distance) {
      var timeScaleStore = this._chart.getChartStore().getTimeScaleStore();
      timeScaleStore.startScroll();
      timeScaleStore.scroll(distance);
      return true;
    };
    Event2.prototype.mouseWheelVertEvent = function(e, scale) {
      var widget = this._findWidgetByEvent(e).widget;
      var event = this._makeWidgetEvent(e, widget);
      var name = widget === null || widget === void 0 ? void 0 : widget.getName();
      if (name === WidgetNameConstants.MAIN) {
        this._chart.getChartStore().getTimeScaleStore().zoom(scale, { x: event.x, y: event.y });
        return true;
      }
      return false;
    };
    Event2.prototype.mouseDownEvent = function(e) {
      var _a2, _b;
      var _c2 = this._findWidgetByEvent(e), pane = _c2.pane, widget = _c2.widget;
      this._mouseDownWidget = widget;
      if (widget !== null) {
        var event_2 = this._makeWidgetEvent(e, widget);
        var name_1 = widget.getName();
        switch (name_1) {
          case WidgetNameConstants.SEPARATOR: {
            return widget.dispatchEvent("mouseDownEvent", event_2);
          }
          case WidgetNameConstants.MAIN: {
            var range = (_a2 = pane.getAxisComponent().getRange()) !== null && _a2 !== void 0 ? _a2 : null;
            this._prevYAxisRange = range === null ? range : __assign({}, range);
            this._startScrollCoordinate = { x: event_2.x, y: event_2.y };
            this._chart.getChartStore().getTimeScaleStore().startScroll();
            return widget.dispatchEvent("mouseDownEvent", event_2);
          }
          case WidgetNameConstants.X_AXIS: {
            var consumed = widget.dispatchEvent("mouseDownEvent", event_2);
            if (consumed) {
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
            }
            this._xAxisStartScaleCoordinate = { x: event_2.x, y: event_2.y };
            this._xAxisStartScaleDistance = event_2.pageX;
            return consumed;
          }
          case WidgetNameConstants.Y_AXIS: {
            var consumed = widget.dispatchEvent("mouseDownEvent", event_2);
            if (consumed) {
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
            }
            var range = (_b = pane.getAxisComponent().getRange()) !== null && _b !== void 0 ? _b : null;
            this._prevYAxisRange = range === null ? range : __assign({}, range);
            this._yAxisStartScaleDistance = event_2.pageY;
            return consumed;
          }
        }
      }
      return false;
    };
    Event2.prototype.mouseMoveEvent = function(e) {
      var _a2, _b, _c2;
      var _d = this._findWidgetByEvent(e), pane = _d.pane, widget = _d.widget;
      var event = this._makeWidgetEvent(e, widget);
      if (((_a2 = this._mouseMoveTriggerWidgetInfo.pane) === null || _a2 === void 0 ? void 0 : _a2.getId()) !== (pane === null || pane === void 0 ? void 0 : pane.getId()) || ((_b = this._mouseMoveTriggerWidgetInfo.widget) === null || _b === void 0 ? void 0 : _b.getName()) !== (widget === null || widget === void 0 ? void 0 : widget.getName())) {
        widget === null || widget === void 0 ? void 0 : widget.dispatchEvent("mouseEnterEvent", event);
        (_c2 = this._mouseMoveTriggerWidgetInfo.widget) === null || _c2 === void 0 ? void 0 : _c2.dispatchEvent("mouseLeaveEvent", event);
        this._mouseMoveTriggerWidgetInfo = { pane, widget };
      }
      if (widget !== null) {
        var name_2 = widget.getName();
        switch (name_2) {
          case WidgetNameConstants.MAIN: {
            var consumed = widget.dispatchEvent("mouseMoveEvent", event);
            var chartStore = this._chart.getChartStore();
            var crosshair = { x: event.x, y: event.y, paneId: pane === null || pane === void 0 ? void 0 : pane.getId() };
            if (consumed && chartStore.getTooltipStore().getActiveIcon() !== null) {
              crosshair = void 0;
              if (widget !== null) {
                widget.getContainer().style.cursor = "pointer";
              }
            }
            this._chart.getChartStore().getTooltipStore().setCrosshair(crosshair);
            return consumed;
          }
          case WidgetNameConstants.SEPARATOR:
          case WidgetNameConstants.X_AXIS:
          case WidgetNameConstants.Y_AXIS: {
            var consumed = widget.dispatchEvent("mouseMoveEvent", event);
            this._chart.getChartStore().getTooltipStore().setCrosshair();
            return consumed;
          }
        }
      }
      return false;
    };
    Event2.prototype.pressedMouseMoveEvent = function(e) {
      var _a2, _b, _c2, _d, _e2;
      if (this._mouseDownWidget !== null && this._mouseDownWidget.getName() === WidgetNameConstants.SEPARATOR) {
        return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent", e);
      }
      var _f = this._findWidgetByEvent(e), pane = _f.pane, widget = _f.widget;
      if (widget !== null && ((_a2 = this._mouseDownWidget) === null || _a2 === void 0 ? void 0 : _a2.getPane().getId()) === (pane === null || pane === void 0 ? void 0 : pane.getId()) && ((_b = this._mouseDownWidget) === null || _b === void 0 ? void 0 : _b.getName()) === widget.getName()) {
        var event_3 = this._makeWidgetEvent(e, widget);
        var name_3 = widget.getName();
        switch (name_3) {
          case WidgetNameConstants.MAIN: {
            var bounding = widget.getBounding();
            var consumed = widget.dispatchEvent("pressedMouseMoveEvent", event_3);
            if (!consumed && this._startScrollCoordinate !== null) {
              var yAxis = pane.getAxisComponent();
              if (this._prevYAxisRange !== null && !yAxis.getAutoCalcTickFlag() && yAxis.getScrollZoomEnabled()) {
                var _g = this._prevYAxisRange, from = _g.from, to2 = _g.to, range = _g.range;
                var distance_1;
                if ((_c2 = yAxis === null || yAxis === void 0 ? void 0 : yAxis.isReverse()) !== null && _c2 !== void 0 ? _c2 : false) {
                  distance_1 = this._startScrollCoordinate.y - event_3.y;
                } else {
                  distance_1 = event_3.y - this._startScrollCoordinate.y;
                }
                var scale = distance_1 / bounding.height;
                var difRange = range * scale;
                var newFrom = from + difRange;
                var newTo = to2 + difRange;
                var newRealFrom = yAxis.convertToRealValue(newFrom);
                var newRealTo = yAxis.convertToRealValue(newTo);
                yAxis.setRange({
                  from: newFrom,
                  to: newTo,
                  range: newTo - newFrom,
                  realFrom: newRealFrom,
                  realTo: newRealTo,
                  realRange: newRealTo - newRealFrom
                });
              }
              var distance = event_3.x - this._startScrollCoordinate.x;
              this._chart.getChartStore().getTimeScaleStore().scroll(distance);
            }
            this._chart.getChartStore().getTooltipStore().setCrosshair({ x: event_3.x, y: event_3.y, paneId: pane === null || pane === void 0 ? void 0 : pane.getId() });
            return consumed;
          }
          case WidgetNameConstants.X_AXIS: {
            var consumed = widget.dispatchEvent("pressedMouseMoveEvent", event_3);
            if (!consumed) {
              var xAxis = pane.getAxisComponent();
              if ((_d = xAxis === null || xAxis === void 0 ? void 0 : xAxis.getScrollZoomEnabled()) !== null && _d !== void 0 ? _d : true) {
                var scale = this._xAxisStartScaleDistance / event_3.pageX;
                if (Number.isFinite(scale)) {
                  var zoomScale = (scale - this._xAxisScale) * 10;
                  this._xAxisScale = scale;
                  this._chart.getChartStore().getTimeScaleStore().zoom(zoomScale, (_e2 = this._xAxisStartScaleCoordinate) !== null && _e2 !== void 0 ? _e2 : void 0);
                }
              }
            } else {
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
            }
            return consumed;
          }
          case WidgetNameConstants.Y_AXIS: {
            var consumed = widget.dispatchEvent("pressedMouseMoveEvent", event_3);
            if (!consumed) {
              var yAxis = pane.getAxisComponent();
              if (this._prevYAxisRange !== null && yAxis.getScrollZoomEnabled()) {
                var _h = this._prevYAxisRange, from = _h.from, to2 = _h.to, range = _h.range;
                var scale = event_3.pageY / this._yAxisStartScaleDistance;
                var newRange = range * scale;
                var difRange = (newRange - range) / 2;
                var newFrom = from - difRange;
                var newTo = to2 + difRange;
                var newRealFrom = yAxis.convertToRealValue(newFrom);
                var newRealTo = yAxis.convertToRealValue(newTo);
                yAxis.setRange({
                  from: newFrom,
                  to: newTo,
                  range: newRange,
                  realFrom: newRealFrom,
                  realTo: newRealTo,
                  realRange: newRealTo - newRealFrom
                });
                this._chart.adjustPaneViewport(false, true, true, true);
              }
            } else {
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
            }
            return consumed;
          }
        }
      }
      return false;
    };
    Event2.prototype.mouseUpEvent = function(e) {
      var widget = this._findWidgetByEvent(e).widget;
      var consumed = false;
      if (widget !== null) {
        var event_4 = this._makeWidgetEvent(e, widget);
        var name_4 = widget.getName();
        switch (name_4) {
          case WidgetNameConstants.MAIN:
          case WidgetNameConstants.SEPARATOR:
          case WidgetNameConstants.X_AXIS:
          case WidgetNameConstants.Y_AXIS: {
            consumed = widget.dispatchEvent("mouseUpEvent", event_4);
            break;
          }
        }
        if (consumed) {
          this._chart.updatePane(
            1
            /* UpdateLevel.Overlay */
          );
        }
      }
      this._mouseDownWidget = null;
      this._startScrollCoordinate = null;
      this._prevYAxisRange = null;
      this._xAxisStartScaleCoordinate = null;
      this._xAxisStartScaleDistance = 0;
      this._xAxisScale = 1;
      this._yAxisStartScaleDistance = 0;
      return consumed;
    };
    Event2.prototype.mouseClickEvent = function(e) {
      var widget = this._findWidgetByEvent(e).widget;
      if (widget !== null) {
        var event_5 = this._makeWidgetEvent(e, widget);
        return widget.dispatchEvent("mouseClickEvent", event_5);
      }
      return false;
    };
    Event2.prototype.mouseRightClickEvent = function(e) {
      var widget = this._findWidgetByEvent(e).widget;
      var consumed = false;
      if (widget !== null) {
        var event_6 = this._makeWidgetEvent(e, widget);
        var name_5 = widget.getName();
        switch (name_5) {
          case WidgetNameConstants.MAIN:
          case WidgetNameConstants.X_AXIS:
          case WidgetNameConstants.Y_AXIS: {
            consumed = widget.dispatchEvent("mouseRightClickEvent", event_6);
            break;
          }
        }
        if (consumed) {
          this._chart.updatePane(
            1
            /* UpdateLevel.Overlay */
          );
        }
      }
      return false;
    };
    Event2.prototype.mouseDoubleClickEvent = function(e) {
      var _a2 = this._findWidgetByEvent(e), pane = _a2.pane, widget = _a2.widget;
      if (widget !== null) {
        var name_6 = widget.getName();
        switch (name_6) {
          case WidgetNameConstants.MAIN: {
            var event_7 = this._makeWidgetEvent(e, widget);
            return widget.dispatchEvent("mouseDoubleClickEvent", event_7);
          }
          case WidgetNameConstants.Y_AXIS: {
            var yAxis = pane.getAxisComponent();
            if (!yAxis.getAutoCalcTickFlag()) {
              yAxis.setAutoCalcTickFlag(true);
              this._chart.adjustPaneViewport(false, true, true, true);
              return true;
            }
            break;
          }
        }
      }
      return false;
    };
    Event2.prototype.mouseLeaveEvent = function() {
      this._chart.getChartStore().getTooltipStore().setCrosshair();
      return true;
    };
    Event2.prototype.touchStartEvent = function(e) {
      var _a2 = this._findWidgetByEvent(e), pane = _a2.pane, widget = _a2.widget;
      if (widget !== null) {
        var event_8 = this._makeWidgetEvent(e, widget);
        var name_7 = widget.getName();
        switch (name_7) {
          case WidgetNameConstants.MAIN: {
            var chartStore = this._chart.getChartStore();
            var tooltipStore = chartStore.getTooltipStore();
            if (widget.dispatchEvent("mouseDownEvent", event_8)) {
              this._touchCancelCrosshair = true;
              this._touchCoordinate = null;
              tooltipStore.setCrosshair(void 0, { notInvalidate: true });
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
              return true;
            }
            if (this._flingScrollRequestId !== null) {
              cancelAnimationFrame(this._flingScrollRequestId);
              this._flingScrollRequestId = null;
            }
            this._flingStartTime = (/* @__PURE__ */ new Date()).getTime();
            this._startScrollCoordinate = { x: event_8.x, y: event_8.y };
            chartStore.getTimeScaleStore().startScroll();
            this._touchZoomed = false;
            if (this._touchCoordinate !== null) {
              var xDif = event_8.x - this._touchCoordinate.x;
              var yDif = event_8.y - this._touchCoordinate.y;
              var radius = Math.sqrt(xDif * xDif + yDif * yDif);
              if (radius < TOUCH_MIN_RADIUS) {
                this._touchCoordinate = { x: event_8.x, y: event_8.y };
                tooltipStore.setCrosshair({ x: event_8.x, y: event_8.y, paneId: pane === null || pane === void 0 ? void 0 : pane.getId() });
              } else {
                this._touchCoordinate = null;
                this._touchCancelCrosshair = true;
                tooltipStore.setCrosshair();
              }
            }
            return true;
          }
          case WidgetNameConstants.X_AXIS:
          case WidgetNameConstants.Y_AXIS: {
            var consumed = widget.dispatchEvent("mouseDownEvent", event_8);
            if (consumed) {
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
            }
            return consumed;
          }
        }
      }
      return false;
    };
    Event2.prototype.touchMoveEvent = function(e) {
      var _a2, _b, _c2;
      var _d = this._findWidgetByEvent(e), pane = _d.pane, widget = _d.widget;
      if (widget !== null) {
        var event_9 = this._makeWidgetEvent(e, widget);
        var name_8 = widget.getName();
        var chartStore = this._chart.getChartStore();
        var tooltipStore = chartStore.getTooltipStore();
        switch (name_8) {
          case WidgetNameConstants.MAIN: {
            if (widget.dispatchEvent("pressedMouseMoveEvent", event_9)) {
              (_a2 = event_9.preventDefault) === null || _a2 === void 0 ? void 0 : _a2.call(event_9);
              tooltipStore.setCrosshair(void 0, { notInvalidate: true });
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
              return true;
            }
            if (this._touchCoordinate !== null) {
              (_b = event_9.preventDefault) === null || _b === void 0 ? void 0 : _b.call(event_9);
              tooltipStore.setCrosshair({ x: event_9.x, y: event_9.y, paneId: pane === null || pane === void 0 ? void 0 : pane.getId() });
            } else {
              if (this._startScrollCoordinate !== null && Math.abs(this._startScrollCoordinate.x - event_9.x) > this._startScrollCoordinate.y - event_9.y) {
                var distance = event_9.x - this._startScrollCoordinate.x;
                chartStore.getTimeScaleStore().scroll(distance);
              }
            }
            return true;
          }
          case WidgetNameConstants.X_AXIS:
          case WidgetNameConstants.Y_AXIS: {
            var consumed = widget.dispatchEvent("pressedMouseMoveEvent", event_9);
            if (consumed) {
              (_c2 = event_9.preventDefault) === null || _c2 === void 0 ? void 0 : _c2.call(event_9);
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
            }
            return consumed;
          }
        }
      }
      return false;
    };
    Event2.prototype.touchEndEvent = function(e) {
      var _this = this;
      var widget = this._findWidgetByEvent(e).widget;
      if (widget !== null) {
        var event_10 = this._makeWidgetEvent(e, widget);
        var name_9 = widget.getName();
        switch (name_9) {
          case WidgetNameConstants.MAIN: {
            widget.dispatchEvent("mouseUpEvent", event_10);
            if (this._startScrollCoordinate !== null) {
              var time = (/* @__PURE__ */ new Date()).getTime() - this._flingStartTime;
              var distance = event_10.x - this._startScrollCoordinate.x;
              var v_1 = distance / (time > 0 ? time : 1) * 20;
              if (time < 200 && Math.abs(v_1) > 0) {
                var timeScaleStore_1 = this._chart.getChartStore().getTimeScaleStore();
                var flingScroll_1 = function() {
                  _this._flingScrollRequestId = requestAnimationFrame(function() {
                    timeScaleStore_1.startScroll();
                    timeScaleStore_1.scroll(v_1);
                    v_1 = v_1 * (1 - 0.025);
                    if (Math.abs(v_1) < 1) {
                      if (_this._flingScrollRequestId !== null) {
                        cancelAnimationFrame(_this._flingScrollRequestId);
                        _this._flingScrollRequestId = null;
                      }
                    } else {
                      flingScroll_1();
                    }
                  });
                };
                flingScroll_1();
              }
            }
            return true;
          }
          case WidgetNameConstants.X_AXIS:
          case WidgetNameConstants.Y_AXIS: {
            var consumed = widget.dispatchEvent("mouseUpEvent", event_10);
            if (consumed) {
              this._chart.updatePane(
                1
                /* UpdateLevel.Overlay */
              );
            }
          }
        }
      }
      return false;
    };
    Event2.prototype.tapEvent = function(e) {
      var _a2 = this._findWidgetByEvent(e), pane = _a2.pane, widget = _a2.widget;
      var consumed = false;
      if (widget !== null) {
        var event_11 = this._makeWidgetEvent(e, widget);
        var result = widget.dispatchEvent("mouseClickEvent", event_11);
        if (widget.getName() === WidgetNameConstants.MAIN) {
          var event_12 = this._makeWidgetEvent(e, widget);
          var chartStore = this._chart.getChartStore();
          var tooltipStore = chartStore.getTooltipStore();
          if (result) {
            this._touchCancelCrosshair = true;
            this._touchCoordinate = null;
            tooltipStore.setCrosshair(void 0, { notInvalidate: true });
            consumed = true;
          } else {
            if (!this._touchCancelCrosshair && !this._touchZoomed) {
              this._touchCoordinate = { x: event_12.x, y: event_12.y };
              tooltipStore.setCrosshair({ x: event_12.x, y: event_12.y, paneId: pane === null || pane === void 0 ? void 0 : pane.getId() }, { notInvalidate: true });
              consumed = true;
            }
            this._touchCancelCrosshair = false;
          }
        }
        if (consumed || result) {
          this._chart.updatePane(
            1
            /* UpdateLevel.Overlay */
          );
        }
      }
      return consumed;
    };
    Event2.prototype.doubleTapEvent = function(e) {
      return this.mouseDoubleClickEvent(e);
    };
    Event2.prototype.longTapEvent = function(e) {
      var _a2 = this._findWidgetByEvent(e), pane = _a2.pane, widget = _a2.widget;
      if (widget !== null && widget.getName() === WidgetNameConstants.MAIN) {
        var event_13 = this._makeWidgetEvent(e, widget);
        this._touchCoordinate = { x: event_13.x, y: event_13.y };
        this._chart.getChartStore().getTooltipStore().setCrosshair({ x: event_13.x, y: event_13.y, paneId: pane === null || pane === void 0 ? void 0 : pane.getId() });
        return true;
      }
      return false;
    };
    Event2.prototype._findWidgetByEvent = function(event) {
      var e_1, _a2, e_2, _b;
      var x = event.x, y = event.y;
      var separatorPanes = this._chart.getAllSeparatorPanes();
      var separatorSize = this._chart.getChartStore().getStyles().separator.size;
      try {
        for (var separatorPanes_1 = __values(separatorPanes), separatorPanes_1_1 = separatorPanes_1.next(); !separatorPanes_1_1.done; separatorPanes_1_1 = separatorPanes_1.next()) {
          var _c2 = __read(separatorPanes_1_1.value, 2), pane_1 = _c2[1];
          var bounding = pane_1.getBounding();
          var top_1 = bounding.top - Math.round((REAL_SEPARATOR_HEIGHT - separatorSize) / 2);
          if (x >= bounding.left && x <= bounding.left + bounding.width && y >= top_1 && y <= top_1 + REAL_SEPARATOR_HEIGHT) {
            return { pane: pane_1, widget: pane_1.getWidget() };
          }
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (separatorPanes_1_1 && !separatorPanes_1_1.done && (_a2 = separatorPanes_1.return)) _a2.call(separatorPanes_1);
        } finally {
          if (e_1) throw e_1.error;
        }
      }
      var drawPanes = this._chart.getAllDrawPanes();
      var pane = null;
      try {
        for (var drawPanes_1 = __values(drawPanes), drawPanes_1_1 = drawPanes_1.next(); !drawPanes_1_1.done; drawPanes_1_1 = drawPanes_1.next()) {
          var p = drawPanes_1_1.value;
          var bounding = p.getBounding();
          if (x >= bounding.left && x <= bounding.left + bounding.width && y >= bounding.top && y <= bounding.top + bounding.height) {
            pane = p;
            break;
          }
        }
      } catch (e_2_1) {
        e_2 = { error: e_2_1 };
      } finally {
        try {
          if (drawPanes_1_1 && !drawPanes_1_1.done && (_b = drawPanes_1.return)) _b.call(drawPanes_1);
        } finally {
          if (e_2) throw e_2.error;
        }
      }
      var widget = null;
      if (pane !== null) {
        if (widget === null) {
          var mainWidget = pane.getMainWidget();
          var mainBounding = mainWidget.getBounding();
          if (x >= mainBounding.left && x <= mainBounding.left + mainBounding.width && y >= mainBounding.top && y <= mainBounding.top + mainBounding.height) {
            widget = mainWidget;
          }
        }
        if (widget === null) {
          var yAxisWidget = pane.getYAxisWidget();
          if (yAxisWidget !== null) {
            var yAxisBounding = yAxisWidget.getBounding();
            if (x >= yAxisBounding.left && x <= yAxisBounding.left + yAxisBounding.width && y >= yAxisBounding.top && y <= yAxisBounding.top + yAxisBounding.height) {
              widget = yAxisWidget;
            }
          }
        }
      }
      return { pane, widget };
    };
    Event2.prototype._makeWidgetEvent = function(event, widget) {
      var _a2, _b, _c2;
      var bounding = (_a2 = widget === null || widget === void 0 ? void 0 : widget.getBounding()) !== null && _a2 !== void 0 ? _a2 : null;
      return __assign(__assign({}, event), { x: event.x - ((_b = bounding === null || bounding === void 0 ? void 0 : bounding.left) !== null && _b !== void 0 ? _b : 0), y: event.y - ((_c2 = bounding === null || bounding === void 0 ? void 0 : bounding.top) !== null && _c2 !== void 0 ? _c2 : 0) });
    };
    Event2.prototype.destroy = function() {
      this._container.removeEventListener("keydown", this._boundKeyBoardDownEvent);
      this._event.destroy();
    };
    return Event2;
  }()
);
var DomPosition;
(function(DomPosition2) {
  DomPosition2["Root"] = "root";
  DomPosition2["Main"] = "main";
  DomPosition2["YAxis"] = "yAxis";
})(DomPosition || (DomPosition = {}));
var ChartImp = (
  /** @class */
  function() {
    function ChartImp2(container, options) {
      this._drawPanes = [];
      this._separatorPanes = /* @__PURE__ */ new Map();
      this._initContainer(container);
      this._chartEvent = new Event(this._chartContainer, this);
      this._chartStore = new ChartStore(this, options);
      this._initPanes(options);
      this.adjustPaneViewport(true, true, true);
    }
    ChartImp2.prototype._initContainer = function(container) {
      this._container = container;
      this._chartContainer = createDom("div", {
        position: "relative",
        width: "100%",
        outline: "none",
        borderStyle: "none",
        cursor: "crosshair",
        boxSizing: "border-box",
        userSelect: "none",
        webkitUserSelect: "none",
        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        // @ts-expect-error
        msUserSelect: "none",
        MozUserSelect: "none",
        webkitTapHighlightColor: "transparent"
      });
      this._chartContainer.tabIndex = 1;
      container.appendChild(this._chartContainer);
    };
    ChartImp2.prototype._initPanes = function(options) {
      var _this = this;
      var _a2;
      var layout = (_a2 = options === null || options === void 0 ? void 0 : options.layout) !== null && _a2 !== void 0 ? _a2 : [{
        type: "candle"
        /* LayoutChildType.Candle */
      }];
      var candlePaneInitialized = false;
      var xAxisPaneInitialized = false;
      var createXAxisPane = function(ops) {
        if (!xAxisPaneInitialized) {
          var pane = _this._createPane(XAxisPane, PaneIdConstants.X_AXIS, ops !== null && ops !== void 0 ? ops : {});
          _this._xAxisPane = pane;
          xAxisPaneInitialized = true;
        }
      };
      layout.forEach(function(child) {
        var _a3, _b, _c2;
        switch (child.type) {
          case "candle": {
            if (!candlePaneInitialized) {
              var paneOptions_1 = (_a3 = child.options) !== null && _a3 !== void 0 ? _a3 : {};
              merge(paneOptions_1, { id: PaneIdConstants.CANDLE });
              _this._candlePane = _this._createPane(CandlePane, PaneIdConstants.CANDLE, paneOptions_1);
              var content = (_b = child.content) !== null && _b !== void 0 ? _b : [];
              content.forEach(function(v) {
                _this.createIndicator(v, true, paneOptions_1);
              });
              candlePaneInitialized = true;
            }
            break;
          }
          case "indicator": {
            var content = (_c2 = child.content) !== null && _c2 !== void 0 ? _c2 : [];
            if (content.length > 0) {
              var paneId_1;
              content.forEach(function(v) {
                if (isValid(paneId_1)) {
                  _this.createIndicator(v, true, { id: paneId_1 });
                } else {
                  paneId_1 = _this.createIndicator(v, true, child.options);
                }
              });
            }
            break;
          }
          case "xAxis": {
            createXAxisPane(child.options);
            break;
          }
        }
      });
      createXAxisPane({
        position: "bottom"
        /* PanePosition.Bottom */
      });
    };
    ChartImp2.prototype._createPane = function(DrawPaneClass, id, options) {
      var index = null;
      var pane = null;
      var position = options === null || options === void 0 ? void 0 : options.position;
      switch (position) {
        case "top": {
          var firstPane = this._drawPanes[0];
          if (isValid(firstPane)) {
            pane = new DrawPaneClass(this._chartContainer, firstPane.getContainer(), this, id, options !== null && options !== void 0 ? options : {});
            index = 0;
          }
          break;
        }
        case "bottom": {
          break;
        }
        default: {
          for (var i = this._drawPanes.length - 1; i > -1; i--) {
            var p = this._drawPanes[i];
            var prevP = this._drawPanes[i - 1];
            if ((p === null || p === void 0 ? void 0 : p.getOptions().position) === "bottom" && (prevP === null || prevP === void 0 ? void 0 : prevP.getOptions().position) !== "bottom") {
              pane = new DrawPaneClass(this._chartContainer, p.getContainer(), this, id, options !== null && options !== void 0 ? options : {});
              index = i;
              break;
            }
          }
        }
      }
      if (!isValid(pane)) {
        pane = new DrawPaneClass(this._chartContainer, null, this, id, options !== null && options !== void 0 ? options : {});
      }
      var newIndex;
      if (isNumber(index)) {
        this._drawPanes.splice(index, 0, pane);
        newIndex = index;
      } else {
        this._drawPanes.push(pane);
        newIndex = this._drawPanes.length - 1;
      }
      if (pane.getId() !== PaneIdConstants.X_AXIS) {
        var nextPane = this._drawPanes[newIndex + 1];
        if (isValid(nextPane)) {
          if (nextPane.getId() === PaneIdConstants.X_AXIS) {
            nextPane = this._drawPanes[newIndex + 2];
          }
        }
        if (isValid(nextPane)) {
          var separatorPane = this._separatorPanes.get(nextPane);
          if (isValid(separatorPane)) {
            separatorPane.setTopPane(pane);
          } else {
            separatorPane = new SeparatorPane(this._chartContainer, nextPane.getContainer(), this, "", pane, nextPane);
            this._separatorPanes.set(nextPane, separatorPane);
          }
        }
        var prevPane = this._drawPanes[newIndex - 1];
        if (isValid(prevPane)) {
          if (prevPane.getId() === PaneIdConstants.X_AXIS) {
            prevPane = this._drawPanes[newIndex - 2];
          }
        }
        if (isValid(prevPane)) {
          var separatorPane = new SeparatorPane(this._chartContainer, pane.getContainer(), this, "", prevPane, pane);
          this._separatorPanes.set(pane, separatorPane);
        }
      }
      return pane;
    };
    ChartImp2.prototype._measurePaneHeight = function() {
      var _this = this;
      var _a2;
      var totalHeight = Math.floor(this._container.clientHeight);
      var separatorSize = this._chartStore.getStyles().separator.size;
      var xAxisHeight = this._xAxisPane.getAxisComponent().getAutoSize();
      var paneExcludeXAxisHeight = totalHeight - xAxisHeight - this._separatorPanes.size * separatorSize;
      if (paneExcludeXAxisHeight < 0) {
        paneExcludeXAxisHeight = 0;
      }
      var indicatorPaneTotalHeight = 0;
      this._drawPanes.forEach(function(pane) {
        if (pane.getId() !== PaneIdConstants.CANDLE && pane.getId() !== PaneIdConstants.X_AXIS) {
          var paneHeight = pane.getBounding().height;
          var paneMinHeight = pane.getOptions().minHeight;
          if (paneHeight < paneMinHeight) {
            paneHeight = paneMinHeight;
          }
          if (indicatorPaneTotalHeight + paneHeight > paneExcludeXAxisHeight) {
            indicatorPaneTotalHeight = paneExcludeXAxisHeight;
            paneHeight = Math.max(paneExcludeXAxisHeight - indicatorPaneTotalHeight, 0);
          } else {
            indicatorPaneTotalHeight += paneHeight;
          }
          pane.setBounding({ height: paneHeight });
        }
      });
      var candlePaneHeight = paneExcludeXAxisHeight - indicatorPaneTotalHeight;
      (_a2 = this._candlePane) === null || _a2 === void 0 ? void 0 : _a2.setBounding({ height: candlePaneHeight });
      this._xAxisPane.setBounding({ height: xAxisHeight });
      var top = 0;
      this._drawPanes.forEach(function(pane) {
        var separatorPane = _this._separatorPanes.get(pane);
        if (isValid(separatorPane)) {
          separatorPane.setBounding({ height: separatorSize, top });
          top += separatorSize;
        }
        pane.setBounding({ top });
        top += pane.getBounding().height;
      });
    };
    ChartImp2.prototype._measurePaneWidth = function() {
      var _this = this;
      var totalWidth = Math.floor(this._container.clientWidth);
      var styles2 = this._chartStore.getStyles();
      var yAxisStyles = styles2.yAxis;
      var isYAxisLeft = yAxisStyles.position === YAxisPosition.Left;
      var isOutside = !yAxisStyles.inside;
      var mainWidth = 0;
      var yAxisWidth = 0;
      var yAxisLeft = 0;
      var mainLeft = 0;
      this._drawPanes.forEach(function(pane) {
        if (pane.getId() !== PaneIdConstants.X_AXIS) {
          yAxisWidth = Math.max(yAxisWidth, pane.getAxisComponent().getAutoSize());
        }
      });
      if (yAxisWidth > totalWidth) {
        yAxisWidth = totalWidth;
      }
      if (isOutside) {
        mainWidth = totalWidth - yAxisWidth;
        if (isYAxisLeft) {
          yAxisLeft = 0;
          mainLeft = yAxisWidth;
        } else {
          yAxisLeft = totalWidth - yAxisWidth;
          mainLeft = 0;
        }
      } else {
        mainWidth = totalWidth;
        mainLeft = 0;
        if (isYAxisLeft) {
          yAxisLeft = 0;
        } else {
          yAxisLeft = totalWidth - yAxisWidth;
        }
      }
      this._chartStore.getTimeScaleStore().setTotalBarSpace(mainWidth);
      var paneBounding = { width: totalWidth };
      var mainBounding = { width: mainWidth, left: mainLeft };
      var yAxisBounding = { width: yAxisWidth, left: yAxisLeft };
      var separatorFill = styles2.separator.fill;
      var separatorBounding;
      if (isOutside && !separatorFill) {
        separatorBounding = mainBounding;
      } else {
        separatorBounding = paneBounding;
      }
      this._drawPanes.forEach(function(pane) {
        var _a2;
        (_a2 = _this._separatorPanes.get(pane)) === null || _a2 === void 0 ? void 0 : _a2.setBounding(separatorBounding);
        pane.setBounding(paneBounding, mainBounding, yAxisBounding);
      });
    };
    ChartImp2.prototype._setPaneOptions = function(options, forceShouldAdjust) {
      var _a2, _b;
      if (isString(options.id)) {
        var pane = this.getDrawPaneById(options.id);
        var shouldMeasureHeight = false;
        if (pane !== null) {
          var shouldAdjust = forceShouldAdjust;
          if (options.id !== PaneIdConstants.CANDLE && isNumber(options.height) && options.height > 0) {
            var minHeight = Math.max((_a2 = options.minHeight) !== null && _a2 !== void 0 ? _a2 : pane.getOptions().minHeight, 0);
            var height = Math.max(minHeight, options.height);
            pane.setBounding({ height });
            shouldAdjust = true;
            shouldMeasureHeight = true;
          }
          if (isString((_b = options.axisOptions) === null || _b === void 0 ? void 0 : _b.name) || isValid(options.gap)) {
            shouldAdjust = true;
          }
          pane.setOptions(options);
          if (shouldAdjust) {
            this.adjustPaneViewport(shouldMeasureHeight, true, true, true, true);
          }
        }
      }
    };
    ChartImp2.prototype.getDrawPaneById = function(paneId) {
      if (paneId === PaneIdConstants.CANDLE) {
        return this._candlePane;
      }
      if (paneId === PaneIdConstants.X_AXIS) {
        return this._xAxisPane;
      }
      var pane = this._drawPanes.find(function(p) {
        return p.getId() === paneId;
      });
      return pane !== null && pane !== void 0 ? pane : null;
    };
    ChartImp2.prototype.getContainer = function() {
      return this._container;
    };
    ChartImp2.prototype.getChartStore = function() {
      return this._chartStore;
    };
    ChartImp2.prototype.getXAxisPane = function() {
      return this._xAxisPane;
    };
    ChartImp2.prototype.getAllDrawPanes = function() {
      return this._drawPanes;
    };
    ChartImp2.prototype.getAllSeparatorPanes = function() {
      return this._separatorPanes;
    };
    ChartImp2.prototype.adjustPaneViewport = function(shouldMeasureHeight, shouldMeasureWidth, shouldUpdate, shouldAdjustYAxis, shouldForceAdjustYAxis) {
      if (shouldMeasureHeight) {
        this._measurePaneHeight();
      }
      var forceMeasureWidth = shouldMeasureWidth;
      var adjustYAxis = shouldAdjustYAxis !== null && shouldAdjustYAxis !== void 0 ? shouldAdjustYAxis : false;
      var forceAdjustYAxis = shouldForceAdjustYAxis !== null && shouldForceAdjustYAxis !== void 0 ? shouldForceAdjustYAxis : false;
      if (adjustYAxis || forceAdjustYAxis) {
        this._drawPanes.forEach(function(pane) {
          var adjust = pane.getAxisComponent().buildTicks(forceAdjustYAxis);
          if (!forceMeasureWidth) {
            forceMeasureWidth = adjust;
          }
        });
      }
      if (forceMeasureWidth) {
        this._measurePaneWidth();
      }
      if (shouldUpdate !== null && shouldUpdate !== void 0 ? shouldUpdate : false) {
        this._xAxisPane.getAxisComponent().buildTicks(true);
        this.updatePane(
          4
          /* UpdateLevel.All */
        );
      }
    };
    ChartImp2.prototype.updatePane = function(level, paneId) {
      if (isValid(paneId)) {
        var pane = this.getDrawPaneById(paneId);
        pane === null || pane === void 0 ? void 0 : pane.update(level);
      } else {
        this._separatorPanes.forEach(function(pane2) {
          pane2.update(level);
        });
        this._drawPanes.forEach(function(pane2) {
          pane2.update(level);
        });
      }
    };
    ChartImp2.prototype.crosshairChange = function(crosshair) {
      var _this = this;
      var actionStore = this._chartStore.getActionStore();
      if (actionStore.has(ActionType.OnCrosshairChange)) {
        var indicatorData_1 = {};
        this._drawPanes.forEach(function(pane) {
          var id = pane.getId();
          var paneIndicatorData = {};
          var indicators2 = _this._chartStore.getIndicatorStore().getInstances(id);
          indicators2.forEach(function(indicator) {
            var _a2;
            var result = indicator.result;
            paneIndicatorData[indicator.name] = result[(_a2 = crosshair.dataIndex) !== null && _a2 !== void 0 ? _a2 : result.length - 1];
          });
          indicatorData_1[id] = paneIndicatorData;
        });
        if (isString(crosshair.paneId)) {
          actionStore.execute(ActionType.OnCrosshairChange, __assign(__assign({}, crosshair), { indicatorData: indicatorData_1 }));
        }
      }
    };
    ChartImp2.prototype.getDom = function(paneId, position) {
      var _a2, _b;
      if (isString(paneId)) {
        var pane = this.getDrawPaneById(paneId);
        if (pane !== null) {
          var pos = position !== null && position !== void 0 ? position : DomPosition.Root;
          switch (pos) {
            case DomPosition.Root: {
              return pane.getContainer();
            }
            case DomPosition.Main: {
              return pane.getMainWidget().getContainer();
            }
            case DomPosition.YAxis: {
              return (_b = (_a2 = pane.getYAxisWidget()) === null || _a2 === void 0 ? void 0 : _a2.getContainer()) !== null && _b !== void 0 ? _b : null;
            }
          }
        }
      } else {
        return this._chartContainer;
      }
      return null;
    };
    ChartImp2.prototype.getSize = function(paneId, position) {
      var _a2, _b;
      if (isValid(paneId)) {
        var pane = this.getDrawPaneById(paneId);
        if (pane !== null) {
          var pos = position !== null && position !== void 0 ? position : DomPosition.Root;
          switch (pos) {
            case DomPosition.Root: {
              return pane.getBounding();
            }
            case DomPosition.Main: {
              return pane.getMainWidget().getBounding();
            }
            case DomPosition.YAxis: {
              return (_b = (_a2 = pane.getYAxisWidget()) === null || _a2 === void 0 ? void 0 : _a2.getBounding()) !== null && _b !== void 0 ? _b : null;
            }
          }
        }
      } else {
        return {
          width: Math.floor(this._chartContainer.clientWidth),
          height: Math.floor(this._chartContainer.clientHeight),
          left: 0,
          top: 0,
          right: 0,
          bottom: 0
        };
      }
      return null;
    };
    ChartImp2.prototype.setStyles = function(styles2) {
      var _a2, _b;
      this._chartStore.setOptions({ styles: styles2 });
      var realStyles;
      if (isString(styles2)) {
        realStyles = getStyles(styles2);
      } else {
        realStyles = styles2;
      }
      if (isValid((_a2 = realStyles === null || realStyles === void 0 ? void 0 : realStyles.yAxis) === null || _a2 === void 0 ? void 0 : _a2.type)) {
        (_b = this._candlePane) === null || _b === void 0 ? void 0 : _b.getAxisComponent().setAutoCalcTickFlag(true);
      }
      this.adjustPaneViewport(true, true, true, true, true);
    };
    ChartImp2.prototype.getStyles = function() {
      return this._chartStore.getStyles();
    };
    ChartImp2.prototype.setLocale = function(locale) {
      this._chartStore.setOptions({ locale });
      this.adjustPaneViewport(true, true, true, true, true);
    };
    ChartImp2.prototype.getLocale = function() {
      return this._chartStore.getLocale();
    };
    ChartImp2.prototype.setCustomApi = function(customApi) {
      this._chartStore.setOptions({ customApi });
      this.adjustPaneViewport(true, true, true, true, true);
    };
    ChartImp2.prototype.setPriceVolumePrecision = function(pricePrecision, volumePrecision) {
      this._chartStore.setPrecision({ price: pricePrecision, volume: volumePrecision });
    };
    ChartImp2.prototype.getPriceVolumePrecision = function() {
      return this._chartStore.getPrecision();
    };
    ChartImp2.prototype.setTimezone = function(timezone) {
      this._chartStore.setOptions({ timezone });
      this._xAxisPane.getAxisComponent().buildTicks(true);
      this._xAxisPane.update(
        3
        /* UpdateLevel.Drawer */
      );
    };
    ChartImp2.prototype.getTimezone = function() {
      return this._chartStore.getTimeScaleStore().getTimezone();
    };
    ChartImp2.prototype.setOffsetRightDistance = function(distance) {
      this._chartStore.getTimeScaleStore().setOffsetRightDistance(distance, true);
    };
    ChartImp2.prototype.getOffsetRightDistance = function() {
      return this._chartStore.getTimeScaleStore().getOffsetRightDistance();
    };
    ChartImp2.prototype.setMaxOffsetLeftDistance = function(distance) {
      if (distance < 0) {
        logWarn("setMaxOffsetLeftDistance", "distance", "distance must greater than zero!!!");
        return;
      }
      this._chartStore.getTimeScaleStore().setMaxOffsetLeftDistance(distance);
    };
    ChartImp2.prototype.setMaxOffsetRightDistance = function(distance) {
      if (distance < 0) {
        logWarn("setMaxOffsetRightDistance", "distance", "distance must greater than zero!!!");
        return;
      }
      this._chartStore.getTimeScaleStore().setMaxOffsetRightDistance(distance);
    };
    ChartImp2.prototype.setLeftMinVisibleBarCount = function(barCount) {
      if (barCount < 0) {
        logWarn("setLeftMinVisibleBarCount", "barCount", "barCount must greater than zero!!!");
        return;
      }
      this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(barCount));
    };
    ChartImp2.prototype.setRightMinVisibleBarCount = function(barCount) {
      if (barCount < 0) {
        logWarn("setRightMinVisibleBarCount", "barCount", "barCount must greater than zero!!!");
        return;
      }
      this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(barCount));
    };
    ChartImp2.prototype.setBarSpace = function(space) {
      this._chartStore.getTimeScaleStore().setBarSpace(space);
    };
    ChartImp2.prototype.getBarSpace = function() {
      return this._chartStore.getTimeScaleStore().getBarSpace().bar;
    };
    ChartImp2.prototype.getVisibleRange = function() {
      return this._chartStore.getTimeScaleStore().getVisibleRange();
    };
    ChartImp2.prototype.clearData = function() {
      this._chartStore.clear();
    };
    ChartImp2.prototype.getDataList = function() {
      return this._chartStore.getDataList();
    };
    ChartImp2.prototype.applyNewData = function(data, more, callback) {
      if (isValid(callback)) {
        logWarn("applyNewData", "", "param `callback` has been deprecated since version 9.8.0, use `subscribeAction('onDataReady')` instead.");
      }
      this._chartStore.addData(data, LoadDataType.Init, more).then(function() {
      }).catch(function() {
      }).finally(function() {
        callback === null || callback === void 0 ? void 0 : callback();
      });
    };
    ChartImp2.prototype.applyMoreData = function(data, more, callback) {
      logWarn("", "", "Api `applyMoreData` has been deprecated since version 9.8.0.");
      this._chartStore.addData(data, LoadDataType.Forward, more !== null && more !== void 0 ? more : true).then(function() {
      }).catch(function() {
      }).finally(function() {
        callback === null || callback === void 0 ? void 0 : callback();
      });
    };
    ChartImp2.prototype.updateData = function(data, callback) {
      if (isValid(callback)) {
        logWarn("updateData", "", "param `callback` has been deprecated since version 9.8.0, use `subscribeAction('onDataReady')` instead.");
      }
      this._chartStore.addData(data).then(function() {
      }).catch(function() {
      }).finally(function() {
        callback === null || callback === void 0 ? void 0 : callback();
      });
    };
    ChartImp2.prototype.loadMore = function(cb) {
      logWarn("", "", "Api `loadMore` has been deprecated since version 9.8.0, use `setLoadDataCallback` instead.");
      this._chartStore.setLoadMoreCallback(cb);
    };
    ChartImp2.prototype.setLoadDataCallback = function(cb) {
      this._chartStore.setLoadDataCallback(cb);
    };
    ChartImp2.prototype.createIndicator = function(value, isStack, paneOptions, callback) {
      var _this = this;
      var _a2;
      var indicator = isString(value) ? { name: value } : value;
      if (getIndicatorClass(indicator.name) === null) {
        logWarn("createIndicator", "value", "indicator not supported, you may need to use registerIndicator to add one!!!");
        return null;
      }
      var paneId = paneOptions === null || paneOptions === void 0 ? void 0 : paneOptions.id;
      var currentPane = this.getDrawPaneById(paneId !== null && paneId !== void 0 ? paneId : "");
      if (currentPane !== null) {
        this._chartStore.getIndicatorStore().addInstance(indicator, paneId !== null && paneId !== void 0 ? paneId : "", isStack !== null && isStack !== void 0 ? isStack : false).then(function(_) {
          var _a3;
          _this._setPaneOptions(paneOptions !== null && paneOptions !== void 0 ? paneOptions : {}, (_a3 = currentPane.getAxisComponent().buildTicks(true)) !== null && _a3 !== void 0 ? _a3 : false);
        }).catch(function(_) {
        });
      } else {
        paneId !== null && paneId !== void 0 ? paneId : paneId = createId(PaneIdConstants.INDICATOR);
        var pane = this._createPane(IndicatorPane, paneId, paneOptions !== null && paneOptions !== void 0 ? paneOptions : {});
        var height = (_a2 = paneOptions === null || paneOptions === void 0 ? void 0 : paneOptions.height) !== null && _a2 !== void 0 ? _a2 : PANE_DEFAULT_HEIGHT;
        pane.setBounding({ height });
        void this._chartStore.getIndicatorStore().addInstance(indicator, paneId, isStack !== null && isStack !== void 0 ? isStack : false).finally(function() {
          _this.adjustPaneViewport(true, true, true, true, true);
          callback === null || callback === void 0 ? void 0 : callback();
        });
      }
      return paneId !== null && paneId !== void 0 ? paneId : null;
    };
    ChartImp2.prototype.overrideIndicator = function(override, paneId, callback) {
      var _this = this;
      this._chartStore.getIndicatorStore().override(override, paneId !== null && paneId !== void 0 ? paneId : null).then(function(_a2) {
        var _b = __read(_a2, 2), onlyUpdateFlag = _b[0], resizeFlag = _b[1];
        if (onlyUpdateFlag || resizeFlag) {
          _this.adjustPaneViewport(false, resizeFlag, true, resizeFlag);
          callback === null || callback === void 0 ? void 0 : callback();
        }
      }).catch(function() {
      });
    };
    ChartImp2.prototype.getIndicatorByPaneId = function(paneId, name) {
      return this._chartStore.getIndicatorStore().getInstanceByPaneId(paneId, name);
    };
    ChartImp2.prototype.removeIndicator = function(paneId, name) {
      var e_1, _a2;
      var _b;
      var indicatorStore = this._chartStore.getIndicatorStore();
      var removed = indicatorStore.removeInstance(paneId, name);
      if (removed) {
        var shouldMeasureHeight = false;
        if (paneId !== PaneIdConstants.CANDLE) {
          if (!indicatorStore.hasInstances(paneId)) {
            var pane = this.getDrawPaneById(paneId);
            var index = this._drawPanes.findIndex(function(p) {
              return p.getId() === paneId;
            });
            if (pane !== null) {
              shouldMeasureHeight = true;
              var separatorPane = this._separatorPanes.get(pane);
              if (isValid(separatorPane)) {
                var topPane = separatorPane === null || separatorPane === void 0 ? void 0 : separatorPane.getTopPane();
                try {
                  for (var _c2 = __values(this._separatorPanes), _d = _c2.next(); !_d.done; _d = _c2.next()) {
                    var item = _d.value;
                    if (item[1].getTopPane().getId() === pane.getId()) {
                      item[1].setTopPane(topPane);
                      break;
                    }
                  }
                } catch (e_1_1) {
                  e_1 = { error: e_1_1 };
                } finally {
                  try {
                    if (_d && !_d.done && (_a2 = _c2.return)) _a2.call(_c2);
                  } finally {
                    if (e_1) throw e_1.error;
                  }
                }
                separatorPane.destroy();
                this._separatorPanes.delete(pane);
              }
              this._drawPanes.splice(index, 1);
              pane.destroy();
              var firstPane = this._drawPanes[0];
              if (isValid(firstPane)) {
                if (firstPane.getId() === PaneIdConstants.X_AXIS) {
                  firstPane = this._drawPanes[1];
                }
              }
              (_b = this._separatorPanes.get(firstPane)) === null || _b === void 0 ? void 0 : _b.destroy();
              this._separatorPanes.delete(firstPane);
            }
          }
        }
        this.adjustPaneViewport(shouldMeasureHeight, true, true, true, true);
      }
    };
    ChartImp2.prototype.createOverlay = function(value, paneId) {
      var overlays2 = [];
      if (isString(value)) {
        overlays2 = [{ name: value }];
      } else if (isArray(value)) {
        overlays2 = value.map(function(v) {
          if (isString(v)) {
            return { name: v };
          }
          return v;
        });
      } else {
        var overlay = value;
        overlays2 = [overlay];
      }
      var appointPaneFlag = true;
      if (!isValid(paneId) || this.getDrawPaneById(paneId) === null) {
        paneId = PaneIdConstants.CANDLE;
        appointPaneFlag = false;
      }
      var ids = this._chartStore.getOverlayStore().addInstances(overlays2, paneId, appointPaneFlag);
      if (isArray(value)) {
        return ids;
      }
      return ids[0];
    };
    ChartImp2.prototype.getOverlayById = function(id) {
      return this._chartStore.getOverlayStore().getInstanceById(id);
    };
    ChartImp2.prototype.overrideOverlay = function(override) {
      this._chartStore.getOverlayStore().override(override);
    };
    ChartImp2.prototype.removeOverlay = function(remove) {
      var overlayRemove;
      if (isValid(remove)) {
        if (isString(remove)) {
          overlayRemove = { id: remove };
        } else {
          overlayRemove = remove;
        }
      }
      this._chartStore.getOverlayStore().removeInstance(overlayRemove);
    };
    ChartImp2.prototype.setPaneOptions = function(options) {
      this._setPaneOptions(options, false);
    };
    ChartImp2.prototype.setZoomEnabled = function(enabled) {
      this._chartStore.getTimeScaleStore().setZoomEnabled(enabled);
    };
    ChartImp2.prototype.isZoomEnabled = function() {
      return this._chartStore.getTimeScaleStore().getZoomEnabled();
    };
    ChartImp2.prototype.setScrollEnabled = function(enabled) {
      this._chartStore.getTimeScaleStore().setScrollEnabled(enabled);
    };
    ChartImp2.prototype.isScrollEnabled = function() {
      return this._chartStore.getTimeScaleStore().getScrollEnabled();
    };
    ChartImp2.prototype.scrollByDistance = function(distance, animationDuration) {
      var duration = isNumber(animationDuration) && animationDuration > 0 ? animationDuration : 0;
      var timeScaleStore = this._chartStore.getTimeScaleStore();
      timeScaleStore.startScroll();
      if (duration > 0) {
        var animation = new Animation({ duration });
        animation.doFrame(function(frameTime) {
          var progressDistance = distance * (frameTime / duration);
          timeScaleStore.scroll(progressDistance);
        });
        animation.start();
      } else {
        timeScaleStore.scroll(distance);
      }
    };
    ChartImp2.prototype.scrollToRealTime = function(animationDuration) {
      var timeScaleStore = this._chartStore.getTimeScaleStore();
      var barSpace = timeScaleStore.getBarSpace().bar;
      var difBarCount = timeScaleStore.getLastBarRightSideDiffBarCount() - timeScaleStore.getInitialOffsetRightDistance() / barSpace;
      var distance = difBarCount * barSpace;
      this.scrollByDistance(distance, animationDuration);
    };
    ChartImp2.prototype.scrollToDataIndex = function(dataIndex, animationDuration) {
      var timeScaleStore = this._chartStore.getTimeScaleStore();
      var distance = (timeScaleStore.getLastBarRightSideDiffBarCount() + (this.getDataList().length - 1 - dataIndex)) * timeScaleStore.getBarSpace().bar;
      this.scrollByDistance(distance, animationDuration);
    };
    ChartImp2.prototype.scrollToTimestamp = function(timestamp, animationDuration) {
      var dataIndex = binarySearchNearest(this.getDataList(), "timestamp", timestamp);
      this.scrollToDataIndex(dataIndex, animationDuration);
    };
    ChartImp2.prototype.zoomAtCoordinate = function(scale, coordinate, animationDuration) {
      var duration = isNumber(animationDuration) && animationDuration > 0 ? animationDuration : 0;
      var timeScaleStore = this._chartStore.getTimeScaleStore();
      var barSpace = timeScaleStore.getBarSpace().bar;
      var scaleBarSpace = barSpace * scale;
      var difSpace = scaleBarSpace - barSpace;
      if (duration > 0) {
        var prevProgressBarSpace_1 = 0;
        var animation = new Animation({ duration });
        animation.doFrame(function(frameTime) {
          var progressBarSpace = difSpace * (frameTime / duration);
          var scale2 = (progressBarSpace - prevProgressBarSpace_1) / timeScaleStore.getBarSpace().bar * SCALE_MULTIPLIER;
          timeScaleStore.zoom(scale2, coordinate);
          prevProgressBarSpace_1 = progressBarSpace;
        });
        animation.start();
      } else {
        timeScaleStore.zoom(difSpace / barSpace * SCALE_MULTIPLIER, coordinate);
      }
    };
    ChartImp2.prototype.zoomAtDataIndex = function(scale, dataIndex, animationDuration) {
      var x = this._chartStore.getTimeScaleStore().dataIndexToCoordinate(dataIndex);
      this.zoomAtCoordinate(scale, { x, y: 0 }, animationDuration);
    };
    ChartImp2.prototype.zoomAtTimestamp = function(scale, timestamp, animationDuration) {
      var dataIndex = binarySearchNearest(this.getDataList(), "timestamp", timestamp);
      this.zoomAtDataIndex(scale, dataIndex, animationDuration);
    };
    ChartImp2.prototype.convertToPixel = function(points, finder) {
      var _a2;
      var _b = finder.paneId, paneId = _b === void 0 ? PaneIdConstants.CANDLE : _b, _c2 = finder.absolute, absolute = _c2 === void 0 ? false : _c2;
      var coordinates = [];
      if (paneId !== PaneIdConstants.X_AXIS) {
        var pane = this.getDrawPaneById(paneId);
        if (pane !== null) {
          var timeScaleStore_1 = this._chartStore.getTimeScaleStore();
          var bounding_1 = pane.getBounding();
          var ps2 = new Array().concat(points);
          var xAxis_1 = this._xAxisPane.getAxisComponent();
          var yAxis_1 = pane.getAxisComponent();
          coordinates = ps2.map(function(point) {
            var coordinate = {};
            var dataIndex = point.dataIndex;
            if (isNumber(point.timestamp)) {
              dataIndex = timeScaleStore_1.timestampToDataIndex(point.timestamp);
            }
            if (isNumber(dataIndex)) {
              coordinate.x = xAxis_1 === null || xAxis_1 === void 0 ? void 0 : xAxis_1.convertToPixel(dataIndex);
            }
            if (isNumber(point.value)) {
              var y = yAxis_1 === null || yAxis_1 === void 0 ? void 0 : yAxis_1.convertToPixel(point.value);
              coordinate.y = absolute ? bounding_1.top + y : y;
            }
            return coordinate;
          });
        }
      }
      return isArray(points) ? coordinates : (_a2 = coordinates[0]) !== null && _a2 !== void 0 ? _a2 : {};
    };
    ChartImp2.prototype.convertFromPixel = function(coordinates, finder) {
      var _a2;
      var _b = finder.paneId, paneId = _b === void 0 ? PaneIdConstants.CANDLE : _b, _c2 = finder.absolute, absolute = _c2 === void 0 ? false : _c2;
      var points = [];
      if (paneId !== PaneIdConstants.X_AXIS) {
        var pane = this.getDrawPaneById(paneId);
        if (pane !== null) {
          var timeScaleStore_2 = this._chartStore.getTimeScaleStore();
          var bounding_2 = pane.getBounding();
          var cs2 = new Array().concat(coordinates);
          var xAxis_2 = this._xAxisPane.getAxisComponent();
          var yAxis_2 = pane.getAxisComponent();
          points = cs2.map(function(coordinate) {
            var _a3, _b2;
            var point = {};
            if (isNumber(coordinate.x)) {
              var dataIndex = (_a3 = xAxis_2 === null || xAxis_2 === void 0 ? void 0 : xAxis_2.convertFromPixel(coordinate.x)) !== null && _a3 !== void 0 ? _a3 : -1;
              point.dataIndex = dataIndex;
              point.timestamp = (_b2 = timeScaleStore_2.dataIndexToTimestamp(dataIndex)) !== null && _b2 !== void 0 ? _b2 : void 0;
            }
            if (isNumber(coordinate.y)) {
              var y = absolute ? coordinate.y - bounding_2.top : coordinate.y;
              point.value = yAxis_2.convertFromPixel(y);
            }
            return point;
          });
        }
      }
      return isArray(coordinates) ? points : (_a2 = points[0]) !== null && _a2 !== void 0 ? _a2 : {};
    };
    ChartImp2.prototype.executeAction = function(type, data) {
      var _a2;
      switch (type) {
        case ActionType.OnCrosshairChange: {
          var crosshair = __assign({}, data);
          crosshair.paneId = (_a2 = crosshair.paneId) !== null && _a2 !== void 0 ? _a2 : PaneIdConstants.CANDLE;
          this._chartStore.getTooltipStore().setCrosshair(crosshair, { notExecuteAction: true });
          break;
        }
      }
    };
    ChartImp2.prototype.subscribeAction = function(type, callback) {
      this._chartStore.getActionStore().subscribe(type, callback);
    };
    ChartImp2.prototype.unsubscribeAction = function(type, callback) {
      this._chartStore.getActionStore().unsubscribe(type, callback);
    };
    ChartImp2.prototype.getConvertPictureUrl = function(includeOverlay, type, backgroundColor) {
      var _this = this;
      var width = this._chartContainer.clientWidth;
      var height = this._chartContainer.clientHeight;
      var canvas = createDom("canvas", {
        width: "".concat(width, "px"),
        height: "".concat(height, "px"),
        boxSizing: "border-box"
      });
      var ctx = canvas.getContext("2d");
      var pixelRatio = getPixelRatio(canvas);
      canvas.width = width * pixelRatio;
      canvas.height = height * pixelRatio;
      ctx.scale(pixelRatio, pixelRatio);
      ctx.fillStyle = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : "#FFFFFF";
      ctx.fillRect(0, 0, width, height);
      var overlayFlag = includeOverlay !== null && includeOverlay !== void 0 ? includeOverlay : false;
      this._drawPanes.forEach(function(pane) {
        var separatorPane = _this._separatorPanes.get(pane);
        if (isValid(separatorPane)) {
          var separatorBounding = separatorPane.getBounding();
          ctx.drawImage(separatorPane.getImage(overlayFlag), separatorBounding.left, separatorBounding.top, separatorBounding.width, separatorBounding.height);
        }
        var bounding = pane.getBounding();
        ctx.drawImage(pane.getImage(overlayFlag), 0, bounding.top, width, bounding.height);
      });
      return canvas.toDataURL("image/".concat(type !== null && type !== void 0 ? type : "jpeg"));
    };
    ChartImp2.prototype.resize = function() {
      this.adjustPaneViewport(true, true, true, true, true);
    };
    ChartImp2.prototype.destroy = function() {
      this._chartEvent.destroy();
      this._drawPanes.forEach(function(pane) {
        pane.destroy();
      });
      this._drawPanes = [];
      this._separatorPanes.forEach(function(pane) {
        pane.destroy();
      });
      this._separatorPanes.clear();
      this._container.removeChild(this._chartContainer);
    };
    return ChartImp2;
  }()
);
var instances = /* @__PURE__ */ new Map();
var chartBaseId = 1;
function init(ds2, options) {
  logTag();
  var dom;
  if (isString(ds2)) {
    dom = document.getElementById(ds2);
  } else {
    dom = ds2;
  }
  if (dom === null) {
    logError("", "", "The chart cannot be initialized correctly. Please check the parameters. The chart container cannot be null and child elements need to be added!!!");
    return null;
  }
  var chart = instances.get(dom.id);
  if (isValid(chart)) {
    logWarn("", "", "The chart has been initialized on the dom！！！");
    return chart;
  }
  var id = "k_line_chart_".concat(chartBaseId++);
  chart = new ChartImp(dom, options);
  chart.id = id;
  dom.setAttribute("k-line-chart-id", id);
  instances.set(id, chart);
  return chart;
}
function dispose(dcs) {
  var _a2, _b;
  var id;
  if (dcs instanceof ChartImp) {
    id = dcs.id;
  } else {
    var dom = void 0;
    if (isString(dcs)) {
      dom = document.getElementById(dcs);
    } else {
      dom = dcs;
    }
    id = (_a2 = dom === null || dom === void 0 ? void 0 : dom.getAttribute("k-line-chart-id")) !== null && _a2 !== void 0 ? _a2 : null;
  }
  if (id !== null) {
    (_b = instances.get(id)) === null || _b === void 0 ? void 0 : _b.destroy();
    instances.delete(id);
  }
}
var utils = {
  clone,
  merge,
  isString,
  isNumber,
  isValid,
  isObject,
  isArray,
  isFunction,
  isBoolean,
  formatValue,
  formatPrecision,
  formatBigNumber,
  formatDate,
  formatThousands,
  formatFoldDecimal,
  calcTextWidth,
  getLinearSlopeIntercept,
  getLinearYFromSlopeIntercept,
  getLinearYFromCoordinates,
  checkCoordinateOnArc,
  checkCoordinateOnCircle,
  checkCoordinateOnLine,
  checkCoordinateOnPolygon,
  checkCoordinateOnRect,
  checkCoordinateOnText,
  drawArc,
  drawCircle,
  drawLine,
  drawPolygon,
  drawRect,
  drawText,
  drawRectText
};

// node_modules/@klinecharts/pro/dist/klinecharts-pro.js
var u5 = Object.defineProperty;
var C5 = (e, t, n) => t in e ? u5(e, t, { enumerable: true, configurable: true, writable: true, value: n }) : e[t] = n;
var B1 = (e, t, n) => (C5(e, typeof t != "symbol" ? t + "" : t, n), n);
function O1(e, t, n) {
  const r = (e.x - t.x) * Math.cos(n) - (e.y - t.y) * Math.sin(n) + t.x, a = (e.x - t.x) * Math.sin(n) + (e.y - t.y) * Math.cos(n) + t.y;
  return { x: r, y: a };
}
function h0(e, t) {
  if (e.length > 1) {
    let n;
    return e[0].x === e[1].x && e[0].y !== e[1].y ? e[0].y < e[1].y ? n = {
      x: e[0].x,
      y: t.height
    } : n = {
      x: e[0].x,
      y: 0
    } : e[0].x > e[1].x ? n = {
      x: 0,
      y: utils.getLinearYFromCoordinates(e[0], e[1], { x: 0, y: e[0].y })
    } : n = {
      x: t.width,
      y: utils.getLinearYFromCoordinates(e[0], e[1], { x: t.width, y: e[0].y })
    }, { coordinates: [e[0], n] };
  }
  return [];
}
function k9(e, t) {
  const n = Math.abs(e.x - t.x), r = Math.abs(e.y - t.y);
  return Math.sqrt(n * n + r * r);
}
var d5 = {
  name: "arrow",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e }) => {
    if (e.length > 1) {
      const t = e[1].x > e[0].x ? 0 : 1, n = utils.getLinearSlopeIntercept(e[0], e[1]);
      let r;
      n ? r = Math.atan(n[0]) + Math.PI * t : e[1].y > e[0].y ? r = Math.PI / 2 : r = Math.PI / 2 * 3;
      const a = O1({ x: e[1].x - 8, y: e[1].y + 4 }, e[1], r), i = O1({ x: e[1].x - 8, y: e[1].y - 4 }, e[1], r);
      return [
        {
          type: "line",
          attrs: { coordinates: e }
        },
        {
          type: "line",
          ignoreEvent: true,
          attrs: { coordinates: [a, e[1], i] }
        }
      ];
    }
    return [];
  }
};
var m5 = {
  name: "circle",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  styles: {
    circle: {
      color: "rgba(22, 119, 255, 0.15)"
    }
  },
  createPointFigures: ({ coordinates: e }) => {
    if (e.length > 1) {
      const t = k9(e[0], e[1]);
      return {
        type: "circle",
        attrs: {
          ...e[0],
          r: t
        },
        styles: { style: "stroke_fill" }
      };
    }
    return [];
  }
};
var p5 = {
  name: "rect",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  styles: {
    polygon: {
      color: "rgba(22, 119, 255, 0.15)"
    }
  },
  createPointFigures: ({ coordinates: e }) => e.length > 1 ? [
    {
      type: "polygon",
      attrs: {
        coordinates: [
          e[0],
          { x: e[1].x, y: e[0].y },
          e[1],
          { x: e[0].x, y: e[1].y }
        ]
      },
      styles: { style: "stroke_fill" }
    }
  ] : []
};
var v5 = {
  name: "parallelogram",
  totalStep: 4,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  styles: {
    polygon: {
      color: "rgba(22, 119, 255, 0.15)"
    }
  },
  createPointFigures: ({ coordinates: e }) => {
    if (e.length === 2)
      return [
        {
          type: "line",
          ignoreEvent: true,
          attrs: { coordinates: e }
        }
      ];
    if (e.length === 3) {
      const t = { x: e[0].x + (e[2].x - e[1].x), y: e[2].y };
      return [
        {
          type: "polygon",
          attrs: { coordinates: [e[0], e[1], e[2], t] },
          styles: { style: "stroke_fill" }
        }
      ];
    }
    return [];
  },
  performEventPressedMove: ({ points: e, performPointIndex: t, performPoint: n }) => {
    t < 2 && (e[0].price = n.price, e[1].price = n.price);
  },
  performEventMoveForDrawing: ({ currentStep: e, points: t, performPoint: n }) => {
    e === 2 && (t[0].price = n.price);
  }
};
var _5 = {
  name: "triangle",
  totalStep: 4,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  styles: {
    polygon: {
      color: "rgba(22, 119, 255, 0.15)"
    }
  },
  createPointFigures: ({ coordinates: e }) => [
    {
      type: "polygon",
      attrs: { coordinates: e },
      styles: { style: "stroke_fill" }
    }
  ]
};
var L5 = {
  name: "fibonacciCircle",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e }) => {
    if (e.length > 1) {
      const t = Math.abs(e[0].x - e[1].x), n = Math.abs(e[0].y - e[1].y), r = Math.sqrt(t * t + n * n), a = [0.236, 0.382, 0.5, 0.618, 0.786, 1], i = [], o = [];
      return a.forEach((s) => {
        const c = r * s;
        i.push(
          { ...e[0], r: c }
        ), o.push({
          x: e[0].x,
          y: e[0].y + c + 6,
          text: `${(s * 100).toFixed(1)}%`
        });
      }), [
        {
          type: "circle",
          attrs: i,
          styles: { style: "stroke" }
        },
        {
          type: "text",
          ignoreEvent: true,
          attrs: o
        }
      ];
    }
    return [];
  }
};
var $5 = {
  name: "fibonacciSegment",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e, overlay: t, precision: n }) => {
    const r = [], a = [];
    if (e.length > 1) {
      const i = e[1].x > e[0].x ? e[0].x : e[1].x, o = [1, 0.786, 0.618, 0.5, 0.382, 0.236, 0], s = e[0].y - e[1].y, c = t.points, C = c[0].value - c[1].value;
      o.forEach((u) => {
        const y = e[1].y + s * u, p = (c[1].value + C * u).toFixed(n.price);
        r.push({ coordinates: [{ x: e[0].x, y }, { x: e[1].x, y }] }), a.push({
          x: i,
          y,
          text: `${p} (${(u * 100).toFixed(1)}%)`,
          baseline: "bottom"
        });
      });
    }
    return [
      {
        type: "line",
        attrs: r
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: a
      }
    ];
  }
};
var b5 = {
  name: "fibonacciSpiral",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e, bounding: t }) => {
    if (e.length > 1) {
      const n = k9(e[0], e[1]) / Math.sqrt(24), r = e[1].x > e[0].x ? 0 : 1, a = utils.getLinearSlopeIntercept(e[0], e[1]);
      let i;
      a ? i = Math.atan(a[0]) + Math.PI * r : e[1].y > e[0].y ? i = Math.PI / 2 : i = Math.PI / 2 * 3;
      const o = O1(
        { x: e[0].x - n, y: e[0].y },
        e[0],
        i
      ), s = O1(
        { x: e[0].x - n, y: e[0].y - n },
        e[0],
        i
      ), c = [{
        ...o,
        r: n,
        startAngle: i,
        endAngle: i + Math.PI / 2
      }, {
        ...s,
        r: n * 2,
        startAngle: i + Math.PI / 2,
        endAngle: i + Math.PI
      }];
      let C = e[0].x - n, u = e[0].y - n;
      for (let y = 2; y < 9; y++) {
        const p = c[y - 2].r + c[y - 1].r;
        let L = 0;
        switch (y % 4) {
          case 0: {
            L = i, C -= c[y - 2].r;
            break;
          }
          case 1: {
            L = i + Math.PI / 2, u -= c[y - 2].r;
            break;
          }
          case 2: {
            L = i + Math.PI, C += c[y - 2].r;
            break;
          }
          case 3: {
            L = i + Math.PI / 2 * 3, u += c[y - 2].r;
            break;
          }
        }
        const M = L + Math.PI / 2, P = O1({ x: C, y: u }, e[0], i);
        c.push({
          ...P,
          r: p,
          startAngle: L,
          endAngle: M
        });
      }
      return [
        {
          type: "arc",
          attrs: c
        },
        {
          type: "line",
          attrs: h0(e, t)
        }
      ];
    }
    return [];
  }
};
var x5 = {
  name: "fibonacciSpeedResistanceFan",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e, bounding: t }) => {
    const n = [];
    let r = [];
    const a = [];
    if (e.length > 1) {
      const i = e[1].x > e[0].x ? -38 : 4, o = e[1].y > e[0].y ? -2 : 20, s = e[1].x - e[0].x, c = e[1].y - e[0].y;
      [1, 0.75, 0.618, 0.5, 0.382, 0.25, 0].forEach((u) => {
        const y = e[1].x - s * u, p = e[1].y - c * u;
        n.push({ coordinates: [{ x: y, y: e[0].y }, { x: y, y: e[1].y }] }), n.push({ coordinates: [{ x: e[0].x, y: p }, { x: e[1].x, y: p }] }), r = r.concat(h0([e[0], { x: y, y: e[1].y }], t)), r = r.concat(h0([e[0], { x: e[1].x, y: p }], t)), a.unshift({
          x: e[0].x + i,
          y: p + 10,
          text: `${u.toFixed(3)}`
        }), a.unshift({
          x: y - 18,
          y: e[0].y + o,
          text: `${u.toFixed(3)}`
        });
      });
    }
    return [
      {
        type: "line",
        attrs: n
      },
      {
        type: "line",
        attrs: r
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: a
      }
    ];
  }
};
var k5 = {
  name: "fibonacciExtension",
  totalStep: 4,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e, overlay: t, precision: n }) => {
    const r = [], a = [];
    if (e.length > 2) {
      const i = t.points, o = i[1].value - i[0].value, s = e[1].y - e[0].y, c = [0, 0.236, 0.382, 0.5, 0.618, 0.786, 1], C = e[2].x > e[1].x ? e[1].x : e[2].x;
      c.forEach((u) => {
        const y = e[2].y + s * u, p = (i[2].value + o * u).toFixed(n.price);
        r.push({ coordinates: [{ x: e[1].x, y }, { x: e[2].x, y }] }), a.push({
          x: C,
          y,
          text: `${p} (${(u * 100).toFixed(1)}%)`,
          baseline: "bottom"
        });
      });
    }
    return [
      {
        type: "line",
        attrs: { coordinates: e },
        styles: { style: "dashed" }
      },
      {
        type: "line",
        attrs: r
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: a
      }
    ];
  }
};
var A5 = {
  name: "gannBox",
  totalStep: 3,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  styles: {
    polygon: {
      color: "rgba(22, 119, 255, 0.15)"
    }
  },
  createPointFigures: ({ coordinates: e }) => {
    if (e.length > 1) {
      const t = (e[1].y - e[0].y) / 4, n = e[1].x - e[0].x, r = [
        { coordinates: [e[0], { x: e[1].x, y: e[1].y - t }] },
        { coordinates: [e[0], { x: e[1].x, y: e[1].y - t * 2 }] },
        { coordinates: [{ x: e[0].x, y: e[1].y }, { x: e[1].x, y: e[0].y + t }] },
        { coordinates: [{ x: e[0].x, y: e[1].y }, { x: e[1].x, y: e[0].y + t * 2 }] },
        { coordinates: [{ ...e[0] }, { x: e[0].x + n * 0.236, y: e[1].y }] },
        { coordinates: [{ ...e[0] }, { x: e[0].x + n * 0.5, y: e[1].y }] },
        { coordinates: [{ x: e[0].x, y: e[1].y }, { x: e[0].x + n * 0.236, y: e[0].y }] },
        { coordinates: [{ x: e[0].x, y: e[1].y }, { x: e[0].x + n * 0.5, y: e[0].y }] }
      ], a = [
        { coordinates: [e[0], e[1]] },
        { coordinates: [{ x: e[0].x, y: e[1].y }, { x: e[1].x, y: e[0].y }] }
      ];
      return [
        {
          type: "line",
          attrs: [
            { coordinates: [e[0], { x: e[1].x, y: e[0].y }] },
            { coordinates: [{ x: e[1].x, y: e[0].y }, e[1]] },
            { coordinates: [e[1], { x: e[0].x, y: e[1].y }] },
            { coordinates: [{ x: e[0].x, y: e[1].y }, e[0]] }
          ]
        },
        {
          type: "polygon",
          ignoreEvent: true,
          attrs: {
            coordinates: [
              e[0],
              { x: e[1].x, y: e[0].y },
              e[1],
              { x: e[0].x, y: e[1].y }
            ]
          },
          styles: { style: "fill" }
        },
        {
          type: "line",
          attrs: r,
          styles: { style: "dashed" }
        },
        {
          type: "line",
          attrs: a
        }
      ];
    }
    return [];
  }
};
var M5 = {
  name: "threeWaves",
  totalStep: 5,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e }) => {
    const t = e.map((n, r) => ({
      ...n,
      text: `(${r})`,
      baseline: "bottom"
    }));
    return [
      {
        type: "line",
        attrs: { coordinates: e }
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: t
      }
    ];
  }
};
var w5 = {
  name: "fiveWaves",
  totalStep: 7,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e }) => {
    const t = e.map((n, r) => ({
      ...n,
      text: `(${r})`,
      baseline: "bottom"
    }));
    return [
      {
        type: "line",
        attrs: { coordinates: e }
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: t
      }
    ];
  }
};
var S5 = {
  name: "eightWaves",
  totalStep: 10,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e }) => {
    const t = e.map((n, r) => ({
      ...n,
      text: `(${r})`,
      baseline: "bottom"
    }));
    return [
      {
        type: "line",
        attrs: { coordinates: e }
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: t
      }
    ];
  }
};
var T5 = {
  name: "anyWaves",
  totalStep: Number.MAX_SAFE_INTEGER,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e }) => {
    const t = e.map((n, r) => ({
      ...n,
      text: `(${r})`,
      baseline: "bottom"
    }));
    return [
      {
        type: "line",
        attrs: { coordinates: e }
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: t
      }
    ];
  }
};
var I5 = {
  name: "abcd",
  totalStep: 5,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  createPointFigures: ({ coordinates: e }) => {
    let t = [], n = [];
    const r = ["A", "B", "C", "D"], a = e.map((i, o) => ({
      ...i,
      baseline: "bottom",
      text: `(${r[o]})`
    }));
    return e.length > 2 && (t = [e[0], e[2]], e.length > 3 && (n = [e[1], e[3]])), [
      {
        type: "line",
        attrs: { coordinates: e }
      },
      {
        type: "line",
        attrs: [{ coordinates: t }, { coordinates: n }],
        styles: { style: "dashed" }
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: a
      }
    ];
  }
};
var N5 = {
  name: "xabcd",
  totalStep: 6,
  needDefaultPointFigure: true,
  needDefaultXAxisFigure: true,
  needDefaultYAxisFigure: true,
  styles: {
    polygon: {
      color: "rgba(22, 119, 255, 0.15)"
    }
  },
  createPointFigures: ({ coordinates: e, overlay: t }) => {
    const n = [], r = [], a = ["X", "A", "B", "C", "D"], i = e.map((o, s) => ({
      ...o,
      baseline: "bottom",
      text: `(${a[s]})`
    }));
    return e.length > 2 && (n.push({ coordinates: [e[0], e[2]] }), r.push({ coordinates: [e[0], e[1], e[2]] }), e.length > 3 && (n.push({ coordinates: [e[1], e[3]] }), e.length > 4 && (n.push({ coordinates: [e[2], e[4]] }), r.push({ coordinates: [e[2], e[3], e[4]] })))), [
      {
        type: "line",
        attrs: { coordinates: e }
      },
      {
        type: "line",
        attrs: n,
        styles: { style: "dashed" }
      },
      {
        type: "polygon",
        ignoreEvent: true,
        attrs: r
      },
      {
        type: "text",
        ignoreEvent: true,
        attrs: i
      }
    ];
  }
};
var D5 = [
  d5,
  m5,
  p5,
  _5,
  v5,
  L5,
  $5,
  b5,
  x5,
  k5,
  A5,
  M5,
  w5,
  S5,
  T5,
  I5,
  N5
];
var Kl = class {
  constructor(t) {
    B1(this, "_apiKey");
    B1(this, "_prevSymbolMarket");
    B1(this, "_ws");
    this._apiKey = t;
  }
  async searchSymbols(t) {
    return await ((await (await fetch(`https://api.polygon.io/v3/reference/tickers?apiKey=${this._apiKey}&active=true&search=${t ?? ""}`)).json()).results || []).map((a) => ({
      ticker: a.ticker,
      name: a.name,
      shortName: a.ticker,
      market: a.market,
      exchange: a.primary_exchange,
      priceCurrency: a.currency_name,
      type: a.type,
      logo: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAA66SURBVHic7Z17cFTVGcB/527AiKGgRA0ShGhKoQjFMb4qUMCMPIrWqdbHSEdlHDGgI9V2aq2d1hmKtVbRsSTGEcQRp4pStaZQlNYUwYLiSKU0SCMBDRCmoQSJGGF3T/84d2VZk+w9d899hf3NMBnl3ns+5vtyHt/5HoIehpQIaijDYjiSciRlwCCgBCgG+gNFQCGCAvUScaADaAfagFagBdiFoAlBI0m2UkWTEMgA/lmeIYIWIFdkLQNJMBbBJUjOA8agFOwF7cAmBO8hWUeMtWIWezwayxciZwByGb1pZTyCaUguA0YGLNIWBK8jWUExa8Q1HA5YHi0iYQByGTH2UYnkBmA6cHLQMnXBfqAOwXMMYLW4hkTQAmUj1AYgqzkLuAXBTUgGBi2PFoI9SJYAT4nZbA9anK4IpQHIhUzE4i4k04OWxQiCOpI8IubwZtCiZBIqA5A1TEdyH3Bh0LJ4xAYE80QVdUELkiIUBiCf4FIk85FcELQsviB4B8G94jb+GrwoASKfZBgJHkUyNUg5AkOwkhhzxa1sC06EAJALKUJwL3A30DsIGULEYeBhJPPFHNr9Htx3A5A1TECyGCjze+yQ04Rgpqii3s9BfTMAWUsfksxD8iO/xowkggVY3Cdmccif4XxAPskw4rwCjPBjvB5AAwVc6cfewPJ6AFnNzcTZSF75OowgzkZZzc1eD+SZAUiJkNX8FlgM9PVqnB5MX2CxrOa3Uno3U3vyYVlLPxIshR7iyQueOmLMELM4YPrDxg1A1jKQJKuQjDL97eMawWYsJpu+fjZqAPL3DMFiNVBu8rt5vqSRJJXidnaa+qAxA5CPU0aMvwFDTX0zT6fsIMEkcQdNJj5mxADs3/x68sr3ix0kmWBiJsjZAOyQrDXkp32/aSTG+Fz3BDkZgKylH0neym/4AkJtDMflcjpw7QeQEkGCpXnlB4hkFAmW5uIncO8IquFB8uf8MDDd1oUrXFmO7aJc7HbQPJ4wU8zmad2XtA3AvtjZSN69GzYOUkCF7gWSlgHIWvqQyF/shJgGYlToXCXr7QGSzCOv/DAzwtaRYxzPAHYkT+jCmvN0gmCi08giRwZgx/B9QD6MKyo0IRntJMbQ2RKgAjjzyo8OZbbOspJ1BrB3/ZvJR+9GjcMUMCrbqSD7DJDgUfLKjyK9bd11S7czgHyCS0my2pxMIaHvUCgshl5FUFQKQtWJ4FALHGmHz5rhizY43BaomEawqOwuA6mg25cl840L5DexQiithNMvhNMvglMr4IT+zt5t3QS762H332FXfTQNQumwy1zLLmcAO1HzNU+E8oNTK+AbN8KwGc4V3h3JODS9Av98GPauz/17fiK4vKuE1K4NoJr1RDFLd+BY+PYCOK3CuzH2rof3fg07Q5Pkm40NYjYXdfYXnRqAXMhEBH/zVibDFBbDRQ/AiFv8G3PbUlhTpfYNYUcyqbP6BJ2fAizu8lwgkwwcC9c3+Kt8UMvLtZuhZKy/47qhC51+ZQawy7J85LlApjhjAkx7Te3ogyIZhz9PhebQH5jOzixX09kM4POvUQ6cdTVc/kawygewCmDKy2omCjdf0e0xM4BdjeuTSBRk6jtUTb9BKz+djlZ4eRy0bQ1aks4R7GEAg9Orlx07A6hSbOFXPsCkp8OlfFAb0UnaQTn+IRnIPirT/1dBxgM3+CqQW0beptZ+NyTj0LIW9m6A//0L2puP/l1RKXytHAZ9RzmNYoX63z/9IrU53LbUnXxeo3S8KvWfXy4BdgXOFsJbhFFhFcAPP4E+JXrvJeOw+TH44NFjld4VfUrg3Htg5Cx9QzjUAn8YEVbP4X6KKUlVND26BLQynrArH9TGT1f5h1pg+fnw9o+dKT/1zrq58MeL4UCj3nh9StQsFU5OtnUNpBuAYFog4ugy5Lt6z3/RBq9OVH59N7RuUu93tOq9N3KWu/H8IE3XRw1AFV4OP2dO0Xt+4/2578o/a1YePx36DoXiMbmN6xVpurbAzu8Lvup2dgqL1R+nHGmHLU+YGfujl/RnkUGV2Z8JhpG2zu0ZIEHoPRgA9NPMP21eDYkOc+M3LNJ7/rTzzI1tGlvnygAElwQqjFPc7MZNouvq1TVYP7F1rgxAddrIkw3dvYTOcuU3ts4L7B47Id2tZHBwh97zXvwGNr4AfU539uyhvebHN8cYKREiUrd/sUK49XPnzyfj8FyZ87P/8cfZFhbDg5bCMYkOdSRzilUAFz/knTxRx2K4hYxYaZcdmmFY5ddBxa88ESXySMotu69edNi+XP+d838Jlz4bvtvDoJGUWaimitFhz1p3a/qwGXBdg/qZJ8UgC9VRMzokOuDdX7h7t6hUzQTX2fGDbq57exYlQlbzb6KY83/1uyr2PxeOtKtY/w+fUQkgybgJyaJEg5DV7IaIRAGlc8o58P1/mFvXj7SrOP+df4aP/6J/+xdN9ghZzadEtd7PmVNg6mvquGeSZFzNCB8th8bnwxrYYYKDQlZzGOgVtCSuGXELjK8xbwQpEh3KCLbURi8lLDtHhKwhiYcNCXzhzClw2YveH/N218O796ufPQGB7BkGANB/OEx9Wf30mubV8NYd4Q3/dopAWkh6xta3bSssO1clbZqMAeiM0kq45n3lYfRq6fEDSTzam8Cu6FcOYx/XDx9zw+56eON687EH/nDQAv+7VXrOgUaVq/fyOHXO9/J8f8YE+N6b4Q7+6Jr26DqCdOhXDufcrgpGmCgW0RmHWuCVcfoh5MHSIGQ1a4BxQUviC7FCtSycdRUMmW7eGNq2wkvnR6NegOItIatZBvwgaEl8xypQ03f5tcooTio1892ddbDicjPf8p4XC4BdQUsRCMm4Os6lAj1PrYCzr1bLhG7mUTpDpsM3boIPl5iQ0mt2WQgz3aciz383wvp74NnBsOoH7jOJAC5ZAL092muYRNBkIYjUrsVzknHY/hK8eK77490J/WH0XPOymUbQaJEk4u4sD2l8Hl4YBZ+syv5sJqPmhN9JlGSrRRVN9ERfgCk6WmHlldCyTu+9wmL3NQz8oZ0qmiwhkEAOC95xQKIDVl2tf7wbPNkbecywSQikmqME7yFDnB/Yq0jVBXDK5y0qqMMkh1rgg8fgvJ87fyes2cGgdE6qRIxkHXBnkPJ0i27tnb3rzRsAKLeyjgGE2T2sdG7nBsZYG6gw2dD15Zty6mTy3416z+fiT/AaW+cWgN1/dkugAnXHZ816629RqXeJmTqZSeGNOt6S6jmcXiLm9cDEcYLuJcsQj5qanhji32qnpOk6vUTMikCEcYru9DvMg4p3/cr1zvY6s4WfpOn6qAEUswbYH4Q8jtB1xpRWmp8Fvq6ZVfTpDrPjm2G/rWsgzQDsunHhLYD/8V9UxS8dxj1ubiN2UimMuVvvnX2hdK/UpWoEQmapWMFzvovjlCPt+jV6+g5V0Tp9h+Y2dp8SuMJFUeqPXbiQvSZDx8cawABWI9TuMJS8/xv9jJ3+w1VR6dFz3fnmB09RGUi60cZftIWvfLwqFn2MUMcYgLiGBJIlvgqlQ0crvP0T/fd6Fakr2hv3qJ+Dp3R/TDzlHPjmbXDVuzB9pbsZpGGR99HJukiWpFcKh6g2jJhWp18xtDMOtSglpa58+5QcbSeXC+3N6hYxfCllX2kY0XnPoBpeQ+LRQdoAJ5Wq7OCwetpWXB6+hlKCOlHFV2LVOu8ZlOQRzwXKhc+aVf3eMMbiNywKn/KhS51Gu21c/+Fqlx+WmWD7cnjjujDWGeiybVzXvYMF8zwTxxRtW1Usfi7xe6b48JmwKr9bXXbfO7iGDUguMC+RYawCuGAefOtu/8OwjrSrjOF//s7fcZ0ieEdUdT2Td9893GEP+sBJxlVE7/Mj1J29XzS9qnb7YVU+ZNVh1rRwWcMKJFPNSeQDp5yjHD/l15qvGZDoUEbWsCh8jp5MBCtFVfeNQLIbwJMMI85moLcxwfwilQo2eLJq5uQ2ROuLNnUbuX05/CcyJWMOU8AocSvbunvIUWEIWc184GdGxAqSXkWqzWvxGCgcoJw+J2Y4flI3eAd3qq5i+zZFLeEzxQNidvYl3JkBLKQIwQcQsaqixy9NSEaLOdnD/bvfBNqIObQjmJm7XHl8QTDTifLBoQEAiCrqESxwL1UeXxAsEFXUO33csQHYT98HNGiKlMc/GmwdOUa7Oph9KthIT6srFH0OUkBFtl1/JnozAGAPEN4kkuOXO3WVDy4MAEDM5mkg34ojPDxk60Qb1wUi7WZTf4IQxw0cH9RRxRV2kq82rmYAACGQxJiBYLPbb+TJEcFmYsxwq3zIwQAAxCwOYDEZ8lVGAqARi8liFgdy+UhOBgB2XmGSSmBHrt/K45gdJKlM5fflQs4GACBuZycJJpE3Aj/YQYJJ4nZ2mviYEQMAEHfQRJIJ5JcDL2kkyQRxh7nKbsbLxMtaBpJkFZJRpr99XCPYbK/5RhN3jM0AKcQs9mAxjjDnGUaPOizGmVY+eDADpLD9BA8CLlJ58qTxEFX8NJejXnd43ilEVnMz8Bj5uwNdDgJ3uvXwOcWXVjH2BdIr9PSy9OZooIAr3fj2dTG+B+gMcSvbiFGRjydwgGABMf1bPffD+YysYQKSxeTDyzJpQjBTJ5jDBL7MAOmIKuqRjAYegKOVKo5jDgMPIBntt/IhgBkgHfkkw0jwaOTyDkwhWEmMuX5N952LEALkE1yKZH4k0tBMIHgHwb3iNv4avCghQtYwHcl9hD0r2T0bEMwTVeFxkoXKAFLIhUzE4q5QF6nQQVBHkkfEHN4MWpRMQmkAKexyNbcguAkZsRb3gj12vaWnMsuyhIlQG0AKuYwY+6hEcgMqBO3koGXqgv1AHYLnGMDqzIJMYSQSBpCOXEZvWhmPYBqSy4CRAYu0BcHrSFZQzJr0IoxRIHIGkImsZSAJxiK4BMl5wBjAqz7y7cAmu8HGOmKs9eKGzk8ibwCZ2LeQZVgMR1KOpAwYBJQAxUB/lIEUIr5smBEHOlAKbgNagRZgF4ImBI0k2UoVTV7dygXF/wF+fTz59Jc5ygAAAABJRU5ErkJggg=="
    }));
  }
  async getHistoryKLineData(t, n, r, a) {
    return await ((await (await fetch(`https://api.polygon.io/v2/aggs/ticker/${t.ticker}/range/${n.multiplier}/${n.timespan}/${r}/${a}?apiKey=${this._apiKey}`)).json()).results || []).map((s) => ({
      timestamp: s.t,
      open: s.o,
      high: s.h,
      low: s.l,
      close: s.c,
      volume: s.v,
      turnover: s.vw
    }));
  }
  subscribe(t, n, r) {
    var a, i;
    this._prevSymbolMarket !== t.market ? ((a = this._ws) == null || a.close(), this._ws = new WebSocket(`wss://delayed.polygon.io/${t.market}`), this._ws.onopen = () => {
      var o;
      (o = this._ws) == null || o.send(JSON.stringify({ action: "auth", params: this._apiKey }));
    }, this._ws.onmessage = (o) => {
      var c;
      const s = JSON.parse(o.data);
      s[0].ev === "status" ? s[0].status === "auth_success" && ((c = this._ws) == null || c.send(JSON.stringify({ action: "subscribe", params: `T.${t.ticker}` }))) : "sym" in s && r({
        timestamp: s.s,
        open: s.o,
        high: s.h,
        low: s.l,
        close: s.c,
        volume: s.v,
        turnover: s.vw
      });
    }) : (i = this._ws) == null || i.send(JSON.stringify({ action: "subscribe", params: `T.${t.ticker}` })), this._prevSymbolMarket = t.market;
  }
  unsubscribe(t, n) {
  }
};
var V = {};
function B5(e) {
  V.context = e;
}
var P5 = (e, t) => e === t;
var d0 = Symbol("solid-proxy");
var O5 = Symbol("solid-track");
var X1 = {
  equals: P5
};
var A9 = I9;
var o1 = 1;
var J1 = 2;
var M9 = {
  owned: null,
  cleanups: null,
  context: null,
  owner: null
};
var C0 = {};
var R = null;
var y1 = null;
var N = null;
var Y = null;
var i1 = null;
var x0 = 0;
function H1(e, t) {
  const n = N, r = R, a = e.length === 0, i = a ? M9 : {
    owned: null,
    cleanups: null,
    context: null,
    owner: t === void 0 ? r : t
  }, o = a ? e : () => e(() => s1(() => a0(i)));
  R = i, N = null;
  try {
    return u1(o, true);
  } finally {
    N = n, R = r;
  }
}
function $(e, t) {
  t = t ? Object.assign({}, X1, t) : X1;
  const n = {
    value: e,
    observers: null,
    observerSlots: null,
    comparator: t.equals || void 0
  }, r = (a) => (typeof a == "function" && (a = a(n.value)), T9(n, a));
  return [S9.bind(n), r];
}
function F0(e, t, n) {
  const r = r0(e, t, true, o1);
  _1(r);
}
function Z(e, t, n) {
  const r = r0(e, t, false, o1);
  _1(r);
}
function a1(e, t, n) {
  A9 = Q5;
  const r = r0(e, t, false, o1);
  r.user = true, i1 ? i1.push(r) : _1(r);
}
function F(e, t, n) {
  n = n ? Object.assign({}, X1, n) : X1;
  const r = r0(e, t, true, 0);
  return r.observers = null, r.observerSlots = null, r.comparator = n.equals || void 0, _1(r), S9.bind(r);
}
function E5(e, t, n) {
  let r, a, i;
  arguments.length === 2 && typeof t == "object" || arguments.length === 1 ? (r = true, a = e, i = t || {}) : (r = e, a = t, i = n || {});
  let o = null, s = C0, c = null, C = false, u = "initialValue" in i, y = typeof r == "function" && F(r);
  const p = /* @__PURE__ */ new Set(), [L, M] = (i.storage || $)(i.initialValue), [P, K] = $(void 0), [w, Q] = $(void 0, {
    equals: false
  }), [S, A] = $(u ? "ready" : "unresolved");
  if (V.context) {
    c = `${V.context.id}${V.context.count++}`;
    let x;
    i.ssrLoadFrom === "initial" ? s = i.initialValue : V.load && (x = V.load(c)) && (s = x[0]);
  }
  function b(x, D, j, n1) {
    return o === x && (o = null, u = true, (x === s || D === s) && i.onHydrated && queueMicrotask(() => i.onHydrated(n1, {
      value: D
    })), s = C0, O(D, j)), D;
  }
  function O(x, D) {
    u1(() => {
      D === void 0 && M(() => x), A(D !== void 0 ? "errored" : "ready"), K(D);
      for (const j of p.keys())
        j.decrement();
      p.clear();
    }, false);
  }
  function H() {
    const x = F5, D = L(), j = P();
    if (j !== void 0 && !o)
      throw j;
    return N && !N.user && x && F0(() => {
      w(), o && (x.resolved || p.has(x) || (x.increment(), p.add(x)));
    }), D;
  }
  function t1(x = true) {
    if (x !== false && C)
      return;
    C = false;
    const D = y ? y() : r;
    if (D == null || D === false) {
      b(o, s1(L));
      return;
    }
    const j = s !== C0 ? s : s1(() => a(D, {
      value: L(),
      refetching: x
    }));
    return typeof j != "object" || !(j && "then" in j) ? (b(o, j, void 0, D), j) : (o = j, C = true, queueMicrotask(() => C = false), u1(() => {
      A(u ? "refreshing" : "pending"), Q();
    }, false), j.then((n1) => b(j, n1, void 0, D), (n1) => b(j, void 0, D9(n1), D)));
  }
  return Object.defineProperties(H, {
    state: {
      get: () => S()
    },
    error: {
      get: () => P()
    },
    loading: {
      get() {
        const x = S();
        return x === "pending" || x === "refreshing";
      }
    },
    latest: {
      get() {
        if (!u)
          return H();
        const x = P();
        if (x && !o)
          throw x;
        return L();
      }
    }
  }), y ? F0(() => t1(false)) : t1(false), [H, {
    refetch: t1,
    mutate: M
  }];
}
function s1(e) {
  if (N === null)
    return e();
  const t = N;
  N = null;
  try {
    return e();
  } finally {
    N = t;
  }
}
function w9(e) {
  a1(() => s1(e));
}
function k0(e) {
  return R === null || (R.cleanups === null ? R.cleanups = [e] : R.cleanups.push(e)), e;
}
function K5(e) {
  const t = N, n = R;
  return Promise.resolve().then(() => {
    N = t, R = n;
    let r;
    return u1(e, false), N = R = null, r ? r.done : void 0;
  });
}
var F5;
function S9() {
  const e = y1;
  if (this.sources && (this.state || e))
    if (this.state === o1 || e)
      _1(this);
    else {
      const t = Y;
      Y = null, u1(() => q1(this), false), Y = t;
    }
  if (N) {
    const t = this.observers ? this.observers.length : 0;
    N.sources ? (N.sources.push(this), N.sourceSlots.push(t)) : (N.sources = [this], N.sourceSlots = [t]), this.observers ? (this.observers.push(N), this.observerSlots.push(N.sources.length - 1)) : (this.observers = [N], this.observerSlots = [N.sources.length - 1]);
  }
  return this.value;
}
function T9(e, t, n) {
  let r = e.value;
  return (!e.comparator || !e.comparator(r, t)) && (e.value = t, e.observers && e.observers.length && u1(() => {
    for (let a = 0; a < e.observers.length; a += 1) {
      const i = e.observers[a], o = y1 && y1.running;
      o && y1.disposed.has(i), (o && !i.tState || !o && !i.state) && (i.pure ? Y.push(i) : i1.push(i), i.observers && N9(i)), o || (i.state = o1);
    }
    if (Y.length > 1e6)
      throw Y = [], new Error();
  }, false)), t;
}
function _1(e) {
  if (!e.fn)
    return;
  a0(e);
  const t = R, n = N, r = x0;
  N = R = e, j5(e, e.value, r), N = n, R = t;
}
function j5(e, t, n) {
  let r;
  try {
    r = e.fn(t);
  } catch (a) {
    e.pure && (e.state = o1, e.owned && e.owned.forEach(a0), e.owned = null), B9(a);
  }
  (!e.updatedAt || e.updatedAt <= n) && (e.updatedAt != null && "observers" in e ? T9(e, r) : e.value = r, e.updatedAt = n);
}
function r0(e, t, n, r = o1, a) {
  const i = {
    fn: e,
    state: r,
    updatedAt: null,
    owned: null,
    sources: null,
    sourceSlots: null,
    cleanups: null,
    value: t,
    owner: R,
    context: null,
    pure: n
  };
  return R === null || R !== M9 && (R.owned ? R.owned.push(i) : R.owned = [i]), i;
}
function W1(e) {
  const t = y1;
  if (e.state === 0 || t)
    return;
  if (e.state === J1 || t)
    return q1(e);
  if (e.suspense && s1(e.suspense.inFallback))
    return e.suspense.effects.push(e);
  const n = [e];
  for (; (e = e.owner) && (!e.updatedAt || e.updatedAt < x0); )
    (e.state || t) && n.push(e);
  for (let r = n.length - 1; r >= 0; r--)
    if (e = n[r], e.state === o1 || t)
      _1(e);
    else if (e.state === J1 || t) {
      const a = Y;
      Y = null, u1(() => q1(e, n[0]), false), Y = a;
    }
}
function u1(e, t) {
  if (Y)
    return e();
  let n = false;
  t || (Y = []), i1 ? n = true : i1 = [], x0++;
  try {
    const r = e();
    return Z5(n), r;
  } catch (r) {
    n || (i1 = null), Y = null, B9(r);
  }
}
function Z5(e) {
  if (Y && (I9(Y), Y = null), e)
    return;
  const t = i1;
  i1 = null, t.length && u1(() => A9(t), false);
}
function I9(e) {
  for (let t = 0; t < e.length; t++)
    W1(e[t]);
}
function Q5(e) {
  let t, n = 0;
  for (t = 0; t < e.length; t++) {
    const r = e[t];
    r.user ? e[n++] = r : W1(r);
  }
  for (V.context && B5(), t = 0; t < n; t++)
    W1(e[t]);
}
function q1(e, t) {
  const n = y1;
  e.state = 0;
  for (let r = 0; r < e.sources.length; r += 1) {
    const a = e.sources[r];
    a.sources && (a.state === o1 || n ? a !== t && W1(a) : (a.state === J1 || n) && q1(a, t));
  }
}
function N9(e) {
  const t = y1;
  for (let n = 0; n < e.observers.length; n += 1) {
    const r = e.observers[n];
    (!r.state || t) && (r.state = J1, r.pure ? Y.push(r) : i1.push(r), r.observers && N9(r));
  }
}
function a0(e) {
  let t;
  if (e.sources)
    for (; e.sources.length; ) {
      const n = e.sources.pop(), r = e.sourceSlots.pop(), a = n.observers;
      if (a && a.length) {
        const i = a.pop(), o = n.observerSlots.pop();
        r < a.length && (i.sourceSlots[o] = r, a[r] = i, n.observerSlots[r] = o);
      }
    }
  if (e.owned) {
    for (t = 0; t < e.owned.length; t++)
      a0(e.owned[t]);
    e.owned = null;
  }
  if (e.cleanups) {
    for (t = 0; t < e.cleanups.length; t++)
      e.cleanups[t]();
    e.cleanups = null;
  }
  e.state = 0, e.context = null;
}
function D9(e) {
  return e instanceof Error || typeof e == "string" ? e : new Error("Unknown error");
}
function B9(e) {
  throw e = D9(e), e;
}
var R5 = Symbol("fallback");
function j0(e) {
  for (let t = 0; t < e.length; t++)
    e[t]();
}
function z5(e, t, n = {}) {
  let r = [], a = [], i = [], o = 0, s = t.length > 1 ? [] : null;
  return k0(() => j0(i)), () => {
    let c = e() || [], C, u;
    return c[O5], s1(() => {
      let p = c.length, L, M, P, K, w, Q, S, A, b;
      if (p === 0)
        o !== 0 && (j0(i), i = [], r = [], a = [], o = 0, s && (s = [])), n.fallback && (r = [R5], a[0] = H1((O) => (i[0] = O, n.fallback())), o = 1);
      else if (o === 0) {
        for (a = new Array(p), u = 0; u < p; u++)
          r[u] = c[u], a[u] = H1(y);
        o = p;
      } else {
        for (P = new Array(p), K = new Array(p), s && (w = new Array(p)), Q = 0, S = Math.min(o, p); Q < S && r[Q] === c[Q]; Q++)
          ;
        for (S = o - 1, A = p - 1; S >= Q && A >= Q && r[S] === c[A]; S--, A--)
          P[A] = a[S], K[A] = i[S], s && (w[A] = s[S]);
        for (L = /* @__PURE__ */ new Map(), M = new Array(A + 1), u = A; u >= Q; u--)
          b = c[u], C = L.get(b), M[u] = C === void 0 ? -1 : C, L.set(b, u);
        for (C = Q; C <= S; C++)
          b = r[C], u = L.get(b), u !== void 0 && u !== -1 ? (P[u] = a[C], K[u] = i[C], s && (w[u] = s[C]), u = M[u], L.set(b, u)) : i[C]();
        for (u = Q; u < p; u++)
          u in P ? (a[u] = P[u], i[u] = K[u], s && (s[u] = w[u], s[u](u))) : a[u] = H1(y);
        a = a.slice(0, o = p), r = c.slice(0);
      }
      return a;
    });
    function y(p) {
      if (i[u] = p, s) {
        const [L, M] = $(u);
        return s[u] = M, t(c[u], L);
      }
      return t(c[u]);
    }
  };
}
function d(e, t) {
  return s1(() => e(t || {}));
}
function U1() {
  return true;
}
var U5 = {
  get(e, t, n) {
    return t === d0 ? n : e.get(t);
  },
  has(e, t) {
    return t === d0 ? true : e.has(t);
  },
  set: U1,
  deleteProperty: U1,
  getOwnPropertyDescriptor(e, t) {
    return {
      configurable: true,
      enumerable: true,
      get() {
        return e.get(t);
      },
      set: U1,
      deleteProperty: U1
    };
  },
  ownKeys(e) {
    return e.keys();
  }
};
function f0(e) {
  return (e = typeof e == "function" ? e() : e) ? e : {};
}
function P9(...e) {
  let t = false;
  for (let r = 0; r < e.length; r++) {
    const a = e[r];
    t = t || !!a && d0 in a, e[r] = typeof a == "function" ? (t = true, F(a)) : a;
  }
  if (t)
    return new Proxy({
      get(r) {
        for (let a = e.length - 1; a >= 0; a--) {
          const i = f0(e[a])[r];
          if (i !== void 0)
            return i;
        }
      },
      has(r) {
        for (let a = e.length - 1; a >= 0; a--)
          if (r in f0(e[a]))
            return true;
        return false;
      },
      keys() {
        const r = [];
        for (let a = 0; a < e.length; a++)
          r.push(...Object.keys(f0(e[a])));
        return [...new Set(r)];
      }
    }, U5);
  const n = {};
  for (let r = e.length - 1; r >= 0; r--)
    if (e[r]) {
      const a = Object.getOwnPropertyDescriptors(e[r]);
      for (const i in a)
        i in n || Object.defineProperty(n, i, {
          enumerable: true,
          get() {
            for (let o = e.length - 1; o >= 0; o--) {
              const s = (e[o] || {})[i];
              if (s !== void 0)
                return s;
            }
          }
        });
    }
  return n;
}
function Y5(e) {
  const t = "fallback" in e && {
    fallback: () => e.fallback
  };
  return F(z5(() => e.each, e.children, t || void 0));
}
function U(e) {
  let t = false;
  const n = e.keyed, r = F(() => e.when, void 0, {
    equals: (a, i) => t ? a === i : !a == !i
  });
  return F(() => {
    const a = r();
    if (a) {
      const i = e.children, o = typeof i == "function" && i.length > 0;
      return t = n || o, o ? s1(() => i(a)) : i;
    }
    return e.fallback;
  }, void 0, void 0);
}
function V5(e, t, n) {
  let r = n.length, a = t.length, i = r, o = 0, s = 0, c = t[a - 1].nextSibling, C = null;
  for (; o < a || s < i; ) {
    if (t[o] === n[s]) {
      o++, s++;
      continue;
    }
    for (; t[a - 1] === n[i - 1]; )
      a--, i--;
    if (a === o) {
      const u = i < r ? s ? n[s - 1].nextSibling : n[i - s] : c;
      for (; s < i; )
        e.insertBefore(n[s++], u);
    } else if (i === s)
      for (; o < a; )
        (!C || !C.has(t[o])) && t[o].remove(), o++;
    else if (t[o] === n[i - 1] && n[s] === t[a - 1]) {
      const u = t[--a].nextSibling;
      e.insertBefore(n[s++], t[o++].nextSibling), e.insertBefore(n[--i], u), t[a] = n[i];
    } else {
      if (!C) {
        C = /* @__PURE__ */ new Map();
        let y = s;
        for (; y < i; )
          C.set(n[y], y++);
      }
      const u = C.get(t[o]);
      if (u != null)
        if (s < u && u < i) {
          let y = o, p = 1, L;
          for (; ++y < a && y < i && !((L = C.get(t[y])) == null || L !== u + p); )
            p++;
          if (p > u - s) {
            const M = t[o];
            for (; s < u; )
              e.insertBefore(n[s++], M);
          } else
            e.replaceChild(n[s++], t[o++]);
        } else
          o++;
      else
        t[o++].remove();
    }
  }
}
var Z0 = "_$DX_DELEGATE";
function H5(e, t, n, r = {}) {
  let a;
  return H1((i) => {
    a = i, t === document ? e() : m(t, e(), t.firstChild ? null : void 0, n);
  }, r.owner), () => {
    a(), t.textContent = "";
  };
}
function g(e, t, n) {
  const r = document.createElement("template");
  r.innerHTML = e;
  let a = r.content.firstChild;
  return n && (a = a.firstChild), a;
}
function q(e, t = window.document) {
  const n = t[Z0] || (t[Z0] = /* @__PURE__ */ new Set());
  for (let r = 0, a = e.length; r < a; r++) {
    const i = e[r];
    n.has(i) || (n.add(i), t.addEventListener(i, G5));
  }
}
function G(e, t, n) {
  n == null ? e.removeAttribute(t) : e.setAttribute(t, n);
}
function h1(e, t) {
  t == null ? e.removeAttribute("class") : e.className = t;
}
function l1(e, t, n, r) {
  if (r)
    Array.isArray(n) ? (e[`$$${t}`] = n[0], e[`$$${t}Data`] = n[1]) : e[`$$${t}`] = n;
  else if (Array.isArray(n)) {
    const a = n[0];
    e.addEventListener(t, n[0] = (i) => a.call(e, n[1], i));
  } else
    e.addEventListener(t, n);
}
function L1(e, t, n) {
  if (!t)
    return n ? G(e, "style") : t;
  const r = e.style;
  if (typeof t == "string")
    return r.cssText = t;
  typeof n == "string" && (r.cssText = n = void 0), n || (n = {}), t || (t = {});
  let a, i;
  for (i in n)
    t[i] == null && r.removeProperty(i), delete n[i];
  for (i in t)
    a = t[i], a !== n[i] && (r.setProperty(i, a), n[i] = a);
  return n;
}
function A0(e, t, n) {
  return s1(() => e(t, n));
}
function m(e, t, n, r) {
  if (n !== void 0 && !r && (r = []), typeof t != "function")
    return e0(e, t, r, n);
  Z((a) => e0(e, t(), a, n), r);
}
function G5(e) {
  const t = `$$${e.type}`;
  let n = e.composedPath && e.composedPath()[0] || e.target;
  for (e.target !== n && Object.defineProperty(e, "target", {
    configurable: true,
    value: n
  }), Object.defineProperty(e, "currentTarget", {
    configurable: true,
    get() {
      return n || document;
    }
  }), V.registry && !V.done && (V.done = true, document.querySelectorAll("[id^=pl-]").forEach((r) => {
    for (; r && r.nodeType !== 8 && r.nodeValue !== "pl-" + e; ) {
      let a = r.nextSibling;
      r.remove(), r = a;
    }
    r && r.remove();
  })); n; ) {
    const r = n[t];
    if (r && !n.disabled) {
      const a = n[`${t}Data`];
      if (a !== void 0 ? r.call(n, a, e) : r.call(n, e), e.cancelBubble)
        return;
    }
    n = n._$host || n.parentNode || n.host;
  }
}
function e0(e, t, n, r, a) {
  for (V.context && !n && (n = [...e.childNodes]); typeof n == "function"; )
    n = n();
  if (t === n)
    return n;
  const i = typeof t, o = r !== void 0;
  if (e = o && n[0] && n[0].parentNode || e, i === "string" || i === "number") {
    if (V.context)
      return n;
    if (i === "number" && (t = t.toString()), o) {
      let s = n[0];
      s && s.nodeType === 3 ? s.data = t : s = document.createTextNode(t), n = p1(e, n, r, s);
    } else
      n !== "" && typeof n == "string" ? n = e.firstChild.data = t : n = e.textContent = t;
  } else if (t == null || i === "boolean") {
    if (V.context)
      return n;
    n = p1(e, n, r);
  } else {
    if (i === "function")
      return Z(() => {
        let s = t();
        for (; typeof s == "function"; )
          s = s();
        n = e0(e, s, n, r);
      }), () => n;
    if (Array.isArray(t)) {
      const s = [], c = n && Array.isArray(n);
      if (m0(s, t, n, a))
        return Z(() => n = e0(e, s, n, r, true)), () => n;
      if (V.context) {
        if (!s.length)
          return n;
        for (let C = 0; C < s.length; C++)
          if (s[C].parentNode)
            return n = s;
      }
      if (s.length === 0) {
        if (n = p1(e, n, r), o)
          return n;
      } else
        c ? n.length === 0 ? Q0(e, s, r) : V5(e, n, s) : (n && p1(e), Q0(e, s));
      n = s;
    } else if (t instanceof Node) {
      if (V.context && t.parentNode)
        return n = o ? [t] : t;
      if (Array.isArray(n)) {
        if (o)
          return n = p1(e, n, r, t);
        p1(e, n, null, t);
      } else
        n == null || n === "" || !e.firstChild ? e.appendChild(t) : e.replaceChild(t, e.firstChild);
      n = t;
    }
  }
  return n;
}
function m0(e, t, n, r) {
  let a = false;
  for (let i = 0, o = t.length; i < o; i++) {
    let s = t[i], c = n && n[i];
    if (s instanceof Node)
      e.push(s);
    else if (!(s == null || s === true || s === false))
      if (Array.isArray(s))
        a = m0(e, s, c) || a;
      else if (typeof s == "function")
        if (r) {
          for (; typeof s == "function"; )
            s = s();
          a = m0(e, Array.isArray(s) ? s : [s], Array.isArray(c) ? c : [c]) || a;
        } else
          e.push(s), a = true;
      else {
        const C = String(s);
        c && c.nodeType === 3 && c.data === C ? e.push(c) : e.push(document.createTextNode(C));
      }
  }
  return a;
}
function Q0(e, t, n = null) {
  for (let r = 0, a = t.length; r < a; r++)
    e.insertBefore(t[r], n);
}
function p1(e, t, n, r) {
  if (n === void 0)
    return e.textContent = "";
  const a = r || document.createTextNode("");
  if (t.length) {
    let i = false;
    for (let o = t.length - 1; o >= 0; o--) {
      const s = t[o];
      if (a !== s) {
        const c = s.parentNode === e;
        !i && !o ? c ? e.replaceChild(a, s) : e.insertBefore(a, n) : c && s.remove();
      } else
        i = true;
    }
  } else
    e.insertBefore(a, n);
  return [a];
}
var Y1 = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
var X5 = typeof Y1 == "object" && Y1 && Y1.Object === Object && Y1;
var O9 = X5;
var J5 = O9;
var W5 = typeof self == "object" && self && self.Object === Object && self;
var q5 = J5 || W5 || Function("return this")();
var e1 = q5;
var e6 = e1;
var t6 = e6.Symbol;
var i0 = t6;
var R0 = i0;
var E9 = Object.prototype;
var n6 = E9.hasOwnProperty;
var r6 = E9.toString;
var P1 = R0 ? R0.toStringTag : void 0;
function a6(e) {
  var t = n6.call(e, P1), n = e[P1];
  try {
    e[P1] = void 0;
    var r = true;
  } catch {
  }
  var a = r6.call(e);
  return r && (t ? e[P1] = n : delete e[P1]), a;
}
var i6 = a6;
var s6 = Object.prototype;
var o6 = s6.toString;
function c6(e) {
  return o6.call(e);
}
var l6 = c6;
var z0 = i0;
var u6 = i6;
var C6 = l6;
var f6 = "[object Null]";
var g6 = "[object Undefined]";
var U0 = z0 ? z0.toStringTag : void 0;
function y6(e) {
  return e == null ? e === void 0 ? g6 : f6 : U0 && U0 in Object(e) ? u6(e) : C6(e);
}
var K1 = y6;
function h6(e) {
  var t = typeof e;
  return e != null && (t == "object" || t == "function");
}
var $1 = h6;
var d6 = K1;
var m6 = $1;
var p6 = "[object AsyncFunction]";
var v6 = "[object Function]";
var _6 = "[object GeneratorFunction]";
var L6 = "[object Proxy]";
function $6(e) {
  if (!m6(e))
    return false;
  var t = d6(e);
  return t == v6 || t == _6 || t == p6 || t == L6;
}
var K9 = $6;
var b6 = e1;
var x6 = b6["__core-js_shared__"];
var k6 = x6;
var g0 = k6;
var Y0 = function() {
  var e = /[^.]+$/.exec(g0 && g0.keys && g0.keys.IE_PROTO || "");
  return e ? "Symbol(src)_1." + e : "";
}();
function A6(e) {
  return !!Y0 && Y0 in e;
}
var M6 = A6;
var w6 = Function.prototype;
var S6 = w6.toString;
function T6(e) {
  if (e != null) {
    try {
      return S6.call(e);
    } catch {
    }
    try {
      return e + "";
    } catch {
    }
  }
  return "";
}
var F9 = T6;
var I6 = K9;
var N6 = M6;
var D6 = $1;
var B6 = F9;
var P6 = /[\\^$.*+?()[\]{}|]/g;
var O6 = /^\[object .+?Constructor\]$/;
var E6 = Function.prototype;
var K6 = Object.prototype;
var F6 = E6.toString;
var j6 = K6.hasOwnProperty;
var Z6 = RegExp(
  "^" + F6.call(j6).replace(P6, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
);
function Q6(e) {
  if (!D6(e) || N6(e))
    return false;
  var t = I6(e) ? Z6 : O6;
  return t.test(B6(e));
}
var R6 = Q6;
function z6(e, t) {
  return e == null ? void 0 : e[t];
}
var U6 = z6;
var Y6 = R6;
var V6 = U6;
function H6(e, t) {
  var n = V6(e, t);
  return Y6(n) ? n : void 0;
}
var d1 = H6;
var G6 = d1;
var X6 = function() {
  try {
    var e = G6(Object, "defineProperty");
    return e({}, "", {}), e;
  } catch {
  }
}();
var J6 = X6;
var V0 = J6;
function W6(e, t, n) {
  t == "__proto__" && V0 ? V0(e, t, {
    configurable: true,
    enumerable: true,
    value: n,
    writable: true
  }) : e[t] = n;
}
var j9 = W6;
function q6(e, t) {
  return e === t || e !== e && t !== t;
}
var Z9 = q6;
var ee = j9;
var te = Z9;
var ne = Object.prototype;
var re = ne.hasOwnProperty;
function ae(e, t, n) {
  var r = e[t];
  (!(re.call(e, t) && te(r, n)) || n === void 0 && !(t in e)) && ee(e, t, n);
}
var M0 = ae;
var ie = Array.isArray;
var b1 = ie;
function se(e) {
  return e != null && typeof e == "object";
}
var x1 = se;
var oe = K1;
var ce = x1;
var le = "[object Symbol]";
function ue(e) {
  return typeof e == "symbol" || ce(e) && oe(e) == le;
}
var w0 = ue;
var Ce = b1;
var fe = w0;
var ge = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/;
var ye = /^\w*$/;
function he(e, t) {
  if (Ce(e))
    return false;
  var n = typeof e;
  return n == "number" || n == "symbol" || n == "boolean" || e == null || fe(e) ? true : ye.test(e) || !ge.test(e) || t != null && e in Object(t);
}
var de = he;
var me = d1;
var pe = me(Object, "create");
var s0 = pe;
var H0 = s0;
function ve() {
  this.__data__ = H0 ? H0(null) : {}, this.size = 0;
}
var _e = ve;
function Le(e) {
  var t = this.has(e) && delete this.__data__[e];
  return this.size -= t ? 1 : 0, t;
}
var $e = Le;
var be = s0;
var xe = "__lodash_hash_undefined__";
var ke = Object.prototype;
var Ae = ke.hasOwnProperty;
function Me(e) {
  var t = this.__data__;
  if (be) {
    var n = t[e];
    return n === xe ? void 0 : n;
  }
  return Ae.call(t, e) ? t[e] : void 0;
}
var we = Me;
var Se = s0;
var Te = Object.prototype;
var Ie = Te.hasOwnProperty;
function Ne(e) {
  var t = this.__data__;
  return Se ? t[e] !== void 0 : Ie.call(t, e);
}
var De = Ne;
var Be = s0;
var Pe = "__lodash_hash_undefined__";
function Oe(e, t) {
  var n = this.__data__;
  return this.size += this.has(e) ? 0 : 1, n[e] = Be && t === void 0 ? Pe : t, this;
}
var Ee = Oe;
var Ke = _e;
var Fe = $e;
var je = we;
var Ze = De;
var Qe = Ee;
function k1(e) {
  var t = -1, n = e == null ? 0 : e.length;
  for (this.clear(); ++t < n; ) {
    var r = e[t];
    this.set(r[0], r[1]);
  }
}
k1.prototype.clear = Ke;
k1.prototype.delete = Fe;
k1.prototype.get = je;
k1.prototype.has = Ze;
k1.prototype.set = Qe;
var Re = k1;
function ze() {
  this.__data__ = [], this.size = 0;
}
var Ue = ze;
var Ye = Z9;
function Ve(e, t) {
  for (var n = e.length; n--; )
    if (Ye(e[n][0], t))
      return n;
  return -1;
}
var o0 = Ve;
var He = o0;
var Ge = Array.prototype;
var Xe = Ge.splice;
function Je(e) {
  var t = this.__data__, n = He(t, e);
  if (n < 0)
    return false;
  var r = t.length - 1;
  return n == r ? t.pop() : Xe.call(t, n, 1), --this.size, true;
}
var We = Je;
var qe = o0;
function e2(e) {
  var t = this.__data__, n = qe(t, e);
  return n < 0 ? void 0 : t[n][1];
}
var t2 = e2;
var n2 = o0;
function r2(e) {
  return n2(this.__data__, e) > -1;
}
var a2 = r2;
var i2 = o0;
function s2(e, t) {
  var n = this.__data__, r = i2(n, e);
  return r < 0 ? (++this.size, n.push([e, t])) : n[r][1] = t, this;
}
var o2 = s2;
var c2 = Ue;
var l2 = We;
var u2 = t2;
var C2 = a2;
var f2 = o2;
function A1(e) {
  var t = -1, n = e == null ? 0 : e.length;
  for (this.clear(); ++t < n; ) {
    var r = e[t];
    this.set(r[0], r[1]);
  }
}
A1.prototype.clear = c2;
A1.prototype.delete = l2;
A1.prototype.get = u2;
A1.prototype.has = C2;
A1.prototype.set = f2;
var c0 = A1;
var g2 = d1;
var y2 = e1;
var h2 = g2(y2, "Map");
var S0 = h2;
var G0 = Re;
var d2 = c0;
var m2 = S0;
function p2() {
  this.size = 0, this.__data__ = {
    hash: new G0(),
    map: new (m2 || d2)(),
    string: new G0()
  };
}
var v2 = p2;
function _2(e) {
  var t = typeof e;
  return t == "string" || t == "number" || t == "symbol" || t == "boolean" ? e !== "__proto__" : e === null;
}
var L2 = _2;
var $2 = L2;
function b2(e, t) {
  var n = e.__data__;
  return $2(t) ? n[typeof t == "string" ? "string" : "hash"] : n.map;
}
var l0 = b2;
var x2 = l0;
function k2(e) {
  var t = x2(this, e).delete(e);
  return this.size -= t ? 1 : 0, t;
}
var A2 = k2;
var M2 = l0;
function w2(e) {
  return M2(this, e).get(e);
}
var S2 = w2;
var T2 = l0;
function I2(e) {
  return T2(this, e).has(e);
}
var N2 = I2;
var D2 = l0;
function B2(e, t) {
  var n = D2(this, e), r = n.size;
  return n.set(e, t), this.size += n.size == r ? 0 : 1, this;
}
var P2 = B2;
var O2 = v2;
var E2 = A2;
var K2 = S2;
var F2 = N2;
var j2 = P2;
function M1(e) {
  var t = -1, n = e == null ? 0 : e.length;
  for (this.clear(); ++t < n; ) {
    var r = e[t];
    this.set(r[0], r[1]);
  }
}
M1.prototype.clear = O2;
M1.prototype.delete = E2;
M1.prototype.get = K2;
M1.prototype.has = F2;
M1.prototype.set = j2;
var Q9 = M1;
var R9 = Q9;
var Z2 = "Expected a function";
function T0(e, t) {
  if (typeof e != "function" || t != null && typeof t != "function")
    throw new TypeError(Z2);
  var n = function() {
    var r = arguments, a = t ? t.apply(this, r) : r[0], i = n.cache;
    if (i.has(a))
      return i.get(a);
    var o = e.apply(this, r);
    return n.cache = i.set(a, o) || i, o;
  };
  return n.cache = new (T0.Cache || R9)(), n;
}
T0.Cache = R9;
var Q2 = T0;
var R2 = Q2;
var z2 = 500;
function U2(e) {
  var t = R2(e, function(r) {
    return n.size === z2 && n.clear(), r;
  }), n = t.cache;
  return t;
}
var Y2 = U2;
var V2 = Y2;
var H2 = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;
var G2 = /\\(\\)?/g;
var X2 = V2(function(e) {
  var t = [];
  return e.charCodeAt(0) === 46 && t.push(""), e.replace(H2, function(n, r, a, i) {
    t.push(a ? i.replace(G2, "$1") : r || n);
  }), t;
});
var J2 = X2;
function W2(e, t) {
  for (var n = -1, r = e == null ? 0 : e.length, a = Array(r); ++n < r; )
    a[n] = t(e[n], n, e);
  return a;
}
var q2 = W2;
var X0 = i0;
var e3 = q2;
var t3 = b1;
var n3 = w0;
var r3 = 1 / 0;
var J0 = X0 ? X0.prototype : void 0;
var W0 = J0 ? J0.toString : void 0;
function z9(e) {
  if (typeof e == "string")
    return e;
  if (t3(e))
    return e3(e, z9) + "";
  if (n3(e))
    return W0 ? W0.call(e) : "";
  var t = e + "";
  return t == "0" && 1 / e == -r3 ? "-0" : t;
}
var a3 = z9;
var i3 = a3;
function s3(e) {
  return e == null ? "" : i3(e);
}
var o3 = s3;
var c3 = b1;
var l3 = de;
var u3 = J2;
var C3 = o3;
function f3(e, t) {
  return c3(e) ? e : l3(e, t) ? [e] : u3(C3(e));
}
var g3 = f3;
var y3 = 9007199254740991;
var h3 = /^(?:0|[1-9]\d*)$/;
function d3(e, t) {
  var n = typeof e;
  return t = t ?? y3, !!t && (n == "number" || n != "symbol" && h3.test(e)) && e > -1 && e % 1 == 0 && e < t;
}
var U9 = d3;
var m3 = w0;
var p3 = 1 / 0;
function v3(e) {
  if (typeof e == "string" || m3(e))
    return e;
  var t = e + "";
  return t == "0" && 1 / e == -p3 ? "-0" : t;
}
var _3 = v3;
var L3 = M0;
var $3 = g3;
var b3 = U9;
var q0 = $1;
var x3 = _3;
function k3(e, t, n, r) {
  if (!q0(e))
    return e;
  t = $3(t, e);
  for (var a = -1, i = t.length, o = i - 1, s = e; s != null && ++a < i; ) {
    var c = x3(t[a]), C = n;
    if (c === "__proto__" || c === "constructor" || c === "prototype")
      return e;
    if (a != o) {
      var u = s[c];
      C = r ? r(u, c, s) : void 0, C === void 0 && (C = q0(u) ? u : b3(t[a + 1]) ? [] : {});
    }
    L3(s, c, C), s = s[c];
  }
  return e;
}
var A3 = k3;
var M3 = A3;
function w3(e, t, n) {
  return e == null ? e : M3(e, t, n);
}
var p0 = w3;
var S3 = c0;
function T3() {
  this.__data__ = new S3(), this.size = 0;
}
var I3 = T3;
function N3(e) {
  var t = this.__data__, n = t.delete(e);
  return this.size = t.size, n;
}
var D3 = N3;
function B3(e) {
  return this.__data__.get(e);
}
var P3 = B3;
function O3(e) {
  return this.__data__.has(e);
}
var E3 = O3;
var K3 = c0;
var F3 = S0;
var j3 = Q9;
var Z3 = 200;
function Q3(e, t) {
  var n = this.__data__;
  if (n instanceof K3) {
    var r = n.__data__;
    if (!F3 || r.length < Z3 - 1)
      return r.push([e, t]), this.size = ++n.size, this;
    n = this.__data__ = new j3(r);
  }
  return n.set(e, t), this.size = n.size, this;
}
var R3 = Q3;
var z3 = c0;
var U3 = I3;
var Y3 = D3;
var V3 = P3;
var H3 = E3;
var G3 = R3;
function w1(e) {
  var t = this.__data__ = new z3(e);
  this.size = t.size;
}
w1.prototype.clear = U3;
w1.prototype.delete = Y3;
w1.prototype.get = V3;
w1.prototype.has = H3;
w1.prototype.set = G3;
var X3 = w1;
function J3(e, t) {
  for (var n = -1, r = e == null ? 0 : e.length; ++n < r && t(e[n], n, e) !== false; )
    ;
  return e;
}
var W3 = J3;
var q3 = M0;
var e8 = j9;
function t8(e, t, n, r) {
  var a = !n;
  n || (n = {});
  for (var i = -1, o = t.length; ++i < o; ) {
    var s = t[i], c = r ? r(n[s], e[s], s, n, e) : void 0;
    c === void 0 && (c = e[s]), a ? e8(n, s, c) : q3(n, s, c);
  }
  return n;
}
var u0 = t8;
function n8(e, t) {
  for (var n = -1, r = Array(e); ++n < e; )
    r[n] = t(n);
  return r;
}
var r8 = n8;
var a8 = K1;
var i8 = x1;
var s8 = "[object Arguments]";
function o8(e) {
  return i8(e) && a8(e) == s8;
}
var c8 = o8;
var e9 = c8;
var l8 = x1;
var Y9 = Object.prototype;
var u8 = Y9.hasOwnProperty;
var C8 = Y9.propertyIsEnumerable;
var f8 = e9(/* @__PURE__ */ function() {
  return arguments;
}()) ? e9 : function(e) {
  return l8(e) && u8.call(e, "callee") && !C8.call(e, "callee");
};
var g8 = f8;
var E1 = {};
var y8 = {
  get exports() {
    return E1;
  },
  set exports(e) {
    E1 = e;
  }
};
function h8() {
  return false;
}
var d8 = h8;
(function(e, t) {
  var n = e1, r = d8, a = t && !t.nodeType && t, i = a && true && e && !e.nodeType && e, o = i && i.exports === a, s = o ? n.Buffer : void 0, c = s ? s.isBuffer : void 0, C = c || r;
  e.exports = C;
})(y8, E1);
var m8 = 9007199254740991;
function p8(e) {
  return typeof e == "number" && e > -1 && e % 1 == 0 && e <= m8;
}
var V9 = p8;
var v8 = K1;
var _8 = V9;
var L8 = x1;
var $8 = "[object Arguments]";
var b8 = "[object Array]";
var x8 = "[object Boolean]";
var k8 = "[object Date]";
var A8 = "[object Error]";
var M8 = "[object Function]";
var w8 = "[object Map]";
var S8 = "[object Number]";
var T8 = "[object Object]";
var I8 = "[object RegExp]";
var N8 = "[object Set]";
var D8 = "[object String]";
var B8 = "[object WeakMap]";
var P8 = "[object ArrayBuffer]";
var O8 = "[object DataView]";
var E8 = "[object Float32Array]";
var K8 = "[object Float64Array]";
var F8 = "[object Int8Array]";
var j8 = "[object Int16Array]";
var Z8 = "[object Int32Array]";
var Q8 = "[object Uint8Array]";
var R8 = "[object Uint8ClampedArray]";
var z8 = "[object Uint16Array]";
var U8 = "[object Uint32Array]";
var I = {};
I[E8] = I[K8] = I[F8] = I[j8] = I[Z8] = I[Q8] = I[R8] = I[z8] = I[U8] = true;
I[$8] = I[b8] = I[P8] = I[x8] = I[O8] = I[k8] = I[A8] = I[M8] = I[w8] = I[S8] = I[T8] = I[I8] = I[N8] = I[D8] = I[B8] = false;
function Y8(e) {
  return L8(e) && _8(e.length) && !!I[v8(e)];
}
var V8 = Y8;
function H8(e) {
  return function(t) {
    return e(t);
  };
}
var I0 = H8;
var v1 = {};
var G8 = {
  get exports() {
    return v1;
  },
  set exports(e) {
    v1 = e;
  }
};
(function(e, t) {
  var n = O9, r = t && !t.nodeType && t, a = r && true && e && !e.nodeType && e, i = a && a.exports === r, o = i && n.process, s = function() {
    try {
      var c = a && a.require && a.require("util").types;
      return c || o && o.binding && o.binding("util");
    } catch {
    }
  }();
  e.exports = s;
})(G8, v1);
var X8 = V8;
var J8 = I0;
var t9 = v1;
var n9 = t9 && t9.isTypedArray;
var W8 = n9 ? J8(n9) : X8;
var q8 = W8;
var e7 = r8;
var t7 = g8;
var n7 = b1;
var r7 = E1;
var a7 = U9;
var i7 = q8;
var s7 = Object.prototype;
var o7 = s7.hasOwnProperty;
function c7(e, t) {
  var n = n7(e), r = !n && t7(e), a = !n && !r && r7(e), i = !n && !r && !a && i7(e), o = n || r || a || i, s = o ? e7(e.length, String) : [], c = s.length;
  for (var C in e)
    (t || o7.call(e, C)) && !(o && // Safari 9 has enumerable `arguments.length` in strict mode.
    (C == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
    a && (C == "offset" || C == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
    i && (C == "buffer" || C == "byteLength" || C == "byteOffset") || // Skip index properties.
    a7(C, c))) && s.push(C);
  return s;
}
var H9 = c7;
var l7 = Object.prototype;
function u7(e) {
  var t = e && e.constructor, n = typeof t == "function" && t.prototype || l7;
  return e === n;
}
var N0 = u7;
function C7(e, t) {
  return function(n) {
    return e(t(n));
  };
}
var G9 = C7;
var f7 = G9;
var g7 = f7(Object.keys, Object);
var y7 = g7;
var h7 = N0;
var d7 = y7;
var m7 = Object.prototype;
var p7 = m7.hasOwnProperty;
function v7(e) {
  if (!h7(e))
    return d7(e);
  var t = [];
  for (var n in Object(e))
    p7.call(e, n) && n != "constructor" && t.push(n);
  return t;
}
var _7 = v7;
var L7 = K9;
var $7 = V9;
function b7(e) {
  return e != null && $7(e.length) && !L7(e);
}
var X9 = b7;
var x7 = H9;
var k7 = _7;
var A7 = X9;
function M7(e) {
  return A7(e) ? x7(e) : k7(e);
}
var D0 = M7;
var w7 = u0;
var S7 = D0;
function T7(e, t) {
  return e && w7(t, S7(t), e);
}
var I7 = T7;
function N7(e) {
  var t = [];
  if (e != null)
    for (var n in Object(e))
      t.push(n);
  return t;
}
var D7 = N7;
var B7 = $1;
var P7 = N0;
var O7 = D7;
var E7 = Object.prototype;
var K7 = E7.hasOwnProperty;
function F7(e) {
  if (!B7(e))
    return O7(e);
  var t = P7(e), n = [];
  for (var r in e)
    r == "constructor" && (t || !K7.call(e, r)) || n.push(r);
  return n;
}
var j7 = F7;
var Z7 = H9;
var Q7 = j7;
var R7 = X9;
function z7(e) {
  return R7(e) ? Z7(e, true) : Q7(e);
}
var B0 = z7;
var U7 = u0;
var Y7 = B0;
function V7(e, t) {
  return e && U7(t, Y7(t), e);
}
var H7 = V7;
var t0 = {};
var G7 = {
  get exports() {
    return t0;
  },
  set exports(e) {
    t0 = e;
  }
};
(function(e, t) {
  var n = e1, r = t && !t.nodeType && t, a = r && true && e && !e.nodeType && e, i = a && a.exports === r, o = i ? n.Buffer : void 0, s = o ? o.allocUnsafe : void 0;
  function c(C, u) {
    if (u)
      return C.slice();
    var y = C.length, p = s ? s(y) : new C.constructor(y);
    return C.copy(p), p;
  }
  e.exports = c;
})(G7, t0);
function X7(e, t) {
  var n = -1, r = e.length;
  for (t || (t = Array(r)); ++n < r; )
    t[n] = e[n];
  return t;
}
var J7 = X7;
function W7(e, t) {
  for (var n = -1, r = e == null ? 0 : e.length, a = 0, i = []; ++n < r; ) {
    var o = e[n];
    t(o, n, e) && (i[a++] = o);
  }
  return i;
}
var q7 = W7;
function et() {
  return [];
}
var J9 = et;
var tt = q7;
var nt = J9;
var rt = Object.prototype;
var at = rt.propertyIsEnumerable;
var r9 = Object.getOwnPropertySymbols;
var it = r9 ? function(e) {
  return e == null ? [] : (e = Object(e), tt(r9(e), function(t) {
    return at.call(e, t);
  }));
} : nt;
var P0 = it;
var st = u0;
var ot = P0;
function ct(e, t) {
  return st(e, ot(e), t);
}
var lt = ct;
function ut(e, t) {
  for (var n = -1, r = t.length, a = e.length; ++n < r; )
    e[a + n] = t[n];
  return e;
}
var W9 = ut;
var Ct = G9;
var ft = Ct(Object.getPrototypeOf, Object);
var q9 = ft;
var gt = W9;
var yt = q9;
var ht = P0;
var dt = J9;
var mt = Object.getOwnPropertySymbols;
var pt = mt ? function(e) {
  for (var t = []; e; )
    gt(t, ht(e)), e = yt(e);
  return t;
} : dt;
var e5 = pt;
var vt = u0;
var _t = e5;
function Lt(e, t) {
  return vt(e, _t(e), t);
}
var $t = Lt;
var bt = W9;
var xt = b1;
function kt(e, t, n) {
  var r = t(e);
  return xt(e) ? r : bt(r, n(e));
}
var t5 = kt;
var At = t5;
var Mt = P0;
var wt = D0;
function St(e) {
  return At(e, wt, Mt);
}
var Tt = St;
var It = t5;
var Nt = e5;
var Dt = B0;
function Bt(e) {
  return It(e, Dt, Nt);
}
var Pt = Bt;
var Ot = d1;
var Et = e1;
var Kt = Ot(Et, "DataView");
var Ft = Kt;
var jt = d1;
var Zt = e1;
var Qt = jt(Zt, "Promise");
var Rt = Qt;
var zt = d1;
var Ut = e1;
var Yt = zt(Ut, "Set");
var Vt = Yt;
var Ht = d1;
var Gt = e1;
var Xt = Ht(Gt, "WeakMap");
var Jt = Xt;
var v0 = Ft;
var _0 = S0;
var L0 = Rt;
var $0 = Vt;
var b0 = Jt;
var n5 = K1;
var S1 = F9;
var a9 = "[object Map]";
var Wt = "[object Object]";
var i9 = "[object Promise]";
var s9 = "[object Set]";
var o9 = "[object WeakMap]";
var c9 = "[object DataView]";
var qt = S1(v0);
var e4 = S1(_0);
var t4 = S1(L0);
var n4 = S1($0);
var r4 = S1(b0);
var g1 = n5;
(v0 && g1(new v0(new ArrayBuffer(1))) != c9 || _0 && g1(new _0()) != a9 || L0 && g1(L0.resolve()) != i9 || $0 && g1(new $0()) != s9 || b0 && g1(new b0()) != o9) && (g1 = function(e) {
  var t = n5(e), n = t == Wt ? e.constructor : void 0, r = n ? S1(n) : "";
  if (r)
    switch (r) {
      case qt:
        return c9;
      case e4:
        return a9;
      case t4:
        return i9;
      case n4:
        return s9;
      case r4:
        return o9;
    }
  return t;
});
var O0 = g1;
var a4 = Object.prototype;
var i4 = a4.hasOwnProperty;
function s4(e) {
  var t = e.length, n = new e.constructor(t);
  return t && typeof e[0] == "string" && i4.call(e, "index") && (n.index = e.index, n.input = e.input), n;
}
var o4 = s4;
var c4 = e1;
var l4 = c4.Uint8Array;
var u4 = l4;
var l9 = u4;
function C4(e) {
  var t = new e.constructor(e.byteLength);
  return new l9(t).set(new l9(e)), t;
}
var E0 = C4;
var f4 = E0;
function g4(e, t) {
  var n = t ? f4(e.buffer) : e.buffer;
  return new e.constructor(n, e.byteOffset, e.byteLength);
}
var y4 = g4;
var h4 = /\w*$/;
function d4(e) {
  var t = new e.constructor(e.source, h4.exec(e));
  return t.lastIndex = e.lastIndex, t;
}
var m4 = d4;
var u9 = i0;
var C9 = u9 ? u9.prototype : void 0;
var f9 = C9 ? C9.valueOf : void 0;
function p4(e) {
  return f9 ? Object(f9.call(e)) : {};
}
var v4 = p4;
var _4 = E0;
function L4(e, t) {
  var n = t ? _4(e.buffer) : e.buffer;
  return new e.constructor(n, e.byteOffset, e.length);
}
var $4 = L4;
var b4 = E0;
var x4 = y4;
var k4 = m4;
var A4 = v4;
var M4 = $4;
var w4 = "[object Boolean]";
var S4 = "[object Date]";
var T4 = "[object Map]";
var I4 = "[object Number]";
var N4 = "[object RegExp]";
var D4 = "[object Set]";
var B4 = "[object String]";
var P4 = "[object Symbol]";
var O4 = "[object ArrayBuffer]";
var E4 = "[object DataView]";
var K4 = "[object Float32Array]";
var F4 = "[object Float64Array]";
var j4 = "[object Int8Array]";
var Z4 = "[object Int16Array]";
var Q4 = "[object Int32Array]";
var R4 = "[object Uint8Array]";
var z4 = "[object Uint8ClampedArray]";
var U4 = "[object Uint16Array]";
var Y4 = "[object Uint32Array]";
function V4(e, t, n) {
  var r = e.constructor;
  switch (t) {
    case O4:
      return b4(e);
    case w4:
    case S4:
      return new r(+e);
    case E4:
      return x4(e, n);
    case K4:
    case F4:
    case j4:
    case Z4:
    case Q4:
    case R4:
    case z4:
    case U4:
    case Y4:
      return M4(e, n);
    case T4:
      return new r();
    case I4:
    case B4:
      return new r(e);
    case N4:
      return k4(e);
    case D4:
      return new r();
    case P4:
      return A4(e);
  }
}
var H4 = V4;
var G4 = $1;
var g9 = Object.create;
var X4 = /* @__PURE__ */ function() {
  function e() {
  }
  return function(t) {
    if (!G4(t))
      return {};
    if (g9)
      return g9(t);
    e.prototype = t;
    var n = new e();
    return e.prototype = void 0, n;
  };
}();
var J4 = X4;
var W4 = J4;
var q4 = q9;
var en = N0;
function tn(e) {
  return typeof e.constructor == "function" && !en(e) ? W4(q4(e)) : {};
}
var nn = tn;
var rn = O0;
var an = x1;
var sn = "[object Map]";
function on(e) {
  return an(e) && rn(e) == sn;
}
var cn = on;
var ln = cn;
var un = I0;
var y9 = v1;
var h9 = y9 && y9.isMap;
var Cn = h9 ? un(h9) : ln;
var fn = Cn;
var gn = O0;
var yn = x1;
var hn = "[object Set]";
function dn(e) {
  return yn(e) && gn(e) == hn;
}
var mn = dn;
var pn = mn;
var vn = I0;
var d9 = v1;
var m9 = d9 && d9.isSet;
var _n = m9 ? vn(m9) : pn;
var Ln = _n;
var $n = X3;
var bn = W3;
var xn = M0;
var kn = I7;
var An = H7;
var Mn = t0;
var wn = J7;
var Sn = lt;
var Tn = $t;
var In = Tt;
var Nn = Pt;
var Dn = O0;
var Bn = o4;
var Pn = H4;
var On = nn;
var En = b1;
var Kn = E1;
var Fn = fn;
var jn = $1;
var Zn = Ln;
var Qn = D0;
var Rn = B0;
var zn = 1;
var Un = 2;
var Yn = 4;
var r5 = "[object Arguments]";
var Vn = "[object Array]";
var Hn = "[object Boolean]";
var Gn = "[object Date]";
var Xn = "[object Error]";
var a5 = "[object Function]";
var Jn = "[object GeneratorFunction]";
var Wn = "[object Map]";
var qn = "[object Number]";
var i5 = "[object Object]";
var er = "[object RegExp]";
var tr = "[object Set]";
var nr = "[object String]";
var rr = "[object Symbol]";
var ar = "[object WeakMap]";
var ir = "[object ArrayBuffer]";
var sr = "[object DataView]";
var or = "[object Float32Array]";
var cr = "[object Float64Array]";
var lr = "[object Int8Array]";
var ur = "[object Int16Array]";
var Cr = "[object Int32Array]";
var fr = "[object Uint8Array]";
var gr = "[object Uint8ClampedArray]";
var yr = "[object Uint16Array]";
var hr = "[object Uint32Array]";
var T = {};
T[r5] = T[Vn] = T[ir] = T[sr] = T[Hn] = T[Gn] = T[or] = T[cr] = T[lr] = T[ur] = T[Cr] = T[Wn] = T[qn] = T[i5] = T[er] = T[tr] = T[nr] = T[rr] = T[fr] = T[gr] = T[yr] = T[hr] = true;
T[Xn] = T[a5] = T[ar] = false;
function G1(e, t, n, r, a, i) {
  var o, s = t & zn, c = t & Un, C = t & Yn;
  if (n && (o = a ? n(e, r, a, i) : n(e)), o !== void 0)
    return o;
  if (!jn(e))
    return e;
  var u = En(e);
  if (u) {
    if (o = Bn(e), !s)
      return wn(e, o);
  } else {
    var y = Dn(e), p = y == a5 || y == Jn;
    if (Kn(e))
      return Mn(e, s);
    if (y == i5 || y == r5 || p && !a) {
      if (o = c || p ? {} : On(e), !s)
        return c ? Tn(e, An(o, e)) : Sn(e, kn(o, e));
    } else {
      if (!T[y])
        return a ? e : {};
      o = Pn(e, y, s);
    }
  }
  i || (i = new $n());
  var L = i.get(e);
  if (L)
    return L;
  i.set(e, o), Zn(e) ? e.forEach(function(K) {
    o.add(G1(K, t, n, K, e, i));
  }) : Fn(e) && e.forEach(function(K, w) {
    o.set(w, G1(K, t, n, w, e, i));
  });
  var M = C ? c ? Nn : In : c ? Rn : Qn, P = u ? void 0 : M(e);
  return bn(P || e, function(K, w) {
    P && (w = K, K = e[w]), xn(o, w, G1(K, t, n, w, e, i));
  }), o;
}
var dr = G1;
var mr = dr;
var pr = 1;
var vr = 4;
function _r(e) {
  return mr(e, pr | vr);
}
var Lr = _r;
var $r = g("<button></button>");
var br = (e) => (() => {
  const t = $r.cloneNode(true);
  return l1(t, "click", e.onClick, true), m(t, () => e.children), Z((n) => {
    const r = e.style, a = `klinecharts-pro-button ${e.type ?? "confirm"} ${e.class ?? ""}`;
    return n._v$ = L1(t, r, n._v$), a !== n._v$2 && h1(t, n._v$2 = a), n;
  }, {
    _v$: void 0,
    _v$2: void 0
  }), t;
})();
q(["click"]);
var xr = g('<svg viewBox="0 0 1024 1024" class="icon"><path d="M810.666667 128H213.333333c-46.933333 0-85.333333 38.4-85.333333 85.333333v597.333334c0 46.933333 38.4 85.333333 85.333333 85.333333h597.333334c46.933333 0 85.333333-38.4 85.333333-85.333333V213.333333c0-46.933333-38.4-85.333333-85.333333-85.333333z m-353.706667 567.04a42.496 42.496 0 0 1-60.16 0L243.626667 541.866667c-8.106667-8.106667-12.373333-18.773333-12.373334-29.866667s4.693333-22.186667 12.373334-29.866667a42.496 42.496 0 0 1 60.16 0L426.666667 604.586667l293.546666-293.546667a42.496 42.496 0 1 1 60.16 60.16l-323.413333 323.84z"></path></svg>');
var kr = g('<svg viewBox="0 0 1024 1024" class="icon"><path d="M245.333333 128h533.333334A117.333333 117.333333 0 0 1 896 245.333333v533.333334A117.333333 117.333333 0 0 1 778.666667 896H245.333333A117.333333 117.333333 0 0 1 128 778.666667V245.333333A117.333333 117.333333 0 0 1 245.333333 128z m0 64c-29.44 0-53.333333 23.893333-53.333333 53.333333v533.333334c0 29.44 23.893333 53.333333 53.333333 53.333333h533.333334c29.44 0 53.333333-23.893333 53.333333-53.333333V245.333333c0-29.44-23.893333-53.333333-53.333333-53.333333H245.333333z"></path></svg>');
var Ar = g("<div></div>");
var Mr = g('<span class="label"></span>');
var wr = () => xr.cloneNode(true);
var Sr = () => kr.cloneNode(true);
var p9 = (e) => {
  const [t, n] = $(e.checked ?? false);
  return a1(() => {
    "checked" in e && n(e.checked);
  }), (() => {
    const r = Ar.cloneNode(true);
    return r.$$click = (a) => {
      const i = !t();
      e.onChange && e.onChange(i), n(i);
    }, m(r, (() => {
      const a = F(() => !!t());
      return () => a() ? d(wr, {}) : d(Sr, {});
    })(), null), m(r, (() => {
      const a = F(() => !!e.label);
      return () => a() && (() => {
        const i = Mr.cloneNode(true);
        return m(i, () => e.label), i;
      })();
    })(), null), Z((a) => {
      const i = e.style, o = `klinecharts-pro-checkbox ${t() && "checked" || ""} ${e.class || ""}`;
      return a._v$ = L1(r, i, a._v$), o !== a._v$2 && h1(r, a._v$2 = o), a;
    }, {
      _v$: void 0,
      _v$2: void 0
    }), r;
  })();
};
q(["click"]);
var Tr = g('<div class="klinecharts-pro-loading"><i class="circle1"></i><i class="circle2"></i><i class="circle3"></i></div>');
var s5 = () => Tr.cloneNode(true);
var Ir = g('<div class="klinecharts-pro-empty"><svg class="icon" viewBox="0 0 1024 1024"><path d="M855.6 427.2H168.5c-12.7 0-24.4 6.9-30.6 18L4.4 684.7C1.5 689.9 0 695.8 0 701.8v287.1c0 19.4 15.7 35.1 35.1 35.1H989c19.4 0 35.1-15.7 35.1-35.1V701.8c0-6-1.5-11.8-4.4-17.1L886.2 445.2c-6.2-11.1-17.9-18-30.6-18zM673.4 695.6c-16.5 0-30.8 11.5-34.3 27.7-12.7 58.5-64.8 102.3-127.2 102.3s-114.5-43.8-127.2-102.3c-3.5-16.1-17.8-27.7-34.3-27.7H119c-26.4 0-43.3-28-31.1-51.4l81.7-155.8c6.1-11.6 18-18.8 31.1-18.8h622.4c13 0 25 7.2 31.1 18.8l81.7 155.8c12.2 23.4-4.7 51.4-31.1 51.4H673.4zM819.9 209.5c-1-1.8-2.1-3.7-3.2-5.5-9.8-16.6-31.1-22.2-47.8-12.6L648.5 261c-17 9.8-22.7 31.6-12.6 48.4 0.9 1.4 1.7 2.9 2.5 4.4 9.5 17 31.2 22.8 48 13L807 257.3c16.7-9.7 22.4-31 12.9-47.8zM375.4 261.1L255 191.6c-16.7-9.6-38-4-47.8 12.6-1.1 1.8-2.1 3.6-3.2 5.5-9.5 16.8-3.8 38.1 12.9 47.8L337.3 327c16.9 9.7 38.6 4 48-13.1 0.8-1.5 1.7-2.9 2.5-4.4 10.2-16.8 4.5-38.6-12.4-48.4zM512 239.3h2.5c19.5 0.3 35.5-15.5 35.5-35.1v-139c0-19.3-15.6-34.9-34.8-35.1h-6.4C489.6 30.3 474 46 474 65.2v139c0 19.5 15.9 35.4 35.5 35.1h2.5z"></path></svg></div>');
var Nr = () => Ir.cloneNode(true);
var Dr = g("<ul></ul>");
var Br = g("<li></li>");
var n0 = (e) => (() => {
  const t = Dr.cloneNode(true);
  return m(t, d(U, {
    get when() {
      return e.loading;
    },
    get children() {
      return d(s5, {});
    }
  }), null), m(t, d(U, {
    get when() {
      var n;
      return !e.loading && !e.children && !((n = e.dataSource) != null && n.length);
    },
    get children() {
      return d(Nr, {});
    }
  }), null), m(t, d(U, {
    get when() {
      return e.children;
    },
    get children() {
      return e.children;
    }
  }), null), m(t, d(U, {
    get when() {
      return !e.children;
    },
    get children() {
      var n;
      return (n = e.dataSource) == null ? void 0 : n.map((r) => {
        var a;
        return ((a = e.renderItem) == null ? void 0 : a.call(e, r)) ?? Br.cloneNode(true);
      });
    }
  }), null), Z((n) => {
    const r = e.style, a = `klinecharts-pro-list ${e.class ?? ""}`;
    return n._v$ = L1(t, r, n._v$), a !== n._v$2 && h1(t, n._v$2 = a), n;
  }, {
    _v$: void 0,
    _v$2: void 0
  }), t;
})();
var Pr = g('<div class="klinecharts-pro-modal"><div class="inner"><div class="title-container"><svg class="close-icon" viewBox="0 0 1024 1024"><path d="M934.184927 199.723787 622.457206 511.452531l311.727721 311.703161c14.334473 14.229073 23.069415 33.951253 23.069415 55.743582 0 43.430138-35.178197 78.660524-78.735226 78.660524-21.664416 0-41.361013-8.865925-55.642275-23.069415L511.149121 622.838388 199.420377 934.490384c-14.204513 14.20349-33.901111 23.069415-55.642275 23.069415-43.482327 0-78.737272-35.230386-78.737272-78.660524 0-21.792329 8.864902-41.513486 23.094998-55.743582l311.677579-311.703161L88.135828 199.723787c-14.230096-14.255679-23.094998-33.92567-23.094998-55.642275 0-43.430138 35.254945-78.762855 78.737272-78.762855 21.741163 0 41.437761 8.813736 55.642275 23.069415l311.727721 311.727721L822.876842 88.389096c14.281261-14.255679 33.977859-23.069415 55.642275-23.069415 43.557028 0 78.735226 35.332716 78.735226 78.762855C957.254342 165.798117 948.5194 185.468109 934.184927 199.723787"></path></svg></div><div class="content-container"></div></div></div>');
var Or = g('<div class="button-container"></div>');
var T1 = (e) => (() => {
  const t = Pr.cloneNode(true), n = t.firstChild, r = n.firstChild, a = r.firstChild, i = r.nextSibling;
  return m(r, () => e.title, a), l1(a, "click", e.onClose, true), m(i, () => e.children), m(n, (() => {
    const o = F(() => !!(e.buttons && e.buttons.length > 0));
    return () => o() && (() => {
      const s = Or.cloneNode(true);
      return m(s, () => e.buttons.map((c) => d(br, P9(c, {
        get children() {
          return c.children;
        }
      })))), s;
    })();
  })(), null), Z(() => n.style.setProperty("width", `${e.width ?? 400}px`)), t;
})();
q(["click"]);
var Er = g('<div tabindex="0"><div class="selector-container"><span class="value"></span><i class="arrow"></i></div></div>');
var Kr = g('<div class="drop-down-container"><ul></ul></div>');
var Fr = g("<li></li>");
var o5 = (e) => {
  const [t, n] = $(false);
  return (() => {
    const r = Er.cloneNode(true), a = r.firstChild, i = a.firstChild;
    return r.addEventListener("blur", (o) => {
      n(false);
    }), r.$$click = (o) => {
      n((s) => !s);
    }, m(i, () => e.value), m(r, (() => {
      const o = F(() => !!(e.dataSource && e.dataSource.length > 0));
      return () => o() && (() => {
        const s = Kr.cloneNode(true), c = s.firstChild;
        return m(c, () => e.dataSource.map((C) => {
          const y = C[e.valueKey ?? "text"] ?? C;
          return (() => {
            const p = Fr.cloneNode(true);
            return p.$$click = (L) => {
              var M;
              L.stopPropagation(), e.value !== y && ((M = e.onSelected) == null || M.call(e, C)), n(false);
            }, m(p, y), p;
          })();
        })), s;
      })();
    })(), null), Z((o) => {
      const s = e.style, c = `klinecharts-pro-select ${e.class ?? ""} ${t() ? "klinecharts-pro-select-show" : ""}`;
      return o._v$ = L1(r, s, o._v$), c !== o._v$2 && h1(r, o._v$2 = c), o;
    }, {
      _v$: void 0,
      _v$2: void 0
    }), r;
  })();
};
q(["click"]);
var jr = g('<span class="prefix"></span>');
var Zr = g('<span class="suffix"></span>');
var Qr = g('<div><input class="value"></div>');
var c5 = (e) => {
  const t = P9({
    min: Number.MIN_SAFE_INTEGER,
    max: Number.MAX_SAFE_INTEGER
  }, e);
  let n;
  const [r, a] = $("normal");
  return (() => {
    const i = Qr.cloneNode(true), o = i.firstChild;
    return i.$$click = () => {
      n == null || n.focus();
    }, m(i, d(U, {
      get when() {
        return t.prefix;
      },
      get children() {
        const s = jr.cloneNode(true);
        return m(s, () => t.prefix), s;
      }
    }), o), o.addEventListener("change", (s) => {
      var C, u;
      const c = s.target.value;
      if ("precision" in t) {
        let y;
        const p = Math.max(0, Math.floor(t.precision));
        p <= 0 ? y = new RegExp(/^[1-9]\d*$/) : y = new RegExp("^\\d+\\.?\\d{0," + p + "}$"), (c === "" || y.test(c) && +c >= t.min && +c <= t.max) && ((C = t.onChange) == null || C.call(t, c === "" ? c : +c));
      } else
        (u = t.onChange) == null || u.call(t, c);
    }), o.addEventListener("blur", () => {
      a("normal");
    }), o.addEventListener("focus", () => {
      a("focus");
    }), A0((s) => {
      n = s;
    }, o), m(i, d(U, {
      get when() {
        return t.suffix;
      },
      get children() {
        const s = Zr.cloneNode(true);
        return m(s, () => t.suffix), s;
      }
    }), null), Z((s) => {
      const c = t.style, C = `klinecharts-pro-input ${t.class ?? ""}`, u = r(), y = t.placeholder ?? "";
      return s._v$ = L1(i, c, s._v$), C !== s._v$2 && h1(i, s._v$2 = C), u !== s._v$3 && G(i, "data-status", s._v$3 = u), y !== s._v$4 && G(o, "placeholder", s._v$4 = y), s;
    }, {
      _v$: void 0,
      _v$2: void 0,
      _v$3: void 0,
      _v$4: void 0
    }), Z(() => o.value = t.value), i;
  })();
};
q(["click"]);
var Rr = g('<div><i class="thumb"></i></div>');
var zr = (e) => (() => {
  const t = Rr.cloneNode(true);
  return t.$$click = (n) => {
    e.onChange && e.onChange();
  }, Z((n) => {
    const r = e.style, a = `klinecharts-pro-switch ${e.open ? "turn-on" : "turn-off"} ${e.class ?? ""}`;
    return n._v$ = L1(t, r, n._v$), a !== n._v$2 && h1(t, n._v$2 = a), n;
  }, {
    _v$: void 0,
    _v$2: void 0
  }), t;
})();
q(["click"]);
var Ur = "指标";
var Yr = "主图指标";
var Vr = "副图指标";
var Hr = "设置";
var Gr = "时区";
var Xr = "截屏";
var Jr = "全屏";
var Wr = "退出全屏";
var qr = "保存";
var ea = "确定";
var ta = "取消";
var na = "MA(移动平均线)";
var ra = "EMA(指数平滑移动平均线)";
var aa = "SMA";
var ia = "BOLL(布林线)";
var sa = "BBI(多空指数)";
var oa = "SAR(停损点指向指标)";
var ca = "VOL(成交量)";
var la = "MACD(指数平滑异同移动平均线)";
var ua = "KDJ(随机指标)";
var Ca = "RSI(相对强弱指标)";
var fa = "BIAS(乖离率)";
var ga = "BRAR(情绪指标)";
var ya = "CCI(顺势指标)";
var ha = "DMI(动向指标)";
var da = "CR(能量指标)";
var ma = "PSY(心理线)";
var pa = "DMA(平行线差指标)";
var va = "TRIX(三重指数平滑平均线)";
var _a = "OBV(能量潮指标)";
var La = "VR(成交量变异率)";
var $a = "WR(威廉指标)";
var ba = "MTM(动量指标)";
var xa = "EMV(简易波动指标)";
var ka = "ROC(变动率指标)";
var Aa = "PVT(价量趋势指标)";
var Ma = "AO(动量震荡指标)";
var wa = "世界统一时间";
var Sa = "(UTC-10) 檀香山";
var Ta = "(UTC-8) 朱诺";
var Ia = "(UTC-7) 洛杉矶";
var Na = "(UTC-5) 芝加哥";
var Da = "(UTC-4) 多伦多";
var Ba = "(UTC-3) 圣保罗";
var Pa = "(UTC+1) 伦敦";
var Oa = "(UTC+2) 柏林";
var Ea = "(UTC+3) 巴林";
var Ka = "(UTC+4) 迪拜";
var Fa = "(UTC+5) 阿什哈巴德";
var ja = "(UTC+6) 阿拉木图";
var Za = "(UTC+7) 曼谷";
var Qa = "(UTC+8) 上海";
var Ra = "(UTC+9) 东京";
var za = "(UTC+10) 悉尼";
var Ua = "(UTC+12) 诺福克岛";
var Ya = "水平直线";
var Va = "水平射线";
var Ha = "水平线段";
var Ga = "垂直直线";
var Xa = "垂直射线";
var Ja = "垂直线段";
var Wa = "直线";
var qa = "射线";
var ei = "线段";
var ti = "箭头";
var ni = "价格线";
var ri = "价格通道线";
var ai = "平行直线";
var ii = "斐波那契回调直线";
var si = "斐波那契回调线段";
var oi = "斐波那契圆环";
var ci = "斐波那契螺旋";
var li = "斐波那契速度阻力扇";
var ui = "斐波那契趋势扩展";
var Ci = "江恩箱";
var fi = "矩形";
var gi = "平行四边形";
var yi = "圆";
var hi = "三角形";
var di = "三浪";
var mi = "五浪";
var pi = "八浪";
var vi = "任意浪";
var _i = "ABCD形态";
var Li = "XABCD形态";
var $i = "弱磁模式";
var bi = "强磁模式";
var xi = "商品搜索";
var ki = "商品代码";
var Ai = "参数1";
var Mi = "参数2";
var wi = "参数3";
var Si = "参数4";
var Ti = "参数5";
var Ii = "周期";
var Ni = "标准差";
var Di = "蜡烛图类型";
var Bi = "全实心";
var Pi = "全空心";
var Oi = "涨空心";
var Ei = "跌空心";
var Ki = "OHLC";
var Fi = "面积图";
var ji = "最新价显示";
var Zi = "最高价显示";
var Qi = "最低价显示";
var Ri = "指标最新值显示";
var zi = "价格轴类型";
var Ui = "线性轴";
var Yi = "百分比轴";
var Vi = "对数轴";
var Hi = "倒置坐标";
var Gi = "网格线显示";
var Xi = "恢复默认";
var Ji = {
  indicator: Ur,
  main_indicator: Yr,
  sub_indicator: Vr,
  setting: Hr,
  timezone: Gr,
  screenshot: Xr,
  full_screen: Jr,
  exit_full_screen: Wr,
  save: qr,
  confirm: ea,
  cancel: ta,
  ma: na,
  ema: ra,
  sma: aa,
  boll: ia,
  bbi: sa,
  sar: oa,
  vol: ca,
  macd: la,
  kdj: ua,
  rsi: Ca,
  bias: fa,
  brar: ga,
  cci: ya,
  dmi: ha,
  cr: da,
  psy: ma,
  dma: pa,
  trix: va,
  obv: _a,
  vr: La,
  wr: $a,
  mtm: ba,
  emv: xa,
  roc: ka,
  pvt: Aa,
  ao: Ma,
  utc: wa,
  honolulu: Sa,
  juneau: Ta,
  los_angeles: Ia,
  chicago: Na,
  toronto: Da,
  sao_paulo: Ba,
  london: Pa,
  berlin: Oa,
  bahrain: Ea,
  dubai: Ka,
  ashkhabad: Fa,
  almaty: ja,
  bangkok: Za,
  shanghai: Qa,
  tokyo: Ra,
  sydney: za,
  norfolk: Ua,
  horizontal_straight_line: Ya,
  horizontal_ray_line: Va,
  horizontal_segment: Ha,
  vertical_straight_line: Ga,
  vertical_ray_line: Xa,
  vertical_segment: Ja,
  straight_line: Wa,
  ray_line: qa,
  segment: ei,
  arrow: ti,
  price_line: ni,
  price_channel_line: ri,
  parallel_straight_line: ai,
  fibonacci_line: ii,
  fibonacci_segment: si,
  fibonacci_circle: oi,
  fibonacci_spiral: ci,
  fibonacci_speed_resistance_fan: li,
  fibonacci_extension: ui,
  gann_box: Ci,
  rect: fi,
  parallelogram: gi,
  circle: yi,
  triangle: hi,
  three_waves: di,
  five_waves: mi,
  eight_waves: pi,
  any_waves: vi,
  abcd: _i,
  xabcd: Li,
  weak_magnet: $i,
  strong_magnet: bi,
  symbol_search: xi,
  symbol_code: ki,
  params_1: Ai,
  params_2: Mi,
  params_3: wi,
  params_4: Si,
  params_5: Ti,
  period: Ii,
  standard_deviation: Ni,
  candle_type: Di,
  candle_solid: Bi,
  candle_stroke: Pi,
  candle_up_stroke: Oi,
  candle_down_stroke: Ei,
  ohlc: Ki,
  area: Fi,
  last_price_show: ji,
  high_price_show: Zi,
  low_price_show: Qi,
  indicator_last_value_show: Ri,
  price_axis_type: zi,
  normal: Ui,
  percentage: Yi,
  log: Vi,
  reverse_coordinate: Hi,
  grid_show: Gi,
  restore_default: Xi
};
var Wi = "Indicator";
var qi = "Main Indicator";
var es = "Sub Indicator";
var ts = "Setting";
var ns = "Timezone";
var rs = "Screenshot";
var as = "Full Screen";
var is = "Exit";
var ss = "Save";
var os = "Confirm";
var cs = "Cancel";
var ls = "MA(Moving Average)";
var us = "EMA(Exponential Moving Average)";
var Cs = "SMA";
var fs = "BOLL(Bolinger Bands)";
var gs = "BBI(Bull And Bearlndex)";
var ys = "SAR(Stop and Reverse)";
var hs = "VOL(Volume)";
var ds = "MACD(Moving Average Convergence / Divergence)";
var ms = "KDJ(KDJ Index)";
var ps = "RSI(Relative Strength Index)";
var vs = "BIAS(Bias Ratio)";
var _s = "BRAR(情绪指标)";
var Ls = "CCI(Commodity Channel Index)";
var $s = "DMI(Directional Movement Index)";
var bs = "CR(能量指标)";
var xs = "PSY(Psychological Line)";
var ks = "DMA(Different of Moving Average)";
var As = "TRIX(Triple Exponentially Smoothed Moving Average)";
var Ms = "OBV(On Balance Volume)";
var ws = "VR(Volatility Volume Ratio)";
var Ss = "WR(Williams %R)";
var Ts = "MTM(Momentum Index)";
var Is = "EMV(Ease of Movement Value)";
var Ns = "ROC(Price Rate of Change)";
var Ds = "PVT(Price and Volume Trend)";
var Bs = "AO(Awesome Oscillator)";
var Ps = "UTC";
var Os = "(UTC-10) Honolulu";
var Es = "(UTC-8) Juneau";
var Ks = "(UTC-7) Los Angeles";
var Fs = "(UTC-5) Chicago";
var js = "(UTC-4) Toronto";
var Zs = "(UTC-3) Sao Paulo";
var Qs = "(UTC+1) London";
var Rs = "(UTC+2) Berlin";
var zs = "(UTC+3) Bahrain";
var Us = "(UTC+4) Dubai";
var Ys = "(UTC+5) Ashkhabad";
var Vs = "(UTC+6) Almaty";
var Hs = "(UTC+7) Bangkok";
var Gs = "(UTC+8) Shanghai";
var Xs = "(UTC+9) Tokyo";
var Js = "(UTC+10) Sydney";
var Ws = "(UTC+12) Norfolk";
var qs = "Horizontal Line";
var eo = "Horizontal Ray";
var to = "Horizontal Segment";
var no = "Vertical Line";
var ro = "Vertical Ray";
var ao = "Vertical Segment";
var io = "Trend Line";
var so = "Ray";
var oo = "Segment";
var co = "Arrow";
var lo = "Price Line";
var uo = "Price Channel Line";
var Co = "Parallel Line";
var fo = "Fibonacci Line";
var go = "Fibonacci Segment";
var yo = "Fibonacci Circle";
var ho = "Fibonacci Spiral";
var mo = "Fibonacci Sector";
var po = "Fibonacci Extension";
var vo = "Gann Box";
var _o = "Rect";
var Lo = "Parallelogram";
var $o = "Circle";
var bo = "Triangle";
var xo = "Three Waves";
var ko = "Five Waves";
var Ao = "Eight Waves";
var Mo = "Any Waves";
var wo = "ABCD Pattern";
var So = "XABCD Pattern";
var To = "Weak Magnet";
var Io = "Strong Magnet";
var No = {
  indicator: Wi,
  main_indicator: qi,
  sub_indicator: es,
  setting: ts,
  timezone: ns,
  screenshot: rs,
  full_screen: as,
  exit_full_screen: is,
  save: ss,
  confirm: os,
  cancel: cs,
  ma: ls,
  ema: us,
  sma: Cs,
  boll: fs,
  bbi: gs,
  sar: ys,
  vol: hs,
  macd: ds,
  kdj: ms,
  rsi: ps,
  bias: vs,
  brar: _s,
  cci: Ls,
  dmi: $s,
  cr: bs,
  psy: xs,
  dma: ks,
  trix: As,
  obv: Ms,
  vr: ws,
  wr: Ss,
  mtm: Ts,
  emv: Is,
  roc: Ns,
  pvt: Ds,
  ao: Bs,
  utc: Ps,
  honolulu: Os,
  juneau: Es,
  los_angeles: Ks,
  chicago: Fs,
  toronto: js,
  sao_paulo: Zs,
  london: Qs,
  berlin: Rs,
  bahrain: zs,
  dubai: Us,
  ashkhabad: Ys,
  almaty: Vs,
  bangkok: Hs,
  shanghai: Gs,
  tokyo: Xs,
  sydney: Js,
  norfolk: Ws,
  horizontal_straight_line: qs,
  horizontal_ray_line: eo,
  horizontal_segment: to,
  vertical_straight_line: no,
  vertical_ray_line: ro,
  vertical_segment: ao,
  straight_line: io,
  ray_line: so,
  segment: oo,
  arrow: co,
  price_line: lo,
  price_channel_line: uo,
  parallel_straight_line: Co,
  fibonacci_line: fo,
  fibonacci_segment: go,
  fibonacci_circle: yo,
  fibonacci_spiral: ho,
  fibonacci_speed_resistance_fan: mo,
  fibonacci_extension: po,
  gann_box: vo,
  rect: _o,
  parallelogram: Lo,
  circle: $o,
  triangle: bo,
  three_waves: xo,
  five_waves: ko,
  eight_waves: Ao,
  any_waves: Mo,
  abcd: wo,
  xabcd: So,
  weak_magnet: To,
  strong_magnet: Io
};
var l5 = {
  "zh-CN": Ji,
  "en-US": No
};
function Fl(e, t) {
  l5[e] = t;
}
var l = (e, t) => {
  var n;
  return ((n = l5[t]) == null ? void 0 : n[e]) ?? e;
};
var Do = g('<img alt="symbol">');
var Bo = g('<div class="symbol"><span></span></div>');
var Po = g('<div class="klinecharts-pro-period-bar"><div class="menu-container"><svg viewBox="0 0 1024 1024"><path d="M192.037 287.953h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32zM832.161 479.169H438.553c-17.673 0-32 14.327-32 32s14.327 32 32 32h393.608c17.673 0 32-14.327 32-32s-14.327-32-32-32zM832.161 735.802H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32zM319.028 351.594l-160 160 160 160z"></path></svg></div><div class="item tools"><svg viewBox="0 0 20 20"><path d="M15.873,20L3.65079,20C1.5873,20,0,18.3871,0,16.2903L0,3.70968C-3.78442e-7,1.6129,1.5873,0,3.65079,0L15.873,0C17.9365,0,19.5238,1.6129,19.5238,3.70968C19.5238,4.35484,19.2063,4.51613,18.5714,4.51613C17.9365,4.51613,17.619,4.19355,17.619,3.70968C17.619,2.74194,16.8254,1.93548,15.873,1.93548L3.65079,1.93548C2.69841,1.93548,1.90476,2.74194,1.90476,3.70968L1.90476,16.2903C1.90476,17.2581,2.69841,18.0645,3.65079,18.0645L15.873,18.0645C16.8254,18.0645,17.619,17.2581,17.619,16.2903C17.619,15.8065,18.0952,15.3226,18.5714,15.3226C19.0476,15.3226,19.5238,15.8065,19.5238,16.2903C19.5238,18.2258,17.9365,20,15.873,20ZM14.9206,12.9032C14.7619,12.9032,14.4444,12.9032,14.2857,12.7419L11.2698,9.35484C10.9524,9.03226,10.9524,8.54839,11.2698,8.22581C11.5873,7.90323,12.0635,7.90323,12.381,8.22581L15.3968,11.6129C15.7143,11.9355,15.7143,12.4194,15.3968,12.7419C15.3968,12.9032,15.2381,12.9032,14.9206,12.9032ZM11.4286,13.2258C11.2698,13.2258,11.1111,13.2258,10.9524,13.0645C10.6349,12.7419,10.6349,12.4194,10.9524,12.0968L15.0794,7.74193C15.3968,7.41935,15.7143,7.41935,16.0317,7.74193C16.3492,8.06452,16.3492,8.3871,16.0317,8.70968L11.9048,13.0645C11.746,13.2258,11.5873,13.2258,11.4286,13.2258ZM10.3175,3.70968C10.6349,3.70968,11.4286,3.87097,11.4286,4.67742C11.4286,5.32258,10.4762,5.16129,10.1587,5.16129C8.73016,5.16129,8.25397,5.96774,8.09524,6.6129L7.77778,8.54839L9.36508,8.54839C9.68254,8.54839,10,8.87097,10,9.19355C10,9.51613,9.68254,9.83871,9.36508,9.83871L7.61905,9.83871L6.50794,14.8387Q6.34921,16.2903,5.39683,16.2903Q4.44444,16.2903,4.92064,14.8387L6.03175,10L4.60317,10C4.28571,10,3.96825,9.67742,3.96825,9.35484C3.96825,8.70968,4.28571,8.54839,4.60317,8.54839L6.34921,8.54839L6.8254,6.45161C7.14286,3.70968,9.52381,3.54839,10.3175,3.70968ZM18.4127,6.6129C18.5714,6.12903,18.8889,5.96774,19.3651,5.96774C19.8413,6.12903,20,6.45161,20,6.93548L18.4127,13.3871C18.254,13.871,17.9365,14.0323,17.4603,14.0323C16.9841,13.871,16.8254,13.5484,16.8254,13.0645L18.4127,6.6129Z"></path></svg><span></span></div><div class="item tools"><svg width="20" height="20" viewBox="0 0 20 20"><path d="M18.5446,9.09091C18.3333,6.61616,17.2887,4.31818,15.5751,2.63889C13.8498,0.94697,11.6197,0,9.28404,0C8.02817,0,6.81925,0.265151,5.66901,0.782828C5.65728,0.782828,5.65728,0.795454,5.64554,0.795454C5.6338,0.795454,5.6338,0.808081,5.62207,0.808081C4.53052,1.31313,3.55634,2.0202,2.71127,2.92929C1.85446,3.85101,1.18545,4.91162,0.715963,6.11111C0.246479,7.33586,0,8.64899,0,10C0,10.8712,0.105634,11.7172,0.305164,12.5379C0.305164,12.5631,0.316901,12.5884,0.328638,12.6136C0.739437,14.2298,1.51408,15.7197,2.62911,16.9571C4.07277,18.548,5.92723,19.5581,7.93427,19.8737C7.95775,19.8737,7.96948,19.8864,7.99296,19.8864C8.3216,19.9369,8.66197,19.9747,9.00235,19.9747L9.21362,19.9747C9.61268,19.9747,10.3756,19.9369,11.0094,19.697C11.1737,19.6338,11.3028,19.5076,11.3732,19.3434C11.4437,19.1793,11.4554,18.9899,11.3967,18.8131C11.3028,18.5354,11.0563,18.346,10.7864,18.346C10.716,18.346,10.6338,18.3586,10.5634,18.3838C10.0939,18.5606,9.46009,18.5859,9.20188,18.5859L9.09624,18.5859C9.20188,18.2702,9.23709,17.9167,9.15493,17.5505C9.00235,16.8939,8.50939,16.3384,7.58216,15.7955L7.19484,15.5682C6.57277,15.2146,6.23239,15.0253,6.03286,14.7348C5.83333,14.4444,5.69249,13.9899,5.51643,12.9798C5.38732,12.298,5.04695,11.7677,4.50704,11.4646C4.14319,11.2626,3.70892,11.149,3.19249,11.149C2.82864,11.149,2.42958,11.1995,2.00704,11.3005C1.79578,11.351,1.59624,11.4141,1.42019,11.4646C1.33803,10.9848,1.30282,10.4798,1.30282,9.97475C1.30282,6.93182,2.76995,4.26768,4.98826,2.72727C5,3.00505,5.05869,3.29545,5.17606,3.57323C5.48122,4.26768,6.10329,4.7096,7.01878,4.89899C7.06573,4.91162,7.10094,4.91162,7.13615,4.91162L7.1831,4.91162C7.26526,4.91162,7.57042,4.92424,7.88732,5.0505C8.3216,5.2399,8.56808,5.55555,8.65023,6.04798C8.84977,7.61364,9.07277,10.4293,8.79108,11.3384C8.76761,11.4141,8.75587,11.4899,8.75587,11.5657C8.75587,11.9444,9.0493,12.2601,9.40141,12.2601C9.57747,12.2601,9.74179,12.1843,9.85915,12.0581C9.97653,11.9318,12.6174,9.05303,13.3216,8.09343C13.4038,7.97979,13.4859,7.87878,13.5798,7.76515C13.9202,7.33586,14.2723,6.90656,14.4014,6.26262C14.554,5.56818,14.4014,4.79798,13.9437,3.85101C13.615,3.16919,13.5563,2.86616,13.5446,2.75252C13.5563,2.7399,13.5798,2.72727,13.6033,2.71464C15.6221,4.10353,17.0188,6.43939,17.2535,9.19192C17.2887,9.55808,17.5587,9.82323,17.8991,9.82323L17.9577,9.82323C18.3099,9.8106,18.5681,9.48232,18.5446,9.09091ZM3.19249,12.5631C3.48592,12.5631,3.72066,12.6136,3.89671,12.7146C4.08451,12.8283,4.19014,12.9924,4.23709,13.2702C4.43662,14.3434,4.61268,15.0631,5,15.6061C5.37559,16.1364,5.85681,16.4015,6.58451,16.8182L6.60798,16.8308C6.71362,16.8939,6.84272,16.9571,6.96009,17.0328C7.69953,17.4621,7.86385,17.7525,7.89906,17.8914C7.93427,18.0303,7.85211,18.2323,7.74648,18.4343C4.91784,17.8535,2.65258,15.6944,1.73709,12.8283C2.15962,12.702,2.71127,12.5631,3.19249,12.5631ZM12.7934,4.5202C13.4272,5.83333,13.1455,6.18687,12.5822,6.89394C12.4883,7.00758,12.3944,7.12121,12.3005,7.24747C11.9484,7.72727,11.0211,8.77525,10.2113,9.68434C10.2113,9.24242,10.1878,8.73737,10.1526,8.19444C10.0704,6.95707,9.92958,5.90909,9.92958,5.87121L9.92958,5.83333C9.75352,4.83586,9.20188,4.11616,8.3216,3.76263C7.82864,3.56061,7.37089,3.53535,7.19484,3.53535C6.73709,3.43434,6.4554,3.24495,6.33803,2.99242C6.19718,2.68939,6.29108,2.24747,6.38498,1.9697C7.28873,1.59091,8.26291,1.37626,9.28404,1.37626C10.3873,1.37626,11.4437,1.61616,12.4061,2.04545C12.3357,2.18434,12.277,2.34848,12.2535,2.5505C12.2066,3.04293,12.3709,3.64899,12.7934,4.5202Z"></path><path d="M15.22299772857666,9.722223632261718C12.59389772857666,9.722223632261718,10.44600772857666,12.020201374511718,10.44600772857666,14.861111374511719C10.44600772857666,17.70202137451172,12.58215772857666,20.000021374511718,15.223007728576661,20.000021374511718C17.86384772857666,20.000021374511718,19.99999772857666,17.70202137451172,19.99999772857666,14.861111374511719C19.99999772857666,12.020201374511718,17.85211772857666,9.72222212709572,15.22299772857666,9.722223632261718ZM15.22299772857666,18.598491374511717C13.30985772857666,18.598491374511717,11.737087728576661,16.91919137451172,11.737087728576661,14.848481374511719C11.737087728576661,12.777781374511719,13.29811772857666,11.098491374511719,15.22299772857666,11.098491374511719C17.14787772857666,11.098491374511719,18.708917728576658,12.777781374511719,18.708917728576658,14.848481374511719C18.708917728576658,16.91919137451172,17.13614772857666,18.59848137451172,15.22299772857666,18.598491374511717Z"></path><path d="M15.692486288146974,15.050496970825195L15.692486288146974,12.676760970825196C15.692486288146974,12.297972970825196,15.399058288146973,11.982316970825195,15.046945288146972,11.982316970825195C14.694833288146972,11.982316970825195,14.401406288146973,12.297972970825196,14.401406288146973,12.676760970825196L14.401406288146973,15.340896970825195C14.401406288146973,15.530296970825194,14.471829288146973,15.694436970825196,14.589200288146973,15.833326970825196L15.751176288146972,17.095956970825195C15.868546288146973,17.222216970825194,16.032866288146973,17.297976970825196,16.208916288146973,17.297976970825196C16.384976288146973,17.297976970825196,16.537556288146973,17.222216970825194,16.666666288146974,17.095956970825195C16.78403628814697,16.969686970825194,16.854456288146974,16.792916970825196,16.854456288146974,16.603526970825193C16.854456288146974,16.414136970825197,16.78403628814697,16.237366970825196,16.666666288146974,16.111106970825197L15.692486288146974,15.050496970825195Z"></path></svg><span></span></div><div class="item tools"><svg viewBox="0 0 20 20"><path d="M19.7361,12.542L18.1916,11.2919C18.2647,10.8678,18.3025,10.4347,18.3025,10.0017C18.3025,9.56861,18.2647,9.13555,18.1916,8.71142L19.7361,7.46135C19.9743,7.26938,20.0615,6.95686,19.9554,6.6756L19.9342,6.61756C19.5074,5.49026,18.8755,4.45449,18.0549,3.53926L18.0124,3.49238C17.8096,3.26692,17.4819,3.1821,17.1848,3.28032L15.2677,3.92544C14.5603,3.3763,13.7704,2.94324,12.9168,2.63966L12.5466,0.742229C12.49,0.449802,12.2472,0.222111,11.9383,0.168536L11.8746,0.157375C10.6461,-0.0524583,9.35391,-0.0524583,8.1254,0.157375L8.06174,0.168536C7.75284,0.222111,7.50997,0.449802,7.45338,0.742229L7.08082,2.64859C6.2343,2.95217,5.44909,3.383,4.74641,3.92991L2.81522,3.28032C2.52047,3.1821,2.19036,3.26469,1.98757,3.49238L1.94513,3.53926C1.12455,4.45672,0.492609,5.49249,0.0658141,6.61756L0.0445921,6.6756C-0.0615171,6.95463,0.0257283,7.26715,0.263885,7.46135L1.82723,8.72482C1.75413,9.14448,1.71876,9.57308,1.71876,9.99944C1.71876,10.428,1.75413,10.8566,1.82723,11.2741L0.263885,12.5375C0.025729,12.7295,-0.0615164,13.042,0.0445929,13.3233L0.0658148,13.3813C0.49261,14.5064,1.12455,15.5444,1.94513,16.4596L1.98757,16.5065C2.19036,16.732,2.51812,16.8168,2.81522,16.7186L4.74641,16.069C5.44909,16.6159,6.2343,17.0489,7.08082,17.3503L7.45338,19.2567C7.50997,19.5491,7.75284,19.7768,8.06174,19.8303L8.1254,19.8415C8.74084,19.9464,9.37042,20,10,20C10.6296,20,11.2615,19.9464,11.8746,19.8415L11.9383,19.8303C12.2472,19.7768,12.49,19.5491,12.5466,19.2567L12.9168,17.3592C13.7704,17.0556,14.5603,16.6248,15.2677,16.0734L17.1848,16.7186C17.4795,16.8168,17.8096,16.7342,18.0124,16.5065L18.0549,16.4596C18.8755,15.5422,19.5074,14.5064,19.9342,13.3813L19.9554,13.3233C20.0615,13.0487,19.9743,12.7362,19.7361,12.542ZM16.5175,8.97483C16.5764,9.3119,16.6071,9.65791,16.6071,10.0039C16.6071,10.3499,16.5764,10.6959,16.5175,11.033L16.3618,11.9281L18.1233,13.3545C17.8568,13.9372,17.5196,14.4863,17.1188,14.9975L14.9305,14.2631L14.1901,14.839C13.6266,15.2765,12.9994,15.6203,12.3203,15.8614L11.4219,16.1806L10.9998,18.3459C10.3372,18.4173,9.66045,18.4173,8.9955,18.3459L8.57342,16.1761L7.6821,15.8524C7.01008,15.6114,6.38521,15.2676,5.82637,14.8323L5.08596,14.2541L2.88361,14.9953C2.48275,14.4841,2.14791,13.9327,1.8791,13.3523L3.65938,11.9125L3.50611,11.0196C3.44952,10.687,3.41887,10.3432,3.41887,10.0039C3.41887,9.66237,3.44716,9.32083,3.50611,8.98822L3.65938,8.09531L1.8791,6.6555C2.14556,6.07288,2.48275,5.52374,2.88361,5.01255L5.08596,5.75367L5.82637,5.17551C6.38521,4.74022,7.01008,4.39645,7.6821,4.15536L8.57578,3.83615L8.99786,1.66638C9.66045,1.59495,10.3372,1.59495,11.0021,1.66638L11.4242,3.83168L12.3226,4.1509C12.9994,4.39198,13.6289,4.73575,14.1925,5.17328L14.9329,5.7492L17.1211,5.01479C17.522,5.52598,17.8568,6.07734,18.1256,6.65773L16.3642,8.08416L16.5175,8.97483ZM10.0024,5.85189C7.7104,5.85189,5.85231,7.61092,5.85231,9.78068C5.85231,11.9504,7.7104,13.7095,10.0024,13.7095C12.2943,13.7095,14.1524,11.9504,14.1524,9.78068C14.1524,7.61092,12.2943,5.85189,10.0024,5.85189ZM11.8699,11.5486C11.37,12.0196,10.7074,12.2808,10.0024,12.2808C9.29732,12.2808,8.63473,12.0196,8.13483,11.5486C7.6373,11.0754,7.36142,10.4481,7.36142,9.78068C7.36142,9.11323,7.6373,8.48596,8.13483,8.01272C8.63473,7.53948,9.29732,7.28054,10.0024,7.28054C10.7074,7.28054,11.37,7.53948,11.8699,8.01272C12.3674,8.48596,12.6433,9.11323,12.6433,9.78068C12.6433,10.4481,12.3674,11.0754,11.8699,11.5486Z"></path></svg><span></span></div><div class="item tools"><svg viewBox="0 0 20 20"><path d="M6.50977,1L13.4902,1C13.6406,1,13.7695,1.1104910000000001,13.7969,1.2631700000000001L14.0273,2.52277C14.1387,3.13147,14.6543,3.57143,15.2559,3.57143L17.5,3.57143C18.8809,3.57143,20,4.72254,20,6.14286L20,16.4286C20,17.8489,18.8809,19,17.5,19L2.5,19C1.11914,19,0,17.8489,0,16.4286L0,6.14286C0,4.72254,1.11914,3.57143,2.5,3.57143L4.74414,3.57143C5.3457,3.57143,5.86133,3.13147,5.97266,2.52277L6.20312,1.2631700000000001C6.23047,1.1104910000000001,6.35937,1,6.50977,1ZM15.2559,4.857139999999999C14.0547,4.857139999999999,13.0215,3.97522,12.7988,2.75982L12.7129,2.28571L7.28711,2.28571L7.20117,2.75982C6.98047,3.97522,5.94727,4.857139999999999,4.74414,4.857139999999999L2.5,4.857139999999999C1.81055,4.857139999999999,1.25,5.43371,1.25,6.14286L1.25,16.4286C1.25,17.1377,1.81055,17.7143,2.5,17.7143L17.5,17.7143C18.1895,17.7143,18.75,17.1377,18.75,16.4286L18.75,6.14286C18.75,5.43371,18.1895,4.857139999999999,17.5,4.857139999999999L15.2559,4.857139999999999ZM4.375,6.78571L3.125,6.78571C2.7793,6.78571,2.5,6.49844,2.5,6.14286C2.5,5.78728,2.7793,5.5,3.125,5.5L4.375,5.5C4.7207,5.5,5,5.78728,5,6.14286C5,6.49844,4.7207,6.78571,4.375,6.78571ZM10,6.14286C7.06641,6.14286,4.6875,8.58973,4.6875,11.6071C4.6875,14.6246,7.06641,17.0714,10,17.0714C12.9336,17.0714,15.3125,14.6246,15.3125,11.6071C15.3125,8.58973,12.9336,6.14286,10,6.14286ZM10,7.42857C11.0859,7.42857,12.1055,7.8625,12.873,8.65201C13.6406,9.44152,14.0625,10.49018,14.0625,11.6071C14.0625,12.7241,13.6406,13.7728,12.873,14.5623C12.1055,15.3518,11.0859,15.7857,10,15.7857C8.91406,15.7857,7.89453,15.3518,7.12695,14.5623C6.35937,13.7728,5.9375,12.7241,5.9375,11.6071C5.9375,10.49018,6.35938,9.44152,7.12695,8.65201C7.89453,7.8625,8.91406,7.42857,10,7.42857ZM10,9.67857C8.96484,9.67857,8.125,10.54241,8.125,11.6071C8.125,12.6719,8.96484,13.5357,10,13.5357C11.0352,13.5357,11.875,12.6719,11.875,11.6071C11.875,10.54241,11.0352,9.67857,10,9.67857ZM10,10.96429C10.3438,10.96429,10.625,11.2536,10.625,11.6071C10.625,11.9607,10.3438,12.25,10,12.25C9.65625,12.25,9.375,11.9607,9.375,11.6071C9.375,11.2536,9.65625,10.96429,10,10.96429Z"></path></svg><span></span></div><div class="item tools"></div></div>');
var y0 = g("<span></span>");
var Oo = g('<svg viewBox="0 0 20 20"><path d="M1.08108,0L0,1.079L4.18919,5.27938L2.54826,6.91715L6.9112,6.91715L6.9112,2.56262L5.28957,4.18112L1.08108,0ZM15.8108,5.27938L20,1.079L18.9189,0L14.7104,4.18112L13.0888,2.56262L13.0888,6.91715L17.4517,6.91715L15.8108,5.27938ZM4.16988,14.7014L0.07722,18.8054L1.1583,20L5.27027,15.7996L6.9112,17.4374L6.9112,13.0829L2.54826,13.0829L4.16988,14.7014ZM17.4517,13.0829L13.0888,13.0829L13.0888,17.4374L14.7297,15.7996L18.8417,20L19.9228,18.8054L15.8301,14.7013L17.4517,13.0829Z"></path></svg>');
var Eo = g('<svg viewBox="0 0 20 20"><path d="M2.93444,1.76899L7.57544,6.40999L6.38918,7.59626L1.76899,2.93444L0,4.70343L0,0L4.70343,0L2.93444,1.76899ZM6.40999,12.4037L1.76899,17.0447L0,15.2758L0,19.9792L4.70343,19.9792L2.93444,18.2102L7.57544,13.5692L6.40999,12.4037ZM15.2758,0L17.0447,1.76899L12.4037,6.40999L13.59,7.59626L18.231,2.95526L20,4.72425L20,0L15.2758,0ZM13.5692,12.4037L12.3829,13.59L17.0239,18.231L15.2549,20L19.9792,20L19.9792,15.2758L18.2102,17.0447L13.5692,12.4037Z"></path></svg>');
var Ko = (e) => {
  let t;
  const [n, r] = $(false), a = () => {
    r((i) => !i);
  };
  return w9(() => {
    document.addEventListener("fullscreenchange", a), document.addEventListener("mozfullscreenchange", a), document.addEventListener("webkitfullscreenchange", a), document.addEventListener("msfullscreenchange", a);
  }), k0(() => {
    document.removeEventListener("fullscreenchange", a), document.removeEventListener("mozfullscreenchange", a), document.removeEventListener("webkitfullscreenchange", a), document.removeEventListener("msfullscreenchange", a);
  }), (() => {
    const i = Po.cloneNode(true), o = i.firstChild, s = o.firstChild, c = o.nextSibling, C = c.firstChild, u = C.nextSibling, y = c.nextSibling, p = y.firstChild, L = p.nextSibling, M = y.nextSibling, P = M.firstChild, K = P.nextSibling, w = M.nextSibling, Q = w.firstChild, S = Q.nextSibling, A = w.nextSibling;
    return A0((b) => {
      t = b;
    }, i), l1(s, "click", e.onMenuClick, true), m(i, d(U, {
      get when() {
        return e.symbol;
      },
      get children() {
        const b = Bo.cloneNode(true), O = b.firstChild;
        return l1(b, "click", e.onSymbolClick, true), m(b, d(U, {
          get when() {
            return e.symbol.logo;
          },
          get children() {
            const H = Do.cloneNode(true);
            return Z(() => G(H, "src", e.symbol.logo)), H;
          }
        }), O), m(O, () => e.symbol.shortName ?? e.symbol.name ?? e.symbol.ticker), b;
      }
    }), c), m(i, () => e.periods.map((b) => (() => {
      const O = y0.cloneNode(true);
      return O.$$click = () => {
        e.onPeriodChange(b);
      }, m(O, () => b.text), Z(() => h1(O, `item period ${b.text === e.period.text ? "selected" : ""}`)), O;
    })()), c), l1(c, "click", e.onIndicatorClick, true), m(u, () => l("indicator", e.locale)), l1(y, "click", e.onTimezoneClick, true), m(L, () => l("timezone", e.locale)), l1(M, "click", e.onSettingClick, true), m(K, () => l("setting", e.locale)), l1(w, "click", e.onScreenshotClick, true), m(S, () => l("screenshot", e.locale)), A.$$click = () => {
      if (n())
        (document.exitFullscreen ?? document.msExitFullscreen ?? document.mozCancelFullScreen ?? document.webkitExitFullscreen).call(document);
      else {
        const b = t == null ? void 0 : t.parentElement;
        b && (b.requestFullscreen ?? b.webkitRequestFullscreen ?? b.mozRequestFullScreen ?? b.msRequestFullscreen).call(b);
      }
    }, m(A, (() => {
      const b = F(() => !!n());
      return () => b() ? [Oo.cloneNode(true), (() => {
        const O = y0.cloneNode(true);
        return m(O, () => l("exit_full_screen", e.locale)), O;
      })()] : [Eo.cloneNode(true), (() => {
        const O = y0.cloneNode(true);
        return m(O, () => l("full_screen", e.locale)), O;
      })()];
    })()), Z(() => G(s, "class", e.spread ? "" : "rotate")), i;
  })();
};
q(["click"]);
var Fo = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M12.41465,11L18.5,11C18.7761,11,19,11.22386,19,11.5C19,11.77614,18.7761,12,18.5,12L12.41465,12C12.20873,12.5826,11.65311,13,11,13C10.34689,13,9.79127,12.5826,9.58535,12L3.5,12C3.223857,12,3,11.77614,3,11.5C3,11.22386,3.223857,11,3.5,11L9.58535,11C9.79127,10.417404,10.34689,10,11,10C11.65311,10,12.20873,10.417404,12.41465,11Z" stroke-opacity="0" stroke="none"></path></svg>');
var jo = () => Fo.cloneNode(true);
var Zo = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M6.91465,11L11.08535,11C11.29127,10.417404,11.84689,10,12.5,10C13.15311,10,13.70873,10.417404,13.91465,11L18.5,11C18.7761,11,19,11.22386,19,11.5C19,11.77614,18.7761,12,18.5,12L13.91465,12C13.70873,12.5826,13.15311,13,12.5,13C11.84689,13,11.29127,12.5826,11.08535,12L6.91465,12C6.70873,12.5826,6.15311,13,5.5,13C4.671573,13,4,12.32843,4,11.5C4,10.671573,4.671573,10,5.5,10C6.15311,10,6.70873,10.417404,6.91465,11Z" stroke-opacity="0" stroke="none"></path></svg>');
var Qo = () => Zo.cloneNode(true);
var Ro = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M6.91465,12.5C6.70873,13.0826,6.15311,13.5,5.5,13.5C4.671573,13.5,4,12.82843,4,12C4,11.171573,4.671573,10.5,5.5,10.5C6.15311,10.5,6.70873,10.917404,6.91465,11.5L16.0853,11.5C16.2913,10.917404,16.846899999999998,10.5,17.5,10.5C18.328400000000002,10.5,19,11.171573,19,12C19,12.82843,18.328400000000002,13.5,17.5,13.5C16.846899999999998,13.5,16.2913,13.0826,16.0853,12.5L6.91465,12.5Z" stroke-opacity="0" stroke="none"></path></svg>');
var zo = () => Ro.cloneNode(true);
var Uo = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M11,12.41465L11,18.5C11,18.7761,11.22386,19,11.5,19C11.77614,19,12,18.7761,12,18.5L12,12.41465C12.5826,12.20873,13,11.65311,13,11C13,10.34689,12.5826,9.79127,12,9.58535L12,3.5C12,3.223857,11.77614,3,11.5,3C11.22386,3,11,3.223857,11,3.5L11,9.58535C10.417404,9.79127,10,10.34689,10,11C10,11.65311,10.417404,12.20873,11,12.41465Z" stroke-opacity="0" stroke="none"></path></svg>');
var Yo = () => Uo.cloneNode(true);
var Vo = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M11.66558837890625,19C10.83716137890625,19,10.16558837890625,18.328400000000002,10.16558837890625,17.5C10.16558837890625,16.846899999999998,10.58298437890625,16.2913,11.16557337890625,16.0854L11.16557337890625,11.91464C10.58298437890625,11.70872,10.16558837890625,11.1531,10.16558837890625,10.5C10.16558837890625,9.8469,10.58298437890625,9.29128,11.16557337890625,9.08536L11.16557337890625,4.5C11.16557337890625,4.223857,11.38942837890625,4,11.66556837890625,4C11.94171837890625,4,12.16556837890625,4.223857,12.16556837890625,4.5L12.16556837890625,9.08535C12.74817837890625,9.291260000000001,13.16558837890625,9.846879999999999,13.16558837890625,10.5C13.16558837890625,11.153120000000001,12.74817837890625,11.708739999999999,12.16556837890625,11.91465L12.16556837890625,16.0854C12.74817837890625,16.2913,13.16558837890625,16.846899999999998,13.16558837890625,17.5C13.16558837890625,18.328400000000002,12.49401837890625,19,11.66558837890625,19Z" stroke-opacity="0" stroke="none"></path></svg>');
var Ho = () => Vo.cloneNode(true);
var Go = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M11.165603637695312,6.91465C11.748203637695312,6.70873,12.165603637695312,6.15311,12.165603637695312,5.5C12.165603637695312,4.671573,11.494033637695313,4,10.665603637695312,4C9.837176637695313,4,9.165603637695312,4.671573,9.165603637695312,5.5C9.165603637695312,6.15311,9.583007637695312,6.70873,10.165603637695312,6.91465L10.165603637695312,16.0854C9.583007637695312,16.2913,9.165603637695312,16.846899999999998,9.165603637695312,17.5C9.165603637695312,18.328400000000002,9.837176637695313,19,10.665603637695312,19C11.494033637695313,19,12.165603637695312,18.328400000000002,12.165603637695312,17.5C12.165603637695312,16.846899999999998,11.748203637695312,16.2913,11.165603637695312,16.0854L11.165603637695312,6.91465Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var Xo = () => Go.cloneNode(true);
var Jo = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M5.146447,15.753C4.9511845,15.9483,4.9511845,16.2649,5.146447,16.4602C5.341709,16.6554,5.658291,16.6554,5.853554,16.4602L8.156600000000001,14.15711C8.352409999999999,14.25082,8.57173,14.3033,8.8033,14.3033C9.631730000000001,14.3033,10.3033,13.63172,10.3033,12.80329C10.3033,12.57172,10.250820000000001,12.352409999999999,10.157119999999999,12.15659L12.156600000000001,10.15711C12.352409999999999,10.250820000000001,12.571729999999999,10.30329,12.8033,10.30329C13.63173,10.30329,14.3033,9.63172,14.3033,8.80329C14.3033,8.57172,14.25082,8.352409999999999,14.15712,8.15659L16.4602,5.853553C16.6554,5.658291,16.6554,5.341709,16.4602,5.146447C16.2649,4.9511843,15.9483,4.9511843,15.753,5.146447L13.45001,7.449479999999999C13.25419,7.35577,13.03487,7.3032900000000005,12.8033,7.3032900000000005C11.97487,7.3032900000000005,11.3033,7.97487,11.3033,8.80329C11.3033,9.03487,11.35578,9.254190000000001,11.44949,9.450009999999999L9.450009999999999,11.449480000000001C9.254190000000001,11.35577,9.03487,11.30329,8.8033,11.30329C7.97487,11.30329,7.3033,11.97487,7.3033,12.80329C7.3033,13.03487,7.35578,13.25419,7.44949,13.45001L5.146447,15.753Z" stroke-opacity="0" stroke="none"></path></svg>');
var Wo = () => Jo.cloneNode(true);
var qo = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M7.573332939453125,14.54567903564453C7.667042939453125,14.741499035644532,7.719512939453125,14.960809035644532,7.719512939453125,15.19239903564453C7.719512939453125,16.02079903564453,7.047942939453125,16.69239903564453,6.219512939453125,16.69239903564453C5.391085939453125,16.69239903564453,4.719512939453125,16.02079903564453,4.719512939453125,15.19239903564453C4.719512939453125,14.36394903564453,5.391085939453125,13.692379035644532,6.219512939453125,13.692379035644532C6.451092939453125,13.692379035644532,6.670412939453125,13.74485903564453,6.866232939453125,13.83856903564453L9.865702939453126,10.83909903564453C9.771992939453124,10.643279035644532,9.719512939453125,10.42395903564453,9.719512939453125,10.192379035644532C9.719512939453125,9.36394903564453,10.391082939453124,8.692379035644532,11.219512939453125,8.692379035644532C11.451092939453126,8.692379035644532,11.670412939453126,8.74485903564453,11.866232939453125,8.838569035644532L15.462112939453124,5.242645035644531C15.657412939453126,5.047383335644532,15.974012939453125,5.047383335644532,16.169212939453125,5.242645035644531C16.364512939453125,5.437907035644531,16.364512939453125,5.754489035644531,16.169212939453125,5.949752035644531L12.573332939453124,9.545679035644532C12.667042939453125,9.74149903564453,12.719512939453125,9.96080903564453,12.719512939453125,10.192379035644532C12.719512939453125,11.020809035644533,12.047942939453126,11.692379035644532,11.219512939453125,11.692379035644532C10.987942939453125,11.692379035644532,10.768632939453125,11.639909035644532,10.572812939453126,11.54619903564453L7.573332939453125,14.54567903564453Z" stroke-opacity="0" stroke="none"></path></svg>');
var ec = () => qo.cloneNode(true);
var tc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M15.719512939453125,8.461776733398438C16.547912939453127,8.461776733398438,17.219512939453125,7.7902067333984375,17.219512939453125,6.9617767333984375C17.219512939453125,6.133349733398438,16.547912939453127,5.4617767333984375,15.719512939453125,5.4617767333984375C14.891082939453124,5.4617767333984375,14.219512939453125,6.133349733398438,14.219512939453125,6.9617767333984375C14.219512939453125,7.193346733398437,14.271992939453124,7.412666733398438,14.365692939453124,7.608486733398438L7.366222939453126,14.607956733398437C7.170402939453125,14.514256733398437,6.951082939453125,14.461776733398438,6.719512939453125,14.461776733398438C5.891085939453125,14.461776733398438,5.219512939453125,15.133346733398437,5.219512939453125,15.961776733398438C5.219512939453125,16.79017673339844,5.891085939453125,17.461776733398438,6.719512939453125,17.461776733398438C7.547942939453125,17.461776733398438,8.219512939453125,16.79017673339844,8.219512939453125,15.961776733398438C8.219512939453125,15.730176733398437,8.167032939453126,15.510876733398437,8.073322939453124,15.315066733398437L15.072802939453124,8.315586733398437C15.268612939453124,8.409296733398438,15.487912939453125,8.461776733398438,15.719512939453125,8.461776733398438Z" stroke-opacity="0" stroke="none"></path></svg>');
var nc = () => tc.cloneNode(true);
var rc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M17.0643,7.033864912109375L18,3.585784912109375L14.5078,4.509695912109375L15.3537,5.344934912109375L6.02026,14.560584912109375C5.87635,14.517484912109374,5.72366,14.494284912109375,5.5655,14.494284912109375C4.7009,14.494284912109375,4,15.186384912109375,4,16.040084912109375C4,16.893784912109375,4.7009,17.585784912109375,5.5655,17.585784912109375C6.43011,17.585784912109375,7.13101,16.893784912109375,7.13101,16.040084912109375C7.13101,15.722284912109375,7.03392,15.426984912109376,6.86744,15.181384912109374L16.0917,6.073604912109375L17.0643,7.033864912109375Z" stroke-opacity="0" stroke="none"></path></svg>');
var ac = () => rc.cloneNode(true);
var ic = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M6.91465,13.00505L18.5,13.00505C18.7761,13.00505,19,13.228909999999999,19,13.50505C19,13.781189999999999,18.7761,14.00505,18.5,14.00505L6.91465,14.00505C6.70873,14.58765,6.15311,15.00505,5.5,15.00505C4.671573,15.00505,4,14.33348,4,13.50505C4,12.67662,4.671573,12.00505,5.5,12.00505C6.15311,12.00505,6.70873,12.422450000000001,6.91465,13.00505ZM7.81404,11.625L10.48591,11.625L10.48591,10.90625L9.65193,10.90625L9.65193,7.125L8.997630000000001,7.125C8.71443,7.306641,8.415600000000001,7.419922,7.96443,7.498047L7.96443,8.05078L8.77497,8.05078L8.77497,10.90625L7.81404,10.90625L7.81404,11.625ZM11.081620000000001,11.625L14.0562,11.625L14.0562,10.88281L13.09724,10.88281C12.8863,10.88281,12.59333,10.90625,12.36482,10.93555C13.17537,10.11328,13.84724,9.2207,13.84724,8.39062C13.84724,7.541016,13.28865,7,12.4488,7C11.84333,7,11.446850000000001,7.234375,11.03279,7.679688L11.52497,8.16797C11.747630000000001,7.914062,12.0113,7.697266,12.33552,7.697266C12.7613,7.697266,13.00154,7.982422,13.00154,8.43359C13.00154,9.14648,12.29255,10.00781,11.081620000000001,11.11523L11.081620000000001,11.625ZM15.9605,11.75C16.8121,11.75,17.526899999999998,11.2832,17.526899999999998,10.4375C17.526899999999998,9.82031,17.142200000000003,9.43945,16.6441,9.30078L16.6441,9.27148C17.1129,9.08594,17.3824,8.7207,17.3824,8.21289C17.3824,7.421875,16.8004,7,15.9429,7C15.4215,7,14.9957,7.210938,14.6109,7.541016L15.066,8.11133C15.3258,7.849609,15.5836,7.697266,15.9019,7.697266C16.2789,7.697266,16.4957,7.914062,16.4957,8.28125C16.4957,8.70898,16.2301,9,15.4215,9L15.4215,9.63672C16.3804,9.63672,16.6383,9.91992,16.6383,10.38086C16.6383,10.79688,16.3336,11.03125,15.8824,11.03125C15.4742,11.03125,15.1578,10.82227,14.8922,10.55078L14.4781,11.13281C14.7906,11.486329999999999,15.2652,11.75,15.9605,11.75Z" stroke-opacity="0" stroke="none"></path></svg>');
var sc = () => ic.cloneNode(true);
var oc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M3.146447,14.178126025390625C2.9511847,13.982826025390626,2.9511847,13.666226025390625,3.146447,13.470926025390625L7.39146,9.225966025390626C7.35417,9.095106025390624,7.33421,8.956946025390625,7.33421,8.814116025390625C7.33421,7.985696025390625,8.00578,7.314116025390625,8.834209999999999,7.314116025390625C8.97703,7.314116025390625,9.11519,7.334086025390625,9.24605,7.371366025390625L13.753,2.864373025390625C13.9483,2.669110325390625,14.2649,2.669110325390625,14.4602,2.864373025390625C14.6554,3.059635025390625,14.6554,3.376217025390625,14.4602,3.571479025390625L10.06916,7.962476025390625C10.23631,8.204386025390626,10.334209999999999,8.497826025390625,10.334209999999999,8.814116025390625C10.334209999999999,9.642546025390626,9.66264,10.314116025390625,8.834209999999999,10.314116025390625C8.51791,10.314116025390625,8.22448,10.216226025390625,7.98256,10.049076025390626L3.853554,14.178126025390625C3.658291,14.373326025390625,3.341709,14.373326025390625,3.146447,14.178126025390625ZM7.67736,19.188526025390626C7.4821,18.993226025390626,7.4821,18.676626025390625,7.67736,18.481426025390626L9.9804,16.178326025390625C9.88669,15.982526025390625,9.834209999999999,15.763226025390624,9.834209999999999,15.531626025390626C9.834209999999999,14.703226025390626,10.50578,14.031626025390626,11.33421,14.031626025390626C11.56579,14.031626025390626,11.78511,14.084126025390624,11.98093,14.177826025390624L13.9804,12.178356025390626C13.8867,11.982536025390624,13.8342,11.763216025390625,13.8342,11.531636025390625C13.8342,10.703206025390624,14.5058,10.031636025390625,15.3342,10.031636025390625C15.5658,10.031636025390625,15.7851,10.084116025390625,15.9809,10.177826025390626L18.284,7.874796025390625C18.4792,7.679536025390625,18.7958,7.679536025390625,18.9911,7.874796025390625C19.1863,8.070056025390624,19.1863,8.386636025390626,18.9911,8.581906025390625L16.688000000000002,10.884936025390624C16.7817,11.080756025390626,16.8342,11.300066025390626,16.8342,11.531636025390625C16.8342,12.360066025390624,16.162599999999998,13.031626025390626,15.3342,13.031626025390626C15.1026,13.031626025390626,14.8833,12.979126025390626,14.6875,12.885426025390625L12.68803,14.884926025390625C12.78174,15.080726025390625,12.83421,15.300026025390626,12.83421,15.531626025390626C12.83421,16.360026025390624,12.16264,17.031626025390626,11.33421,17.031626025390626C11.10264,17.031626025390626,10.88333,16.979126025390627,10.68751,16.885426025390625L8.38446,19.188526025390626C8.1892,19.383726025390626,7.87262,19.383726025390626,7.67736,19.188526025390626Z" stroke-opacity="0" stroke="none"></path></svg>');
var cc = () => oc.cloneNode(true);
var lc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M3.3367688759765626,12.63173C3.5320318759765623,12.82699,3.8486138759765627,12.82699,4.043876875976562,12.63173L11.822052875976562,4.853553C12.017312875976563,4.658291,12.017312875976563,4.341708,11.822052875976562,4.146446C11.626792875976562,3.9511843,11.310202875976563,3.9511843,11.114942875976563,4.146446L3.3367688759765626,11.92462C3.1415071759765625,12.11988,3.1415071759765625,12.43647,3.3367688759765626,12.63173ZM5.001492875976562,17.0351C4.806232875976562,16.8399,4.806232875976562,16.5233,5.001492875976562,16.328L7.304532875976562,14.025C7.210822875976563,13.82916,7.158352875976563,13.60984,7.158352875976563,13.37827C7.158352875976563,12.54984,7.829922875976562,11.87827,8.658352875976561,11.87827C8.889922875976563,11.87827,9.109232875976563,11.93075,9.305052875976562,12.02446L11.304532875976562,10.02498C11.210822875976563,9.82916,11.158352875976561,9.60984,11.158352875976561,9.37827C11.158352875976561,8.54984,11.829922875976562,7.8782700000000006,12.658352875976563,7.8782700000000006C12.889922875976563,7.8782700000000006,13.109232875976563,7.93075,13.305022875976562,8.024460000000001L15.608122875976562,5.72142C15.803322875976562,5.5261499999999995,16.119922875976563,5.5261499999999995,16.315222875976563,5.72142C16.510422875976563,5.9166799999999995,16.510422875976563,6.23326,16.315222875976563,6.42852L14.012122875976562,8.73156C14.105822875976562,8.92738,14.158322875976562,9.1467,14.158322875976562,9.37827C14.158322875976562,10.2067,13.486822875976562,10.87827,12.658352875976563,10.87827C12.426772875976562,10.87827,12.207452875976562,10.82579,12.011642875976563,10.73209L10.012162875976562,12.73156C10.105872875976562,12.92738,10.158352875976561,13.1467,10.158352875976561,13.37827C10.158352875976561,14.2067,9.486772875976563,14.8783,8.658352875976561,14.8783C8.426772875976562,14.8783,8.207452875976562,14.8258,8.011642875976563,14.7321L5.708602875976562,17.0351C5.513342875976562,17.2304,5.196752875976562,17.2304,5.001492875976562,17.0351ZM10.415712875976563,18.328C10.220452875976562,18.5233,9.903862875976563,18.5233,9.708602875976563,18.328C9.513342875976562,18.1328,9.513342875976562,17.816200000000002,9.708602875976563,17.6209L12.304532875976562,15.025C12.210822875976563,14.8292,12.158352875976563,14.6098,12.158352875976563,14.3783C12.158352875976563,13.54984,12.829922875976562,12.87827,13.658322875976562,12.87827C13.889922875976563,12.87827,14.109222875976563,12.93075,14.305022875976562,13.02446L17.486822875976564,9.84274C17.682022875976564,9.64747,17.99862287597656,9.64747,18.19392287597656,9.84274C18.38912287597656,10.038,18.38912287597656,10.35458,18.19392287597656,10.54984L15.012122875976562,13.73156C15.105822875976562,13.92738,15.158322875976562,14.1467,15.158322875976562,14.3783C15.158322875976562,15.2067,14.486822875976562,15.8783,13.658322875976562,15.8783C13.426822875976562,15.8783,13.207422875976562,15.8258,13.011642875976563,15.7321L10.415712875976563,18.328Z" stroke-opacity="0" stroke="none"></path></svg>');
var uc = () => lc.cloneNode(true);
var Cc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M13.1889,6C12.98303,6.582599999999999,12.42741,7,11.7743,7C11.12119,7,10.565570000000001,6.582599999999999,10.35965,6L3.5,6C3.223857,6,3,5.77614,3,5.5C3,5.22386,3.223857,5,3.5,5L10.35965,5C10.565570000000001,4.417404,11.12119,4,11.7743,4C12.42741,4,12.98303,4.417404,13.1889,5L18.5,5C18.7761,5,19,5.22386,19,5.5C19,5.77614,18.7761,6,18.5,6L13.1889,6ZM3,8.5C3,8.22386,3.223857,8,3.5,8L18.5,8C18.7761,8,19,8.22386,19,8.5C19,8.77614,18.7761,9,18.5,9L3.5,9C3.223857,9,3,8.77614,3,8.5ZM3.278549,11.5C3.278549,11.22386,3.502407,11,3.778549,11L18.7785,11C19.0547,11,19.2785,11.22386,19.2785,11.5C19.2785,11.77614,19.0547,12,18.7785,12L3.778549,12C3.502407,12,3.278549,11.77614,3.278549,11.5ZM3.139267,14.5C3.139267,14.2239,3.363124,14,3.6392670000000003,14L18.6393,14C18.915399999999998,14,19.1393,14.2239,19.1393,14.5C19.1393,14.7761,18.915399999999998,15,18.6393,15L3.6392670000000003,15C3.363124,15,3.139267,14.7761,3.139267,14.5ZM13.1889,18C12.98303,18.5826,12.42741,19,11.7743,19C11.12119,19,10.565570000000001,18.5826,10.35965,18L3.778549,18C3.502407,18,3.278549,17.7761,3.278549,17.5C3.278549,17.2239,3.502407,17,3.778549,17L10.35965,17C10.565570000000001,16.4174,11.12119,16,11.7743,16C12.42741,16,12.98303,16.4174,13.1889,17L18.7785,17C19.0547,17,19.2785,17.2239,19.2785,17.5C19.2785,17.7761,19.0547,18,18.7785,18L13.1889,18Z" stroke-opacity="0" stroke="none"></path></svg>');
var fc = () => Cc.cloneNode(true);
var gc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M4.91465,6C4.70873,6.582599999999999,4.15311,7,3.5,7C2.671573,7,2,6.32843,2,5.5C2,4.671573,2.671573,4,3.5,4C4.15311,4,4.70873,4.417404,4.91465,5L18.2257,5C18.5018,5,18.7257,5.22386,18.7257,5.5C18.7257,5.77614,18.5018,6,18.2257,6L4.91465,6ZM2.7257,8.5C2.7257,8.22386,2.949558,8,3.2257,8L18.2257,8C18.5018,8,18.7257,8.22386,18.7257,8.5C18.7257,8.77614,18.5018,9,18.2257,9L3.2257,9C2.949558,9,2.7257,8.77614,2.7257,8.5ZM3.00425,11.5C3.00425,11.22386,3.22811,11,3.50425,11L18.5042,11C18.7804,11,19.0042,11.22386,19.0042,11.5C19.0042,11.77614,18.7804,12,18.5042,12L3.50425,12C3.22811,12,3.00425,11.77614,3.00425,11.5ZM2.864967,14.5C2.864967,14.2239,3.08882,14,3.36497,14L18.365,14C18.6411,14,18.865,14.2239,18.865,14.5C18.865,14.7761,18.6411,15,18.365,15L3.36497,15C3.08882,15,2.864967,14.7761,2.864967,14.5ZM20,17.5C20,18.328400000000002,19.3284,19,18.5,19C17.846899999999998,19,17.2913,18.5826,17.0854,18L3.50425,18C3.22811,18,3.00425,17.7761,3.00425,17.5C3.00425,17.2239,3.22811,17,3.50425,17L17.0854,17C17.2913,16.4174,17.846899999999998,16,18.5,16C19.3284,16,20,16.671599999999998,20,17.5Z" stroke-opacity="0" stroke="none"></path></svg>');
var yc = () => gc.cloneNode(true);
var hc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><ellipse cx="10.5" cy="11.5" rx="1.5" ry="1.5" stroke-opacity="0" stroke="none"></ellipse><ellipse cx="17.5" cy="11.5" rx="1.5" ry="1.5" stroke-opacity="0" stroke="none"></ellipse><ellipse cx="10.5" cy="11.5" rx="7" ry="7" fill-opacity="0" stroke-opacity="1" fill="none" stroke-width="1"></ellipse><ellipse cx="10.5" cy="11.5" rx="5" ry="5" fill-opacity="0" stroke-opacity="1" fill="none" stroke-width="1"></ellipse><ellipse cx="10.5" cy="11.5" rx="3" ry="3" fill-opacity="0" stroke-opacity="1" fill="none" stroke-width="1"></ellipse></svg>');
var dc = () => hc.cloneNode(true);
var mc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M3,7.32468C5.90649,3.3893050000000002,11.49833,2.81306,14.6674,6.31944C14.9056,6.1554199999999994,15.192,6.05979,15.5,6.05979C15.845,6.05979,16.1628,6.17974,16.4162,6.381349999999999L18.4509,4.23827L19,4.816615L16.8945,7.03429C16.962600000000002,7.21075,17,7.40319,17,7.60463C17,8.45782,16.328400000000002,9.14947,15.5,9.14947C14.6716,9.14947,14,8.45782,14,7.60463C14,7.36402,14.0534,7.13625,14.1487,6.93322C11.32695,3.748365,6.25159,4.253956,3.612785,7.82695L3,7.32468ZM14.09,15.4717C15.7427,13.78985,16.244500000000002,11.524740000000001,15.5633,9.30134L15.5618,9.30134L16.3012,9.0502C17.072400000000002,11.56646,16.497700000000002,14.158,14.6282,16.0599C12.28737,18.442,8.62386,18.6988,6.41348,16.4501C4.5526,14.5572,4.52076,11.19671,6.36766,9.3177C7.89069,7.76754,10.07544,7.706189999999999,11.56741,9.22363C11.95453,9.61742,12.24817,10.08363,12.43369,10.57677L14.1451,8.77421L14.6942,9.35256L12.64982,11.50582C12.65827,11.59712,12.66295,11.68839,12.66378,11.77936C12.87398,12.04523,13,12.38451,13,12.7541C13,13.60729,12.32843,14.2989,11.5,14.2989C10.67157,14.2989,10,13.60729,10,12.7541C10,11.90091,10.67157,11.20926,11.5,11.20926C11.60387,11.20926,11.70528,11.220130000000001,11.8032,11.240829999999999L11.81763,11.22564C11.69858,10.71874,11.42858,10.21929,11.0284,9.81179C9.844000000000001,8.60765,8.136890000000001,8.65592,6.90822,9.90586C5.37975,11.460930000000001,5.40693,14.288,6.95404,15.8619C8.84598,17.7867,12.03496,17.5626,14.09,15.4717Z" stroke-opacity="0" stroke="none"></path></svg>');
var pc = () => mc.cloneNode(true);
var vc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M4,17.0854L4,3.5C4,3.223858,4.22386,3,4.5,3C4.77614,3,5,3.223858,5,3.5L5,10L7.57584,10L9.8127,4.46359C9.91614,4.20756,10.20756,4.08386,10.46359,4.1873000000000005C10.71963,4.29075,10.84333,4.58216,10.73988,4.8382000000000005L8.65438,10L11.08535,10C11.29127,9.4174,11.84689,9,12.5,9C12.65154,9,12.79784,9.02247,12.93573,9.06427L16.6464,5.35355C16.8417,5.15829,17.1583,5.15829,17.3536,5.35355C17.5488,5.54882,17.5488,5.8654,17.3536,6.06066L13.7475,9.66675C13.907,9.90508,14,10.19168,14,10.5C14,11.15311,13.5826,11.70873,13,11.91465L13,14.3638L18.3714,12.1936C18.6274,12.09015,18.918799999999997,12.21385,19.0222,12.46989C19.1257,12.72592,19.002,13.0173,18.746000000000002,13.1208L13,15.4423L13,18L19.5,18C19.7761,18,20,18.2239,20,18.5C20,18.7761,19.7761,19,19.5,19L5.91465,19C5.70873,19.5826,5.15311,20,4.5,20C3.671573,20,3,19.3284,3,18.5C3,17.846899999999998,3.417404,17.2913,4,17.0854ZM6.3729499999999994,17.0413L12,14.7678L12,11.91465C11.88136,11.87271,11.76956,11.81627,11.66675,11.74746L6.3729499999999994,17.0413ZM12,15.8463L6.6694700000000005,18L12,18L12,15.8463ZM6.38629,15.6137L8.250350000000001,11L11,11L6.38629,15.6137ZM5,11L7.17182,11L5,16.3754L5,11Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var _c = () => vc.cloneNode(true);
var Lc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M17,4.5C17,5.32843,16.328400000000002,6,15.5,6C15.0931,6,14.7241,5.83802,14.4539,5.57503L5.98992,8.32515C5.99658,8.38251,6,8.440850000000001,6,8.5C6,9.15311,5.582599999999999,9.70873,5,9.91465L5,11.08535C5.42621,11.236,5.763999999999999,11.57379,5.91465,12L19.5,12C19.7761,12,20,12.22386,20,12.5C20,12.77614,19.7761,13,19.5,13L5.91465,13C5.70873,13.5826,5.15311,14,4.5,14C3.671573,14,3,13.3284,3,12.5C3,11.84689,3.417404,11.29127,4,11.08535L4,9.91465C3.417404,9.70873,3,9.15311,3,8.5C3,7.67157,3.671573,7,4.5,7C4.90411,7,5.2709,7.15981,5.5406200000000005,7.41967L14.0093,4.66802C14.0032,4.6128599999999995,14,4.5568,14,4.5C14,3.671573,14.6716,3,15.5,3C16.328400000000002,3,17,3.671573,17,4.5ZM4,15.5C4,15.2239,4.22386,15,4.5,15L19.5,15C19.7761,15,20,15.2239,20,15.5C20,15.7761,19.7761,16,19.5,16L4.5,16C4.22386,16,4,15.7761,4,15.5ZM4,18.5C4,18.2239,4.22386,18,4.5,18L19.5,18C19.7761,18,20,18.2239,20,18.5C20,18.7761,19.7761,19,19.5,19L4.5,19C4.22386,19,4,18.7761,4,18.5Z" stroke-opacity="0" stroke="none"></path></svg>');
var $c = () => Lc.cloneNode(true);
var bc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M20,3.5C20,4.15311,19.5826,4.70873,19,4.91465L19,18.5C19,18.7761,18.7761,19,18.5,19L4.91465,19C4.70873,19.5826,4.15311,20,3.5,20C2.671573,20,2,19.3284,2,18.5C2,17.846899999999998,2.417404,17.2913,3,17.0854L3,3.5C3,3.22386,3.22386,3,3.5,3L17.0854,3C17.2913,2.417404,17.846899999999998,2,18.5,2C19.3284,2,20,2.671573,20,3.5ZM17.0854,4C17.236,4.42621,17.5738,4.763999999999999,18,4.91465L18,8L14,8L14,4L17.0854,4ZM13,4L13,8L9,8L9,4L13,4ZM13,9L9,9L9,13L13,13L13,9ZM13,14L9,14L9,18L13,18L13,14ZM14,18L14,14L18,14L18,18L14,18ZM18,13L14,13L14,9L18,9L18,13ZM4.91465,18C4.763999999999999,17.5738,4.42621,17.236,4,17.0854L4,14L8,14L8,18L4.91465,18ZM4,8L4,4L8,4L8,8L4,8ZM8,9L8,13L4,13L4,9L8,9Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var xc = () => bc.cloneNode(true);
var kc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><ellipse cx="10.5" cy="11.5" rx="1.5" ry="1.5" stroke-opacity="0" stroke="none"></ellipse><ellipse cx="17.5" cy="11.5" rx="1.5" ry="1.5" stroke-opacity="0" stroke="none"></ellipse><ellipse cx="10.5" cy="11.5" rx="7" ry="7" fill-opacity="0" fill="none" stroke-opacity="1" stroke-width="1"></ellipse></svg>');
var Ac = () => kc.cloneNode(true);
var Mc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M11.57625,6.9981C11.55099,6.999359999999999,11.52557,7,11.5,7C11.34,7,11.18584,6.97495,11.04125,6.9285499999999995L5.55401,16.4327C5.713760000000001,16.5905,5.83826,16.7839,5.91465,17L16.0854,17C16.2187,16.622700000000002,16.4987,16.314700000000002,16.8569,16.1445L11.57625,6.9981ZM12.50759,6.611219999999999C12.81005,6.336790000000001,13,5.94058,13,5.5C13,4.671573,12.32843,4,11.5,4C10.67157,4,10,4.671573,10,5.5C10,5.80059,10.08841,6.08052,10.24066,6.31522L4.64514,16.0069C4.59738,16.002299999999998,4.54896,16,4.5,16C3.671573,16,3,16.671599999999998,3,17.5C3,18.328400000000002,3.671573,19,4.5,19C5.15311,19,5.70873,18.5826,5.91465,18L16.0854,18C16.2913,18.5826,16.846899999999998,19,17.5,19C18.328400000000002,19,19,18.328400000000002,19,17.5C19,16.8365,18.5691,16.2735,17.971899999999998,16.075699999999998L12.50759,6.611219999999999Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var wc = () => Mc.cloneNode(true);
var Sc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M19,4.5C19,5.15311,18.5826,5.70873,18,5.91465L18,18.5C18,18.7761,17.7761,19,17.5,19L5.91465,19C5.70873,19.5826,5.15311,20,4.5,20C3.671573,20,3,19.3284,3,18.5C3,17.846899999999998,3.417404,17.2913,4,17.0854L4,4.5C4,4.22386,4.22386,4,4.5,4L16.0854,4C16.2913,3.417404,16.846899999999998,3,17.5,3C18.328400000000002,3,19,3.671573,19,4.5ZM5,5L16.0854,5C16.236,5.42621,16.5738,5.763999999999999,17,5.91465L17,18L5.91465,18C5.763999999999999,17.5738,5.42621,17.236,5,17.0854L5,5Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var Tc = () => Sc.cloneNode(true);
var Ic = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M19.6401,7.99355C20.4028,7.92291,21,7.2811900000000005,21,6.5C21,5.671573,20.3284,5,19.5,5C18.8469,5,18.2913,5.417404,18.0854,6L7.62067,6C7.34453,6,7.12067,6.22386,7.12067,6.5C7.12067,6.5479,7.12741,6.59423,7.13999,6.63809L3.2294099999999997,15.0243C2.530138,15.1517,2,15.764,2,16.5C2,17.328400000000002,2.671573,18,3.5,18C4.15311,18,4.70873,17.5826,4.91465,17L14.5963,17C14.6456,17.076,14.7162,17.1396,14.8044,17.1807C15.0546,17.2974,15.3521,17.1891,15.4688,16.9388L19.6401,7.99355ZM14.7896,16.0293L18.6551,7.739599999999999C18.3942,7.56144,18.1925,7.30307,18.0854,7L8.0746,7L4.25044,15.2009C4.55701,15.3784,4.79493,15.6613,4.91465,16L14.6207,16C14.68,16,14.7368,16.0103,14.7896,16.0293Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var Nc = () => Ic.cloneNode(true);
var Dc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M8.134443814697265,7.494615087890625L8.764323814697265,7.494615087890625L8.764323814697265,3.414215087890625L8.310223814697267,3.414215087890625L7.294603814697266,4.005035087890625L7.289713814697266,4.634915087890625L8.134443814697265,4.149892087890625L8.134443814697265,7.494615087890625ZM18.832003814697266,6.933095087890624Q19.004603814697266,6.635245087890625,19.004603814697266,6.2543850878906255Q19.004603814697266,5.884915087890625,18.845103814697264,5.593575087890625Q18.685503814697267,5.3006050878906255,18.399103814697266,5.136225087890625Q18.114303814697266,4.9702050878906245,17.754603814697266,4.9653250878906245L18.820603814697265,3.840647087890625L18.820603814697265,3.414215087890625L16.519203814697264,3.414215087890625L16.519203814697264,3.939931087890625L18.050803814697264,3.939931087890625L16.719403814697266,5.334785087890625L17.074203814697263,5.7205350878906245Q17.254903814697265,5.484525087890625,17.619503814697268,5.484525087890625Q17.980803814697268,5.484525087890625,18.187503814697266,5.689605087890625Q18.394203814697267,5.894685087890625,18.394203814697267,6.2543850878906255Q18.394203814697267,6.604315087890625,18.187503814697266,6.822415087890625Q17.980803814697268,7.0405150878906255,17.640603814697265,7.0405150878906255Q17.334603814697267,7.0405150878906255,17.124703814697266,6.890775087890625Q16.914703814697265,6.739415087890626,16.820303814697265,6.469225087890624L16.354803814697263,6.744295087890626Q16.480103814697266,7.125155087890625,16.821903814697265,7.341625087890625Q17.165403814697264,7.559725087890625,17.640603814697265,7.559725087890625Q18.039403814697266,7.559725087890625,18.348603814697267,7.393705087890625Q18.659503814697267,7.229315087890625,18.832003814697266,6.933095087890624ZM10.000003814697266,10.634915087890626C10.000003814697266,11.024655087890626,9.851363814697265,11.379685087890625,9.607683814697266,11.646395087890625L12.168903814697266,15.171615087890626C12.275403814697265,15.147615087890625,12.386203814697266,15.134915087890626,12.500003814697266,15.134915087890626C12.596503814697266,15.134915087890626,12.690803814697265,15.144015087890624,12.782303814697265,15.161415087890624L16.108803814697268,11.196955087890625C16.038703814697264,11.023375087890624,16.000003814697266,10.833655087890625,16.000003814697266,10.634915087890626C16.000003814697266,9.806495087890625,16.671603814697264,9.134915087890626,17.500003814697266,9.134915087890626C18.328403814697264,9.134915087890626,19.000003814697266,9.806495087890625,19.000003814697266,10.634915087890626C19.000003814697266,11.463345087890625,18.328403814697264,12.134915087890626,17.500003814697266,12.134915087890626C17.239503814697265,12.134915087890626,16.994503814697268,12.068495087890625,16.781003814697264,11.951675087890624L13.654703814697266,15.677415087890624C13.870303814697266,15.937215087890625,14.000003814697266,16.270915087890625,14.000003814697266,16.634915087890626C14.000003814697266,17.463315087890624,13.328403814697266,18.134915087890626,12.500003814697266,18.134915087890626C11.671573814697265,18.134915087890626,11.000003814697266,17.463315087890624,11.000003814697266,16.634915087890626C11.000003814697266,16.284415087890626,11.120193814697265,15.962015087890626,11.321603814697266,15.706715087890625L8.715393814697265,12.119565087890624C8.645053814697267,12.129685087890625,8.573143814697266,12.134915087890626,8.500003814697266,12.134915087890626C8.162103814697264,12.134915087890626,7.8503038146972655,12.023195087890626,7.599523814697266,11.834665087890626L4.505583814697266,15.521915087890624C4.809213814697266,15.796415087890624,5.000003814697266,16.193415087890624,5.000003814697266,16.634915087890626C5.000003814697266,17.463315087890624,4.328433814697266,18.134915087890626,3.5000038146972656,18.134915087890626C2.6715768146972656,18.134915087890626,2.0000038146972656,17.463315087890624,2.0000038146972656,16.634915087890626C2.0000038146972656,15.806515087890626,2.6715768146972656,15.134915087890626,3.5000038146972656,15.134915087890626C3.508253814697266,15.134915087890626,3.5164838146972657,15.135015087890626,3.524703814697266,15.135115087890625L7.033823814697266,10.953115087890625C7.011673814697265,10.850565087890626,7.000003814697266,10.744105087890624,7.000003814697266,10.634915087890626C7.000003814697266,9.806495087890625,7.671573814697266,9.134915087890626,8.500003814697266,9.134915087890626C9.328433814697267,9.134915087890626,10.000003814697266,9.806495087890625,10.000003814697266,10.634915087890626Z" stroke-opacity="0" stroke="none"></path></svg>');
var Bc = () => Dc.cloneNode(true);
var Pc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M8.13444,7.494615087890625L8.76432,7.494615087890625L8.76432,3.414215087890625L8.310220000000001,3.414215087890625L7.2946,4.005035087890625L7.28971,4.634915087890625L8.13444,4.149892087890625L8.13444,7.494615087890625ZM18.832,6.929835087890625Q19.0046,6.635245087890625,19.0046,6.2543850878906255Q19.0046,5.889805087890625,18.8451,5.5952050878906245Q18.6855,5.3006050878906255,18.3975,5.132965087890625Q18.1094,4.9653250878906245,17.7399,4.9653250878906245Q17.435499999999998,4.9653250878906245,17.1556,5.149245087890625L17.2793,3.939931087890625L18.8304,3.939931087890625L18.8304,3.414215087890625L16.7406,3.414215087890625L16.5094,5.665195087890625L17.0156,5.795405087890625Q17.095399999999998,5.655425087890626,17.2516,5.570795087890625Q17.4095,5.484525087890625,17.6357,5.484525087890625Q17.9694,5.484525087890625,18.1842,5.697745087890625Q18.4007,5.909335087890625,18.4007,6.2543850878906255Q18.4007,6.604315087890625,18.1842,6.822415087890625Q17.9694,7.0405150878906255,17.6292,7.0405150878906255Q17.3298,7.0405150878906255,17.119799999999998,6.890775087890625Q16.9098,6.739415087890626,16.825200000000002,6.474115087890625L16.3597,6.749175087890626Q16.470399999999998,7.110505087890624,16.807299999999998,7.335115087890625Q17.144199999999998,7.559725087890625,17.6292,7.559725087890625Q18.0296,7.559725087890625,18.3438,7.392075087890625Q18.6595,7.224435087890625,18.832,6.929835087890625ZM10,10.634915087890626C10,11.024655087890626,9.85136,11.379685087890625,9.60768,11.646395087890625L12.1689,15.171615087890626C12.2754,15.147615087890625,12.3862,15.134915087890626,12.5,15.134915087890626C12.5965,15.134915087890626,12.6908,15.144015087890624,12.7823,15.161415087890624L16.108800000000002,11.196955087890625C16.0387,11.023375087890624,16,10.833655087890625,16,10.634915087890626C16,9.806495087890625,16.671599999999998,9.134915087890626,17.5,9.134915087890626C18.3284,9.134915087890626,19,9.806495087890625,19,10.634915087890626C19,11.463345087890625,18.3284,12.134915087890626,17.5,12.134915087890626C17.2395,12.134915087890626,16.994500000000002,12.068505087890625,16.781,11.951675087890624L13.6547,15.677415087890624C13.8703,15.937215087890625,14,16.270915087890625,14,16.634915087890626C14,17.463315087890624,13.3284,18.134915087890626,12.5,18.134915087890626C11.67157,18.134915087890626,11,17.463315087890624,11,16.634915087890626C11,16.284415087890626,11.12019,15.962015087890626,11.3216,15.706715087890625L8.71539,12.119565087890624C8.645050000000001,12.129685087890625,8.57314,12.134915087890626,8.5,12.134915087890626C8.162099999999999,12.134915087890626,7.8503,12.023195087890626,7.59952,11.834665087890626L4.50558,15.521915087890624C4.80921,15.796415087890624,5,16.193415087890624,5,16.634915087890626C5,17.463315087890624,4.32843,18.134915087890626,3.5,18.134915087890626C2.671573,18.134915087890626,2,17.463315087890624,2,16.634915087890626C2,15.806515087890626,2.671573,15.134915087890626,3.5,15.134915087890626C3.5082500000000003,15.134915087890626,3.51648,15.135015087890626,3.5247,15.135115087890625L7.03382,10.953115087890625C7.01167,10.850565087890626,7,10.744105087890624,7,10.634915087890626C7,9.806495087890625,7.67157,9.134915087890626,8.5,9.134915087890626C9.32843,9.134915087890626,10,9.806495087890625,10,10.634915087890626Z" stroke-opacity="0" stroke="none"></path></svg>');
var Oc = () => Pc.cloneNode(true);
var Ec = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M18.8532,7.020985087890625Q19.0257,6.734525087890625,19.0257,6.369945087890625Q19.0257,6.020005087890625,18.8499,5.754705087890625Q18.6758,5.489415087890626,18.3649,5.339675087890625Q18.5944,5.209465087890625,18.7214,4.994615087890625Q18.8499,4.779775087890625,18.8499,4.5193550878906255Q18.8499,4.2003480878906245,18.7002,3.951324087890625Q18.5505,3.700673087890625,18.277,3.557444087890625Q18.0052,3.414215087890625,17.6455,3.414215087890625Q17.285800000000002,3.414215087890625,17.0107,3.557444087890625Q16.7357,3.700673087890625,16.5843,3.951324087890625Q16.4346,4.2003480878906245,16.4346,4.5193550878906255Q16.4346,4.779775087890625,16.561500000000002,4.994615087890625Q16.6901,5.209465087890625,16.919600000000003,5.339675087890625Q16.6055,5.489415087890626,16.4297,5.757965087890625Q16.255499999999998,6.024895087890625,16.255499999999998,6.369945087890625Q16.255499999999998,6.734525087890625,16.4297,7.020985087890625Q16.6055,7.305815087890625,16.919600000000003,7.465325087890625Q17.2354,7.624825087890625,17.6455,7.624825087890625Q18.0557,7.624825087890625,18.3682,7.465325087890625Q18.6807,7.305815087890625,18.8532,7.020985087890625ZM8.76432,7.559725087890625L8.13444,7.559725087890625L8.13444,4.214996087890625L7.28971,4.700025087890625L7.2946,4.070139087890625L8.310220000000001,3.479319087890625L8.76432,3.479319087890625L8.76432,7.559725087890625ZM17.1816,4.955555087890625Q17.0042,4.784655087890625,17.0042,4.5095950878906255Q17.0042,4.229645087890625,17.18,4.057119087890625Q17.355800000000002,3.884592087890625,17.6455,3.884592087890625Q17.935200000000002,3.884592087890625,18.1077,4.057119087890625Q18.2803,4.229645087890625,18.2803,4.5095950878906255Q18.2803,4.784655087890625,18.1045,4.955555087890625Q17.930300000000003,5.124825087890625,17.6455,5.124825087890625Q17.3607,5.124825087890625,17.1816,4.955555087890625ZM18.2217,5.7953950878906255Q18.4398,6.005365087890625,18.4398,6.3552950878906245Q18.4398,6.705235087890625,18.2217,6.915195087890625Q18.0052,7.125155087890625,17.6455,7.125155087890625Q17.285800000000002,7.125155087890625,17.067700000000002,6.915195087890625Q16.849600000000002,6.705235087890625,16.849600000000002,6.3552950878906245Q16.849600000000002,6.005365087890625,17.064500000000002,5.7953950878906255Q17.2793,5.585435087890625,17.6455,5.585435087890625Q18.0052,5.585435087890625,18.2217,5.7953950878906255ZM9.60768,11.711495087890626C9.85136,11.444785087890626,10,11.089765087890626,10,10.700025087890625C10,9.871595087890626,9.32843,9.200025087890625,8.5,9.200025087890625C7.67157,9.200025087890625,7,9.871595087890626,7,10.700025087890625C7,10.809205087890625,7.01167,10.915665087890625,7.03382,11.018215087890624L3.5247,15.200215087890625C3.51648,15.200115087890625,3.5082500000000003,15.200015087890625,3.5,15.200015087890625C2.671573,15.200015087890625,2,15.871615087890625,2,16.700015087890627C2,17.528415087890625,2.671573,18.200015087890627,3.5,18.200015087890627C4.32843,18.200015087890627,5,17.528415087890625,5,16.700015087890627C5,16.258515087890625,4.80921,15.861515087890625,4.50558,15.587015087890626L7.59952,11.899765087890625C7.8503,12.088295087890625,8.162099999999999,12.200025087890625,8.5,12.200025087890625C8.57314,12.200025087890625,8.645050000000001,12.194785087890626,8.71539,12.184675087890625L11.3216,15.771815087890625C11.12019,16.027215087890625,11,16.349515087890623,11,16.700015087890627C11,17.528415087890625,11.67157,18.200015087890627,12.5,18.200015087890627C13.3284,18.200015087890627,14,17.528415087890625,14,16.700015087890627C14,16.336015087890623,13.8703,16.002315087890626,13.6547,15.742515087890625L16.781,12.016775087890625C16.994500000000002,12.133605087890626,17.2395,12.200025087890625,17.5,12.200025087890625C18.3284,12.200025087890625,19,11.528445087890624,19,10.700025087890625C19,9.871595087890626,18.3284,9.200025087890625,17.5,9.200025087890625C16.671599999999998,9.200025087890625,16,9.871595087890626,16,10.700025087890625C16,10.898765087890624,16.0387,11.088475087890625,16.108800000000002,11.262055087890625L12.7823,15.226515087890625C12.6908,15.209115087890625,12.5965,15.200015087890625,12.5,15.200015087890625C12.3862,15.200015087890625,12.2754,15.212715087890626,12.1689,15.236715087890625L9.60768,11.711495087890626Z" stroke-opacity="0" stroke="none"></path></svg>');
var Kc = () => Ec.cloneNode(true);
var Fc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M9.474616630859375,7.494615087890625L8.844736630859375,7.494615087890625L8.844736630859375,4.149892087890625L8.000006630859374,4.634915087890625L8.004896630859374,4.005035087890625L9.020516630859376,3.414215087890625L9.474616630859375,3.414215087890625L9.474616630859375,7.494615087890625ZM18.529296630859378,4.8318550878906255Q18.307996630859375,5.028795087890625,18.122396630859377,5.385245087890625Q17.868496630859376,5.019035087890625,17.629196630859376,4.8269750878906255Q17.389996630859375,4.634915087890625,17.168596630859376,4.634915087890625Q16.794296630859375,4.634915087890625,16.522496630859376,4.976715087890625Q16.252296630859377,5.3168850878906255,16.252296630859377,5.7856350878906255Q16.252296630859377,6.218575087890625,16.502896630859375,6.521315087890625Q16.755196630859373,6.822415087890625,17.114896630859377,6.822415087890625Q17.368796630859375,6.822415087890625,17.588596630859374,6.625475087890624Q17.809896630859377,6.428535087890625,17.998696630859374,6.0688350878906245Q18.249396630859373,6.439935087890625,18.488596630859377,6.631985087890625Q18.727896630859377,6.822415087890625,18.952496630859375,6.822415087890625Q19.326796630859373,6.822415087890625,19.596996630859376,6.482245087890625Q19.868796630859375,6.140455087890626,19.868796630859375,5.671705087890626Q19.868796630859375,5.238755087890625,19.618196630859376,4.937655087890625Q19.367496630859375,4.634915087890625,19.006196630859375,4.634915087890625Q18.750696630859377,4.634915087890625,18.529296630859378,4.8318550878906255ZM18.337296630859377,5.674955087890625L18.278696630859375,5.596835087890625Q18.449596630859375,5.272935087890625,18.622096630859374,5.1101750878906245Q18.794596630859374,4.947415087890625,18.967096630859373,4.947415087890625Q19.194996630859375,4.947415087890625,19.346396630859374,5.1345950878906255Q19.497696630859377,5.320135087890625,19.497696630859377,5.598455087890625Q19.497696630859377,5.8914250878906245,19.360996630859376,6.096505087890625Q19.224296630859374,6.301585087890626,19.027396630859375,6.301585087890626Q18.915096630859374,6.301585087890626,18.742496630859375,6.146965087890624Q18.569996630859375,5.992335087890625,18.337296630859377,5.674955087890625ZM17.785496630859377,5.779125087890625L17.842496630859372,5.857245087890625Q17.668296630859373,6.186025087890625,17.495796630859374,6.348785087890625Q17.324896630859374,6.509915087890625,17.153996630859375,6.509915087890625Q16.926096630859377,6.509915087890625,16.774796630859377,6.324375087890624Q16.623396630859375,6.137195087890625,16.623396630859375,5.858875087890625Q16.623396630859375,5.565905087890625,16.761696630859376,5.360825087890625Q16.900096630859373,5.1557550878906255,17.095396630859376,5.1557550878906255Q17.228896630859374,5.1557550878906255,17.365596630859375,5.2778250878906245Q17.502296630859377,5.399895087890625,17.785496630859377,5.779125087890625ZM10.710296630859375,10.634915087890626C10.710296630859375,11.024655087890626,10.561656630859375,11.379685087890625,10.317976630859375,11.646395087890625L12.879196630859376,15.171615087890626C12.985696630859374,15.147615087890625,13.096496630859376,15.134915087890626,13.210296630859375,15.134915087890626C13.306796630859376,15.134915087890626,13.401096630859374,15.144015087890624,13.492596630859374,15.161415087890624L16.819096630859377,11.196955087890625C16.748996630859374,11.023375087890624,16.710296630859375,10.833655087890625,16.710296630859375,10.634915087890626C16.710296630859375,9.806495087890625,17.381896630859373,9.134915087890626,18.210296630859375,9.134915087890626C19.038696630859373,9.134915087890626,19.710296630859375,9.806495087890625,19.710296630859375,10.634915087890626C19.710296630859375,11.463345087890625,19.038696630859373,12.134915087890626,18.210296630859375,12.134915087890626C17.949796630859375,12.134915087890626,17.704796630859377,12.068505087890625,17.491296630859374,11.951675087890624L14.364996630859375,15.677415087890624C14.580596630859375,15.937215087890625,14.710296630859375,16.270915087890625,14.710296630859375,16.634915087890626C14.710296630859375,17.463315087890624,14.038696630859375,18.134915087890626,13.210296630859375,18.134915087890626C12.381866630859374,18.134915087890626,11.710296630859375,17.463315087890624,11.710296630859375,16.634915087890626C11.710296630859375,16.284415087890626,11.830486630859374,15.962015087890626,12.031896630859375,15.706715087890625L9.425686630859374,12.119565087890624C9.355346630859376,12.129685087890625,9.283436630859375,12.134915087890626,9.210296630859375,12.134915087890626C8.872396630859374,12.134915087890626,8.560596630859376,12.023195087890626,8.309816630859375,11.834665087890626L5.215876630859375,15.521915087890624C5.519506630859375,15.796415087890624,5.710296630859375,16.193415087890624,5.710296630859375,16.634915087890626C5.710296630859375,17.463315087890624,5.038726630859375,18.134915087890626,4.210296630859375,18.134915087890626C3.381869630859375,18.134915087890626,2.710296630859375,17.463315087890624,2.710296630859375,16.634915087890626C2.710296630859375,15.806515087890626,3.381869630859375,15.134915087890626,4.210296630859375,15.134915087890626C4.218546630859375,15.134915087890626,4.226776630859375,15.135015087890626,4.234996630859375,15.135115087890625L7.744116630859375,10.953115087890625C7.721966630859375,10.850565087890626,7.710296630859375,10.744105087890624,7.710296630859375,10.634915087890626C7.710296630859375,9.806495087890625,8.381866630859374,9.134915087890626,9.210296630859375,9.134915087890626C10.038726630859376,9.134915087890626,10.710296630859375,9.806495087890625,10.710296630859375,10.634915087890626Z" stroke-opacity="0" stroke="none"></path></svg>');
var jc = () => Fc.cloneNode(true);
var Zc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M21,5.5C21,6.32843,20.3284,7,19.5,7C19.4136,7,19.3289,6.99269,19.2465,6.97866L15.6257,15.5086C15.8587,15.7729,16,16.119999999999997,16,16.5C16,17.328400000000002,15.3284,18,14.5,18C13.8469,18,13.2913,17.5826,13.0854,17L3.91465,17C3.70873,17.5826,3.15311,18,2.5,18C1.671573,18,1,17.328400000000002,1,16.5C1,15.6716,1.671573,15,2.5,15C2.5840199999999998,15,2.66643,15.0069,2.74668,15.0202L6.36934,6.48574C6.13933,6.22213,6,5.87733,6,5.5C6,4.671573,6.67157,4,7.5,4C8.15311,4,8.70873,4.417404,8.91465,5L18.0854,5C18.2913,4.417404,18.8469,4,19.5,4C20.3284,4,21,4.671573,21,5.5ZM18.0854,6L8.91465,6C8.892579999999999,6.06243,8.8665,6.12296,8.83672,6.18128L13.9814,15.0921C14.143,15.0325,14.3177,15,14.5,15C14.584,15,14.6664,15.0069,14.7467,15.0202L18.3693,6.48574C18.2462,6.3446,18.149,6.1802,18.0854,6ZM13.2036,15.745L8.0861,6.8811800000000005C7.90605,6.95768,7.70797,7,7.5,7C7.41359,7,7.32888,6.99269,7.24647,6.97866L3.62571,15.5086C3.7512,15.651,3.8501,15.8174,3.91465,16L13.0854,16C13.1169,15.9108,13.1566,15.8255,13.2036,15.745Z" stroke-opacity="0" stroke="none"></path></svg>');
var Qc = () => Zc.cloneNode(true);
var Rc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M5.92159,5.93994C6.04014,5.90529,6.152620000000001,5.85639,6.25704,5.79523L9.12729,9.89437C9.045449999999999,10.07959,9,10.28449,9,10.5C9,10.79522,9.08529,11.07053,9.232569999999999,11.30262L4.97573,16.7511L5.92159,5.93994ZM4.92259,5.8848400000000005C4.38078,5.658659999999999,4,5.1238,4,4.5C4,3.671573,4.67157,3,5.5,3C6.2157,3,6.81433,3.50124,6.96399,4.17183L15.1309,4.88634C15.3654,4.36387,15.8902,4,16.5,4C17.328400000000002,4,18,4.67157,18,5.5C18,6.08983,17.659599999999998,6.60015,17.1645,6.84518L18.4264,14.0018C18.4508,14.0006,18.4753,14,18.5,14C19.3284,14,20,14.6716,20,15.5C20,16.328400000000002,19.3284,17,18.5,17C17.932499999999997,17,17.4386,16.6849,17.183799999999998,16.22L5.99686,18.5979C5.946429999999999,19.3807,5.29554,20,4.5,20C3.671573,20,3,19.3284,3,18.5C3,17.869300000000003,3.389292,17.3295,3.94071,17.1077L4.92259,5.8848400000000005ZM5.72452,17.6334C5.69799,17.596,5.6698,17.5599,5.64004,17.525100000000002L10.01843,11.92103C10.16958,11.97223,10.33155,12,10.5,12C10.80059,12,11.08052,11.91158,11.31522,11.75934L17.0606,15.0765C17.0457,15.1271,17.0335,15.1789,17.023899999999998,15.2317L5.72452,17.6334ZM11.92855,10.95875L17.4349,14.1379L16.1699,6.96356C15.9874,6.92257,15.8174,6.8483,15.6667,6.74746L11.99771,10.4165C11.99923,10.44414,12,10.47198,12,10.5C12,10.66,11.97495,10.814160000000001,11.92855,10.95875ZM10.5,9C10.259830000000001,9,10.03285,9.05644,9.83159,9.15679L7.04919,5.1831L15.0493,5.88302C15.054,5.90072,15.059,5.91829,15.0643,5.9357299999999995L11.56066,9.43934C11.28921,9.16789,10.91421,9,10.5,9Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var zc = () => Rc.cloneNode(true);
var Uc = g('<svg viewBox="0 0 22 22"><path d="M4.727219638671875,8.007996215820313L9.973849638671876,2.7629472158203123C10.167279638671875,2.5696791158203123,10.480729638671875,2.5696791158203123,10.674169638671875,2.7629472158203123L13.223329638671874,5.311756215820313C13.416929638671874,5.505236215820313,13.416929638671874,5.8189862158203125,13.223329638671874,6.012466215820313L7.977129638671875,11.257906215820313C7.379859638671875,11.855176215820313,7.407609638671875,12.909396215820312,8.033809638671876,13.535596215820313C8.660409638671876,14.162596215820313,9.713849638671874,14.189996215820312,10.311129638671876,13.591896215820313L15.556929638671875,8.346066215820311C15.750429638671875,8.152526215820313,16.064229638671875,8.152526215820313,16.257629638671872,8.346066215820311L18.806529638671876,10.895266215820312C19.000029638671876,11.088746215820313,19.000029638671876,11.402496215820312,18.806529638671876,11.595976215820313L13.560629638671875,16.841796215820313C11.165619638671876,19.237196215820312,7.197149638671875,19.19919621582031,4.783499638671875,16.785496215820313C2.3698426386718747,14.371896215820312,2.331397638671875,10.403416215820313,4.727219638671875,8.007996215820313ZM12.172299638671875,5.662106215820312L10.323809638671875,3.8136162158203124L5.4287196386718755,8.709096215820313C3.422893638671875,10.714536215820312,3.4549956386718748,14.055196215820313,5.484999638671875,16.08479621582031C7.514609638671875,18.114796215820313,10.855289638671875,18.146496215820314,12.860719638671876,16.141096215820312L15.465629638671874,13.535796215820312L14.090929638671875,12.160756215820312L14.791629638671875,11.460436215820312L16.166229638671876,12.834996215820313L17.755829638671877,11.245226215820313L15.907729638671874,9.396736215820312L11.011839638671875,14.292596215820312C10.042809638671875,15.262396215820312,8.418249638671874,15.243796215820312,7.406019638671875,14.306496215820312L7.333099638671875,14.236296215820312C6.327599638671876,13.230796215820313,6.284009638671876,11.550396215820312,7.276419638671875,10.557586215820312L9.882199638671874,7.952026215820313L8.501079638671875,6.570906215820313L9.201789638671876,5.870186215820313L10.582939638671874,7.251336215820312L12.172299638671875,5.662106215820312Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var Yc = (e) => (() => {
  const t = Uc.cloneNode(true);
  return G(t, "class", `icon-overlay ${e ?? ""}`), t;
})();
var Vc = g('<svg viewBox="0 0 22 22"><defs><clipPath id="master_svg0_151_615"><rect x="0" y="0" width="22" height="22" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_151_615)"><path d="M19.672,3.0673368C19.4417,2.9354008,19.1463,3.00292252,18.9994,3.2210900000000002L17.4588,5.50622L16.743299999999998,3.781253L13.9915,7.4662L13.9618,7.51108C13.8339,7.72862,13.8936,8.005659999999999,14.1004,8.15391L14.1462,8.183430000000001C14.3683,8.308720000000001,14.6511,8.25001,14.8022,8.047229999999999L16.4907,5.78571L17.246299999999998,7.60713L19.8374,3.7635389999999997L19.8651,3.717088C19.9871,3.484615,19.9023,3.199273,19.672,3.0673368ZM4.79974,8.462530000000001L10.117740000000001,3.252975C10.31381,3.0610145,10.63152,3.0610145,10.82759,3.252975L13.4115,5.78453C13.6076,5.976710000000001,13.6076,6.28833,13.4115,6.4805L8.093869999999999,11.69045C7.48847,12.28368,7.51659,13.3308,8.151309999999999,13.9528C8.786439999999999,14.5755,9.85421,14.6027,10.45961,14.0087L15.7768,8.79831C15.9729,8.60609,16.2909,8.60609,16.487099999999998,8.79831L19.0705,11.33026C19.2667,11.52244,19.2667,11.83406,19.0705,12.02623L13.7533,17.2366C11.32572,19.6158,7.30328,19.578,4.85679,17.1807C2.410298,14.7834,2.371331,10.84174,4.79974,8.462530000000001ZM12.3461,6.1325199999999995L10.47246,4.29654L5.51079,9.15889C3.477674,11.15076,3.510214,14.4688,5.56784,16.4847C7.62506,18.500999999999998,11.01117,18.5325,13.0439,16.540599999999998L15.6842,13.9529L14.2908,12.58718L15.0011,11.89161L16.394399999999997,13.2569L18.0056,11.67786L16.1323,9.84188L11.16985,14.7046C10.18764,15.6679,8.540980000000001,15.6494,7.51498,14.7184L7.44107,14.6487C6.4219,13.65,6.37771,11.98096,7.38362,10.994869999999999L10.02485,8.40693L8.624939999999999,7.03516L9.335180000000001,6.33919L10.73512,7.71099L12.3461,6.1325199999999995Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></g></svg>');
var Hc = (e) => (() => {
  const t = Vc.cloneNode(true);
  return G(t, "class", `icon-overlay ${e ?? ""}`), t;
})();
var Gc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M11,17C5.80945,17,3.667717,12.85,3.113386,11.575C2.9622047,11.2,2.9622047,10.8,3.113386,10.425C3.667717,9.15,5.80945,5,11,5C16.165399999999998,5,18.3323,9.15,18.8866,10.425C19.0378,10.8,19.0378,11.2,18.8866,11.575C18.3323,12.85,16.165399999999998,17,11,17ZM4.04567,10.8C3.995276,10.925,3.995276,11.05,4.04567,11.175C4.52441,12.325,6.43937,16,11,16C15.5606,16,17.4756,12.325,17.9543,11.2C18.0047,11.075,18.0047,10.95,17.9543,10.825C17.4756,9.675,15.5606,6,11,6C6.43937,6,4.52441,9.675,4.04567,10.8ZM11,13.5C9.61417,13.5,8.480319999999999,12.375,8.480319999999999,11C8.480319999999999,9.625,9.61417,8.5,11,8.5C12.38583,8.5,13.5197,9.625,13.5197,11C13.5197,12.375,12.38583,13.5,11,13.5ZM11,9.5C10.1685,9.5,9.48819,10.175,9.48819,11C9.48819,11.825,10.1685,12.5,11,12.5C11.8315,12.5,12.51181,11.825,12.51181,11C12.51181,10.175,11.8315,9.5,11,9.5Z" stroke-opacity="0" fill-opacity="1"></path></svg>');
var Xc = () => Gc.cloneNode(true);
var Jc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M5.80417,14.9887L4.62563,16.167299999999997C4.43037,16.3625,4.43037,16.6791,4.62563,16.8744C4.82089,17.0696,5.13748,17.0696,5.332739999999999,16.8744L6.62638,15.5807C7.75595,16.290100000000002,9.19328,16.7929,11,16.7929C16.165399999999998,16.7929,18.3323,12.64289,18.8866,11.36789C19.0378,10.99289,19.0378,10.59289,18.8866,10.21789C18.5549,9.45486,17.6456,7.66212,15.8617,6.34545L17.3536,4.853553C17.5488,4.658291,17.5488,4.341709,17.3536,4.146447C17.1583,3.9511845,16.8417,3.9511845,16.6464,4.146447L15.0014,5.7915399999999995C13.9314,5.1969,12.61166,4.792893,11,4.792893C5.80945,4.792893,3.667717,8.94289,3.113386,10.21789C2.9622049,10.59289,2.9622049,10.99289,3.113386,11.36789C3.424435,12.08333,4.2353000000000005,13.70399,5.80417,14.9887ZM7.36012,14.847C8.32327,15.4074,9.52286,15.7929,11,15.7929C15.5606,15.7929,17.4756,12.11789,17.9543,10.99289C18.0047,10.86789,18.0047,10.74289,17.9543,10.61789C17.659,9.90846,16.8171,8.23812,15.1447,7.06241L12.96929,9.23782C13.3134,9.66543,13.5197,10.20642,13.5197,10.79289C13.5197,12.16789,12.38583,13.29289,11,13.29289C10.41596,13.29289,9.87667,13.09308,9.44815,12.75896L7.36012,14.847ZM8.794609999999999,11.99829L6.520099999999999,14.2728C5.06905,13.12119,4.32057,11.628250000000001,4.04567,10.96789C3.995275,10.84289,3.995275,10.71789,4.04567,10.59289C4.52441,9.46789,6.43937,5.79289,11,5.79289C12.28868,5.79289,13.3661,6.086320000000001,14.2596,6.53329L12.19759,8.5953C11.84086,8.40257,11.43271,8.29289,11,8.29289C9.61417,8.29289,8.480319999999999,9.41789,8.480319999999999,10.79289C8.480319999999999,11.22918,8.594470000000001,11.64029,8.794609999999999,11.99829ZM10.16528,12.04183C10.404869999999999,12.20032,10.692070000000001,12.29289,11,12.29289C11.8315,12.29289,12.51181,11.61789,12.51181,10.79289C12.51181,10.48318,12.41593,10.194600000000001,12.25216,9.95494L10.16528,12.04183ZM11.43602,9.35687L9.55616,11.236740000000001C9.512,11.09633,9.48819,10.94724,9.48819,10.79289C9.48819,9.96789,10.1685,9.29289,11,9.29289C11.15142,9.29289,11.29782,9.31528,11.43602,9.35687Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></svg>');
var Wc = () => Jc.cloneNode(true);
var qc = g('<svg class="icon-overlay" viewBox="0 0 22 22"><defs><clipPath id="master_svg0_151_625"><rect x="0" y="0" width="22" height="22" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_151_625)"><path d="M14.5385,9.76923L15.6538,9.76923C16.6538,9.76923,17.4615,10.576920000000001,17.4615,11.576920000000001L17.4615,17.1923C17.4615,18.1923,16.6538,19,15.6538,19L5.80769,19C4.807692,19,4,18.1923,4,17.1923L4,11.576920000000001C4,10.576920000000001,4.807692,9.76923,5.80769,9.76923L7.23077,9.76923L7.23077,7.576919999999999C7.23077,5.61538,8.88462,4,10.88462,4C12.88462,4,14.5385,5.61538,14.5385,7.576919999999999L14.5385,9.76923ZM10.88461,5.15385C9.5,5.15385,8.38461,6.23077,8.38461,7.576919999999999L8.38461,9.76923L13.38462,9.76923L13.38462,7.576919999999999C13.38462,6.23077,12.26923,5.15385,10.88461,5.15385ZM15.6538,17.8462C16,17.8462,16.3077,17.5385,16.3077,17.1923L16.3077,11.576920000000001C16.3077,11.23077,16,10.923079999999999,15.6538,10.923079999999999L5.80769,10.923079999999999C5.46154,10.923079999999999,5.15385,11.23077,5.15385,11.576920000000001L5.15385,17.1923C5.15385,17.5385,5.46154,17.8462,5.80769,17.8462L15.6538,17.8462ZM10.153839999999999,12.65385C10.153839999999999,12.34615,10.42307,12.07692,10.73076,12.07692C11.038450000000001,12.07692,11.307680000000001,12.34615,11.307680000000001,12.65385L11.307680000000001,14.5769C11.307680000000001,14.8846,11.038450000000001,15.1538,10.73076,15.1538C10.42307,15.1538,10.153839999999999,14.8846,10.153839999999999,14.5769L10.153839999999999,12.65385Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></g></svg>');
var el = () => qc.cloneNode(true);
var tl = g('<svg class="icon-overlay" viewBox="0 0 22 22"><defs><clipPath id="master_svg0_151_620"><rect x="0" y="0" width="22" height="22" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_151_620)"><path d="M8.38461,9.76923L15.6538,9.76923C16.6538,9.76923,17.4615,10.576920000000001,17.4615,11.576920000000001L17.4615,17.1923C17.4615,18.1923,16.6538,19,15.6538,19L5.80769,19C4.807692,19,4,18.1923,4,17.1923L4,11.576920000000001C4,10.576920000000001,4.807693,9.76923,5.80769,9.76923L7.23077,9.76923L7.23077,7.576919999999999C7.23077,5.61538,8.88462,4,10.88462,4C12.46154,4,13.84615,4.961539,14.3462,6.423080000000001C14.4615,6.73077,14.3077,7.038460000000001,14,7.15385C13.69231,7.26923,13.38461,7.11538,13.26923,6.80769C12.92308,5.80769,11.96154,5.15385,10.88462,5.15385C9.5,5.15385,8.38461,6.23077,8.38461,7.576919999999999L8.38461,9.76923ZM15.6538,17.8462C16,17.8462,16.3077,17.5385,16.3077,17.1923L16.3077,11.576920000000001C16.3077,11.23077,16,10.923079999999999,15.6538,10.923079999999999L5.80769,10.923079999999999C5.46154,10.923079999999999,5.15385,11.23077,5.15385,11.576920000000001L5.15385,17.1923C5.15385,17.5385,5.46154,17.8462,5.80769,17.8462L15.6538,17.8462ZM10.153839999999999,12.65385C10.153839999999999,12.34615,10.42307,12.07692,10.73076,12.07692C11.03846,12.07692,11.307690000000001,12.34615,11.307690000000001,12.65385L11.307690000000001,14.5769C11.307690000000001,14.8846,11.03846,15.1538,10.73076,15.1538C10.42307,15.1538,10.153839999999999,14.8846,10.153839999999999,14.5769L10.153839999999999,12.65385Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></g></svg>');
var nl = () => tl.cloneNode(true);
var rl = g('<svg class="icon-overlay" viewBox="0 0 22 22"><path d="M16.966900000000003,8.67144C16.6669,8.67144,16.4247,8.91558,16.4247,9.21802L16.4247,16.631500000000003C16.4247,17.322,16.007199999999997,17.9068,15.5139,17.9068L13.93072,17.9068L13.93072,9.2162C13.93072,8.91741,13.68675,8.67144,13.38855,8.67144C13.09036,8.67144,12.84639,8.91741,12.84639,9.21802L12.84639,17.9068L10.151810000000001,17.9068L10.151810000000001,9.21802C10.151810000000001,8.91741,9.90783,8.67144,9.609639999999999,8.67144C9.31145,8.67144,9.06747,8.91741,9.06747,9.219850000000001L9.06747,17.9068L7.48614,17.9068C6.99277,17.9068,6.5753,17.322,6.5753,16.631500000000003L6.5753,9.21802C6.5753,8.91558,6.333130000000001,8.67144,6.03313,8.67144C5.73313,8.67144,5.49096,8.91558,5.49096,9.21802L5.49096,16.631500000000003C5.49096,17.9378,6.385540000000001,19,7.48614,19L15.512,19C16.6127,19,17.509,17.9378,17.509,16.631500000000003L17.509,9.21802C17.509,8.91558,17.2669,8.67144,16.966900000000003,8.67144ZM18.4578,6.21183L4.542169,6.21183C4.243976,6.21183,4,6.45779,4,6.75841C4,7.05903,4.243976,7.30499,4.542169,7.30499L18.4578,7.30499C18.756,7.30499,19,7.05903,19,6.75841C19,6.45779,18.756,6.21183,18.4578,6.21183ZM8.68072,5.10045L14.3193,5.10045C14.6175,5.10045,14.8614,4.852666,14.8614,4.550225C14.8614,4.247783,14.6175,4,14.3193,4L8.68072,4C8.38253,4,8.13855,4.247783,8.13855,4.550225C8.13855,4.852666,8.38253,5.10045,8.68072,5.10045Z" stroke-opacity="0" fill-opacity="1"></path></svg>');
var al = () => rl.cloneNode(true);
var il = {
  horizontalStraightLine: jo,
  horizontalRayLine: Qo,
  horizontalSegment: zo,
  verticalStraightLine: Yo,
  verticalRayLine: Ho,
  verticalSegment: Xo,
  straightLine: Wo,
  rayLine: ec,
  segment: nc,
  arrow: ac,
  priceLine: sc,
  priceChannelLine: cc,
  parallelStraightLine: uc,
  fibonacciLine: fc,
  fibonacciSegment: yc,
  fibonacciCircle: dc,
  fibonacciSpiral: pc,
  fibonacciSpeedResistanceFan: _c,
  fibonacciExtension: $c,
  gannBox: xc,
  circle: Ac,
  triangle: wc,
  rect: Tc,
  parallelogram: Nc,
  threeWaves: Bc,
  fiveWaves: Oc,
  eightWaves: Kc,
  anyWaves: jc,
  abcd: Qc,
  xabcd: zc,
  weak_magnet: Yc,
  strong_magnet: Hc,
  lock: el,
  unlock: nl,
  visible: Xc,
  invisible: Wc,
  remove: al
};
function sl(e) {
  return [
    { key: "horizontalStraightLine", text: l("horizontal_straight_line", e) },
    { key: "horizontalRayLine", text: l("horizontal_ray_line", e) },
    { key: "horizontalSegment", text: l("horizontal_segment", e) },
    { key: "verticalStraightLine", text: l("vertical_straight_line", e) },
    { key: "verticalRayLine", text: l("vertical_ray_line", e) },
    { key: "verticalSegment", text: l("vertical_segment", e) },
    { key: "straightLine", text: l("straight_line", e) },
    { key: "rayLine", text: l("ray_line", e) },
    { key: "segment", text: l("segment", e) },
    { key: "arrow", text: l("arrow", e) },
    { key: "priceLine", text: l("price_line", e) }
  ];
}
function ol(e) {
  return [
    { key: "priceChannelLine", text: l("price_channel_line", e) },
    { key: "parallelStraightLine", text: l("parallel_straight_line", e) }
  ];
}
function cl(e) {
  return [
    { key: "circle", text: l("circle", e) },
    { key: "rect", text: l("rect", e) },
    { key: "parallelogram", text: l("parallelogram", e) },
    { key: "triangle", text: l("triangle", e) }
  ];
}
function ll(e) {
  return [
    { key: "fibonacciLine", text: l("fibonacci_line", e) },
    { key: "fibonacciSegment", text: l("fibonacci_segment", e) },
    { key: "fibonacciCircle", text: l("fibonacci_circle", e) },
    { key: "fibonacciSpiral", text: l("fibonacci_spiral", e) },
    { key: "fibonacciSpeedResistanceFan", text: l("fibonacci_speed_resistance_fan", e) },
    { key: "fibonacciExtension", text: l("fibonacci_extension", e) },
    { key: "gannBox", text: l("gann_box", e) }
  ];
}
function ul(e) {
  return [
    { key: "xabcd", text: l("xabcd", e) },
    { key: "abcd", text: l("abcd", e) },
    { key: "threeWaves", text: l("three_waves", e) },
    { key: "fiveWaves", text: l("five_waves", e) },
    { key: "eightWaves", text: l("eight_waves", e) },
    { key: "anyWaves", text: l("any_waves", e) }
  ];
}
function Cl(e) {
  return [
    { key: "weak_magnet", text: l("weak_magnet", e) },
    { key: "strong_magnet", text: l("strong_magnet", e) }
  ];
}
var J = (e) => il[e.name](e.class);
var fl = g('<div class="klinecharts-pro-drawing-bar"><span class="split-line"></span><div class="item" tabindex="0"><span style="width:32px;height:32px"></span><div class="icon-arrow"><svg viewBox="0 0 4 6"><path d="M1.07298,0.159458C0.827521,-0.0531526,0.429553,-0.0531526,0.184094,0.159458C-0.0613648,0.372068,-0.0613648,0.716778,0.184094,0.929388L2.61275,3.03303L0.260362,5.07061C0.0149035,5.28322,0.0149035,5.62793,0.260362,5.84054C0.505822,6.05315,0.903789,6.05315,1.14925,5.84054L3.81591,3.53075C4.01812,3.3556,4.05374,3.0908,3.92279,2.88406C3.93219,2.73496,3.87113,2.58315,3.73964,2.46925L1.07298,0.159458Z" stroke="none" stroke-opacity="0"></path></svg></div></div><div class="item"><span style="width:32px;height:32px"></span></div><div class="item"><span style="width:32px;height:32px"></span></div><span class="split-line"></span><div class="item"><span style="width:32px;height:32px"></span></div></div>');
var gl = g('<div class="item" tabindex="0"><span style="width:32px;height:32px"></span><div class="icon-arrow"><svg viewBox="0 0 4 6"><path d="M1.07298,0.159458C0.827521,-0.0531526,0.429553,-0.0531526,0.184094,0.159458C-0.0613648,0.372068,-0.0613648,0.716778,0.184094,0.929388L2.61275,3.03303L0.260362,5.07061C0.0149035,5.28322,0.0149035,5.62793,0.260362,5.84054C0.505822,6.05315,0.903789,6.05315,1.14925,5.84054L3.81591,3.53075C4.01812,3.3556,4.05374,3.0908,3.92279,2.88406C3.93219,2.73496,3.87113,2.58315,3.73964,2.46925L1.07298,0.159458Z" stroke="none" stroke-opacity="0"></path></svg></div></div>');
var v9 = g('<li><span style="padding-left:8px"></span></li>');
var _9 = "drawing_tools";
var yl = (e) => {
  const [t, n] = $("horizontalStraightLine"), [r, a] = $("priceChannelLine"), [i, o] = $("circle"), [s, c] = $("fibonacciLine"), [C, u] = $("xabcd"), [y, p] = $("weak_magnet"), [L, M] = $("normal"), [P, K] = $(false), [w, Q] = $(true), [S, A] = $(""), b = F(() => [{
    key: "singleLine",
    icon: t(),
    list: sl(e.locale),
    setter: n
  }, {
    key: "moreLine",
    icon: r(),
    list: ol(e.locale),
    setter: a
  }, {
    key: "polygon",
    icon: i(),
    list: cl(e.locale),
    setter: o
  }, {
    key: "fibonacci",
    icon: s(),
    list: ll(e.locale),
    setter: c
  }, {
    key: "wave",
    icon: C(),
    list: ul(e.locale),
    setter: u
  }]), O = F(() => Cl(e.locale));
  return (() => {
    const H = fl.cloneNode(true), t1 = H.firstChild, x = t1.nextSibling, D = x.firstChild, j = D.nextSibling, n1 = j.firstChild, I1 = x.nextSibling, N1 = I1.firstChild, C1 = I1.nextSibling, F1 = C1.firstChild, j1 = C1.nextSibling, Z1 = j1.nextSibling, Q1 = Z1.firstChild;
    return m(H, () => b().map((k) => (() => {
      const z = gl.cloneNode(true), W = z.firstChild, c1 = W.nextSibling, D1 = c1.firstChild;
      return z.addEventListener("blur", () => {
        A("");
      }), W.$$click = () => {
        e.onDrawingItemClick({
          groupId: _9,
          name: k.icon,
          visible: w(),
          lock: P(),
          mode: L()
        });
      }, m(W, d(J, {
        get name() {
          return k.icon;
        }
      })), c1.$$click = () => {
        k.key === S() ? A("") : A(k.key);
      }, m(z, (() => {
        const h = F(() => k.key === S());
        return () => h() && d(n0, {
          class: "list",
          get children() {
            return k.list.map((f) => (() => {
              const v = v9.cloneNode(true), _ = v.firstChild;
              return v.$$click = () => {
                k.setter(f.key), e.onDrawingItemClick({
                  name: f.key,
                  lock: P(),
                  mode: L()
                }), A("");
              }, m(v, d(J, {
                get name() {
                  return f.key;
                }
              }), _), m(_, () => f.text), v;
            })());
          }
        });
      })(), null), Z(() => G(D1, "class", k.key === S() ? "rotate" : "")), z;
    })()), t1), x.addEventListener("blur", () => {
      A("");
    }), D.$$click = () => {
      let k = y();
      L() !== "normal" && (k = "normal"), M(k), e.onModeChange(k);
    }, m(D, (() => {
      const k = F(() => y() === "weak_magnet");
      return () => k() ? (() => {
        const z = F(() => L() === "weak_magnet");
        return () => z() ? d(J, {
          name: "weak_magnet",
          class: "selected"
        }) : d(J, {
          name: "weak_magnet"
        });
      })() : (() => {
        const z = F(() => L() === "strong_magnet");
        return () => z() ? d(J, {
          name: "strong_magnet",
          class: "selected"
        }) : d(J, {
          name: "strong_magnet"
        });
      })();
    })()), j.$$click = () => {
      S() === "mode" ? A("") : A("mode");
    }, m(x, (() => {
      const k = F(() => S() === "mode");
      return () => k() && d(n0, {
        class: "list",
        get children() {
          return O().map((z) => (() => {
            const W = v9.cloneNode(true), c1 = W.firstChild;
            return W.$$click = () => {
              p(z.key), M(z.key), e.onModeChange(z.key), A("");
            }, m(W, d(J, {
              get name() {
                return z.key;
              }
            }), c1), m(c1, () => z.text), W;
          })());
        }
      });
    })(), null), N1.$$click = () => {
      const k = !P();
      K(k), e.onLockChange(k);
    }, m(N1, (() => {
      const k = F(() => !!P());
      return () => k() ? d(J, {
        name: "lock"
      }) : d(J, {
        name: "unlock"
      });
    })()), F1.$$click = () => {
      const k = !w();
      Q(k), e.onVisibleChange(k);
    }, m(F1, (() => {
      const k = F(() => !!w());
      return () => k() ? d(J, {
        name: "visible"
      }) : d(J, {
        name: "invisible"
      });
    })()), Q1.$$click = () => {
      e.onRemoveClick(_9);
    }, m(Q1, d(J, {
      name: "remove"
    })), Z(() => G(n1, "class", S() === "mode" ? "rotate" : "")), H;
  })();
};
q(["click"]);
var L9 = g('<li class="title"></li>');
var $9 = g('<li class="row"></li>');
var hl = (e) => d(T1, {
  get title() {
    return l("indicator", e.locale);
  },
  width: 400,
  get onClose() {
    return e.onClose;
  },
  get children() {
    return d(n0, {
      class: "klinecharts-pro-indicator-modal-list",
      get children() {
        return [(() => {
          const t = L9.cloneNode(true);
          return m(t, () => l("main_indicator", e.locale)), t;
        })(), F(() => ["MA", "EMA", "SMA", "BOLL", "SAR", "BBI"].map((t) => {
          const n = e.mainIndicators.includes(t);
          return (() => {
            const r = $9.cloneNode(true);
            return r.$$click = (a) => {
              e.onMainIndicatorChange({
                name: t,
                paneId: "candle_pane",
                added: !n
              });
            }, m(r, d(p9, {
              checked: n,
              get label() {
                return l(t.toLowerCase(), e.locale);
              }
            })), r;
          })();
        })), (() => {
          const t = L9.cloneNode(true);
          return m(t, () => l("sub_indicator", e.locale)), t;
        })(), F(() => ["MA", "EMA", "VOL", "MACD", "BOLL", "KDJ", "RSI", "BIAS", "BRAR", "CCI", "DMI", "CR", "PSY", "DMA", "TRIX", "OBV", "VR", "WR", "MTM", "EMV", "SAR", "SMA", "ROC", "PVT", "BBI", "AO"].map((t) => {
          const n = t in e.subIndicators;
          return (() => {
            const r = $9.cloneNode(true);
            return r.$$click = (a) => {
              e.onSubIndicatorChange({
                name: t,
                paneId: e.subIndicators[t] ?? "",
                added: !n
              });
            }, m(r, d(p9, {
              checked: n,
              get label() {
                return l(t.toLowerCase(), e.locale);
              }
            })), r;
          })();
        }))];
      }
    });
  }
});
q(["click"]);
function b9(e, t) {
  switch (e) {
    case "Etc/UTC":
      return l("utc", t);
    case "Pacific/Honolulu":
      return l("honolulu", t);
    case "America/Juneau":
      return l("juneau", t);
    case "America/Los_Angeles":
      return l("los_angeles", t);
    case "America/Chicago":
      return l("chicago", t);
    case "America/Toronto":
      return l("toronto", t);
    case "America/Sao_Paulo":
      return l("sao_paulo", t);
    case "Europe/London":
      return l("london", t);
    case "Europe/Berlin":
      return l("berlin", t);
    case "Asia/Bahrain":
      return l("bahrain", t);
    case "Asia/Dubai":
      return l("dubai", t);
    case "Asia/Ashkhabad":
      return l("ashkhabad", t);
    case "Asia/Almaty":
      return l("almaty", t);
    case "Asia/Bangkok":
      return l("bangkok", t);
    case "Asia/Shanghai":
      return l("shanghai", t);
    case "Asia/Tokyo":
      return l("tokyo", t);
    case "Australia/Sydney":
      return l("sydney", t);
    case "Pacific/Norfolk":
      return l("norfolk", t);
  }
  return e;
}
function dl(e) {
  return [
    { key: "Etc/UTC", text: l("utc", e) },
    { key: "Pacific/Honolulu", text: l("honolulu", e) },
    { key: "America/Juneau", text: l("juneau", e) },
    { key: "America/Los_Angeles", text: l("los_angeles", e) },
    { key: "America/Chicago", text: l("chicago", e) },
    { key: "America/Toronto", text: l("toronto", e) },
    { key: "America/Sao_Paulo", text: l("sao_paulo", e) },
    { key: "Europe/London", text: l("london", e) },
    { key: "Europe/Berlin", text: l("berlin", e) },
    { key: "Asia/Bahrain", text: l("bahrain", e) },
    { key: "Asia/Dubai", text: l("dubai", e) },
    { key: "Asia/Ashkhabad", text: l("ashkhabad", e) },
    { key: "Asia/Almaty", text: l("almaty", e) },
    { key: "Asia/Bangkok", text: l("bangkok", e) },
    { key: "Asia/Shanghai", text: l("shanghai", e) },
    { key: "Asia/Tokyo", text: l("tokyo", e) },
    { key: "Australia/Sydney", text: l("sydney", e) },
    { key: "Pacific/Norfolk", text: l("norfolk", e) }
  ];
}
var ml = (e) => {
  const [t, n] = $(e.timezone), r = F(() => dl(e.locale));
  return d(T1, {
    get title() {
      return l("timezone", e.locale);
    },
    width: 320,
    get buttons() {
      return [{
        children: l("confirm", e.locale),
        onClick: () => {
          e.onConfirm(t()), e.onClose();
        }
      }];
    },
    get onClose() {
      return e.onClose;
    },
    get children() {
      return d(o5, {
        style: {
          width: "100%",
          "margin-top": "20px"
        },
        get value() {
          return t().text;
        },
        onSelected: (a) => {
          n(a);
        },
        get dataSource() {
          return r();
        }
      });
    }
  });
};
function x9(e) {
  return [
    {
      key: "candle.type",
      text: l("candle_type", e),
      component: "select",
      dataSource: [
        { key: "candle_solid", text: l("candle_solid", e) },
        { key: "candle_stroke", text: l("candle_stroke", e) },
        { key: "candle_up_stroke", text: l("candle_up_stroke", e) },
        { key: "candle_down_stroke", text: l("candle_down_stroke", e) },
        { key: "ohlc", text: l("ohlc", e) },
        { key: "area", text: l("area", e) }
      ]
    },
    {
      key: "candle.priceMark.last.show",
      text: l("last_price_show", e),
      component: "switch"
    },
    {
      key: "candle.priceMark.high.show",
      text: l("high_price_show", e),
      component: "switch"
    },
    {
      key: "candle.priceMark.low.show",
      text: l("low_price_show", e),
      component: "switch"
    },
    {
      key: "indicator.lastValueMark.show",
      text: l("indicator_last_value_show", e),
      component: "switch"
    },
    {
      key: "yAxis.type",
      text: l("price_axis_type", e),
      component: "select",
      dataSource: [
        { key: "normal", text: l("normal", e) },
        { key: "percentage", text: l("percentage", e) },
        { key: "log", text: l("log", e) }
      ]
    },
    {
      key: "yAxis.reverse",
      text: l("reverse_coordinate", e),
      component: "switch"
    },
    {
      key: "grid.show",
      text: l("grid_show", e),
      component: "switch"
    }
  ];
}
var pl = g('<div class="klinecharts-pro-setting-modal-content"></div>');
var vl = g("<span></span>");
var _l = (e) => {
  const [t, n] = $(e.currentStyles), [r, a] = $(x9(e.locale));
  a1(() => {
    a(x9(e.locale));
  });
  const i = (o, s) => {
    const c = {};
    p0(c, o.key, s);
    const C = utils.clone(t());
    p0(C, o.key, s), n(C), a(r().map((u) => ({
      ...u
    }))), e.onChange(c);
  };
  return d(T1, {
    get title() {
      return l("setting", e.locale);
    },
    width: 560,
    get buttons() {
      return [{
        children: l("restore_default", e.locale),
        onClick: () => {
          e.onRestoreDefault(r()), e.onClose();
        }
      }];
    },
    get onClose() {
      return e.onClose;
    },
    get children() {
      const o = pl.cloneNode(true);
      return m(o, d(Y5, {
        get each() {
          return r();
        },
        children: (s) => {
          let c;
          const C = utils.formatValue(t(), s.key);
          switch (s.component) {
            case "select": {
              c = d(o5, {
                style: {
                  width: "120px"
                },
                get value() {
                  return l(C, e.locale);
                },
                get dataSource() {
                  return s.dataSource;
                },
                onSelected: (u) => {
                  const y = u.key;
                  i(s, y);
                }
              });
              break;
            }
            case "switch": {
              const u = !!C;
              c = d(zr, {
                open: u,
                onChange: () => {
                  i(s, !u);
                }
              });
              break;
            }
          }
          return [(() => {
            const u = vl.cloneNode(true);
            return m(u, () => s.text), u;
          })(), c];
        }
      })), o;
    }
  });
};
var Ll = g('<img style="width:500px;margin-top: 20px">');
var $l = (e) => d(T1, {
  get title() {
    return l("screenshot", e.locale);
  },
  width: 540,
  get buttons() {
    return [{
      type: "confirm",
      children: l("save", e.locale),
      onClick: () => {
        const t = document.createElement("a");
        t.download = "screenshot", t.href = e.url, document.body.appendChild(t), t.click(), t.remove();
      }
    }];
  },
  get onClose() {
    return e.onClose;
  },
  get children() {
    const t = Ll.cloneNode(true);
    return Z(() => G(t, "src", e.url)), t;
  }
});
var bl = {
  AO: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 5 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 34 }
  ],
  BIAS: [
    { paramNameKey: "BIAS1", precision: 0, min: 1, styleKey: "lines[0].color" },
    { paramNameKey: "BIAS2", precision: 0, min: 1, styleKey: "lines[1].color" },
    { paramNameKey: "BIAS3", precision: 0, min: 1, styleKey: "lines[2].color" },
    { paramNameKey: "BIAS4", precision: 0, min: 1, styleKey: "lines[3].color" },
    { paramNameKey: "BIAS5", precision: 0, min: 1, styleKey: "lines[4].color" }
  ],
  BOLL: [
    { paramNameKey: "period", precision: 0, min: 1, default: 20 },
    { paramNameKey: "standard_deviation", precision: 2, min: 1, default: 2 }
  ],
  BRAR: [
    { paramNameKey: "period", precision: 0, min: 1, default: 26 }
  ],
  BBI: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 3 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 6 },
    { paramNameKey: "params_3", precision: 0, min: 1, default: 12 },
    { paramNameKey: "params_4", precision: 0, min: 1, default: 24 }
  ],
  CCI: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 20 }
  ],
  CR: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 26 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 10 },
    { paramNameKey: "params_3", precision: 0, min: 1, default: 20 },
    { paramNameKey: "params_4", precision: 0, min: 1, default: 40 },
    { paramNameKey: "params_5", precision: 0, min: 1, default: 60 }
  ],
  DMA: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 10 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 50 },
    { paramNameKey: "params_3", precision: 0, min: 1, default: 10 }
  ],
  DMI: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 14 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 6 }
  ],
  EMV: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 14 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 9 }
  ],
  EMA: [
    { paramNameKey: "EMA1", precision: 0, min: 1, styleKey: "lines[0].color" },
    { paramNameKey: "EMA2", precision: 0, min: 1, styleKey: "lines[1].color" },
    { paramNameKey: "EMA3", precision: 0, min: 1, styleKey: "lines[2].color" },
    { paramNameKey: "EMA4", precision: 0, min: 1, styleKey: "lines[3].color" },
    { paramNameKey: "EMA5", precision: 0, min: 1, styleKey: "lines[4].color" }
  ],
  MTM: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 12 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 6 }
  ],
  MA: [
    { paramNameKey: "MA1", precision: 0, min: 1, styleKey: "lines[0].color" },
    { paramNameKey: "MA2", precision: 0, min: 1, styleKey: "lines[1].color" },
    { paramNameKey: "MA3", precision: 0, min: 1, styleKey: "lines[2].color" },
    { paramNameKey: "MA4", precision: 0, min: 1, styleKey: "lines[3].color" },
    { paramNameKey: "MA5", precision: 0, min: 1, styleKey: "lines[4].color" }
  ],
  MACD: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 12 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 26 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 9 }
  ],
  OBV: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 30 }
  ],
  PVT: [],
  PSY: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 12 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 6 }
  ],
  ROC: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 12 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 6 }
  ],
  RSI: [
    { paramNameKey: "RSI1", precision: 0, min: 1, styleKey: "lines[0].color" },
    { paramNameKey: "RSI2", precision: 0, min: 1, styleKey: "lines[1].color" },
    { paramNameKey: "RSI3", precision: 0, min: 1, styleKey: "lines[2].color" },
    { paramNameKey: "RSI4", precision: 0, min: 1, styleKey: "lines[3].color" },
    { paramNameKey: "RSI5", precision: 0, min: 1, styleKey: "lines[4].color" }
  ],
  SMA: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 12 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 2 }
  ],
  KDJ: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 9 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 3 },
    { paramNameKey: "params_3", precision: 0, min: 1, default: 3 }
  ],
  SAR: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 2 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 2 },
    { paramNameKey: "params_3", precision: 0, min: 1, default: 20 }
  ],
  TRIX: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 12 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 9 }
  ],
  VOL: [
    { paramNameKey: "MA1", precision: 0, min: 1, styleKey: "lines[0].color" },
    { paramNameKey: "MA2", precision: 0, min: 1, styleKey: "lines[1].color" },
    { paramNameKey: "MA3", precision: 0, min: 1, styleKey: "lines[2].color" },
    { paramNameKey: "MA4", precision: 0, min: 1, styleKey: "lines[3].color" },
    { paramNameKey: "MA5", precision: 0, min: 1, styleKey: "lines[4].color" }
  ],
  VR: [
    { paramNameKey: "params_1", precision: 0, min: 1, default: 26 },
    { paramNameKey: "params_2", precision: 0, min: 1, default: 6 }
  ],
  WR: [
    { paramNameKey: "WR1", precision: 0, min: 1, styleKey: "lines[0].color" },
    { paramNameKey: "WR2", precision: 0, min: 1, styleKey: "lines[1].color" },
    { paramNameKey: "WR3", precision: 0, min: 1, styleKey: "lines[2].color" },
    { paramNameKey: "WR4", precision: 0, min: 1, styleKey: "lines[3].color" },
    { paramNameKey: "WR5", precision: 0, min: 1, styleKey: "lines[4].color" }
  ]
};
var xl = g('<div class="klinecharts-pro-indicator-setting-modal-content"></div>');
var kl = g("<span></span>");
var Al = (e) => {
  const [t, n] = $(utils.clone(e.params.calcParams)), r = (a) => bl[a];
  return d(T1, {
    get title() {
      return e.params.indicatorName;
    },
    width: 360,
    get buttons() {
      return [{
        type: "confirm",
        children: l("confirm", e.locale),
        onClick: () => {
          const a = r(e.params.indicatorName), i = [];
          utils.clone(t()).forEach((o, s) => {
            !utils.isValid(o) || o === "" ? "default" in a[s] && i.push(a[s].default) : i.push(o);
          }), e.onConfirm(i), e.onClose();
        }
      }];
    },
    get onClose() {
      return e.onClose;
    },
    get children() {
      const a = xl.cloneNode(true);
      return m(a, () => r(e.params.indicatorName).map((i, o) => [(() => {
        const s = kl.cloneNode(true);
        return m(s, () => l(i.paramNameKey, e.locale)), s;
      })(), d(c5, {
        style: {
          width: "200px"
        },
        get value() {
          return t()[o] ?? "";
        },
        get precision() {
          return i.precision;
        },
        get min() {
          return i.min;
        },
        onChange: (s) => {
          const c = utils.clone(t());
          c[o] = s, n(c);
        }
      })])), a;
    }
  });
};
var Ml = g('<svg viewBox="0 0 1024 1024"><path d="M945.066667 898.133333l-189.866667-189.866666c55.466667-64 87.466667-149.333333 87.466667-241.066667 0-204.8-168.533333-373.333333-373.333334-373.333333S96 264.533333 96 469.333333 264.533333 842.666667 469.333333 842.666667c91.733333 0 174.933333-34.133333 241.066667-87.466667l189.866667 189.866667c6.4 6.4 14.933333 8.533333 23.466666 8.533333s17.066667-2.133333 23.466667-8.533333c8.533333-12.8 8.533333-34.133333-2.133333-46.933334zM469.333333 778.666667C298.666667 778.666667 160 640 160 469.333333S298.666667 160 469.333333 160 778.666667 298.666667 778.666667 469.333333 640 778.666667 469.333333 778.666667z"></path></svg>');
var wl = g('<img alt="symbol">');
var Sl = g("<li><div><span></span></div></li>");
var Tl = (e) => {
  const [t, n] = $(""), [r] = E5(t, e.datafeed.searchSymbols.bind(e.datafeed));
  return d(T1, {
    get title() {
      return l("symbol_search", e.locale);
    },
    width: 460,
    get onClose() {
      return e.onClose;
    },
    get children() {
      return [d(c5, {
        class: "klinecharts-pro-symbol-search-modal-input",
        get placeholder() {
          return l("symbol_code", e.locale);
        },
        get suffix() {
          return Ml.cloneNode(true);
        },
        get value() {
          return t();
        },
        onChange: (a) => {
          const i = `${a}`;
          n(i);
        }
      }), d(n0, {
        class: "klinecharts-pro-symbol-search-modal-list",
        get loading() {
          return r.loading;
        },
        get dataSource() {
          return r() ?? [];
        },
        renderItem: (a) => (() => {
          const i = Sl.cloneNode(true), o = i.firstChild, s = o.firstChild;
          return i.$$click = () => {
            e.onSymbolSelected(a), e.onClose();
          }, m(o, d(U, {
            get when() {
              return a.logo;
            },
            get children() {
              const c = wl.cloneNode(true);
              return Z(() => G(c, "src", a.logo)), c;
            }
          }), s), m(s, () => a.shortName ?? a.ticker, null), m(s, () => `${a.name ? `(${a.name})` : ""}`, null), m(i, () => a.exchange ?? "", null), Z(() => G(s, "title", a.name ?? "")), i;
        })()
      })];
    }
  });
};
q(["click"]);
var Il = g('<i class="icon-close klinecharts-pro-load-icon"></i>');
var Nl = g('<div class="klinecharts-pro-content"><div class="klinecharts-pro-widget"></div></div>');
function V1(e, t, n, r) {
  return t === "VOL" && (r = {
    gap: {
      bottom: 2
    },
    ...r
  }), (e == null ? void 0 : e.createIndicator({
    name: t,
    // @ts-expect-error
    createTooltipDataSource: ({
      indicator: a,
      defaultStyles: i
    }) => {
      const o = [];
      return a.visible ? (o.push(i.tooltip.icons[1]), o.push(i.tooltip.icons[2]), o.push(i.tooltip.icons[3])) : (o.push(i.tooltip.icons[0]), o.push(i.tooltip.icons[2]), o.push(i.tooltip.icons[3])), {
        icons: o
      };
    }
  }, n, r)) ?? null;
}
var Dl = (e) => {
  let t, n = null, r, a = false;
  const [i, o] = $(e.theme), [s, c] = $(e.styles), [C, u] = $(e.locale), [y, p] = $(e.symbol), [L, M] = $(e.period), [P, K] = $(false), [w, Q] = $([...e.mainIndicators]), [S, A] = $({}), [b, O] = $(false), [H, t1] = $({
    key: e.timezone,
    text: b9(e.timezone, e.locale)
  }), [x, D] = $(false), [j, n1] = $(), [I1, N1] = $(""), [C1, F1] = $(e.drawingBarVisible), [j1, Z1] = $(false), [Q1, k] = $(false), [z, W] = $({
    visible: false,
    indicatorName: "",
    paneId: "",
    calcParams: []
  });
  e.ref({
    setTheme: o,
    getTheme: () => i(),
    setStyles: c,
    getStyles: () => n.getStyles(),
    setLocale: u,
    getLocale: () => C(),
    setTimezone: (h) => {
      t1({
        key: h,
        text: b9(e.timezone, C())
      });
    },
    getTimezone: () => H().key,
    setSymbol: p,
    getSymbol: () => y(),
    setPeriod: M,
    getPeriod: () => L()
  });
  const c1 = () => {
    n == null || n.resize();
  }, D1 = (h, f, v) => {
    let _ = f, E = _;
    switch (h.timespan) {
      case "minute": {
        _ = _ - _ % (60 * 1e3), E = _ - v * h.multiplier * 60 * 1e3;
        break;
      }
      case "hour": {
        _ = _ - _ % (60 * 60 * 1e3), E = _ - v * h.multiplier * 60 * 60 * 1e3;
        break;
      }
      case "day": {
        _ = _ - _ % (60 * 60 * 1e3), E = _ - v * h.multiplier * 24 * 60 * 60 * 1e3;
        break;
      }
      case "week": {
        const X = new Date(_).getDay(), f1 = X === 0 ? 6 : X - 1;
        _ = _ - f1 * 60 * 60 * 24;
        const m1 = new Date(_);
        _ = (/* @__PURE__ */ new Date(`${m1.getFullYear()}-${m1.getMonth() + 1}-${m1.getDate()}`)).getTime(), E = v * h.multiplier * 7 * 24 * 60 * 60 * 1e3;
        break;
      }
      case "month": {
        const r1 = new Date(_), X = r1.getFullYear(), f1 = r1.getMonth() + 1;
        _ = (/* @__PURE__ */ new Date(`${X}-${f1}-01`)).getTime(), E = v * h.multiplier * 30 * 24 * 60 * 60 * 1e3;
        const m1 = new Date(E);
        E = (/* @__PURE__ */ new Date(`${m1.getFullYear()}-${m1.getMonth() + 1}-01`)).getTime();
        break;
      }
      case "year": {
        const X = new Date(_).getFullYear();
        _ = (/* @__PURE__ */ new Date(`${X}-01-01`)).getTime(), E = v * h.multiplier * 365 * 24 * 60 * 60 * 1e3;
        const f1 = new Date(E);
        E = (/* @__PURE__ */ new Date(`${f1.getFullYear()}-01-01`)).getTime();
        break;
      }
    }
    return [E, _];
  };
  return w9(() => {
    if (window.addEventListener("resize", c1), n = init(t, {
      customApi: {
        formatDate: (f, v, _, E) => {
          switch (L().timespan) {
            case "minute":
              return E === FormatDateType.XAxis ? utils.formatDate(f, v, "HH:mm") : utils.formatDate(f, v, "YYYY-MM-DD HH:mm");
            case "hour":
              return E === FormatDateType.XAxis ? utils.formatDate(f, v, "MM-DD HH:mm") : utils.formatDate(f, v, "YYYY-MM-DD HH:mm");
            case "day":
            case "week":
              return utils.formatDate(f, v, "YYYY-MM-DD");
            case "month":
              return E === FormatDateType.XAxis ? utils.formatDate(f, v, "YYYY-MM") : utils.formatDate(f, v, "YYYY-MM-DD");
            case "year":
              return E === FormatDateType.XAxis ? utils.formatDate(f, v, "YYYY") : utils.formatDate(f, v, "YYYY-MM-DD");
          }
          return utils.formatDate(f, v, "YYYY-MM-DD HH:mm");
        }
      }
    }), n) {
      const f = n.getDom("candle_pane", DomPosition.Main);
      if (f) {
        let _ = document.createElement("div");
        if (_.className = "klinecharts-pro-watermark", utils.isString(e.watermark)) {
          const E = e.watermark.replace(/(^\s*)|(\s*$)/g, "");
          _.innerHTML = E;
        } else
          _.appendChild(e.watermark);
        f.appendChild(_);
      }
      const v = n.getDom("candle_pane", DomPosition.YAxis);
      r = document.createElement("span"), r.className = "klinecharts-pro-price-unit", v == null || v.appendChild(r);
    }
    w().forEach((f) => {
      V1(n, f, true, {
        id: "candle_pane"
      });
    });
    const h = {};
    e.subIndicators.forEach((f) => {
      const v = V1(n, f, true);
      v && (h[f] = v);
    }), A(h), n == null || n.loadMore((f) => {
      a = true, (async () => {
        const _ = L(), [E] = D1(_, f, 1), [r1] = D1(_, E, 500), X = await e.datafeed.getHistoryKLineData(y(), _, r1, E);
        n == null || n.applyMoreData(X, X.length > 0), a = false;
      })();
    }), n == null || n.subscribeAction(ActionType.OnTooltipIconClick, (f) => {
      if (f.indicatorName)
        switch (f.iconId) {
          case "visible": {
            n == null || n.overrideIndicator({
              name: f.indicatorName,
              visible: true
            }, f.paneId);
            break;
          }
          case "invisible": {
            n == null || n.overrideIndicator({
              name: f.indicatorName,
              visible: false
            }, f.paneId);
            break;
          }
          case "setting": {
            const v = n == null ? void 0 : n.getIndicatorByPaneId(f.paneId, f.indicatorName);
            W({
              visible: true,
              indicatorName: f.indicatorName,
              paneId: f.paneId,
              calcParams: v.calcParams
            });
            break;
          }
          case "close":
            if (f.paneId === "candle_pane") {
              const v = [...w()];
              n == null || n.removeIndicator("candle_pane", f.indicatorName), v.splice(v.indexOf(f.indicatorName), 1), Q(v);
            } else {
              const v = {
                ...S()
              };
              n == null || n.removeIndicator(f.paneId, f.indicatorName), delete v[f.indicatorName], A(v);
            }
        }
    });
  }), k0(() => {
    window.removeEventListener("resize", c1), dispose(t);
  }), a1(() => {
    const h = y();
    h != null && h.priceCurrency ? (r.innerHTML = h == null ? void 0 : h.priceCurrency.toLocaleUpperCase(), r.style.display = "flex") : r.style.display = "none", n == null || n.setPriceVolumePrecision((h == null ? void 0 : h.pricePrecision) ?? 2, (h == null ? void 0 : h.volumePrecision) ?? 0);
  }), a1((h) => {
    if (!a) {
      h && e.datafeed.unsubscribe(h.symbol, h.period);
      const f = y(), v = L();
      return a = true, k(true), (async () => {
        const [E, r1] = D1(v, (/* @__PURE__ */ new Date()).getTime(), 500), X = await e.datafeed.getHistoryKLineData(f, v, E, r1);
        n == null || n.applyNewData(X, X.length > 0), e.datafeed.subscribe(f, v, (f1) => {
          n == null || n.updateData(f1);
        }), a = false, k(false);
      })(), {
        symbol: f,
        period: v
      };
    }
    return h;
  }), a1(() => {
    const h = i();
    n == null || n.setStyles(h);
    const f = h === "dark" ? "#929AA5" : "#76808F";
    n == null || n.setStyles({
      indicator: {
        tooltip: {
          icons: [{
            id: "visible",
            position: TooltipIconPosition.Middle,
            marginLeft: 8,
            marginTop: 7,
            marginRight: 0,
            marginBottom: 0,
            paddingLeft: 0,
            paddingTop: 0,
            paddingRight: 0,
            paddingBottom: 0,
            icon: "",
            fontFamily: "icomoon",
            size: 14,
            color: f,
            activeColor: f,
            backgroundColor: "transparent",
            activeBackgroundColor: "rgba(22, 119, 255, 0.15)"
          }, {
            id: "invisible",
            position: TooltipIconPosition.Middle,
            marginLeft: 8,
            marginTop: 7,
            marginRight: 0,
            marginBottom: 0,
            paddingLeft: 0,
            paddingTop: 0,
            paddingRight: 0,
            paddingBottom: 0,
            icon: "",
            fontFamily: "icomoon",
            size: 14,
            color: f,
            activeColor: f,
            backgroundColor: "transparent",
            activeBackgroundColor: "rgba(22, 119, 255, 0.15)"
          }, {
            id: "setting",
            position: TooltipIconPosition.Middle,
            marginLeft: 6,
            marginTop: 7,
            marginBottom: 0,
            marginRight: 0,
            paddingLeft: 0,
            paddingTop: 0,
            paddingRight: 0,
            paddingBottom: 0,
            icon: "",
            fontFamily: "icomoon",
            size: 14,
            color: f,
            activeColor: f,
            backgroundColor: "transparent",
            activeBackgroundColor: "rgba(22, 119, 255, 0.15)"
          }, {
            id: "close",
            position: TooltipIconPosition.Middle,
            marginLeft: 6,
            marginTop: 7,
            marginRight: 0,
            marginBottom: 0,
            paddingLeft: 0,
            paddingTop: 0,
            paddingRight: 0,
            paddingBottom: 0,
            icon: "",
            fontFamily: "icomoon",
            size: 14,
            color: f,
            activeColor: f,
            backgroundColor: "transparent",
            activeBackgroundColor: "rgba(22, 119, 255, 0.15)"
          }]
        }
      }
    });
  }), a1(() => {
    n == null || n.setLocale(C());
  }), a1(() => {
    n == null || n.setTimezone(H().key);
  }), a1(() => {
    s() && (n == null || n.setStyles(s()), n1(Lr(n.getStyles())));
  }), [Il.cloneNode(true), d(U, {
    get when() {
      return j1();
    },
    get children() {
      return d(Tl, {
        get locale() {
          return e.locale;
        },
        get datafeed() {
          return e.datafeed;
        },
        onSymbolSelected: (h) => {
          p(h);
        },
        onClose: () => {
          Z1(false);
        }
      });
    }
  }), d(U, {
    get when() {
      return P();
    },
    get children() {
      return d(hl, {
        get locale() {
          return e.locale;
        },
        get mainIndicators() {
          return w();
        },
        get subIndicators() {
          return S();
        },
        onClose: () => {
          K(false);
        },
        onMainIndicatorChange: (h) => {
          const f = [...w()];
          h.added ? (V1(n, h.name, true, {
            id: "candle_pane"
          }), f.push(h.name)) : (n == null || n.removeIndicator("candle_pane", h.name), f.splice(f.indexOf(h.name), 1)), Q(f);
        },
        onSubIndicatorChange: (h) => {
          const f = {
            ...S()
          };
          if (h.added) {
            const v = V1(n, h.name);
            v && (f[h.name] = v);
          } else
            h.paneId && (n == null || n.removeIndicator(h.paneId, h.name), delete f[h.name]);
          A(f);
        }
      });
    }
  }), d(U, {
    get when() {
      return b();
    },
    get children() {
      return d(ml, {
        get locale() {
          return e.locale;
        },
        get timezone() {
          return H();
        },
        onClose: () => {
          O(false);
        },
        onConfirm: t1
      });
    }
  }), d(U, {
    get when() {
      return x();
    },
    get children() {
      return d(_l, {
        get locale() {
          return e.locale;
        },
        get currentStyles() {
          return utils.clone(n.getStyles());
        },
        onClose: () => {
          D(false);
        },
        onChange: (h) => {
          n == null || n.setStyles(h);
        },
        onRestoreDefault: (h) => {
          const f = {};
          h.forEach((v) => {
            const _ = v.key;
            p0(f, _, utils.formatValue(j(), _));
          }), n == null || n.setStyles(f);
        }
      });
    }
  }), d(U, {
    get when() {
      return I1().length > 0;
    },
    get children() {
      return d($l, {
        get locale() {
          return e.locale;
        },
        get url() {
          return I1();
        },
        onClose: () => {
          N1("");
        }
      });
    }
  }), d(U, {
    get when() {
      return z().visible;
    },
    get children() {
      return d(Al, {
        get locale() {
          return e.locale;
        },
        get params() {
          return z();
        },
        onClose: () => {
          W({
            visible: false,
            indicatorName: "",
            paneId: "",
            calcParams: []
          });
        },
        onConfirm: (h) => {
          const f = z();
          n == null || n.overrideIndicator({
            name: f.indicatorName,
            calcParams: h
          }, f.paneId);
        }
      });
    }
  }), d(Ko, {
    get locale() {
      return e.locale;
    },
    get symbol() {
      return y();
    },
    get spread() {
      return C1();
    },
    get period() {
      return L();
    },
    get periods() {
      return e.periods;
    },
    onMenuClick: async () => {
      try {
        await K5(() => F1(!C1())), n == null || n.resize();
      } catch {
      }
    },
    onSymbolClick: () => {
      Z1(!j1());
    },
    onPeriodChange: M,
    onIndicatorClick: () => {
      K((h) => !h);
    },
    onTimezoneClick: () => {
      O((h) => !h);
    },
    onSettingClick: () => {
      D((h) => !h);
    },
    onScreenshotClick: () => {
      if (n) {
        const h = n.getConvertPictureUrl(true, "jpeg", e.theme === "dark" ? "#151517" : "#ffffff");
        N1(h);
      }
    }
  }), (() => {
    const h = Nl.cloneNode(true), f = h.firstChild;
    m(h, d(U, {
      get when() {
        return Q1();
      },
      get children() {
        return d(s5, {});
      }
    }), f), m(h, d(U, {
      get when() {
        return C1();
      },
      get children() {
        return d(yl, {
          get locale() {
            return e.locale;
          },
          onDrawingItemClick: (_) => {
            n == null || n.createOverlay(_);
          },
          onModeChange: (_) => {
            n == null || n.overrideOverlay({
              mode: _
            });
          },
          onLockChange: (_) => {
            n == null || n.overrideOverlay({
              lock: _
            });
          },
          onVisibleChange: (_) => {
            n == null || n.overrideOverlay({
              visible: _
            });
          },
          onRemoveClick: (_) => {
            n == null || n.removeOverlay({
              groupId: _
            });
          }
        });
      }
    }), f);
    const v = t;
    return typeof v == "function" ? A0(v, f) : t = f, Z(() => G(f, "data-drawing-bar-visible", C1())), h;
  })()];
};
var Bl = g('<svg class="logo" viewBox="0 0 80 92"><path d="M17.3121,90.6225C17.4517,90.6436,17.5901,90.6541,17.7274,90.6541C19.0559,90.6541,20.2213,89.6944,20.4295,88.3532C20.6566,86.8762,19.6297,85.4953,18.1367,85.2705C12.4557,84.4139,8.6332,82.4828,6.77344,79.5289C4.57886,76.0413,5.81634,72.041,5.82344,72.0188C5.85893,71.9123,5.88732,71.8035,5.9098,71.6934C8.12389,60.6361,11.356,53.3215,14.8104,48.1192C18.2648,42.9169,21.9414,39.8269,25.0446,37.2188C26.5968,35.915,28.0614,34.6827,29.2456,33.3731C30.9225,31.5172,31.6197,29.527,31.6725,27.5336C35.6187,26.8278,40.9421,26.2679,47.2065,26.583C48.0984,31.9917,53.6073,36.1009,54.9203,37.0116C62.331,44.1074,67.7577,51.6455,71.0525,59.4213C71.4914,60.4582,72.5065,61.082,73.576,61.082C73.9388,61.082,74.2976,61.01,74.6313,60.8702C76.0249,60.2932,76.6815,58.7074,76.0971,57.3287C72.4887,48.8133,66.5865,40.6151,58.5547,32.9599C58.4423,32.8523,58.3157,32.7516,58.1868,32.665C57.0851,31.9259,54.232,29.5936,53.0642,27.1195C53.1331,27.1287,53.2022,27.138,53.2713,27.1474C54.0162,29.0245,55.8642,30.3535,58.026,30.3535C59.5009,30.3535,60.8298,29.7349,61.7619,28.7456C64.8144,29.7431,68.4378,31.7217,69.4046,35.5848C69.6826,36.6932,70.687,37.4351,71.792,37.4351C71.9884,37.4351,72.1871,37.4117,72.3859,37.3638C73.7062,37.0407,74.5106,35.7206,74.1841,34.4145C72.9993,29.682,69.5399,26.8822,66.0787,25.233C69.5063,23.5492,71.5221,21.2286,71.6702,21.054C72.5457,20.0253,72.412,18.4886,71.3721,17.6226C70.3322,16.7577,68.78,16.8888,67.9033,17.9175C67.87,17.9563,65.4948,20.6901,61.621,21.7153C60.6982,20.8102,59.4281,20.2511,58.026,20.2511C57.4767,20.2511,56.9477,20.3369,56.4519,20.4957C60.0845,17.7606,64.6729,14.2394,65.5797,13.2374C67.1035,11.5533,68.7444,9.07333,67.9103,6.83096C67.4406,5.56933,66.3321,4.73254,64.8675,4.53476C63.5567,4.35687,62.3511,4.77234,61.2899,5.13865C59.4858,5.76127,58.3843,6.06556,56.7564,5.08482C56.1318,4.70797,55.5284,4.32176,54.9369,3.94374L54.9364,3.9434C51.4796,1.73271,47.5602,-0.773825,41.9871,0.726471C40.5296,1.11853,39.6695,2.60604,40.0659,4.04789C40.4622,5.48975,41.9647,6.34058,43.4234,5.94853C46.497,5.12109,48.4668,6.25164,51.9662,8.48933C52.5992,8.89427,53.2439,9.30622,53.9124,9.70882C56.1034,11.0278,58.1028,11.2502,59.7803,11.0758C57.5491,12.857,53.6142,15.8508,49.9988,18.539C49.8498,18.6502,49.7137,18.7754,49.5907,18.9135C48.8054,19.7953,48.2004,20.7386,47.7817,21.7249C40.8791,21.3359,35.0392,21.9433,30.7016,22.7299C28.9691,18.45,25.3757,14.69,23.6876,12.9237L23.2771,12.4919C22.3803,11.5427,21.4493,9.09088,20.724,6.56646C22.9517,7.09896,24.4992,7.27569,26.6784,7.49454C28.182,7.64786,29.5236,6.56295,29.6762,5.07662C29.83,3.59029,28.7357,2.26195,27.2321,2.11098C24.2638,1.81255,22.7731,1.66274,17.8125,0.123747C16.8976,-0.159672,15.8995,0.0512175,15.1814,0.679657C14.4636,1.30796,14.1306,2.26212,14.3036,3.19471C14.6017,4.80159,16.2438,12.9776,19.2819,16.1902L19.7125,16.6431C21.7693,18.7949,24.087,21.4425,25.3073,23.9616C23.5312,24.4607,22.5042,24.8571,22.352,24.9172C21.0897,25.4146,20.4756,26.8272,20.9761,28.076C21.4777,29.3247,22.908,29.9368,24.1703,29.4429C24.1971,29.4326,24.7465,29.2231,25.7556,28.9202C25.6051,29.2154,25.4105,29.4984,25.1676,29.7672C24.2342,30.7995,22.9683,31.8633,21.5025,33.0957C15.0785,38.4945,5.37624,46.647,0.56829,70.5137C0.241766,71.6314,-1.1223,77.1437,2.07787,82.3084C4.80718,86.7136,9.93219,89.5095,17.3121,90.6225ZM31.9158,3.86173C31.9158,5.61208,33.3502,7.03101,35.1195,7.03101C36.8889,7.03101,38.3233,5.61208,38.3233,3.86173C38.3233,2.11139,36.8889,0.69245,35.1195,0.69245C33.3502,0.69245,31.9158,2.11139,31.9158,3.86173ZM76.4249,69.6758C74.6555,69.6758,73.2212,68.2569,73.2212,66.5065C73.2212,64.7562,74.6555,63.3372,76.4249,63.3372C78.1943,63.3372,79.6286,64.7562,79.6286,66.5065C79.6286,68.2569,78.1943,69.6758,76.4249,69.6758ZM33.3378,91.7858C34.2038,91.7987,35.0734,91.8045,35.9465,91.8045C51.0955,91.8046,67.0041,89.9999,69.4317,89.142C76.148,86.7686,80,81.5992,80,74.9575C80,73.463,78.7755,72.2517,77.2648,72.2517C75.754,72.2517,74.5295,73.463,74.5295,74.9575C74.5295,79.3603,72.1953,82.4184,67.6134,84.037C65.7512,84.6175,49.6344,86.6059,33.4183,86.3742C31.9158,86.3297,30.6653,87.5457,30.6428,89.0402C30.6203,90.5359,31.827,91.7636,33.3378,91.7858ZM22.0693,88.8307C22.0693,90.5811,23.5037,92,25.2731,92C27.0424,92,28.4768,90.5811,28.4768,88.8307C28.4768,87.0804,27.0424,85.6615,25.2731,85.6615C23.5037,85.6615,22.0693,87.0804,22.0693,88.8307Z" fill-rule="evenodd" fill-opacity="1"></path><rect x="23.445068359375" y="52.683013916015625" width="12.70588207244873" height="22.702716827392578" rx="2" fill-opacity="1"></rect><path d="M29.562697410583496 47.24264647066593C29.562697410583496 47.11269711728047 29.66804217572163 47.007352352142334 29.797991529107094 47.007352352142334L29.797991529107094 47.007352352142334C29.927940882492557 47.007352352142334 30.03328564763069 47.11269711728047 30.03328564763069 47.24264647066593L30.03328564763069 52.68303155899048C30.03328564763069 52.68303155899048 30.03328564763069 52.68303155899048 30.03328564763069 52.68303155899048L29.562697410583496 52.68303155899048C29.562697410583496 52.68303155899048 29.562697410583496 52.68303155899048 29.562697410583496 52.68303155899048Z" fill-opacity="1"></path><path d="M29.562697410583496 75.38572645187378C29.562697410583496 75.38572645187378 29.562697410583496 75.38572645187378 29.562697410583496 75.38572645187378L30.03328564763069 75.38572645187378C30.03328564763069 75.38572645187378 30.03328564763069 75.38572645187378 30.03328564763069 75.38572645187378L30.03328564763069 80.82611154019833C30.03328564763069 80.95606089358378 29.927940882492557 81.06140565872192 29.797991529107094 81.06140565872192L29.797991529107094 81.06140565872192C29.66804217572163 81.06140565872192 29.562697410583496 80.95606089358378 29.562697410583496 80.82611154019833Z" fill-opacity="1"></path><rect x="42.73918533325195" y="44.73706293106079" width="12.70588207244873" height="22.702716827392578" rx="2" fill-opacity="1"></rect><path d="M48.85681438446045 39.2966954857111C48.85681438446045 39.166746132325635 48.962159149598584 39.0614013671875 49.09210850298405 39.0614013671875L49.09210850298405 39.0614013671875C49.22205785636951 39.0614013671875 49.327402621507645 39.166746132325635 49.327402621507645 39.2966954857111L49.327402621507645 44.737080574035645C49.327402621507645 44.737080574035645 49.327402621507645 44.737080574035645 49.327402621507645 44.737080574035645L48.85681438446045 44.737080574035645C48.85681438446045 44.737080574035645 48.85681438446045 44.737080574035645 48.85681438446045 44.737080574035645Z" fill-opacity="1"></path><path d="M48.85681438446045 67.43977546691895C48.85681438446045 67.43977546691895 48.85681438446045 67.43977546691895 48.85681438446045 67.43977546691895L49.327402621507645 67.43977546691895C49.327402621507645 67.43977546691895 49.327402621507645 67.43977546691895 49.327402621507645 67.43977546691895L49.327402621507645 72.88016055524349C49.327402621507645 73.01010990862895 49.22205785636951 73.11545467376709 49.09210850298405 73.11545467376709L49.09210850298405 73.11545467376709C48.962159149598584 73.11545467376709 48.85681438446045 73.01010990862895 48.85681438446045 72.88016055524349Z" fill-opacity="1"></path></svg>');
var Pl = Bl.cloneNode(true);
var jl = class {
  constructor(t) {
    B1(this, "_chartApi", null);
    if (utils.isString(t.container)) {
      if (this._container = document.getElementById(t.container), !this._container)
        throw new Error("Container is null");
    } else
      this._container = t.container;
    this._container.classList.add("klinecharts-pro"), this._container.setAttribute("data-theme", t.theme ?? "light");
    const n = this;
    H5(() => d(Dl, {
      ref: (r) => {
        n._chartApi = r;
      },
      get styles() {
        return t.styles ?? {};
      },
      get watermark() {
        return t.watermark ?? Pl;
      },
      get theme() {
        return t.theme ?? "light";
      },
      get locale() {
        return t.locale ?? "zh-CN";
      },
      get drawingBarVisible() {
        return t.drawingBarVisible ?? true;
      },
      get symbol() {
        return t.symbol;
      },
      get period() {
        return t.period;
      },
      get periods() {
        return t.periods ?? [{
          multiplier: 1,
          timespan: "minute",
          text: "1m"
        }, {
          multiplier: 5,
          timespan: "minute",
          text: "5m"
        }, {
          multiplier: 15,
          timespan: "minute",
          text: "15m"
        }, {
          multiplier: 1,
          timespan: "hour",
          text: "1H"
        }, {
          multiplier: 2,
          timespan: "hour",
          text: "2H"
        }, {
          multiplier: 4,
          timespan: "hour",
          text: "4H"
        }, {
          multiplier: 1,
          timespan: "day",
          text: "D"
        }, {
          multiplier: 1,
          timespan: "week",
          text: "W"
        }, {
          multiplier: 1,
          timespan: "month",
          text: "M"
        }, {
          multiplier: 1,
          timespan: "year",
          text: "Y"
        }];
      },
      get timezone() {
        return t.timezone ?? "Asia/Shanghai";
      },
      get mainIndicators() {
        return t.mainIndicators ?? ["MA"];
      },
      get subIndicators() {
        return t.subIndicators ?? ["VOL"];
      },
      get datafeed() {
        return t.datafeed;
      }
    }), this._container);
  }
  setTheme(t) {
    var n;
    (n = this._container) == null || n.setAttribute("data-theme", t), this._chartApi.setTheme(t);
  }
  getTheme() {
    return this._chartApi.getTheme();
  }
  setStyles(t) {
    this._chartApi.setStyles(t);
  }
  getStyles() {
    return this._chartApi.getStyles();
  }
  setLocale(t) {
    this._chartApi.setLocale(t);
  }
  getLocale() {
    return this._chartApi.getLocale();
  }
  setTimezone(t) {
    this._chartApi.setTimezone(t);
  }
  getTimezone() {
    return this._chartApi.getTimezone();
  }
  setSymbol(t) {
    this._chartApi.setSymbol(t);
  }
  getSymbol() {
    return this._chartApi.getSymbol();
  }
  setPeriod(t) {
    this._chartApi.setPeriod(t);
  }
  getPeriod() {
    return this._chartApi.getPeriod();
  }
};
D5.forEach((e) => {
  registerOverlay(e);
});
export {
  Kl as DefaultDatafeed,
  jl as KLineChartPro,
  Fl as loadLocales
};
/*! Bundled license information:

klinecharts/dist/index.esm.js:
  (**
       * @license
       * KLineChart v9.8.12
       * Copyright (c) 2019 lihu.
       * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
       *)
*/
//# sourceMappingURL=@klinecharts_pro.js.map
